#<AdxTL>@(#)0.0.0.0 $Revision$Class Report
# Supervisor
## ACLA-CLASSE ## AREPORT
# 2018-08-27 12:22:22 630


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : RPTCOD Report code ( Field ARP 15)
####################################################################

$SET_RPTCOD
If [L]_AOLDVAL<>this.RPTCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_RPTCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.RPTCOD
 Gosub PROPAGATE_RPTCOD
Endif
Return

$INIT_RPTCOD
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_RPTCOD
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_RPTCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_RPTCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_RPTCOD
[L]CURPRO = "RPTCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.RPTCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_RPTCOD
[L]CURPRO = "RPTCOD"
If vireblc(this.RPTCOD,2)<>vireblc(format$("K:15c",this.RPTCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_RPTCOD
[L]CURPRO = "RPTCOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_RPTCOD
[L]CURPRO = "RPTCOD"
Return

$PROPAGATE_RPTCOD
this.isReadonly = 0
[L]CURPRO = "RPTCOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_RPTCOD
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTCOD"
$_LNKPRO_RPTCOD
Return

$_ALOADATTRIBUTE_RPTCOD
[L]ASTATUS = fmet this.ASETATTRIBUTE("RPTCOD","$isMandatory","true")
Return


####################################################################
# 2 : GRP Group ( Field Local menu number 97)
####################################################################

$SET_GRP
If [L]_AOLDVAL<>this.GRP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_GRP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.GRP
 Gosub PROPAGATE_GRP
Endif
Return

$INIT_GRP
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GRP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.GRP=0 and fmet this.AGETATTRIBUTE("GRP","$isMandatory")="true"
 this.GRP = 1
Endif
Return
 
$CONTROL_GRP
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GRP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_GRP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_GRP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_GRP
[L]CURPRO = "GRP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.GRP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_GRP
[L]CURPRO = "GRP"
If this.GRP<0 or this.GRP>len(mess(0,97,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"97 ->"-num$(this.GRP)-mess(99,123,1)):  Return : # Local menu "97 -> Invalid option
Endif
Return

$_AOTHERS_GRP
[L]CURPRO = "GRP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_GRP
[L]CURPRO = "GRP"
Return

$PROPAGATE_GRP
this.isReadonly = 0
[L]CURPRO = "GRP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_GRP
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GRP"
$_LNKPRO_GRP
Return


####################################################################
# 3 : MODULE Module ( Field Local menu number 14)
####################################################################

$SET_MODULE
If [L]_AOLDVAL<>this.MODULE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MODULE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MODULE
 Gosub PROPAGATE_MODULE
Endif
Return

$INIT_MODULE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MODULE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.MODULE=0 and fmet this.AGETATTRIBUTE("MODULE","$isMandatory")="true"
 this.MODULE = 1
Endif
Return
 
$CONTROL_MODULE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MODULE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MODULE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MODULE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MODULE
[L]CURPRO = "MODULE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.MODULE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MODULE
[L]CURPRO = "MODULE"
If this.MODULE<0 or this.MODULE>len(mess(0,14,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"14 ->"-num$(this.MODULE)-mess(99,123,1)):  Return : # Local menu "14 -> Invalid option
Endif
Return

$_AOTHERS_MODULE
[L]CURPRO = "MODULE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MODULE
[L]CURPRO = "MODULE"
Return

$PROPAGATE_MODULE
this.isReadonly = 0
[L]CURPRO = "MODULE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MODULE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MODULE"
$_LNKPRO_MODULE
Return


####################################################################
# 4 : CODACT Activity code ( Field ACV 5)
####################################################################

$SET_CODACT
If [L]_AOLDVAL<>this.CODACT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CODACT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CODACT
 Gosub PROPAGATE_CODACT
Endif
Return

$INIT_CODACT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "CODACT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CODACT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "CODACT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CODACT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CODACT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CODACT
[L]CURPRO = "CODACT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CODACT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CODACT
[L]CURPRO = "CODACT"
If vireblc(this.CODACT,2)<>vireblc(format$("KTD:5B",this.CODACT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CODACT
[L]CURPRO = "CODACT"
If vireblc(this.CODACT,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPACV.ACTRLREF(this,"CODACT",this.CODACT,this.CODACT,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CODACT<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CODACT
[L]CURPRO = "CODACT"
Return

$PROPAGATE_CODACT
this.isReadonly = 0
[L]CURPRO = "CODACT"
Gosub _LNKPRO_CODACT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CODACT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "CODACT"
$_LNKPRO_CODACT
If vireblc(this.CODACT,2)<>""
 # Link ACTIV
 Local File ACTIV [WACV]
 Read [F:WACV]CODACT = this.CODACT
 If !fstat
  Local File ATEXTE [WATX]
  For [F:WATX] Where NUMERO=[F:WACV]LIBACT & LAN=this.ACTX.LAN
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CODACT","$description",[WATX]TEXTE)
  Next WATX
  LogicClose File [WATX]
 Endif
 LogicClose File [WACV]
Endif
Return


####################################################################
# 5 : ENAFLG Active ( Field Local menu number 1)
####################################################################

$SET_ENAFLG
If [L]_AOLDVAL<>this.ENAFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ENAFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ENAFLG
 Gosub PROPAGATE_ENAFLG
Endif
Return

$INIT_ENAFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ENAFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.ENAFLG=0 and fmet this.AGETATTRIBUTE("ENAFLG","$isMandatory")="true"
 this.ENAFLG = 1
Endif
Return
 
$CONTROL_ENAFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ENAFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ENAFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ENAFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ENAFLG
[L]CURPRO = "ENAFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ENAFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ENAFLG
[L]CURPRO = "ENAFLG"
If this.ENAFLG<0 or this.ENAFLG>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.ENAFLG)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_ENAFLG
[L]CURPRO = "ENAFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ENAFLG
[L]CURPRO = "ENAFLG"
Return

$PROPAGATE_ENAFLG
this.isReadonly = 0
[L]CURPRO = "ENAFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ENAFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ENAFLG"
$_LNKPRO_ENAFLG
Return


####################################################################
# 6 : LAN Language ( Field LAN 3)
####################################################################

$SET_LAN
If [L]_AOLDVAL<>this.LAN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LAN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LAN
 Gosub PROPAGATE_LAN
Endif
Return

$INIT_LAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "LAN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "LAN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LAN                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LAN                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LAN
[L]CURPRO = "LAN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LAN,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LAN
[L]CURPRO = "LAN"
If vireblc(this.LAN,2)<>vireblc(format$("KTD:3B",this.LAN),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_LAN
[L]CURPRO = "LAN"
If vireblc(this.LAN,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPLAN.ACTRLREF(this,"LAN",this.LAN,this.LAN,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.LAN<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LAN
[L]CURPRO = "LAN"
Return

$PROPAGATE_LAN
this.isReadonly = 0
[L]CURPRO = "LAN"
Gosub _LNKPRO_LAN
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "LAN"
$_LNKPRO_LAN
If vireblc(this.LAN,2)<>""
 # Link TABLAN
 Local File TABLAN [WTLA]
 Read [F:WTLA]TLA0 = this.LAN
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABLAN" & ZONE="INTSHO" & IDENT1=[F:WTLA]LAN & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("LAN","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABLAN" & ZONE="INTDES" & IDENT1=[F:WTLA]LAN & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("LAN","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTLA]
Endif
Return

$_ALOADATTRIBUTE_LAN
[L]ASTATUS = fmet this.ASETATTRIBUTE("LAN","$isMandatory","true")
Return


####################################################################
# 7 : MULLAN Multi-language ( Field Local menu number 1)
####################################################################

$SET_MULLAN
If [L]_AOLDVAL<>this.MULLAN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MULLAN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MULLAN
 Gosub PROPAGATE_MULLAN
Endif
Return

$INIT_MULLAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MULLAN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.MULLAN=0 and fmet this.AGETATTRIBUTE("MULLAN","$isMandatory")="true"
 this.MULLAN = 1
Endif
Return
 
$CONTROL_MULLAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MULLAN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MULLAN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MULLAN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MULLAN
[L]CURPRO = "MULLAN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.MULLAN=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MULLAN
[L]CURPRO = "MULLAN"
If this.MULLAN<0 or this.MULLAN>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.MULLAN)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_MULLAN
[L]CURPRO = "MULLAN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MULLAN
[L]CURPRO = "MULLAN"
Return

$PROPAGATE_MULLAN
this.isReadonly = 0
[L]CURPRO = "MULLAN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MULLAN
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "MULLAN"
$_LNKPRO_MULLAN
Return


####################################################################
# 8 : RPTDES Description ( Field ATX)
####################################################################

$GET_RPTDES
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTDES"
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_RPTDES
If [L]_AOLDVAL<>this.RPTDES
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_RPTDES
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.RPTDES
 Gosub PROPAGATE_RPTDES
Endif
Return

$INIT_RPTDES
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTDES"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_RPTDES
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTDES"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_RPTDES                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_RPTDES                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_RPTDES
[L]CURPRO = "RPTDES"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & (maxtab(this.ATX)=0 or  func ASYRSUB._HASFIELDATX(this.ATX,[L]CURPRO)=0)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_RPTDES
[L]CURPRO = "RPTDES"
Return

$_AOTHERS_RPTDES
[L]CURPRO = "RPTDES"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_RPTDES
[L]CURPRO = "RPTDES"
Return

$PROPAGATE_RPTDES
this.isReadonly = 0
[L]CURPRO = "RPTDES"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_RPTDES
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTDES"
$_LNKPRO_RPTDES
Return


####################################################################
# 9 : RPTSHO Short description ( Field ATX)
####################################################################

$GET_RPTSHO
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTSHO"
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_RPTSHO
If [L]_AOLDVAL<>this.RPTSHO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_RPTSHO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.RPTSHO
 Gosub PROPAGATE_RPTSHO
Endif
Return

$INIT_RPTSHO
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTSHO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_RPTSHO
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTSHO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_RPTSHO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_RPTSHO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_RPTSHO
[L]CURPRO = "RPTSHO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & (maxtab(this.ATX)=0 or  func ASYRSUB._HASFIELDATX(this.ATX,[L]CURPRO)=0)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_RPTSHO
[L]CURPRO = "RPTSHO"
Return

$_AOTHERS_RPTSHO
[L]CURPRO = "RPTSHO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_RPTSHO
[L]CURPRO = "RPTSHO"
Return

$PROPAGATE_RPTSHO
this.isReadonly = 0
[L]CURPRO = "RPTSHO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_RPTSHO
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "RPTSHO"
$_LNKPRO_RPTSHO
Return


####################################################################
# 11 : TRTINI Standard processing ( Field ADC 30)
####################################################################

$SET_TRTINI
If [L]_AOLDVAL<>this.TRTINI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TRTINI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TRTINI
 Gosub PROPAGATE_TRTINI
Endif
Return

$INIT_TRTINI
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTINI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TRTINI
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTINI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TRTINI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TRTINI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TRTINI
[L]CURPRO = "TRTINI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TRTINI,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TRTINI
[L]CURPRO = "TRTINI"
If vireblc(this.TRTINI,2)<>vireblc(format$("KTD:30X",this.TRTINI),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TRTINI
[L]CURPRO = "TRTINI"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TRTINI
[L]CURPRO = "TRTINI"
Return

$PROPAGATE_TRTINI
this.isReadonly = 0
[L]CURPRO = "TRTINI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TRTINI
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTINI"
$_LNKPRO_TRTINI
Return


####################################################################
# 12 : TRTSPE Specific processing ( Field ADC 30)
####################################################################

$SET_TRTSPE
If [L]_AOLDVAL<>this.TRTSPE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TRTSPE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TRTSPE
 Gosub PROPAGATE_TRTSPE
Endif
Return

$INIT_TRTSPE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTSPE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TRTSPE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTSPE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TRTSPE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TRTSPE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TRTSPE
[L]CURPRO = "TRTSPE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TRTSPE,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TRTSPE
[L]CURPRO = "TRTSPE"
If vireblc(this.TRTSPE,2)<>vireblc(format$("KTD:30X",this.TRTSPE),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TRTSPE
[L]CURPRO = "TRTSPE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TRTSPE
[L]CURPRO = "TRTSPE"
Return

$PROPAGATE_TRTSPE
this.isReadonly = 0
[L]CURPRO = "TRTSPE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TRTSPE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "TRTSPE"
$_LNKPRO_TRTSPE
Return


####################################################################
# 13 : EXEFLG Not executable ( Field Local menu number 1)
####################################################################

$SET_EXEFLG
If [L]_AOLDVAL<>this.EXEFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EXEFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EXEFLG
 Gosub PROPAGATE_EXEFLG
Endif
Return

$INIT_EXEFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.EXEFLG=0 and fmet this.AGETATTRIBUTE("EXEFLG","$isMandatory")="true"
 this.EXEFLG = 1
Endif
Return
 
$CONTROL_EXEFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EXEFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EXEFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EXEFLG
[L]CURPRO = "EXEFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EXEFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EXEFLG
[L]CURPRO = "EXEFLG"
If this.EXEFLG<0 or this.EXEFLG>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.EXEFLG)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_EXEFLG
[L]CURPRO = "EXEFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EXEFLG
[L]CURPRO = "EXEFLG"
Return

$PROPAGATE_EXEFLG
this.isReadonly = 0
[L]CURPRO = "EXEFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EXEFLG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEFLG"
$_LNKPRO_EXEFLG
Return


####################################################################
# 14 : FNC Function ( Field AFC 12)
####################################################################

$SET_FNC
If [L]_AOLDVAL<>this.FNC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_FNC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.FNC
 Gosub PROPAGATE_FNC
Endif
Return

$INIT_FNC
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "FNC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_FNC
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "FNC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_FNC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_FNC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_FNC
[L]CURPRO = "FNC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.FNC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_FNC
[L]CURPRO = "FNC"
If vireblc(this.FNC,2)<>vireblc(format$("KTD:12B",this.FNC),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_FNC
[L]CURPRO = "FNC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_FNC
[L]CURPRO = "FNC"
Return

$PROPAGATE_FNC
this.isReadonly = 0
[L]CURPRO = "FNC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_FNC
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "FNC"
$_LNKPRO_FNC
Return


####################################################################
# 15 : AUZFCY Authorization site ( Field Local menu number 1)
####################################################################

$SET_AUZFCY
If [L]_AOLDVAL<>this.AUZFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AUZFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AUZFCY
 Gosub PROPAGATE_AUZFCY
Endif
Return

$INIT_AUZFCY
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "AUZFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.AUZFCY=0 and fmet this.AGETATTRIBUTE("AUZFCY","$isMandatory")="true"
 this.AUZFCY = 1
Endif
Return
 
$CONTROL_AUZFCY
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "AUZFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AUZFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AUZFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AUZFCY
[L]CURPRO = "AUZFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AUZFCY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AUZFCY
[L]CURPRO = "AUZFCY"
If this.AUZFCY<0 or this.AUZFCY>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.AUZFCY)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_AUZFCY
[L]CURPRO = "AUZFCY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AUZFCY
[L]CURPRO = "AUZFCY"
Return

$PROPAGATE_AUZFCY
this.isReadonly = 0
[L]CURPRO = "AUZFCY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AUZFCY
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "AUZFCY"
$_LNKPRO_AUZFCY
Return


####################################################################
# 16 : ACS Access code ( Field ACS 10)
####################################################################

$SET_ACS
If [L]_AOLDVAL<>this.ACS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ACS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ACS
 Gosub PROPAGATE_ACS
Endif
Return

$INIT_ACS
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ACS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ACS
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ACS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ACS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ACS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ACS
[L]CURPRO = "ACS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ACS,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ACS
[L]CURPRO = "ACS"
If vireblc(this.ACS,2)<>vireblc(format$("KTD:10B",this.ACS),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_ACS
[L]CURPRO = "ACS"
If vireblc(this.ACS,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPACS.ACTRLREF(this,"ACS",this.ACS,this.ACS,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ACS<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ACS
[L]CURPRO = "ACS"
Return

$PROPAGATE_ACS
this.isReadonly = 0
[L]CURPRO = "ACS"
Gosub _LNKPRO_ACS
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ACS
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "ACS"
$_LNKPRO_ACS
If vireblc(this.ACS,2)<>""
 # Link ACCCOD
 Local File ACCCOD [WACS]
 Read [F:WACS]ACS0 = this.ACS
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ACCCOD" & ZONE="DESACC" & IDENT1=[F:WACS]CODACC & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("ACS","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WACS]
Endif
Return


####################################################################
# 17 : PRTSRV Server ( Field A 30)
####################################################################

$SET_PRTSRV
If [L]_AOLDVAL<>this.PRTSRV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTSRV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTSRV
 Gosub PROPAGATE_PRTSRV
Endif
Return

$INIT_PRTSRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTSRV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTSRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTSRV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTSRV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTSRV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTSRV
[L]CURPRO = "PRTSRV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTSRV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTSRV
[L]CURPRO = "PRTSRV"
Return

$_AOTHERS_PRTSRV
[L]CURPRO = "PRTSRV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTSRV
[L]CURPRO = "PRTSRV"
Return

$PROPAGATE_PRTSRV
this.isReadonly = 0
[L]CURPRO = "PRTSRV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTSRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTSRV"
$_LNKPRO_PRTSRV
Return


####################################################################
# 18 : PRTNAM Destination ( Field A 50)
####################################################################

$SET_PRTNAM
If [L]_AOLDVAL<>this.PRTNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTNAM
 Gosub PROPAGATE_PRTNAM
Endif
Return

$INIT_PRTNAM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTNAM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTNAM
[L]CURPRO = "PRTNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTNAM
[L]CURPRO = "PRTNAM"
Return

$_AOTHERS_PRTNAM
[L]CURPRO = "PRTNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTNAM
[L]CURPRO = "PRTNAM"
Return

$PROPAGATE_PRTNAM
this.isReadonly = 0
[L]CURPRO = "PRTNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTNAM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAM"
$_LNKPRO_PRTNAM
Return


####################################################################
# 19 : PRTOBL Mandatory ( Field Local menu number 1)
####################################################################

$SET_PRTOBL
If [L]_AOLDVAL<>this.PRTOBL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTOBL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTOBL
 Gosub PROPAGATE_PRTOBL
Endif
Return

$INIT_PRTOBL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTOBL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PRTOBL=0 and fmet this.AGETATTRIBUTE("PRTOBL","$isMandatory")="true"
 this.PRTOBL = 1
Endif
Return
 
$CONTROL_PRTOBL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTOBL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTOBL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTOBL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTOBL
[L]CURPRO = "PRTOBL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PRTOBL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTOBL
[L]CURPRO = "PRTOBL"
If this.PRTOBL<0 or this.PRTOBL>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.PRTOBL)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_PRTOBL
[L]CURPRO = "PRTOBL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTOBL
[L]CURPRO = "PRTOBL"
Return

$PROPAGATE_PRTOBL
this.isReadonly = 0
[L]CURPRO = "PRTOBL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTOBL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTOBL"
$_LNKPRO_PRTOBL
Return


####################################################################
# 20 : PRTDRV Driver ( Field A 30)
####################################################################

$SET_PRTDRV
If [L]_AOLDVAL<>this.PRTDRV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTDRV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTDRV
 Gosub PROPAGATE_PRTDRV
Endif
Return

$INIT_PRTDRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDRV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTDRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDRV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTDRV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTDRV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTDRV
[L]CURPRO = "PRTDRV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTDRV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTDRV
[L]CURPRO = "PRTDRV"
Return

$_AOTHERS_PRTDRV
[L]CURPRO = "PRTDRV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTDRV
[L]CURPRO = "PRTDRV"
Return

$PROPAGATE_PRTDRV
this.isReadonly = 0
[L]CURPRO = "PRTDRV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTDRV
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDRV"
$_LNKPRO_PRTDRV
Return


####################################################################
# 21 : PRTPOR Port ( Field A 30)
####################################################################

$SET_PRTPOR
If [L]_AOLDVAL<>this.PRTPOR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTPOR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTPOR
 Gosub PROPAGATE_PRTPOR
Endif
Return

$INIT_PRTPOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTPOR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTPOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTPOR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTPOR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTPOR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTPOR
[L]CURPRO = "PRTPOR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTPOR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTPOR
[L]CURPRO = "PRTPOR"
Return

$_AOTHERS_PRTPOR
[L]CURPRO = "PRTPOR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTPOR
[L]CURPRO = "PRTPOR"
Return

$PROPAGATE_PRTPOR
this.isReadonly = 0
[L]CURPRO = "PRTPOR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTPOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTPOR"
$_LNKPRO_PRTPOR
Return


####################################################################
# 23 : PARSEG Segmentation ( Field A 15)
####################################################################

$SET_PARSEG
If [L]_AOLDVAL<>this.PARSEG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PARSEG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PARSEG
 Gosub PROPAGATE_PARSEG
Endif
Return

$INIT_PARSEG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PARSEG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PARSEG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PARSEG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PARSEG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PARSEG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PARSEG
[L]CURPRO = "PARSEG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PARSEG,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PARSEG
[L]CURPRO = "PARSEG"
Return

$_AOTHERS_PARSEG
[L]CURPRO = "PARSEG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PARSEG
[L]CURPRO = "PARSEG"
Return

$PROPAGATE_PARSEG
this.isReadonly = 0
[L]CURPRO = "PARSEG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PARSEG
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PARSEG"
$_LNKPRO_PARSEG
Return


####################################################################
# 24 : PRTNAT Type ( Field Local menu number 22)
####################################################################

$SET_PRTNAT
If [L]_AOLDVAL<>this.PRTNAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTNAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTNAT
 Gosub PROPAGATE_PRTNAT
Endif
Return

$INIT_PRTNAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PRTNAT=0 and fmet this.AGETATTRIBUTE("PRTNAT","$isMandatory")="true"
 this.PRTNAT = 1
Endif
Return
 
$CONTROL_PRTNAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTNAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTNAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTNAT
[L]CURPRO = "PRTNAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PRTNAT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTNAT
[L]CURPRO = "PRTNAT"
If this.PRTNAT<0 or this.PRTNAT>len(mess(0,22,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"22 ->"-num$(this.PRTNAT)-mess(99,123,1)):  Return : # Local menu "22 -> Invalid option
Endif
Return

$_AOTHERS_PRTNAT
[L]CURPRO = "PRTNAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTNAT
[L]CURPRO = "PRTNAT"
Return

$PROPAGATE_PRTNAT
this.isReadonly = 0
[L]CURPRO = "PRTNAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTNAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTNAT"
$_LNKPRO_PRTNAT
Return


####################################################################
# 25 : PRTDEF Printer ( Field AIM 10)
####################################################################

$SET_PRTDEF
If [L]_AOLDVAL<>this.PRTDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTDEF
 Gosub PROPAGATE_PRTDEF
Endif
Return

$INIT_PRTDEF
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTDEF
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTDEF                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTDEF                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTDEF
[L]CURPRO = "PRTDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTDEF,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTDEF
[L]CURPRO = "PRTDEF"
If vireblc(this.PRTDEF,2)<>vireblc(format$("K:10c",this.PRTDEF),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PRTDEF
[L]CURPRO = "PRTDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTDEF
[L]CURPRO = "PRTDEF"
Return

$PROPAGATE_PRTDEF
this.isReadonly = 0
[L]CURPRO = "PRTDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTDEF
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTDEF"
$_LNKPRO_PRTDEF
Return


####################################################################
# 26 : PRTFRM Add info formula ( Field AFR 250)
####################################################################

$SET_PRTFRM
If [L]_AOLDVAL<>this.PRTFRM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRTFRM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRTFRM
 Gosub PROPAGATE_PRTFRM
Endif
Return

$INIT_PRTFRM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTFRM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRTFRM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTFRM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRTFRM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRTFRM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRTFRM
[L]CURPRO = "PRTFRM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRTFRM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRTFRM
[L]CURPRO = "PRTFRM"
Return

$_AOTHERS_PRTFRM
[L]CURPRO = "PRTFRM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRTFRM
[L]CURPRO = "PRTFRM"
Return

$PROPAGATE_PRTFRM
this.isReadonly = 0
[L]CURPRO = "PRTFRM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRTFRM
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "PRTFRM"
$_LNKPRO_PRTFRM
Return


####################################################################
# 27 : EXEBAT Execute in batch ( Field Local menu number 1)
####################################################################

$SET_EXEBAT
If [L]_AOLDVAL<>this.EXEBAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EXEBAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EXEBAT
 Gosub PROPAGATE_EXEBAT
Endif
Return

$INIT_EXEBAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEBAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.EXEBAT=0 and fmet this.AGETATTRIBUTE("EXEBAT","$isMandatory")="true"
 this.EXEBAT = 1
Endif
Return
 
$CONTROL_EXEBAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEBAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EXEBAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EXEBAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EXEBAT
[L]CURPRO = "EXEBAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EXEBAT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EXEBAT
[L]CURPRO = "EXEBAT"
If this.EXEBAT<0 or this.EXEBAT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.EXEBAT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_EXEBAT
[L]CURPRO = "EXEBAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EXEBAT
[L]CURPRO = "EXEBAT"
Return

$PROPAGATE_EXEBAT
this.isReadonly = 0
[L]CURPRO = "EXEBAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EXEBAT
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "EXEBAT"
$_LNKPRO_EXEBAT
Return


####################################################################
# 28 : HOR Hourly constraints ( Field ABH 5)
####################################################################

$SET_HOR
If [L]_AOLDVAL<>this.HOR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_HOR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.HOR
 Gosub PROPAGATE_HOR
Endif
Return

$INIT_HOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "HOR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_HOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "HOR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_HOR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_HOR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_HOR
[L]CURPRO = "HOR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.HOR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_HOR
[L]CURPRO = "HOR"
If vireblc(this.HOR,2)<>vireblc(format$("K:5c",this.HOR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_HOR
[L]CURPRO = "HOR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_HOR
[L]CURPRO = "HOR"
Return

$PROPAGATE_HOR
this.isReadonly = 0
[L]CURPRO = "HOR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_HOR
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "HOR"
$_LNKPRO_HOR
Return


####################################################################
# 29 : IMPLIE Linked prints ( Field Local menu number 1)
####################################################################

$SET_IMPLIE
If [L]_AOLDVAL<>this.IMPLIE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_IMPLIE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.IMPLIE
 Gosub PROPAGATE_IMPLIE
Endif
Return

$INIT_IMPLIE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "IMPLIE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.IMPLIE=0 and fmet this.AGETATTRIBUTE("IMPLIE","$isMandatory")="true"
 this.IMPLIE = 1
Endif
Return
 
$CONTROL_IMPLIE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "IMPLIE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_IMPLIE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_IMPLIE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_IMPLIE
[L]CURPRO = "IMPLIE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.IMPLIE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_IMPLIE
[L]CURPRO = "IMPLIE"
If this.IMPLIE<0 or this.IMPLIE>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.IMPLIE)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_IMPLIE
[L]CURPRO = "IMPLIE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_IMPLIE
[L]CURPRO = "IMPLIE"
Return

$PROPAGATE_IMPLIE
this.isReadonly = 0
[L]CURPRO = "IMPLIE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_IMPLIE
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "IMPLIE"
$_LNKPRO_IMPLIE
Return


####################################################################
# 30 : GESZPL ZPL printer ( Field Local menu number 1)
####################################################################

$SET_GESZPL
If [L]_AOLDVAL<>this.GESZPL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_GESZPL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.GESZPL
 Gosub PROPAGATE_GESZPL
Endif
Return

$INIT_GESZPL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GESZPL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.GESZPL=0 and fmet this.AGETATTRIBUTE("GESZPL","$isMandatory")="true"
 this.GESZPL = 1
Endif
Return
 
$CONTROL_GESZPL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GESZPL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_GESZPL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_GESZPL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_GESZPL
[L]CURPRO = "GESZPL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.GESZPL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_GESZPL
[L]CURPRO = "GESZPL"
If this.GESZPL<0 or this.GESZPL>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.GESZPL)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_GESZPL
[L]CURPRO = "GESZPL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_GESZPL
[L]CURPRO = "GESZPL"
Return

$PROPAGATE_GESZPL
this.isReadonly = 0
[L]CURPRO = "GESZPL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_GESZPL
Gosub DECLARE_VAR From WMC0AREPORT
[L]CURPRO = "GESZPL"
$_LNKPRO_GESZPL
Return




