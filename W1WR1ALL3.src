#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management WR1ALL3 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [16/04/2018]
A_HEURE = "14:35:31"
A_USER  = "ADMIN"
A_STAMP = "20180416143531"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If [M:MFG3]FMTDIE(1)<>""
    Chgfmt CCE1 With [M:MFG3]FMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(2)<>""
    Chgfmt CCE2 With [M:MFG3]FMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(3)<>""
    Chgfmt CCE3 With [M:MFG3]FMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(4)<>""
    Chgfmt CCE4 With [M:MFG3]FMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(5)<>""
    Chgfmt CCE5 With [M:MFG3]FMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(6)<>""
    Chgfmt CCE6 With [M:MFG3]FMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(7)<>""
    Chgfmt CCE7 With [M:MFG3]FMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(8)<>""
    Chgfmt CCE8 With [M:MFG3]FMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(9)<>""
    Chgfmt CCE9 With [M:MFG3]FMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(10)<>""
    Chgfmt CCE10 With [M:MFG3]FMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(11)<>""
    Chgfmt CCE11 With [M:MFG3]FMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(12)<>""
    Chgfmt CCE12 With [M:MFG3]FMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(13)<>""
    Chgfmt CCE13 With [M:MFG3]FMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(14)<>""
    Chgfmt CCE14 With [M:MFG3]FMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(15)<>""
    Chgfmt CCE15 With [M:MFG3]FMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(16)<>""
    Chgfmt CCE16 With [M:MFG3]FMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(17)<>""
    Chgfmt CCE17 With [M:MFG3]FMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(18)<>""
    Chgfmt CCE18 With [M:MFG3]FMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(19)<>""
    Chgfmt CCE19 With [M:MFG3]FMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(20)<>""
    Chgfmt CCE20 With [M:MFG3]FMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(1)<>""
    Chgfmt LABCCE1 With [M:MFG3]FMTDIE(1)
   Else
    Chgfmt LABCCE1 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(2)<>""
    Chgfmt LABCCE2 With [M:MFG3]FMTDIE(2)
   Else
    Chgfmt LABCCE2 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(3)<>""
    Chgfmt LABCCE3 With [M:MFG3]FMTDIE(3)
   Else
    Chgfmt LABCCE3 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(4)<>""
    Chgfmt LABCCE4 With [M:MFG3]FMTDIE(4)
   Else
    Chgfmt LABCCE4 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(5)<>""
    Chgfmt LABCCE5 With [M:MFG3]FMTDIE(5)
   Else
    Chgfmt LABCCE5 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(6)<>""
    Chgfmt LABCCE6 With [M:MFG3]FMTDIE(6)
   Else
    Chgfmt LABCCE6 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(7)<>""
    Chgfmt LABCCE7 With [M:MFG3]FMTDIE(7)
   Else
    Chgfmt LABCCE7 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(8)<>""
    Chgfmt LABCCE8 With [M:MFG3]FMTDIE(8)
   Else
    Chgfmt LABCCE8 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(9)<>""
    Chgfmt LABCCE9 With [M:MFG3]FMTDIE(9)
   Else
    Chgfmt LABCCE9 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(10)<>""
    Chgfmt LABCCE10 With [M:MFG3]FMTDIE(10)
   Else
    Chgfmt LABCCE10 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(11)<>""
    Chgfmt LABCCE11 With [M:MFG3]FMTDIE(11)
   Else
    Chgfmt LABCCE11 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(12)<>""
    Chgfmt LABCCE12 With [M:MFG3]FMTDIE(12)
   Else
    Chgfmt LABCCE12 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(13)<>""
    Chgfmt LABCCE13 With [M:MFG3]FMTDIE(13)
   Else
    Chgfmt LABCCE13 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(14)<>""
    Chgfmt LABCCE14 With [M:MFG3]FMTDIE(14)
   Else
    Chgfmt LABCCE14 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(15)<>""
    Chgfmt LABCCE15 With [M:MFG3]FMTDIE(15)
   Else
    Chgfmt LABCCE15 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(16)<>""
    Chgfmt LABCCE16 With [M:MFG3]FMTDIE(16)
   Else
    Chgfmt LABCCE16 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(17)<>""
    Chgfmt LABCCE17 With [M:MFG3]FMTDIE(17)
   Else
    Chgfmt LABCCE17 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(18)<>""
    Chgfmt LABCCE18 With [M:MFG3]FMTDIE(18)
   Else
    Chgfmt LABCCE18 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(19)<>""
    Chgfmt LABCCE19 With [M:MFG3]FMTDIE(19)
   Else
    Chgfmt LABCCE19 With "-K:1X"
   Endif
   If [M:MFG3]FMTDIE(20)<>""
    Chgfmt LABCCE20 With [M:MFG3]FMTDIE(20)
   Else
    Chgfmt LABCCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WR1ALL3 [MFG3]
Gosub HORODAT
Local Inpbox "WR1ALL3" From GFONCTION At A_STAMP With A_WINDPREV Mask [MFG3] As [SIM_]
Grizo [MFG3]5
Grizo [MFG3]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MFG3]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=80 : Y1(0)=1 : Y2(0)=2
X1(1)=1 : X2(1)=80 : Y1(1)=3 : Y2(1)=23
Return

$ON_SCDMOD
Onevent INIT_AREA Call D_SCDMOD(zc) From W1WR1ALL3
Return

Subprog D_SCDMOD(VALEUR)
Variable Integer VALEUR
If varinit([M]SCDMOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SCDFLG
Onevent INIT_AREA Call D_SCDFLG(zc) From W1WR1ALL3
Return

Subprog D_SCDFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]SCDFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_REACT
Onevent INIT_AREA Call D_REACT(zc) From W1WR1ALL3
Return

Subprog D_REACT(VALEUR)
Variable Integer VALEUR
If varinit([M]REACT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_NBLIG
Onevent CONTROL Call C_NBLIG From W1WR1ALL3
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WR1ALL3
Onevent BEFORE_INPUT Call AS_NBLIG From W1WR1ALL3
Onevent BEFORE_AREA Call AV_NBLIG From W1WR1ALL3
Return

Subprog IB_NBLIG
Local Decimal BASPAG
## Action STD
Call IB_NBLIG From SUBMFG3
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W5WR1ALL3
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
Call TEXTE(17010,GBOUT2) From OBJDIV
Call TEXTE(17009,GBOUT3) From OBJDIV
Call TEXTE(17009,GBOUT4) From OBJDIV
Call TEXTE(454,GBOUT5) From OBJDIV
Call TEXTE(454,GBOUT6) From OBJDIV
Call TEXTE(28866,GBOUT7) From OBJDIV
Call IB_NBLIG
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WR1ALL3
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WR1ALL3
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WR1ALL3
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WR1ALL3
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WR1ALL3
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WR1ALL3
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WR1ALL3
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBMFG3
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOFICH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOFICH"
 PARMSK(1) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOW","MFGWINLIB","XWIMFOW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B2_NBLIG From SUBMFG3
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKSTA"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MFG3"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOQTY","MFGWINLIB","XWIMFOQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKSTAB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKSTAB"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MFG3"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOQTYB","MFGWINLIB","XWIMFOQTYB") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBMFG3
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ACLOB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ACLOB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_NBLIG" : PROGSUB = "SUBMFG3" : PROGSPE = "SPEMFG3" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MFG3]MFOTEX(nolign-1)
 PARMSK(2) = "MFO"
 PARMSK(3) = "TRTX3TEX"
 PARMSK(4) = "MFG3"
 PARMSK(5) = num$(nolign)
 PARMSK(6) = "1"
 Call TRAITE_NUM(BASPAG,PARMSK,"","ACLOB","ACLOB",3,"XYACLOB") From GTRAITE
 [M:MFG3]MFOTEX(nolign-1) = PARMSK(1)
 ACTION = "BB5_NBLIG" : PROGSUB = "SUBMFG3" : PROGSPE = "SPEMFG3" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIMODPOX
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIMODPOX"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB6_NBLIG" : PROGSUB = "SUBMFG3" : PROGSPE = "SPEMFG3" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = "4"
 PARMSK(3) = "1"
 PARMSK(4) = [M:MFG3]WIPNUM(nolign-1)
 PARMSK(5) = [M:MFG3]SCOITMREF(nolign-1)
 PARMSK(6) = "4"
 PARMSK(7) = "4"
 PARMSK(8) = GUSER
 PARMSK(9) = num$([M:MFG3]REACT)
 Call SAISIE_NUM(BASPAG,PARMSK,"DMODPOF","BENCHLIBP","XYZBENCHLIBP") From GSAISIE
 [M:MFG3]REACT = val(PARMSK(9))
 ACTION = "BB6_NBLIG" : PROGSUB = "SUBMFG3" : PROGSPE = "SPEMFG3" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUETASST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUETASST"
 PARMSK(1) = [M:MFG0]MFGNUM
 PARMSK(2) = num$([M:MFG3]OPENUM(nolign-1))
 PARMSK(3) = num$([M:MFG3]OPESPLNUM(nolign-1))
 PARMSK(4) = "MFG3"
 PARMSK(5) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYSCO","TRTDSYSCO","SPEDSYSCO") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NOLIG
Onevent BEFORE_AREA Gosub AV_NOLIG From W1WR1ALL3
Return

$AV_NOLIG
zc = nolign
Gosub _AFF
Return

$ON_OPENUM
Return

$ON_OPESTA
Onevent INIT_AREA Call D_OPESTA(zc) From W1WR1ALL3
Return

Subprog D_OPESTA(VALEUR)
Variable Integer VALEUR
If varinit([M]OPESTA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EXTWST
Onevent BEFORE_INPUT Call AS_EXTWST(zc) From W1WR1ALL3
Onevent CONTROL Call C_EXTWST(zc) From W1WR1ALL3
Onevent AFTER_AREA Call AP_EXTWST(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTWST From W1WR1ALL3
Return

Subprog AS_EXTWST(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5964,GBOUT1) From OBJDIV
Call TEXTE(454,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
If !([M]OPESTA(nolign-1)<4  & GMODIF = 2)
 Affzo EXTWST : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_EXTWST(VALEUR) From SUBMFG3
 If mkstat=2
  [M]EXTWST(INDIC) = VALEUR
  Affzo EXTWST(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action PASRVMMFM
  Call PASRVMMFM From RVMLIB
  If mkstat=2
   [M]EXTWST(INDIC) = VALEUR
   Affzo EXTWST(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_EXTWST(zc) From W1WR1ALL3
  Onkey 130 Titled GBOUT2 Call B2_EXTWST(zc) From W1WR1ALL3
  Onkey 131 Titled GBOUT3 Call B3_EXTWST(zc) From W1WR1ALL3
  Onkey   2 Titled GBOUTS Call S_EXTWST(zc) From W1WR1ALL3
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTWST(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "EXTWST" : GZNUM = 6076 : Endif
If !mkstat
 ## Action STD
 Call C_EXTWST(VALEUR) From SUBMFG3
 If mkstat : GERR = 1 : GZONE = "EXTWST" : GZNUM = 6076 : Endif
Endif
Gosub _AFF
End

Subprog AP_EXTWST(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_EXTWST(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTWST" : GZNUM = 6076 : Endif
Gosub _AFF
End

$AMM_EXTWST
Call AM_EXTWST(zc)
If !mkstat & GOBJET
 zoncou = "EXTWST" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTWST(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_EXTWST(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTWST" : GZNUM = 6076 : Endif
Gosub _AFF
End

Subprog S_EXTWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_EXTWST(VALEUR)
Variable Char    VALEUR()
## Action GOBJETC0
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "GOBJETC0"
Local Char    OBJCLE(30)
OBJCLE = [M:MFG0]MFGFCY
Call OBJET_CHAR(OBJCLE,"MWS",VALEUR) From GOBJET
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_EXTWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call B2_EXTWST(VALEUR) From SUBMFG3
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_EXTWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELRPLWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELRPLWST"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELRPLWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_OPESTR
Onevent BEFORE_AREA Gosub AV_OPESTR From W1WR1ALL3
Return

$AV_OPESTR
Chgfmt [M]OPESTR(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_OPEEND
Onevent BEFORE_AREA Gosub AV_OPEEND From W1WR1ALL3
Return

$AV_OPEEND
Chgfmt [M]OPEEND(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_FDMA
Onevent BEFORE_AREA Gosub AV_FDMA From W1WR1ALL3
Return

$AV_FDMA
Chgfmt [M]FDMA(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_FRCSTRDAT
Onevent BEFORE_AREA Gosub AV_FRCSTRDAT From W1WR1ALL3
Onevent BEFORE_INPUT Call AS_FRCSTRDAT(zc) From W1WR1ALL3
Onevent CONTROL Call C_FRCSTRDAT(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_FRCSTRDAT From W1WR1ALL3
Return

$AV_FRCSTRDAT
## Action STD
Call AV_FRCSTRDAT(zc) From SUBMFG3
Chgfmt [M]FRCSTRDAT(indice) With "DZc:"+GFMDAT
Gosub _AFF
Return

Subprog AS_FRCSTRDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
If !([M]OPESTA(nolign-1)<4 & [M]SCDCOD(nolign-1) < 7 & GMODIF = 2)
 Affzo FRCSTRDAT : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_FRCSTRDAT(VALEUR) From SUBMFG3
 If mkstat=2
  [M]FRCSTRDAT(INDIC) = VALEUR
  Affzo FRCSTRDAT(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_FRCSTRDAT(zc) From W1WR1ALL3
Endif
Gosub _AFF
End

Subprog C_FRCSTRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_FRCSTRDAT(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "FRCSTRDAT" : GZNUM = 12343 : Endif
Gosub _AFF
End

$AMM_FRCSTRDAT
Call AM_FRCSTRDAT(zc)
If !mkstat & GOBJET
 zoncou = "FRCSTRDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FRCSTRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_FRCSTRDAT(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "FRCSTRDAT" : GZNUM = 12343 : Endif
Gosub _AFF
End

Subprog B1_FRCSTRDAT(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action MFOFRC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOFRC"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MFG3"
 Call SAISIE_DAT(VALEUR,PARMSK,"IMFOFRC","MFGWINLIB","XWIMFOFRC") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FRCSTRHOU
Onevent CONTROL Call C_FRCSTRHOU(zc) From W1WR1ALL3
Onevent AFTER_AREA Call AP_FRCSTRHOU(zc) From W1WR1ALL3
Onevent BEFORE_INPUT Call AS_FRCSTRHOU(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_FRCSTRHOU From W1WR1ALL3
Return

Subprog AS_FRCSTRHOU(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<4&[M]SCDCOD(nolign-1)<7 & GMODIF = 2)
 Affzo FRCSTRHOU : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_FRCSTRHOU(VALEUR) From SUBMFG3
 If mkstat=2
  [M]FRCSTRHOU(INDIC) = VALEUR
  Affzo FRCSTRHOU(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_FRCSTRHOU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTHM
 Call CONTHM(VALEUR) From OBJDIV
 If mkstat : GERR = 1 : GZONE = "FRCSTRHOU" : GZNUM = 12344 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_FRCSTRHOU(VALEUR) From SUBMFG3
 If mkstat : GERR = 1 : GZONE = "FRCSTRHOU" : GZNUM = 12344 : Endif
Endif
Gosub _AFF
End

Subprog AP_FRCSTRHOU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action INIHM
 Call INIHM(VALEUR) From OBJDIV
 If mkstat : GERR = 1 : GZONE = "FRCSTRHOU" : GZNUM = 12344 : Endif
Endif
Gosub _AFF
End

$AMM_FRCSTRHOU
Call AM_FRCSTRHOU(zc)
If !mkstat & GOBJET
 zoncou = "FRCSTRHOU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FRCSTRHOU(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_FRCSTRHOU(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "FRCSTRHOU" : GZNUM = 12344 : Endif
Gosub _AFF
End

$ON_WCR
Return

$ON_EXTWSTNBR
Onevent BEFORE_INPUT Call AS_EXTWSTNBR(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTWSTNBR From W1WR1ALL3
Onevent CONTROL Call C_EXTWSTNBR(zc) From W1WR1ALL3
Return

Subprog AS_EXTWSTNBR(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<4 & GMODIF = 2)
 Affzo EXTWSTNBR : mkstat = 2
Endif
If !mkstat
 ## Action PASRVMMFM
 Call PASRVMMFM From RVMLIB
 If mkstat=2
  [M]EXTWSTNBR(INDIC) = VALEUR
  Affzo EXTWSTNBR(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTWSTNBR(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "EXTWSTNBR" : GZNUM = 2879 : Endif
Gosub _AFF
End

$AMM_EXTWSTNBR
Call AM_EXTWSTNBR(zc)
If !mkstat & GOBJET
 zoncou = "EXTWSTNBR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTWSTNBR(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTWSTNBR(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTWSTNBR" : GZNUM = 2879 : Endif
Gosub _AFF
End

$ON_EXTQTY
Onevent BEFORE_AREA Gosub AV_EXTQTY From W1WR1ALL3
Onevent BEFORE_INPUT Call AS_EXTQTY(zc) From W1WR1ALL3
Onevent CONTROL Call C_EXTQTY(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTQTY From W1WR1ALL3
Return

$AV_EXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]OPEUOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_EXTQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<5 & GMODIF = 2)
 Affzo EXTQTY : mkstat = 2
Endif
If !mkstat
 ## Action PASRVMMFM
 Call PASRVMMFM From RVMLIB
 If mkstat=2
  [M]EXTQTY(INDIC) = VALEUR
  Affzo EXTQTY(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_EXTQTY(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTQTY" : GZNUM = 1906 : Endif
Gosub _AFF
End

$AMM_EXTQTY
Call AM_EXTQTY(zc)
If !mkstat & GOBJET
 zoncou = "EXTQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTQTY(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTQTY" : GZNUM = 1906 : Endif
Gosub _AFF
End

$ON_OPEUOM
Return

$ON_TIMUOMCOD
Onevent INIT_AREA Call D_TIMUOMCOD(zc) From W1WR1ALL3
Return

Subprog D_TIMUOMCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]TIMUOMCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EXTSETTIM
Onevent BEFORE_INPUT Call AS_EXTSETTIM(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTSETTIM From W1WR1ALL3
Onevent CONTROL Call C_EXTSETTIM(zc) From W1WR1ALL3
Return

Subprog AS_EXTSETTIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<5 & GMODIF = 2)
 Affzo EXTSETTIM : mkstat = 2
Endif
If !mkstat
 ## Action PASRVMMFM
 Call PASRVMMFM From RVMLIB
 If mkstat=2
  [M]EXTSETTIM(INDIC) = VALEUR
  Affzo EXTSETTIM(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTSETTIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_EXTSETTIM
Call AM_EXTSETTIM(zc)
If !mkstat & GOBJET
 zoncou = "EXTSETTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTSETTIM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTSETTIM(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTSETTIM" : GZNUM = 2398 : Endif
Gosub _AFF
End

$ON_EXTUNTTIM
Onevent BEFORE_INPUT Call AS_EXTUNTTIM(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTUNTTIM From W1WR1ALL3
Onevent CONTROL Call C_EXTUNTTIM(zc) From W1WR1ALL3
Return

Subprog AS_EXTUNTTIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<5 & GMODIF = 2)
 Affzo EXTUNTTIM : mkstat = 2
Endif
If !mkstat
 ## Action PASRVMMFM
 Call PASRVMMFM From RVMLIB
 If mkstat=2
  [M]EXTUNTTIM(INDIC) = VALEUR
  Affzo EXTUNTTIM(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTUNTTIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_EXTUNTTIM
Call AM_EXTUNTTIM(zc)
If !mkstat & GOBJET
 zoncou = "EXTUNTTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTUNTTIM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTUNTTIM(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTUNTTIM" : GZNUM = 10664 : Endif
Gosub _AFF
End

$ON_EXTOPETIM
Onevent BEFORE_INPUT Call AS_EXTOPETIM(zc) From W1WR1ALL3
Onevent AFTER_CHANGE Gosub AMM_EXTOPETIM From W1WR1ALL3
Onevent CONTROL Call C_EXTOPETIM(zc) From W1WR1ALL3
Return

Subprog AS_EXTOPETIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]OPESTA(nolign-1)<5 & GMODIF = 2)
 Affzo EXTOPETIM : mkstat = 2
Endif
If !mkstat
 ## Action PASRVMMFM
 Call PASRVMMFM From RVMLIB
 If mkstat=2
  [M]EXTOPETIM(INDIC) = VALEUR
  Affzo EXTOPETIM(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_EXTOPETIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_EXTOPETIM
Call AM_EXTOPETIM(zc)
If !mkstat & GOBJET
 zoncou = "EXTOPETIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTOPETIM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTOPETIM(VALEUR) From SUBMFG3
If mkstat : GERR = 1 : GZONE = "EXTOPETIM" : GZNUM = 2905 : Endif
Gosub _AFF
End

$ON_SCOCOD
Onevent INIT_AREA Call D_SCOCOD(zc) From W1WR1ALL3
Return

Subprog D_SCOCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]SCOCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SCOWCR
Return

$ON_SCOWST
Onevent CONTROL Call C_SCOWST(zc) From W1WR1ALL3
Onevent BEFORE_INPUT Call AS_SCOWST(zc) From W1WR1ALL3
Return

Subprog AS_SCOWST(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M:MFG3]SCOCOD(nolign-1) = 3 & GMODIF=2)
 Affzo SCOWST : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

Subprog C_SCOWST(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "SCOWST" : GZNUM = 6049 : Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W5WR1ALL3
Return

$TIT_COL
Gosub TIT_COL From W5WR1ALL3
Return


