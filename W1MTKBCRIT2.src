#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management MTKBCRIT2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:53:55"
A_USER  = "ADMIN"
A_STAMP = "20180326125355"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask MTKBCRIT2 [MTB2]
Gosub HORODAT
Local Inpbox "MTKBCRIT2" From GFONCTION At A_STAMP With A_WINDPREV Mask [MTB2] As [SIM_]
Grizo [MTB2]5
Grizo [MTB2]10
Grizo [MTB2]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MTB2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=8 : X2(0)=104 : Y1(0)=7 : Y2(0)=9
X1(1)=8 : X2(1)=104 : Y1(1)=10 : Y2(1)=18
X1(2)=8 : X2(2)=104 : Y1(2)=19 : Y2(2)=21
Return

$ON_MEMO
Return

$ON_FORMULE
Onevent CONTROL Call C_FORMULE(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_FORMULE(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_FORMULE From W1MTKBCRIT2
Return

Subprog AS_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_FORMULE(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_FORMULE(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_FORMULE(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_FORMULE(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_FORMULE(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"16",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "FORMULE" : GZNUM = 12877 : Endif
Gosub _AFF
End

$AMM_FORMULE
Call AM_FORMULE(zc)
If !mkstat & GOBJET
 zoncou = "FORMULE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FORMULE(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZFORMULE)")>indice
 [M]FORMULE(indice) = VALEUR
 Affzo ZFORMULE(indice)
Endif
Gosub _AFF
End

Subprog S_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "16"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FORMULE(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"16") From GOBJET
Gosub _AFF
End

Subprog SA_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "16"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "16"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZFORMULE
Onevent BEFORE_AREA Gosub AV_ZFORMULE From W1MTKBCRIT2
Return

$AV_ZFORMULE
Call LECTEXTRA(zc,"TABFOR","DES","16",num$([M]FORMULE(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_WMFGNUMD
Onevent CONTROL Call C_WMFGNUMD(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WMFGNUMD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WMFGNUMD From W1MTKBCRIT2
Return

Subprog AS_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_WMFGNUMD(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WMFGNUMD(INDIC) = VALEUR
 Affzo WMFGNUMD(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WMFGNUMD(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WMFGNUMD" : GZNUM = 9595 : Endif
Endif
Gosub _AFF
End

$AMM_WMFGNUMD
Call AM_WMFGNUMD(zc)
If !mkstat & GOBJET
 zoncou = "WMFGNUMD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WMFGNUMD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WMFGNUMD" : GZNUM = 9595 : Endif
Gosub _AFF
End

Subprog S_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call S_WMFGNUMD(VALEUR) From FUNBENCHM
Endif
Gosub _AFF
End

$ON_WMFGNUMF
Onevent CONTROL Call C_WMFGNUMF(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WMFGNUMF(zc) From W1MTKBCRIT2
Return

Subprog AS_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_WMFGNUMF(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WMFGNUMF(INDIC) = VALEUR
 Affzo WMFGNUMF(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WMFGNUMF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WMFGNUMF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_WMFGNUMF(VALEUR) From FUNBENCHM
 If mkstat : GERR = 1 : GZONE = "WMFGNUMF" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call S_WMFGNUMF(VALEUR) From FUNBENCHM
Endif
Gosub _AFF
End

$ON_WOPENUMD
Onevent BEFORE_INPUT Call AS_WOPENUMD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WOPENUMD From W1MTKBCRIT2
Onevent CONTROL Call C_WOPENUMD(zc) From W1MTKBCRIT2
Return

Subprog AS_WOPENUMD(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WOPENUMD(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WOPENUMD(INDIC) = VALEUR
 Affzo WOPENUMD(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_WOPENUMD(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_WOPENUMD
Call AM_WOPENUMD(zc)
If !mkstat & GOBJET
 zoncou = "WOPENUMD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WOPENUMD(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_WOPENUMD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WOPENUMD" : GZNUM = 2296 : Endif
Gosub _AFF
End

$ON_WOPENUMF
Onevent BEFORE_INPUT Call AS_WOPENUMF(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_WOPENUMF(zc) From W1MTKBCRIT2
Return

Subprog AS_WOPENUMF(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WOPENUMF(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WOPENUMF(INDIC) = VALEUR
 Affzo WOPENUMF(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_WOPENUMF(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_WOPENUMF(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WOPENUMF" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_WITMRELD
Onevent CONTROL Call C_WITMRELD(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WITMRELD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WITMRELD From W1MTKBCRIT2
Return

Subprog IB_WITMRELD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMRELD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMRELD(VALEUR)
## Action STD
Call AS_WITMRELD(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WITMRELD(INDIC) = VALEUR
 Affzo WITMRELD(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WITMRELD(zc) From W1MTKBCRIT2
Onkey 170 Titled GBOUT13 Call B13_WITMRELD(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WITMRELD(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WITMRELD(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WITMRELD(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WITMRELD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMRELD" : GZNUM = 11093 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMRELD" : GZNUM = 11093 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMRELD" : GZNUM = 11093 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMRELD
Call AM_WITMRELD(zc)
If !mkstat & GOBJET
 zoncou = "WITMRELD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMRELD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WITMRELD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WITMRELD" : GZNUM = 11093 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWITMRELD)")>indice
 [M]WITMRELD(indice) = VALEUR
 Affzo ZWITMRELD(indice)
Endif
Gosub _AFF
End

Subprog S_WITMRELD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WITMRELD(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_WITMRELD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMRELD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMRELD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMRELD
Onevent BEFORE_AREA Gosub AV_ZWITMRELD From W1MTKBCRIT2
Return

$AV_ZWITMRELD
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMRELD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WITMRELF
Onevent CONTROL Call C_WITMRELF(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WITMRELF(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WITMRELF From W1MTKBCRIT2
Return

Subprog IB_WITMRELF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMRELF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMRELF(VALEUR)
## Action STD
Call AS_WITMRELF(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WITMRELF(INDIC) = VALEUR
 Affzo WITMRELF(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WITMRELF(zc) From W1MTKBCRIT2
Onkey 170 Titled GBOUT13 Call B13_WITMRELF(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WITMRELF(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WITMRELF(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WITMRELF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WITMRELF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMRELF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMRELF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMRELF" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WITMRELF(VALEUR) From FUNBENCHM
   If mkstat : GERR = 1 : GZONE = "WITMRELF" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMRELF
Call AM_WITMRELF(zc)
If !mkstat & GOBJET
 zoncou = "WITMRELF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMRELF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWITMRELF)")>indice
 [M]WITMRELF(indice) = VALEUR
 Affzo ZWITMRELF(indice)
Endif
Gosub _AFF
End

Subprog S_WITMRELF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WITMRELF(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_WITMRELF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMRELF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMRELF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMRELF
Onevent BEFORE_AREA Gosub AV_ZWITMRELF From W1MTKBCRIT2
Return

$AV_ZWITMRELF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMRELF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WBOMNUMD
Onevent CONTROL Call C_WBOMNUMD(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WBOMNUMD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WBOMNUMD From W1MTKBCRIT2
Return

Subprog IB_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WBOMNUMD(VALEUR)
## Action STD
Call AS_WBOMNUMD(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WBOMNUMD(INDIC) = VALEUR
 Affzo WBOMNUMD(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WBOMNUMD(zc) From W1MTKBCRIT2
Onkey 170 Titled GBOUT13 Call B13_WBOMNUMD(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WBOMNUMD(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WBOMNUMD(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WBOMNUMD(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WBOMNUMD" : GZNUM = 3966 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WBOMNUMD" : GZNUM = 3966 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WBOMNUMD" : GZNUM = 3966 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WBOMNUMD
Call AM_WBOMNUMD(zc)
If !mkstat & GOBJET
 zoncou = "WBOMNUMD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WBOMNUMD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WBOMNUMD" : GZNUM = 3966 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMNUMD)")>indice
 [M]WBOMNUMD(indice) = VALEUR
 Affzo ZWBOMNUMD(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WBOMNUMD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMNUMD
Onevent BEFORE_AREA Gosub AV_ZWBOMNUMD From W1MTKBCRIT2
Return

$AV_ZWBOMNUMD
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WBOMNUMD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WBOMNUMF
Onevent CONTROL Call C_WBOMNUMF(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WBOMNUMF(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WBOMNUMF From W1MTKBCRIT2
Return

Subprog IB_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WBOMNUMF(VALEUR)
## Action STD
Call AS_WBOMNUMF(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WBOMNUMF(INDIC) = VALEUR
 Affzo WBOMNUMF(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WBOMNUMF(zc) From W1MTKBCRIT2
Onkey 170 Titled GBOUT13 Call B13_WBOMNUMF(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WBOMNUMF(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WBOMNUMF(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WBOMNUMF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WBOMNUMF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WBOMNUMF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WBOMNUMF" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WBOMNUMF(VALEUR) From FUNBENCHM
   If mkstat : GERR = 1 : GZONE = "WBOMNUMF" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WBOMNUMF
Call AM_WBOMNUMF(zc)
If !mkstat & GOBJET
 zoncou = "WBOMNUMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMNUMF)")>indice
 [M]WBOMNUMF(indice) = VALEUR
 Affzo ZWBOMNUMF(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WBOMNUMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMNUMF
Onevent BEFORE_AREA Gosub AV_ZWBOMNUMF From W1MTKBCRIT2
Return

$AV_ZWBOMNUMF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WBOMNUMF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WBOMALTD
Onevent BEFORE_INPUT Call AS_WBOMALTD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WBOMALTD From W1MTKBCRIT2
Onevent CONTROL Call C_WBOMALTD(zc) From W1MTKBCRIT2
Return

Subprog AS_WBOMALTD(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_WBOMALTD(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WBOMALTD(INDIC) = VALEUR
 Affzo WBOMALTD(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WBOMALTD(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WBOMALTD(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WBOMALTD(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!B",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WBOMALTD" : GZNUM = 3964 : Endif
Gosub _AFF
End

$AMM_WBOMALTD
Call AM_WBOMALTD(zc)
If !mkstat & GOBJET
 zoncou = "WBOMALTD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMALTD(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_WBOMALTD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WBOMALTD" : GZNUM = 3964 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMALTD)")>indice
 [M]WBOMALTD(indice) = VALEUR
 Affzo ZWBOMALTD(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMALTD(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]FCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_WBOMALTD(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMALTD
Onevent BEFORE_AREA Gosub AV_ZWBOMALTD From W1MTKBCRIT2
Return

$AV_ZWBOMALTD
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX","2",num$([M]WBOMALTD(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_WBOMALTF
Onevent BEFORE_INPUT Call AS_WBOMALTF(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_WBOMALTF(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WBOMALTF From W1MTKBCRIT2
Return

Subprog AS_WBOMALTF(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_WBOMALTF(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WBOMALTF(INDIC) = VALEUR
 Affzo WBOMALTF(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WBOMALTF(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WBOMALTF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WBOMALTF(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!B",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WBOMALTF" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_WBOMALTF(VALEUR) From FUNBENCHM
 If mkstat : GERR = 1 : GZONE = "WBOMALTF" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_WBOMALTF
Call AM_WBOMALTF(zc)
If !mkstat & GOBJET
 zoncou = "WBOMALTF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMALTF(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMALTF)")>indice
 [M]WBOMALTF(indice) = VALEUR
 Affzo ZWBOMALTF(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMALTF(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]FCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_WBOMALTF(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMALTF
Onevent BEFORE_AREA Gosub AV_ZWBOMALTF From W1MTKBCRIT2
Return

$AV_ZWBOMALTF
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX","2",num$([M]WBOMALTF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_WCDED
Onevent CONTROL Call C_WCDED(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WCDED(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WCDED From W1MTKBCRIT2
Return

Subprog AS_WCDED(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_WCDED(VALEUR) From FUNBENCHM
If mkstat=2
 [M]WCDED(INDIC) = VALEUR
 Affzo WCDED(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WCDED(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WCDED(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WCDED" : GZNUM = 3312 : Endif
Endif
Gosub _AFF
End

$AMM_WCDED
Call AM_WCDED(zc)
If !mkstat & GOBJET
 zoncou = "WCDED" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WCDED(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WCDED(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WCDED" : GZNUM = 3312 : Endif
Gosub _AFF
End

Subprog S_WCDED(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 PARMSK(3) = [M]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WCDEF
Onevent CONTROL Call C_WCDEF(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WCDEF(zc) From W1MTKBCRIT2
Return

Subprog AS_WCDEF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WCDEF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WCDEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WCDEF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_WCDEF(VALEUR) From FUNBENCHM
 If mkstat : GERR = 1 : GZONE = "WCDEF" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_WCDEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 PARMSK(3) = [M]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WPJTD
Onevent BEFORE_INPUT Call AS_WPJTD(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_WPJTD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WPJTD From W1MTKBCRIT2
Return

Subprog IB_WPJTD(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTD(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat=2
 [M]WPJTD(INDIC) = VALEUR
 Affzo WPJTD(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_WPJTD(VALEUR) From FUNBENCHM
 If mkstat=2
  [M]WPJTD(INDIC) = VALEUR
  Affzo WPJTD(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_WPJTD(zc) From W1MTKBCRIT2
 Onkey 130 Titled GBOUT2 Call B2_WPJTD(zc) From W1MTKBCRIT2
 Onkey 131 Titled GBOUT3 Call B3_WPJTD(zc) From W1MTKBCRIT2
 Onkey 132 Titled GBOUT4 Call B4_WPJTD(zc) From W1MTKBCRIT2
 Onkey 172 Titled GBOUT15 Call B15_WPJTD(zc) From W1MTKBCRIT2
 Onkey 173 Titled GBOUT16 Call B16_WPJTD(zc) From W1MTKBCRIT2
 Onkey 174 Titled GBOUT17 Call B17_WPJTD(zc) From W1MTKBCRIT2
 Onkey 175 Titled GBOUT18 Call B18_WPJTD(zc) From W1MTKBCRIT2
 Onkey 176 Titled GBOUT19 Call B19_WPJTD(zc) From W1MTKBCRIT2
 Onkey   2 Titled GBOUTS Call S_WPJTD(zc) From W1MTKBCRIT2
 Onkey 144 Titled GBOUTP Call P_WPJTD(zc) From W1MTKBCRIT2
 Onkey 146 Titled GBOUTA Call SA_WPJTD(zc) From W1MTKBCRIT2
Endif
Gosub _AFF
End

Subprog C_WPJTD(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTD" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTD" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_WPJTD
Call AM_WPJTD(zc)
If !mkstat & GOBJET
 zoncou = "WPJTD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTD(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTD" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_WPJTD(VALEUR) From FUNBENCHM
 If mkstat : GERR = 1 : GZONE = "WPJTD" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MTB2","WPJTD",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTD"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WPJTF
Onevent BEFORE_INPUT Call AS_WPJTF(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_WPJTF(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WPJTF From W1MTKBCRIT2
Return

Subprog IB_WPJTF(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTF(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat=2
 [M]WPJTF(INDIC) = VALEUR
 Affzo WPJTF(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_WPJTF(VALEUR) From FUNBENCHM
 If mkstat=2
  [M]WPJTF(INDIC) = VALEUR
  Affzo WPJTF(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_WPJTF(zc) From W1MTKBCRIT2
 Onkey 130 Titled GBOUT2 Call B2_WPJTF(zc) From W1MTKBCRIT2
 Onkey 131 Titled GBOUT3 Call B3_WPJTF(zc) From W1MTKBCRIT2
 Onkey 132 Titled GBOUT4 Call B4_WPJTF(zc) From W1MTKBCRIT2
 Onkey 172 Titled GBOUT15 Call B15_WPJTF(zc) From W1MTKBCRIT2
 Onkey 173 Titled GBOUT16 Call B16_WPJTF(zc) From W1MTKBCRIT2
 Onkey 174 Titled GBOUT17 Call B17_WPJTF(zc) From W1MTKBCRIT2
 Onkey 175 Titled GBOUT18 Call B18_WPJTF(zc) From W1MTKBCRIT2
 Onkey 176 Titled GBOUT19 Call B19_WPJTF(zc) From W1MTKBCRIT2
 Onkey   2 Titled GBOUTS Call S_WPJTF(zc) From W1MTKBCRIT2
 Onkey 144 Titled GBOUTP Call P_WPJTF(zc) From W1MTKBCRIT2
 Onkey 146 Titled GBOUTA Call SA_WPJTF(zc) From W1MTKBCRIT2
Endif
Gosub _AFF
End

Subprog C_WPJTF(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTF" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_WPJTF(VALEUR) From FUNBENCHM
  If mkstat : GERR = 1 : GZONE = "WPJTF" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WPJTF
Call AM_WPJTF(zc)
If !mkstat & GOBJET
 zoncou = "WPJTF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTF(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTF" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MTB2","WPJTF",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MTB2]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MTB2"
 PARMSK(2) = "WPJTF"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MTB2]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MTB2]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WITMREFD
Onevent CONTROL Call C_WITMREFD(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WITMREFD From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WITMREFD(zc) From W1MTKBCRIT2
Return

Subprog IB_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMREFD(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_WITMREFD(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WITMREFD(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WITMREFD(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WITMREFD(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 11249 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 11249 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 11249 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMREFD
Call AM_WITMREFD(zc)
If !mkstat & GOBJET
 zoncou = "WITMREFD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMREFD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WITMREFD(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 11249 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWITMREFD)")>indice
 [M]WITMREFD(indice) = VALEUR
 Affzo ZWITMREFD(indice)
Endif
Gosub _AFF
End

Subprog S_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMREFD
Onevent BEFORE_AREA Gosub AV_ZWITMREFD From W1MTKBCRIT2
Return

$AV_ZWITMREFD
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMREFD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WITMREFF
Onevent CONTROL Call C_WITMREFF(zc) From W1MTKBCRIT2
Onevent BEFORE_INPUT Call AS_WITMREFF(zc) From W1MTKBCRIT2
Onevent AFTER_CHANGE Gosub AMM_WITMREFF From W1MTKBCRIT2
Return

Subprog IB_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMREFF(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_WITMREFF(zc) From W1MTKBCRIT2
Onkey   2 Titled GBOUTS Call S_WITMREFF(zc) From W1MTKBCRIT2
Onkey 144 Titled GBOUTP Call P_WITMREFF(zc) From W1MTKBCRIT2
Onkey 146 Titled GBOUTA Call SA_WITMREFF(zc) From W1MTKBCRIT2
Gosub _AFF
End

Subprog C_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WITMREFF(VALEUR) From FUNBENCHM
   If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMREFF
Call AM_WITMREFF(zc)
If !mkstat & GOBJET
 zoncou = "WITMREFF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWITMREFF)")>indice
 [M]WITMREFF(indice) = VALEUR
 Affzo ZWITMREFF(indice)
Endif
Gosub _AFF
End

Subprog S_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMREFF
Onevent BEFORE_AREA Gosub AV_ZWITMREFF From W1MTKBCRIT2
Return

$AV_ZWITMREFF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMREFF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_CRIT1
Onevent BEFORE_INPUT Call AS_CRIT1(zc) From W1MTKBCRIT2
Onevent INIT_AREA Call D_CRIT1(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_CRIT1(zc) From W1MTKBCRIT2
Return

Subprog D_CRIT1(VALEUR)
Variable Integer VALEUR
If varinit([M]CRIT1,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CRIT1(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2308) From COMBOS
## Action STD
Call AS_CRIT1(VALEUR) From FUNBENCHM
If mkstat=2
 [M]CRIT1(INDIC) = VALEUR
 Affzo CRIT1(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2308,1))))
Endif
If !mkstat
 Discombo 0 From CRIT1(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From CRIT1(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_CRIT1(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_CRIT2
Onevent BEFORE_INPUT Call AS_CRIT2(zc) From W1MTKBCRIT2
Onevent CONTROL Call C_CRIT2(zc) From W1MTKBCRIT2
Onevent INIT_AREA Call D_CRIT2(zc) From W1MTKBCRIT2
Return

Subprog D_CRIT2(VALEUR)
Variable Integer VALEUR
If varinit([M]CRIT2,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

Subprog AS_CRIT2(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2308) From COMBOS
## Action STD
Call AS_CRIT2(VALEUR) From FUNBENCHM
If mkstat=2
 [M]CRIT2(INDIC) = VALEUR
 Affzo CRIT2(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2308,1))))
Endif
If !mkstat
 Discombo 0 From CRIT2(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From CRIT2(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_CRIT2(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
## Action STD
Call C_CRIT2(VALEUR) From FUNBENCHM
If mkstat : GERR = 1 : GZONE = "CRIT2" : GZNUM = 24839 : Endif
Gosub _AFF
End

$ON_FCY
Return

$CHG_STY
Return


