#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management TDUPDR2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "13:04:46"
A_USER  = "ADMIN"
A_STAMP = "20180326130446"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask TDUPDR2 [TUR2]
Gosub HORODAT
Local Inpbox "TDUPDR2" From GFONCTION At A_STAMP With A_WINDPREV Mask [TUR2] As [SIM_]
Grizo [TUR2]5
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [TUR2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=112 : Y1(0)=1 : Y2(0)=25
Return

$ON_FSETTIM
Onevent AFTER_CHANGE Gosub AMM_FSETTIM From W1TDUPDR2
Onevent INIT_AREA Call D_FSETTIM(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FSETTIM(zc) From W1TDUPDR2
Return

Subprog D_FSETTIM(VALEUR)
Variable Integer VALEUR
If varinit([M]FSETTIM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FSETTIM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FSETTIM
Call AM_FSETTIM(zc)
If !mkstat & GOBJET
 zoncou = "FSETTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FSETTIM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FSETTIM(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FSETTIM" : GZNUM = 2400 : Endif
Gosub _AFF
End

$ON_SETTIMV
Onevent CONTROL Call C_SETTIMV(zc) From W1TDUPDR2
Return

Subprog C_SETTIMV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_SETTIMF
Onevent INIT_AREA Call D_SETTIMF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_SETTIMF(zc) From W1TDUPDR2
Onevent CONTROL Call C_SETTIMF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_SETTIMF From W1TDUPDR2
Return

Subprog D_SETTIMF(VALEUR)
Variable Char    VALEUR()
If varinit([M]SETTIMF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_SETTIMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]SETTIMF(INDIC) = VALEUR
  Affzo SETTIMF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_SETTIMF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_SETTIMF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_SETTIMF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_SETTIMF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_SETTIMF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_SETTIMF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_SETTIMF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_SETTIMF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_SETTIMF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "SETTIMF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_SETTIMF
Call AM_SETTIMF(zc)
If !mkstat & GOBJET
 zoncou = "SETTIMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SETTIMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSETTIMF)")>indice
 [M]SETTIMF(indice) = VALEUR
 Affzo ZSETTIMF(indice)
Endif
Gosub _AFF
End

Subprog S_SETTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_SETTIMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_SETTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_SETTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_SETTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_SETTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SETTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SETTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSETTIMF
Onevent BEFORE_AREA Gosub AV_ZSETTIMF From W1TDUPDR2
Return

$AV_ZSETTIMF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]SETTIMF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FOPETIM
Onevent AFTER_CHANGE Gosub AMM_FOPETIM From W1TDUPDR2
Onevent INIT_AREA Call D_FOPETIM(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FOPETIM(zc) From W1TDUPDR2
Return

Subprog D_FOPETIM(VALEUR)
Variable Integer VALEUR
If varinit([M]FOPETIM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FOPETIM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FOPETIM
Call AM_FOPETIM(zc)
If !mkstat & GOBJET
 zoncou = "FOPETIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FOPETIM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FOPETIM(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FOPETIM" : GZNUM = 10578 : Endif
Gosub _AFF
End

$ON_OPETIMV
Onevent CONTROL Call C_OPETIMV(zc) From W1TDUPDR2
Return

Subprog C_OPETIMV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_OPETIMF
Onevent INIT_AREA Call D_OPETIMF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_OPETIMF(zc) From W1TDUPDR2
Onevent CONTROL Call C_OPETIMF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_OPETIMF From W1TDUPDR2
Return

Subprog D_OPETIMF(VALEUR)
Variable Char    VALEUR()
If varinit([M]OPETIMF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_OPETIMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]OPETIMF(INDIC) = VALEUR
  Affzo OPETIMF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_OPETIMF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_OPETIMF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_OPETIMF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_OPETIMF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_OPETIMF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_OPETIMF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_OPETIMF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_OPETIMF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_OPETIMF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "OPETIMF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_OPETIMF
Call AM_OPETIMF(zc)
If !mkstat & GOBJET
 zoncou = "OPETIMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_OPETIMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZOPETIMF)")>indice
 [M]OPETIMF(indice) = VALEUR
 Affzo ZOPETIMF(indice)
Endif
Gosub _AFF
End

Subprog S_OPETIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_OPETIMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_OPETIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_OPETIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_OPETIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_OPETIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_OPETIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_OPETIMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZOPETIMF
Onevent BEFORE_AREA Gosub AV_ZOPETIMF From W1TDUPDR2
Return

$AV_ZOPETIMF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]OPETIMF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FPRPTIM
Onevent AFTER_CHANGE Gosub AMM_FPRPTIM From W1TDUPDR2
Onevent INIT_AREA Call D_FPRPTIM(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FPRPTIM(zc) From W1TDUPDR2
Return

Subprog D_FPRPTIM(VALEUR)
Variable Integer VALEUR
If varinit([M]FPRPTIM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FPRPTIM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FPRPTIM
Call AM_FPRPTIM(zc)
If !mkstat & GOBJET
 zoncou = "FPRPTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FPRPTIM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FPRPTIM(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FPRPTIM" : GZNUM = 16233 : Endif
Gosub _AFF
End

$ON_PRPTIMV
Onevent CONTROL Call C_PRPTIMV(zc) From W1TDUPDR2
Return

Subprog C_PRPTIMV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_PRPTIMF
Onevent INIT_AREA Call D_PRPTIMF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_PRPTIMF(zc) From W1TDUPDR2
Onevent CONTROL Call C_PRPTIMF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_PRPTIMF From W1TDUPDR2
Return

Subprog D_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If varinit([M]PRPTIMF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_PRPTIMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]PRPTIMF(INDIC) = VALEUR
  Affzo PRPTIMF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_PRPTIMF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_PRPTIMF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_PRPTIMF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_PRPTIMF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_PRPTIMF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_PRPTIMF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_PRPTIMF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_PRPTIMF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_PRPTIMF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PRPTIMF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_PRPTIMF
Call AM_PRPTIMF(zc)
If !mkstat & GOBJET
 zoncou = "PRPTIMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPRPTIMF)")>indice
 [M]PRPTIMF(indice) = VALEUR
 Affzo ZPRPTIMF(indice)
Endif
Gosub _AFF
End

Subprog S_PRPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_PRPTIMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_PRPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PRPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PRPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPRPTIMF
Onevent BEFORE_AREA Gosub AV_ZPRPTIMF From W1TDUPDR2
Return

$AV_ZPRPTIMF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]PRPTIMF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FWAITIM
Onevent AFTER_CHANGE Gosub AMM_FWAITIM From W1TDUPDR2
Onevent INIT_AREA Call D_FWAITIM(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FWAITIM(zc) From W1TDUPDR2
Return

Subprog D_FWAITIM(VALEUR)
Variable Integer VALEUR
If varinit([M]FWAITIM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FWAITIM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FWAITIM
Call AM_FWAITIM(zc)
If !mkstat & GOBJET
 zoncou = "FWAITIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FWAITIM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FWAITIM(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FWAITIM" : GZNUM = 5726 : Endif
Gosub _AFF
End

$ON_WAITIMV
Onevent CONTROL Call C_WAITIMV(zc) From W1TDUPDR2
Return

Subprog C_WAITIMV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_WAITIMF
Onevent INIT_AREA Call D_WAITIMF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_WAITIMF(zc) From W1TDUPDR2
Onevent CONTROL Call C_WAITIMF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_WAITIMF From W1TDUPDR2
Return

Subprog D_WAITIMF(VALEUR)
Variable Char    VALEUR()
If varinit([M]WAITIMF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_WAITIMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]WAITIMF(INDIC) = VALEUR
  Affzo WAITIMF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_WAITIMF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_WAITIMF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_WAITIMF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_WAITIMF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_WAITIMF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_WAITIMF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_WAITIMF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_WAITIMF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_WAITIMF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WAITIMF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_WAITIMF
Call AM_WAITIMF(zc)
If !mkstat & GOBJET
 zoncou = "WAITIMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WAITIMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWAITIMF)")>indice
 [M]WAITIMF(indice) = VALEUR
 Affzo ZWAITIMF(indice)
Endif
Gosub _AFF
End

Subprog S_WAITIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WAITIMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_WAITIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WAITIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WAITIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_WAITIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WAITIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WAITIMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWAITIMF
Onevent BEFORE_AREA Gosub AV_ZWAITIMF From W1TDUPDR2
Return

$AV_ZWAITIMF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]WAITIMF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FPSPTIM
Onevent AFTER_CHANGE Gosub AMM_FPSPTIM From W1TDUPDR2
Onevent INIT_AREA Call D_FPSPTIM(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FPSPTIM(zc) From W1TDUPDR2
Return

Subprog D_FPSPTIM(VALEUR)
Variable Integer VALEUR
If varinit([M]FPSPTIM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FPSPTIM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FPSPTIM
Call AM_FPSPTIM(zc)
If !mkstat & GOBJET
 zoncou = "FPSPTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FPSPTIM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FPSPTIM(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FPSPTIM" : GZNUM = 16234 : Endif
Gosub _AFF
End

$ON_PSPTIMV
Onevent CONTROL Call C_PSPTIMV(zc) From W1TDUPDR2
Return

Subprog C_PSPTIMV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_PSPTIMF
Onevent INIT_AREA Call D_PSPTIMF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_PSPTIMF(zc) From W1TDUPDR2
Onevent CONTROL Call C_PSPTIMF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_PSPTIMF From W1TDUPDR2
Return

Subprog D_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If varinit([M]PSPTIMF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_PSPTIMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]PSPTIMF(INDIC) = VALEUR
  Affzo PSPTIMF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_PSPTIMF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_PSPTIMF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_PSPTIMF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_PSPTIMF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_PSPTIMF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_PSPTIMF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_PSPTIMF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_PSPTIMF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_PSPTIMF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PSPTIMF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_PSPTIMF
Call AM_PSPTIMF(zc)
If !mkstat & GOBJET
 zoncou = "PSPTIMF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPSPTIMF)")>indice
 [M]PSPTIMF(indice) = VALEUR
 Affzo ZPSPTIMF(indice)
Endif
Gosub _AFF
End

Subprog S_PSPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_PSPTIMF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_PSPTIMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PSPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PSPTIMF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPSPTIMF
Onevent BEFORE_AREA Gosub AV_ZPSPTIMF From W1TDUPDR2
Return

$AV_ZPSPTIMF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]PSPTIMF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FSETLABCOE
Onevent AFTER_CHANGE Gosub AMM_FSETLABCOE From W1TDUPDR2
Onevent INIT_AREA Call D_FSETLABCOE(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FSETLABCOE(zc) From W1TDUPDR2
Return

Subprog D_FSETLABCOE(VALEUR)
Variable Integer VALEUR
If varinit([M]FSETLABCOE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FSETLABCOE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FSETLABCOE
Call AM_FSETLABCOE(zc)
If !mkstat & GOBJET
 zoncou = "FSETLABCOE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FSETLABCOE(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FSETLABCOE(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FSETLABCOE" : GZNUM = 16231 : Endif
Gosub _AFF
End

$ON_SETLABCOEV
Onevent CONTROL Call C_SETLABCOEV(zc) From W1TDUPDR2
Return

Subprog C_SETLABCOEV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_SETLABCOEF
Onevent INIT_AREA Call D_SETLABCOEF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_SETLABCOEF(zc) From W1TDUPDR2
Onevent CONTROL Call C_SETLABCOEF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_SETLABCOEF From W1TDUPDR2
Return

Subprog D_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If varinit([M]SETLABCOEF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]SETLABCOEF(INDIC) = VALEUR
  Affzo SETLABCOEF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_SETLABCOEF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_SETLABCOEF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_SETLABCOEF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_SETLABCOEF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_SETLABCOEF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_SETLABCOEF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_SETLABCOEF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_SETLABCOEF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "SETLABCOEF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_SETLABCOEF
Call AM_SETLABCOEF(zc)
If !mkstat & GOBJET
 zoncou = "SETLABCOEF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSETLABCOEF)")>indice
 [M]SETLABCOEF(indice) = VALEUR
 Affzo ZSETLABCOEF(indice)
Endif
Gosub _AFF
End

Subprog S_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SETLABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSETLABCOEF
Onevent BEFORE_AREA Gosub AV_ZSETLABCOEF From W1TDUPDR2
Return

$AV_ZSETLABCOEF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]SETLABCOEF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FOPELABCOE
Onevent AFTER_CHANGE Gosub AMM_FOPELABCOE From W1TDUPDR2
Onevent INIT_AREA Call D_FOPELABCOE(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FOPELABCOE(zc) From W1TDUPDR2
Return

Subprog D_FOPELABCOE(VALEUR)
Variable Integer VALEUR
If varinit([M]FOPELABCOE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FOPELABCOE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FOPELABCOE
Call AM_FOPELABCOE(zc)
If !mkstat & GOBJET
 zoncou = "FOPELABCOE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FOPELABCOE(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FOPELABCOE(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FOPELABCOE" : GZNUM = 16232 : Endif
Gosub _AFF
End

$ON_OPELABCOEV
Onevent CONTROL Call C_OPELABCOEV(zc) From W1TDUPDR2
Return

Subprog C_OPELABCOEV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_OPELABCOEF
Onevent INIT_AREA Call D_OPELABCOEF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_OPELABCOEF(zc) From W1TDUPDR2
Onevent CONTROL Call C_OPELABCOEF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_OPELABCOEF From W1TDUPDR2
Return

Subprog D_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If varinit([M]OPELABCOEF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]OPELABCOEF(INDIC) = VALEUR
  Affzo OPELABCOEF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_OPELABCOEF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_OPELABCOEF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_OPELABCOEF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_OPELABCOEF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_OPELABCOEF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_OPELABCOEF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_OPELABCOEF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_OPELABCOEF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "OPELABCOEF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_OPELABCOEF
Call AM_OPELABCOEF(zc)
If !mkstat & GOBJET
 zoncou = "OPELABCOEF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZOPELABCOEF)")>indice
 [M]OPELABCOEF(indice) = VALEUR
 Affzo ZOPELABCOEF(indice)
Endif
Gosub _AFF
End

Subprog S_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_OPELABCOEF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZOPELABCOEF
Onevent BEFORE_AREA Gosub AV_ZOPELABCOEF From W1TDUPDR2
Return

$AV_ZOPELABCOEF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]OPELABCOEF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FCAD
Onevent AFTER_CHANGE Gosub AMM_FCAD From W1TDUPDR2
Onevent INIT_AREA Call D_FCAD(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_FCAD(zc) From W1TDUPDR2
Return

Subprog D_FCAD(VALEUR)
Variable Integer VALEUR
If varinit([M]FCAD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FCAD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FCAD
Call AM_FCAD(zc)
If !mkstat & GOBJET
 zoncou = "FCAD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FCAD(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FCAD(VALEUR) From FUNTDUPDR
If mkstat : GERR = 1 : GZONE = "FCAD" : GZNUM = 6031 : Endif
Gosub _AFF
End

$ON_CADV
Onevent CONTROL Call C_CADV(zc) From W1TDUPDR2
Return

Subprog C_CADV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_CADF
Onevent INIT_AREA Call D_CADF(zc) From W1TDUPDR2
Onevent BEFORE_INPUT Call AS_CADF(zc) From W1TDUPDR2
Onevent CONTROL Call C_CADF(zc) From W1TDUPDR2
Onevent AFTER_CHANGE Gosub AMM_CADF From W1TDUPDR2
Return

Subprog D_CADF(VALEUR)
Variable Char    VALEUR()
If varinit([M]CADF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_CADF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]CADF(INDIC) = VALEUR
  Affzo CADF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_CADF(zc) From W1TDUPDR2
Onkey 130 Titled GBOUT2 Call B2_CADF(zc) From W1TDUPDR2
Onkey 131 Titled GBOUT3 Call B3_CADF(zc) From W1TDUPDR2
Onkey 132 Titled GBOUT4 Call B4_CADF(zc) From W1TDUPDR2
Onkey 133 Titled GBOUT5 Call B5_CADF(zc) From W1TDUPDR2
Onkey   2 Titled GBOUTS Call S_CADF(zc) From W1TDUPDR2
Onkey 144 Titled GBOUTP Call P_CADF(zc) From W1TDUPDR2
Onkey 146 Titled GBOUTA Call SA_CADF(zc) From W1TDUPDR2
Gosub _AFF
End

Subprog C_CADF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "CADF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_CADF
Call AM_CADF(zc)
If !mkstat & GOBJET
 zoncou = "CADF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CADF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZCADF)")>indice
 [M]CADF(indice) = VALEUR
 Affzo ZCADF(indice)
Endif
Gosub _AFF
End

Subprog S_CADF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CADF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_CADF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_CADF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_CADF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_CADF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_CADF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CADF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCADF
Onevent BEFORE_AREA Gosub AV_ZCADF From W1TDUPDR2
Return

$AV_ZCADF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]CADF(indice))) From ATEXTRA
Gosub _AFF
Return

$CHG_STY
Gosub CHG_STY From W2TDUPDR2
Return

$TIT_COL
Gosub TIT_COL From W2TDUPDR2
Return


