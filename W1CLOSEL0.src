#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management CLOSEL0 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:42:10"
A_USER  = "ADMIN"
A_STAMP = "20180326124210"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CLOSEL0 [DIA]
Gosub HORODAT
Local Inpbox "CLOSEL0" From GFONCTION At A_STAMP With A_WINDPREV Mask [DIA] As [SIM_]
Grizo [DIA]5
Grizo [DIA]10
Grizo [DIA]15
Grizo [DIA]20
Grizo [DIA]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [DIA]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=10 : X2(0)=103 : Y1(0)=4 : Y2(0)=6
X1(1)=10 : X2(1)=103 : Y1(1)=7 : Y2(1)=12
X1(2)=10 : X2(2)=103 : Y1(2)=13 : Y2(2)=14
X1(3)=10 : X2(3)=103 : Y1(3)=15 : Y2(3)=19
X1(4)=10 : X2(4)=103 : Y1(4)=20 : Y2(4)=24
Return

$ON_WCRFCY
Onevent CONTROL Call C_WCRFCY(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WCRFCY From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WCRFCY(zc) From W1CLOSEL0
Return

Subprog AS_WCRFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WCRFCY(zc) From W1CLOSEL0
Onkey   2 Titled GBOUTS Call S_WCRFCY(zc) From W1CLOSEL0
Onkey 144 Titled GBOUTP Call P_WCRFCY(zc) From W1CLOSEL0
Onkey 146 Titled GBOUTA Call SA_WCRFCY(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WCRFCY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "WCRFCY" : GZNUM = 9144 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "WCRFCY" : GZNUM = 9144 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WCRFCY" : GZNUM = 9144 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WCRFCY
Call AM_WCRFCY(zc)
If !mkstat & GOBJET
 zoncou = "WCRFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WCRFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WCRFCY(VALEUR) From SUBCLS0
If mkstat : GERR = 1 : GZONE = "WCRFCY" : GZNUM = 9144 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWCRFCY)")>indice
 [M]WCRFCY(indice) = VALEUR
 Affzo ZWCRFCY(indice)
Endif
Gosub _AFF
End

Subprog S_WCRFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WCRFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_WCRFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WCRFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWCRFCY
Onevent BEFORE_AREA Gosub AV_ZWCRFCY From W1CLOSEL0
Return

$AV_ZWCRFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]WCRFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_WTRAIT
Onevent BEFORE_INPUT Call AS_WTRAIT(zc) From W1CLOSEL0
Onevent INIT_AREA Call D_WTRAIT(zc) From W1CLOSEL0
Onevent CONTROL Call C_WTRAIT(zc) From W1CLOSEL0
Return

Subprog D_WTRAIT(VALEUR)
Variable Integer VALEUR
If varinit([M]WTRAIT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_WTRAIT(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2373) From COMBOS
## Action STD
Call AS_WTRAIT(VALEUR) From SUBCLS0
If mkstat=2
 [M]WTRAIT(INDIC) = VALEUR
 Affzo WTRAIT(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2373,1))))
Endif
If !mkstat
 Discombo 0 From WTRAIT(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From WTRAIT(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_WTRAIT(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_WNUMDEB
Onevent CONTROL Call C_WNUMDEB(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WNUMDEB From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WNUMDEB(zc) From W1CLOSEL0
Return

Subprog AS_WNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WNUMDEB(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WNUMDEB" : GZNUM = 21332 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_WNUMDEB(VALEUR) From SUBCLS0
 If mkstat : GERR = 1 : GZONE = "WNUMDEB" : GZNUM = 21332 : Endif
Endif
Gosub _AFF
End

$AMM_WNUMDEB
Call AM_WNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "WNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WNUMDEB(VALEUR) From SUBCLS0
If mkstat : GERR = 1 : GZONE = "WNUMDEB" : GZNUM = 21332 : Endif
Gosub _AFF
End

Subprog S_WNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAM3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAM3"
 PARMSK(1) = [M:DIA]WCRFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAM3","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WNUMFIN
Onevent CONTROL Call C_WNUMFIN(zc) From W1CLOSEL0
Onevent BEFORE_AREA Gosub AV_WNUMFIN From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WNUMFIN(zc) From W1CLOSEL0
Return

$AV_WNUMFIN
## Action STD
Call AV_WNUMFIN(zc) From SUBCLS0
Gosub _AFF
Return

Subprog AS_WNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WNUMFIN(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M:DIA]WNUMDEB) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "WNUMFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_WNUMFIN(VALEUR) From SUBCLS0
  If mkstat : GERR = 1 : GZONE = "WNUMFIN" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_WNUMFIN(VALEUR)
Variable Char    VALEUR()
## Action SELGAM3
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELGAM3"
PARMSK(1) = [M:DIA]WCRFCY
Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAM3","MFGSELLIB","") From GACTION
GACTION = SAVACT
Gosub _AFF
End

$ON_WITMDEB
Onevent CONTROL Call C_WITMDEB(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WITMDEB From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WITMDEB(zc) From W1CLOSEL0
Return

Subprog IB_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMDEB(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_WITMDEB(zc) From W1CLOSEL0
Onkey   2 Titled GBOUTS Call S_WITMDEB(zc) From W1CLOSEL0
Onkey 144 Titled GBOUTP Call P_WITMDEB(zc) From W1CLOSEL0
Onkey 146 Titled GBOUTA Call SA_WITMDEB(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_WITMDEB(VALEUR) From SUBCLS0
   If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMDEB
Call AM_WITMDEB(zc)
If !mkstat & GOBJET
 zoncou = "WITMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WITMDEB(VALEUR) From SUBCLS0
If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 3651 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWITMDEB)")>indice
 [M]WITMDEB(indice) = VALEUR
 Affzo ZWITMDEB(indice)
Endif
Gosub _AFF
End

Subprog S_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMDEB
Onevent BEFORE_AREA Gosub AV_ZWITMDEB From W1CLOSEL0
Return

$AV_ZWITMDEB
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WITMFIN
Onevent CONTROL Call C_WITMFIN(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WITMFIN(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WITMFIN From W1CLOSEL0
Return

Subprog IB_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMFIN(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_WITMFIN(zc) From W1CLOSEL0
Onkey   2 Titled GBOUTS Call S_WITMFIN(zc) From W1CLOSEL0
Onkey 144 Titled GBOUTP Call P_WITMFIN(zc) From W1CLOSEL0
Onkey 146 Titled GBOUTA Call SA_WITMFIN(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WITMFIN(VALEUR) From SUBCLS0
   If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 0 : Endif
   If !mkstat
    ## Action CTLALPV
    Call CTLALPV(VALEUR,[M]WITMDEB) From CONTDIV
    If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 0 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMFIN
Call AM_WITMFIN(zc)
If !mkstat & GOBJET
 zoncou = "WITMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWITMFIN)")>indice
 [M]WITMFIN(indice) = VALEUR
 Affzo ZWITMFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMFIN
Onevent BEFORE_AREA Gosub AV_ZWITMFIN From W1CLOSEL0
Return

$AV_ZWITMFIN
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WDATDEB
Onevent BEFORE_AREA Gosub AV_WDATDEB From W1CLOSEL0
Return

$AV_WDATDEB
Chgfmt [M]WDATDEB(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$ON_WDATFIN
Onevent BEFORE_INPUT Call AS_WDATFIN(zc) From W1CLOSEL0
Onevent CONTROL Call C_WDATFIN(zc) From W1CLOSEL0
Onevent BEFORE_AREA Gosub AV_WDATFIN From W1CLOSEL0
Return

$AV_WDATFIN
Chgfmt [M]WDATFIN(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_WDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WDATFIN(VALEUR) From SUBCLS0
If mkstat=2
 [M]WDATFIN(INDIC) = VALEUR
 Affzo WDATFIN(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_WDATFIN(VALEUR)
Variable Date    VALEUR
## Action CTLDATV
Call CTLDATV(VALEUR,[M]WDATDEB) From CONTDIV
If mkstat : GERR = 1 : GZONE = "WDATFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_WPJTDEB
Onevent BEFORE_INPUT Call AS_WPJTDEB(zc) From W1CLOSEL0
Onevent CONTROL Call C_WPJTDEB(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPJTDEB From W1CLOSEL0
Return

Subprog IB_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat=2
 [M]WPJTDEB(INDIC) = VALEUR
 Affzo WPJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WPJTDEB(zc) From W1CLOSEL0
Onkey 130 Titled GBOUT2 Call B2_WPJTDEB(zc) From W1CLOSEL0
Onkey 131 Titled GBOUT3 Call B3_WPJTDEB(zc) From W1CLOSEL0
Onkey 132 Titled GBOUT4 Call B4_WPJTDEB(zc) From W1CLOSEL0
Onkey 172 Titled GBOUT15 Call B15_WPJTDEB(zc) From W1CLOSEL0
Onkey 173 Titled GBOUT16 Call B16_WPJTDEB(zc) From W1CLOSEL0
Onkey 174 Titled GBOUT17 Call B17_WPJTDEB(zc) From W1CLOSEL0
Onkey 175 Titled GBOUT18 Call B18_WPJTDEB(zc) From W1CLOSEL0
Onkey 176 Titled GBOUT19 Call B19_WPJTDEB(zc) From W1CLOSEL0
Onkey   2 Titled GBOUTS Call S_WPJTDEB(zc) From W1CLOSEL0
Onkey 144 Titled GBOUTP Call P_WPJTDEB(zc) From W1CLOSEL0
Onkey 146 Titled GBOUTA Call SA_WPJTDEB(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_WPJTDEB
Call AM_WPJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "WPJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_WPJTDEB(VALEUR) From SUBCLS0
 If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","WPJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WPJTFIN
Onevent BEFORE_INPUT Call AS_WPJTFIN(zc) From W1CLOSEL0
Onevent CONTROL Call C_WPJTFIN(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPJTFIN From W1CLOSEL0
Return

Subprog IB_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat=2
 [M]WPJTFIN(INDIC) = VALEUR
 Affzo WPJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WPJTFIN(zc) From W1CLOSEL0
Onkey 130 Titled GBOUT2 Call B2_WPJTFIN(zc) From W1CLOSEL0
Onkey 131 Titled GBOUT3 Call B3_WPJTFIN(zc) From W1CLOSEL0
Onkey 132 Titled GBOUT4 Call B4_WPJTFIN(zc) From W1CLOSEL0
Onkey 172 Titled GBOUT15 Call B15_WPJTFIN(zc) From W1CLOSEL0
Onkey 173 Titled GBOUT16 Call B16_WPJTFIN(zc) From W1CLOSEL0
Onkey 174 Titled GBOUT17 Call B17_WPJTFIN(zc) From W1CLOSEL0
Onkey 175 Titled GBOUT18 Call B18_WPJTFIN(zc) From W1CLOSEL0
Onkey 176 Titled GBOUT19 Call B19_WPJTFIN(zc) From W1CLOSEL0
Onkey   2 Titled GBOUTS Call S_WPJTFIN(zc) From W1CLOSEL0
Onkey 144 Titled GBOUTP Call P_WPJTFIN(zc) From W1CLOSEL0
Onkey 146 Titled GBOUTA Call SA_WPJTFIN(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]WPJTDEB) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WPJTFIN
Call AM_WPJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "WPJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","WPJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:DIA]WCRFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:DIA]WCRFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WCRFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WCDEDEB
Onevent CONTROL Call C_WCDEDEB(zc) From W1CLOSEL0
Onevent AFTER_CHANGE Gosub AMM_WCDEDEB From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WCDEDEB(zc) From W1CLOSEL0
Return

Subprog AS_WCDEDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6028,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WCDEDEB(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WCDEDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WCDEDEB" : GZNUM = 3312 : Endif
Endif
Gosub _AFF
End

$AMM_WCDEDEB
Call AM_WCDEDEB(zc)
If !mkstat & GOBJET
 zoncou = "WCDEDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WCDEDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WCDEDEB(VALEUR) From SUBCLS0
If mkstat : GERR = 1 : GZONE = "WCDEDEB" : GZNUM = 3312 : Endif
Gosub _AFF
End

Subprog B1_WCDEDEB(VALEUR)
Variable Char    VALEUR()
## Action SELOBJW
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJW"
PARMSK(1) = "SOH"
PARMSK(2) = "#"
PARMSK(3) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_WCDEFIN
Onevent CONTROL Call C_WCDEFIN(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_WCDEFIN(zc) From W1CLOSEL0
Return

Subprog AS_WCDEFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6028,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WCDEFIN(zc) From W1CLOSEL0
Gosub _AFF
End

Subprog C_WCDEFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WCDEFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]WCDEDEB) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "WCDEFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_WCDEFIN(VALEUR)
Variable Char    VALEUR()
## Action SELOBJW
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJW"
PARMSK(1) = "SOH"
PARMSK(2) = "#"
PARMSK(3) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CLOSED
Onevent INIT_AREA Call D_CLOSED(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_CLOSED(zc) From W1CLOSEL0
Return

Subprog D_CLOSED(VALEUR)
Variable Integer VALEUR
If varinit([M]CLOSED,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CLOSED(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_REAFLG
Onevent INIT_AREA Call D_REAFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_REAFLG(zc) From W1CLOSEL0
Return

Subprog D_REAFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]REAFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_REAFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_LANFLG
Onevent INIT_AREA Call D_LANFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_LANFLG(zc) From W1CLOSEL0
Return

Subprog D_LANFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]LANFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LANFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CNSFLG
Onevent INIT_AREA Call D_CNSFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_CNSFLG(zc) From W1CLOSEL0
Return

Subprog D_CNSFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]CNSFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CNSFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_QTYFLG
Onevent INIT_AREA Call D_QTYFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_QTYFLG(zc) From W1CLOSEL0
Return

Subprog D_QTYFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]QTYFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_QTYFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SSTFLG
Onevent INIT_AREA Call D_SSTFLG(zc) From W1CLOSEL0
Return

Subprog D_SSTFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]SSTFLG,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

$ON_MATFLG
Onevent INIT_AREA Call D_MATFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_MATFLG(zc) From W1CLOSEL0
Return

Subprog D_MATFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]MATFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MATFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_OPEFLG
Onevent INIT_AREA Call D_OPEFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_OPEFLG(zc) From W1CLOSEL0
Return

Subprog D_OPEFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]OPEFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_OPEFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PRFFLG
Onevent INIT_AREA Call D_PRFFLG(zc) From W1CLOSEL0
Onevent BEFORE_INPUT Call AS_PRFFLG(zc) From W1CLOSEL0
Return

Subprog D_PRFFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]PRFFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_PRFFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Return


