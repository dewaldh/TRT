#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management YSETRUL 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone YRULTYPCOD
mkstat = 0
zoncou = "YRULTYPCOD"
indice = 0
If varmode([M]YRULTYPCOD,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YRULTYPCOD" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YRULID
mkstat = 0
zoncou = "YRULID"
indice = 0
If varmode([M]YRULID,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YRULID" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YACTFLG
mkstat = 0
zoncou = "YACTFLG"
indice = 0
IMPENT = [M]YACTFLG
If varinit([M]YACTFLG,indice)=0
 IMPENT = 1
Endif
If varmode([M]YACTFLG,indice)=0
 [M]YACTFLG(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "YACTFLG" : Gosub ACTION From =IMPTRT
  IMPENT = [M]YACTFLG(indice)
 Endif
Endif
[M]YACTFLG = IMPENT

## Zone YSTRDES
mkstat = 0
zoncou = "YSTRDES"
indice = 0
If varmode([M]YSTRDES,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YSTRDES" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YFFCY
mkstat = 0
zoncou = "YFFCY"
indice = 0
If varmode([M]YFFCY,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFFCY" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "ACONTFCY"
 Call CONTSITE([M]YFFCY) From SUBAGF
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YFFCY" : GZNUM = 101136 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("FCY","!",[M]YFFCY,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YFFCY" : GZNUM = 101136 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YTFCY
mkstat = 0
zoncou = "YTFCY"
indice = 0
If varmode([M]YTFCY,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YTFCY" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "ACONTFCY"
 Call CONTSITE([M]YTFCY) From SUBAGF
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YTFCY" : GZNUM = 101134 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("FCY","!",[M]YTFCY,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YTFCY" : GZNUM = 101134 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YCALTYP
mkstat = 0
zoncou = "YCALTYP"
indice = 0
IMPENT = [M]YCALTYP
If varinit([M]YCALTYP,indice)=0
 IMPENT = 1
Endif
[M]YCALTYP = IMPENT

## Zone YSET
mkstat = 0
zoncou = "YSET"
indice = 0
If varmode([M]YSET,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YSET" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTNUM("YEST","!",[M]YSET,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YSET" : GZNUM = 100372 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YFBANK
mkstat = 0
zoncou = "YFBANK"
indice = 0
If varmode([M]YFBANK,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFBANK" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("BAN","!",[M]YFBANK,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFBANK" : GZNUM = 38162 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YLANDPUR
mkstat = 0
zoncou = "YLANDPUR"
indice = 0
If varmode([M]YLANDPUR,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YLANDPUR" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YFACC
mkstat = 0
zoncou = "YFACC"
indice = 0
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT("") From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]YFACC : Endif
If !mkstat
 If varmode([M]YFACC,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "YFACC" : Gosub ACTION From =IMPTRT
  Endif
  Call CONTROLE("GAC","!",[M]YFACC,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YFACC" : GZNUM = 3956 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YTACC
mkstat = 0
zoncou = "YTACC"
indice = 0
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT("") From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]YTACC : Endif
If !mkstat
 If varmode([M]YTACC,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "YTACC" : Gosub ACTION From =IMPTRT
  Endif
  Call CONTROLE("GAC","!",[M]YTACC,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YTACC" : GZNUM = 3956 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YPRECINCT
mkstat = 0
zoncou = "YPRECINCT"
indice = 0
If varmode([M]YPRECINCT,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YPRECINCT" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("YPRE","!",[M]YPRECINCT,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YPRECINCT" : GZNUM = 100373 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YFDRCR
mkstat = 0
zoncou = "YFDRCR"
indice = 0
IMPENT = [M]YFDRCR
If varinit([M]YFDRCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]YFDRCR,indice)=0
 [M]YFDRCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFDRCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]YFDRCR(indice)
 Endif
Endif
[M]YFDRCR = IMPENT

## Zone YALWADJ
mkstat = 0
zoncou = "YALWADJ"
indice = 0
IMPENT = [M]YALWADJ
If varinit([M]YALWADJ,indice)=0
 IMPENT = 1
Endif
[M]YALWADJ = IMPENT

## Zone YSTAG
mkstat = 0
zoncou = "YSTAG"
indice = 0
If varmode([M]YSTAG,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YSTAG" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("YSTA","!",[M]YSTAG,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YSTAG" : GZNUM = 32952 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YLOT
mkstat = 0
zoncou = "YLOT"
indice = 0
If varmode([M]YLOT,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YLOT" : Gosub ACTION From =IMPTRT
 Endif
 If vireblc([M]YLOT,2)=""
  mkstat = 1 : GMESSAGE = mess(10,123,1)
 Endif
 If mkstat : GERR = 1 : GZONE = "YLOT" : GZNUM = 2721 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("YLOT","",[M]YLOT,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YLOT" : GZNUM = 2721 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YSETPRC
mkstat = 0
zoncou = "YSETPRC"
indice = 0
IMPENT = [M]YSETPRC
If varinit([M]YSETPRC,indice)=0
 IMPENT = 1
Endif
[M]YSETPRC = IMPENT

## Zone YFGST
mkstat = 0
zoncou = "YFGST"
indice = 0
If varmode([M]YFGST,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFGST" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "CONTTVT"
 Call CONTTVT([M]YFGST,"","","","","","") From SUBTVT
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YFGST" : GZNUM = 6818 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YTGST
mkstat = 0
zoncou = "YTGST"
indice = 0
If varmode([M]YTGST,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YTGST" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "CONTTVT"
 Call CONTTVT([M]YTGST,"","","","","","") From SUBTVT
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YTGST" : GZNUM = 6818 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YLIGDES
mkstat = 0
zoncou = "YLIGDES"
indice = 0
If varmode([M]YLIGDES,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YLIGDES" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YFAMTAMD
mkstat = 0
zoncou = "YFAMTAMD"
indice = 0
IMPENT = [M]YFAMTAMD
If varinit([M]YFAMTAMD,indice)=0
 IMPENT = 1
Endif
If varmode([M]YFAMTAMD,indice)=0
 [M]YFAMTAMD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFAMTAMD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]YFAMTAMD(indice)
 Endif
Endif
[M]YFAMTAMD = IMPENT

## Zone YTAMTAMD
mkstat = 0
zoncou = "YTAMTAMD"
indice = 0
IMPENT = [M]YTAMTAMD
If varinit([M]YTAMTAMD,indice)=0
 IMPENT = 1
Endif
If varmode([M]YTAMTAMD,indice)=0
 [M]YTAMTAMD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "YTAMTAMD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]YTAMTAMD(indice)
 Endif
Endif
[M]YTAMTAMD = IMPENT

## Zone YVLDFRM
mkstat = 0
zoncou = "YVLDFRM"
indice = 0
If varmode([M]YVLDFRM,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YVLDFRM" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YVLDTO
mkstat = 0
zoncou = "YVLDTO"
indice = 0
If varmode([M]YVLDTO,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YVLDTO" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YPRC
mkstat = 0
zoncou = "YPRC"
indice = 0
If varmode([M]YPRC,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YPRC" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YFFXDVAL
mkstat = 0
zoncou = "YFFXDVAL"
indice = 0
If varmode([M]YFFXDVAL,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFFXDVAL" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone YFLONAGR
mkstat = 0
zoncou = "YFLONAGR"
indice = 0
If varmode([M]YFLONAGR,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFLONAGR" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("YELA","!",[M]YFLONAGR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFLONAGR" : GZNUM = 100118 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YFPJTLIN
mkstat = 0
zoncou = "YFPJTLIN"
indice = 0
WCHAR = [M]YFPJTLIN
If varmode([M]YFPJTLIN,indice)=0
 SAVACT = GACTION : GACTION = "PJTBEFZON"
 Call PJT_BEFORE_ZONE([M]YFPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
 GACTION = SAVACT
 If mkstat=1 : Raz [M]YFPJTLIN : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "YFPJTLIN" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "PJTCTL"
  Call PJT_CONTROL([M]YFPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]YFPJTLIN
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]YFPJTLIN = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]YFPJTLIN or IMPMOD
     SAVACT = GACTION : GACTION = "PJTAFTMOD"
     Call PJT_AFTER_MODIFY([M]YFPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone YFCCE
mkstat = 0
zoncou = "YFCCE"
indice = 0
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT("") From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]YFCCE : Endif
If !mkstat
 If varmode([M]YFCCE,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "YFCCE" : Gosub ACTION From =IMPTRT
  Endif
  Call CONTROLE("CCE","!",[M]YFCCE,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YFCCE" : GZNUM = 3997 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone YTLONLGR
mkstat = 0
zoncou = "YTLONLGR"
indice = 0
If varmode([M]YTLONLGR,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "YTLONLGR" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("YELA","!",[M]YTLONLGR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YTLONLGR" : GZNUM = 100118 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone YTPJTLIN
mkstat = 0
zoncou = "YTPJTLIN"
indice = 0
WCHAR = [M]YTPJTLIN
If varmode([M]YTPJTLIN,indice)=0
 SAVACT = GACTION : GACTION = "PJTBEFZON"
 Call PJT_BEFORE_ZONE([M]YTPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
 GACTION = SAVACT
 If mkstat=1 : Raz [M]YTPJTLIN : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "YTPJTLIN" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "PJTCTL"
  Call PJT_CONTROL([M]YTPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]YTPJTLIN
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]YTPJTLIN = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]YTPJTLIN or IMPMOD
     SAVACT = GACTION : GACTION = "PJTAFTMOD"
     Call PJT_AFTER_MODIFY([M]YTPJTLIN,"","","","","","","","","","","","","","","","","","","") From TRTPJT
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone YTCCE
mkstat = 0
zoncou = "YTCCE"
indice = 0
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT("") From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]YTCCE : Endif
If !mkstat
 If varmode([M]YTCCE,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "YTCCE" : Gosub ACTION From =IMPTRT
  Endif
  Call CONTROLE("CCE","!",[M]YTCCE,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "YTCCE" : GZNUM = 3997 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

mkstat = 0

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "YSETRUL"
Return

