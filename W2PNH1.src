#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management PNH1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$ON_QTYSTU
Onevent BEFORE_AREA Gosub AV_QTYSTU From W2PNH1
Onevent BEFORE_INPUT Call AS_QTYSTU(zc) From W2PNH1
Onevent CONTROL Call C_QTYSTU(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_QTYSTU From W2PNH1
Return

$AV_QTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PNH1]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYSTU(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTYSTU(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_QTYSTU(VALEUR) From SUBPNH
If mkstat=2
 [M]QTYSTU(INDIC) = VALEUR
 Affzo QTYSTU(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_QTYSTU(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
If !mkstat
 ## Action STD
 Call C_QTYSTU(VALEUR) From SUBPNH
 If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
Endif
Gosub _AFF
End

$AMM_QTYSTU
Call AM_QTYSTU(zc)
If !mkstat & GOBJET
 zoncou = "QTYSTU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYSTU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_QTYSTU(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
Gosub _AFF
End

$ON_QTYSTUACT
Onevent BEFORE_AREA Gosub AV_QTYSTUACT From W2PNH1
Return

$AV_QTYSTUACT
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PNH1]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_WRH
Onevent CONTROL Call C_WRH(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_WRH(zc) From W2PNH1
Return

Subprog AS_WRH(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_WRH(VALEUR) From SUBPNH
If mkstat=2
 [M]WRH(INDIC) = VALEUR
 Affzo WRH(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WRH(zc) From W2PNH1
Gosub _AFF
End

Subprog C_WRH(VALEUR)
Variable Char    VALEUR()
## Action WRHCTL
Call WRHCTL(VALEUR,[M:PNH1]PNHFCY,GWRHOBY) From STKWRH
If mkstat : GERR = 1 : GZONE = "WRH" : GZNUM = 281 : Endif
If !mkstat
 ## Action STD
 Call C_WRH(VALEUR) From SUBPNH
 If mkstat : GERR = 1 : GZONE = "WRH" : GZNUM = 281 : Endif
Endif
Gosub _AFF
End

Subprog S_WRH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action WRHSEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "WRHSEL"
 PARMSK(1) = [M:PNH1]PNHFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"WRHSEL","STKWRH","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_STA
Onevent BEFORE_INPUT Call AS_STA(zc) From W2PNH1
Onevent CONTROL Call C_STA(zc) From W2PNH1
Return

Subprog AS_STA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action SAIZONSOR
Call SAIZONSOR("STA",nolign-1) From STKECR
If mkstat=2
 [M]STA(INDIC) = VALEUR
 Affzo STA(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_STA(zc) From W2PNH1
Gosub _AFF
End

Subprog C_STA(VALEUR)
Variable Char    VALEUR()
## Action STKCTRSTA
Call STKCTRSTA(VALEUR,[F:SRU]AUZSST,0,0,0,mkstat) From STKACT
If mkstat : GERR = 1 : GZONE = "STA" : GZNUM = 1287 : Endif
Gosub _AFF
End

Subprog S_STA(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSTA"
 PARMSK(1) = [F:SRU]AUZSST
 PARMSK(2) = "0"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSTA","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_LOC
Onevent BEFORE_INPUT Call AS_LOC(zc) From W2PNH1
Onevent CONTROL Call C_LOC(zc) From W2PNH1
Return

Subprog AS_LOC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3234,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action SAIZONSOR
Call SAIZONSOR("LOC",nolign-1) From STKECR
If mkstat=2
 [M]LOC(INDIC) = VALEUR
 Affzo LOC(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LOC(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LOC(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LOC(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LOC(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LOC(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("LOC","!",VALEUR,num$([M:PNH1]PNHFCY),mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "LOC" : GZNUM = 3623 : Endif
If !mkstat
 ## Action STKCTREMPS
 Call STKCTREMPS(VALEUR,[M:PNH1]PNHFCY,"12",[M:PNH1]BPSNUM,string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PNH1]WRH)),[M:PNH1]WRH(nolign-1))))) From STKLOC
 If mkstat : GERR = 1 : GZONE = "LOC" : GZNUM = 3623 : Endif
Endif
Gosub _AFF
End

Subprog S_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELEMP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELEMP"
 PARMSK(1) = [M:PNH1]PNHFCY
 PARMSK(2) = ""
 PARMSK(3) = "12"
 PARMSK(4) = [M:PNH1]BPSNUM
 PARMSK(5) = ""
 PARMSK(6) = string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PNH1]WRH)),[M:PNH1]WRH(nolign-1))))
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELEMP","STKLOC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LOC(VALEUR)
Variable Char    VALEUR()
Call OBJET("LOC",VALEUR,num$([M:PNH1]PNHFCY)) From GOBJET
Gosub _AFF
End

Subprog SA_LOC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "LOC"
PARMSK(2) = num$([M:PNH1]PNHFCY)
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LOC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:PNH1]PNHFCY)
Call VISU("LOC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LOT
Onevent BEFORE_INPUT Call AS_LOT(zc) From W2PNH1
Onevent CONTROL Call C_LOT(zc) From W2PNH1
Return

Subprog AS_LOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6109,GBOUTS) From OBJDIV
## Action SAIZONSOR
Call SAIZONSOR("LOT",nolign-1) From STKECR
If mkstat=2
 [M]LOT(INDIC) = VALEUR
 Affzo LOT(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_LOT(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKCTRLOTS
Call STKCTRLOTS(VALEUR,[M:PNH1]ITMREF(nolign-1),[M:PNH1]RTNDAT,"","") From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

Subprog S_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELLOT"
 PARMSK(1) = [M:PNH1]ITMREF(nolign-1)
 PARMSK(2) = ""
 PARMSK(3) = "PNH1"
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELLOT","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_SLO
Onevent BEFORE_INPUT Call AS_SLO(zc) From W2PNH1
Onevent CONTROL Call C_SLO(zc) From W2PNH1
Return

Subprog AS_SLO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONSOR
Call SAIZONSOR("SLO",nolign-1) From STKECR
If mkstat=2
 [M]SLO(INDIC) = VALEUR
 Affzo SLO(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_SLO(VALEUR)
Variable Char    VALEUR()
## Action STKCTRSLOS
Call STKCTRSLOS(VALEUR,[M:PNH1]LOT(nolign-1),[M:PNH1]ITMREF(nolign-1),[M:PNH1]RTNDAT,"","") From STKACT
If mkstat : GERR = 1 : GZONE = "SLO" : GZNUM = 18960 : Endif
Gosub _AFF
End

$ON_SERNUM
Onevent BEFORE_INPUT Call AS_SERNUM(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_SERNUM From W2PNH1
Return

Subprog AS_SERNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action SAIZONSOR
Call SAIZONSOR("SERNUM",nolign-1) From STKECR
If mkstat=2
 [M]SERNUM(INDIC) = VALEUR
 Affzo SERNUM(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_SERNUM(zc) From W2PNH1
Gosub _AFF
End

$AMM_SERNUM
Call AM_SERNUM(zc)
If !mkstat & GOBJET
 zoncou = "SERNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SERNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SERNUM(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "SERNUM" : GZNUM = 3206 : Endif
Gosub _AFF
End

Subprog S_SERNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSER
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSER"
 PARMSK(1) = [M:PNH1]PNHFCY
 PARMSK(2) = [M:PNH1]ITMREF(nolign-1)
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = "6"
 PARMSK(5) = [M:PNH1]PTHNUM(nolign-1)
 PARMSK(6) = num$([M:PNH1]PTDLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSER","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_PALNUM
Onevent BEFORE_INPUT Call AS_PALNUM(zc) From W2PNH1
Return

Subprog AS_PALNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONSOR
Call SAIZONSOR("PALNUM",nolign-1) From STKECR
If mkstat=2
 [M]PALNUM(INDIC) = VALEUR
 Affzo PALNUM(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_CTRNUM
Onevent BEFORE_INPUT Call AS_CTRNUM(zc) From W2PNH1
Return

Subprog AS_CTRNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONSOR
Call SAIZONSOR("CTRNUM",nolign-1) From STKECR
If mkstat=2
 [M]CTRNUM(INDIC) = VALEUR
 Affzo CTRNUM(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_MVTDES
Onevent BEFORE_INPUT Call AS_MVTDES(zc) From W2PNH1
Return

Subprog AS_MVTDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONSOR
Call SAIZONSOR("MVTDES",nolign-1) From STKECR
If mkstat=2
 [M]MVTDES(INDIC) = VALEUR
 Affzo MVTDES(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_LINCAT
Onevent BEFORE_INPUT Call AS_LINCAT(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINCAT From W2PNH1
Onevent INIT_AREA Call D_LINCAT(zc) From W2PNH1
Return

Subprog D_LINCAT(VALEUR)
Variable Integer VALEUR
If varinit([M]LINCAT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LINCAT(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M:PNH1]PTHNUM(nolign-1)="")
 Affzo LINCAT : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_LINCAT(VALEUR) From SUBPNH
 If mkstat=2
  [M]LINCAT(INDIC) = VALEUR
  Affzo LINCAT(INDIC) : mkstat = 2
 Endif
 If VALEUR<1
  VALEUR = 1
 Endif
Endif
Gosub _AFF
End

$AMM_LINCAT
Call AM_LINCAT(zc)
If !mkstat & GOBJET
 zoncou = "LINCAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINCAT(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_LINCAT(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINCAT" : GZNUM = 707 : Endif
Gosub _AFF
End

$ON_ORDFLG
Onevent BEFORE_INPUT Call AS_ORDFLG(zc) From W2PNH1
Onevent CONTROL Call C_ORDFLG(zc) From W2PNH1
Onevent AFTER_AREA Call AP_ORDFLG(zc) From W2PNH1
Onevent INIT_AREA Call D_ORDFLG(zc) From W2PNH1
Return

Subprog D_ORDFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]ORDFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_ORDFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(540) From COMBOS
## Action STD
Call AS_ORDFLG(VALEUR) From SUBPNH
If mkstat=2
 [M]ORDFLG(INDIC) = VALEUR
 Affzo ORDFLG(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,540,1))))
Endif
If !mkstat
 Discombo 0 From ORDFLG(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From ORDFLG(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_ORDFLG(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
## Action STD
Call C_ORDFLG(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "ORDFLG" : GZNUM = 7886 : Endif
Gosub _AFF
End

Subprog AP_ORDFLG(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_ORDFLG(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "ORDFLG" : GZNUM = 7886 : Endif
Gosub _AFF
End

$ON_AVOFLG
Onevent BEFORE_INPUT Call AS_AVOFLG(zc) From W2PNH1
Onevent INIT_AREA Call D_AVOFLG(zc) From W2PNH1
Return

Subprog D_AVOFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]AVOFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_AVOFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_AVOFLG(VALEUR) From SUBPNH
If mkstat=2
 [M]AVOFLG(INDIC) = VALEUR
 Affzo AVOFLG(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_INVQTYPUU
Onevent BEFORE_AREA Gosub AV_INVQTYPUU From W2PNH1
Return

$AV_INVQTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find("",GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_POHFCY
Onevent CONTROL Call C_POHFCY(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_POHFCY(zc) From W2PNH1
Return

Subprog AS_POHFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_POHFCY(VALEUR) From SUBPNH
If mkstat=2
 [M]POHFCY(INDIC) = VALEUR
 Affzo POHFCY(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_POHFCY(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_POHFCY(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_POHFCY(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_POHFCY(zc) From W2PNH1
Gosub _AFF
End

Subprog C_POHFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "POHFCY" : GZNUM = 4445 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!G",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "POHFCY" : GZNUM = 4445 : Endif
Endif
Gosub _AFF
End

Subprog S_POHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!G"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_POHFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_POHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_POHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_INVQTYSTU
Onevent BEFORE_AREA Gosub AV_INVQTYSTU From W2PNH1
Return

$AV_INVQTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find("",GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_POHNUM
Return

$ON_POHTYP
Onevent INIT_AREA Call D_POHTYP(zc) From W2PNH1
Return

Subprog D_POHTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]POHTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W2PNH1
Onevent CONTROL Call C_PJT(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_PJT From W2PNH1
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
&,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
&,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W2PNH1
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W2PNH1
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W2PNH1
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W2PNH1
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W2PNH1
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W2PNH1
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W2PNH1
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W2PNH1
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W2PNH1
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
&,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
&,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJT(VALEUR) From SUBPNH
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
& ,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
& ,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
& ,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"PNH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PNH1]PNHFCY,""
& ,"","[M:PNH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PNH1]PNHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PNH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PNH1]PNHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_GROPRI
Onevent BEFORE_AREA Gosub AV_GROPRI From W2PNH1
Onevent BEFORE_INPUT Call AS_GROPRI(zc) From W2PNH1
Onevent AFTER_AREA Call AP_GROPRI(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_GROPRI From W2PNH1
Return

Subprog IB_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_GROPRI From SUBPNH
Endif
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "GROPRI"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_GROPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

Subprog AS_GROPRI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(13454,GBOUT1) From OBJDIV
Call TEXTE(7720,GBOUT2) From OBJDIV
Call TEXTE(16098,GBOUT3) From OBJDIV
Call TEXTE(454,GBOUT4) From OBJDIV
Call TEXTE(15405,GBOUT5) From OBJDIV
Call IB_GROPRI(VALEUR)
## Action PASLINPNH
Call PASLINPNH(0) From SUBPNH
If mkstat=2
 [M]GROPRI(INDIC) = VALEUR
 Affzo GROPRI(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action DIVREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "GROPRI"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
 If mkstat=2
  [M]GROPRI(INDIC) = VALEUR
  Affzo GROPRI(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_GROPRI(zc) From W2PNH1
 Onkey 130 Titled GBOUT2 Call B2_GROPRI(zc) From W2PNH1
 Onkey 131 Titled GBOUT3 Call B3_GROPRI(zc) From W2PNH1
 Onkey 132 Titled GBOUT4 Call B4_GROPRI(zc) From W2PNH1
 Onkey 133 Titled GBOUT5 Call B5_GROPRI(zc) From W2PNH1
Endif
Gosub _AFF
End

Subprog AP_GROPRI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AP_GROPRI(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
Gosub _AFF
End

$AMM_GROPRI
Call AM_GROPRI(zc)
If !mkstat & GOBJET
 zoncou = "GROPRI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_GROPRI(VALEUR)
Variable Decimal VALEUR
## Action PAMDISCRG
Call PAMDISCRG(VALEUR,"PNH1",0,nolign-1,[M:PNH1]NETCUR(nolign-1)) From TRTACHPRI1
If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
Gosub _AFF
End

Subprog B1_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUPPV
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUPPV"
 PARMSK(1) = [M:PNH1]RTNDAT
 PARMSK(2) = [M:PNH1]ITMREF(nolign-1)
 PARMSK(3) = [M:PNH1]BPSNUM
 Call SAISIE_NUM(VALEUR,PARMSK,"IPPV","FUNACHPPV","XWIPPV") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIPURREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIPURREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPURREN","TRTPRICE","XWIPURREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUPLP1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUPLP1"
 PARMSK(1) = [M:PNH1]BPSNUM
 PARMSK(2) = [M:PNH1]ITMREF(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPLP1","TRTACHFEN1","XWIPLP1") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B4_GROPRI(VALEUR) From SUBPNH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUCLCPRI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCLCPRI"
 PARMSK(1) = "PNH"
 PARMSK(2) = [M:PNH1]NETCUR(nolign-1)
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 Call SAISIE_NUM(VALEUR,PARMSK,"IDETPRI","TRTPRICE","XWIDETPRI") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL1
Onevent BEFORE_INPUT Call AS_DISCRGVAL1(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL1 From W2PNH1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL1 From W2PNH1
Return

Subprog IB_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL1"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL1
If GFORREM(0)<>""
 Chgfmt [M]DISCRGVAL1(indice) With GFORREM(0)
Else
 Chgfmt [M]DISCRGVAL1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7720,GBOUT2) From OBJDIV
Call IB_DISCRGVAL1(VALEUR)
## Action PASLINPNH
Call PASLINPNH(1) From SUBPNH
If mkstat=2
 [M]DISCRGVAL1(INDIC) = VALEUR
 Affzo DISCRGVAL1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action DIVREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL1"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
 If mkstat=2
  [M]DISCRGVAL1(INDIC) = VALEUR
  Affzo DISCRGVAL1(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL1(zc) From W2PNH1
Endif
Gosub _AFF
End

$AMM_DISCRGVAL1
Call AM_DISCRGVAL1(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
## Action PAMDISCRG
Call PAMDISCRG(VALEUR,"PNH1",1,nolign-1,[M:PNH1]NETCUR(nolign-1)) From TRTACHPRI1
If mkstat : GERR = 1 : GZONE = "DISCRGVAL1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIPURREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIPURREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPURREN","TRTPRICE","XWIPURREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL2
Onevent BEFORE_INPUT Call AS_DISCRGVAL2(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL2 From W2PNH1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL2 From W2PNH1
Return

Subprog IB_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL2"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL2
If GFORREM(1)<>""
 Chgfmt [M]DISCRGVAL2(indice) With GFORREM(1)
Else
 Chgfmt [M]DISCRGVAL2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7720,GBOUT2) From OBJDIV
Call IB_DISCRGVAL2(VALEUR)
## Action PASLINPNH
Call PASLINPNH(2) From SUBPNH
If mkstat=2
 [M]DISCRGVAL2(INDIC) = VALEUR
 Affzo DISCRGVAL2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action DIVREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL2"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
 If mkstat=2
  [M]DISCRGVAL2(INDIC) = VALEUR
  Affzo DISCRGVAL2(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL2(zc) From W2PNH1
Endif
Gosub _AFF
End

$AMM_DISCRGVAL2
Call AM_DISCRGVAL2(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
## Action PAMDISCRG
Call PAMDISCRG(VALEUR,"PNH1",2,nolign-1,[M:PNH1]NETCUR(nolign-1)) From TRTACHPRI1
If mkstat : GERR = 1 : GZONE = "DISCRGVAL2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIPURREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIPURREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPURREN","TRTPRICE","XWIPURREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL3
Onevent BEFORE_INPUT Call AS_DISCRGVAL3(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL3 From W2PNH1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL3 From W2PNH1
Return

Subprog IB_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL3"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL3
If GFORREM(2)<>""
 Chgfmt [M]DISCRGVAL3(indice) With GFORREM(2)
Else
 Chgfmt [M]DISCRGVAL3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7720,GBOUT2) From OBJDIV
Call IB_DISCRGVAL3(VALEUR)
## Action PASLINPNH
Call PASLINPNH(3) From SUBPNH
If mkstat=2
 [M]DISCRGVAL3(INDIC) = VALEUR
 Affzo DISCRGVAL3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action DIVREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = "6"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL3"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
 If mkstat=2
  [M]DISCRGVAL3(INDIC) = VALEUR
  Affzo DISCRGVAL3(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL3(zc) From W2PNH1
Endif
Gosub _AFF
End

$AMM_DISCRGVAL3
Call AM_DISCRGVAL3(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
## Action PAMDISCRG
Call PAMDISCRG(VALEUR,"PNH1",3,nolign-1,[M:PNH1]NETCUR(nolign-1)) From TRTACHPRI1
If mkstat : GERR = 1 : GZONE = "DISCRGVAL3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIPURREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIPURREN"
 PARMSK(1) = "PNH1"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPURREN","TRTPRICE","XWIPURREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W2PNH1
Return

$AV_NETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_NETPRIPUU
Onevent BEFORE_AREA Gosub AV_NETPRIPUU From W2PNH1
Return

$AV_NETPRIPUU
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_LINAMT
Onevent BEFORE_AREA Gosub AV_LINAMT From W2PNH1
Return

$AV_LINAMT
Chgfmt [M]LINAMT(indice) With "NPz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_NETCUR
Return

$ON_LINACC1
Onevent BEFORE_AREA Gosub AV_LINACC1 From W2PNH1
Onevent CONTROL Call C_LINACC1(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC1(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC1 From W2PNH1
Return

$AV_LINACC1
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
If GFMTCOA(1)<>""
 Chgfmt [M]LINACC1(indice) With GFMTCOA(1)
Else
 Chgfmt [M]LINACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC1(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC1(INDIC) = VALEUR
 Affzo LINACC1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC1(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC1(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC1(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC1(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC1(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC1
Call AM_LINACC1(zc)
If !mkstat & GOBJET
 zoncou = "LINACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC1(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(1))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC2
Onevent BEFORE_AREA Gosub AV_LINACC2 From W2PNH1
Onevent CONTROL Call C_LINACC2(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC2(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC2 From W2PNH1
Return

$AV_LINACC2
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
If GFMTCOA(2)<>""
 Chgfmt [M]LINACC2(indice) With GFMTCOA(2)
Else
 Chgfmt [M]LINACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC2(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC2(INDIC) = VALEUR
 Affzo LINACC2(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC2(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC2(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC2(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC2(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(2))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC2(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC2
Call AM_LINACC2(zc)
If !mkstat & GOBJET
 zoncou = "LINACC2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC2(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(2)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC2(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(2))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(2))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC3
Onevent BEFORE_AREA Gosub AV_LINACC3 From W2PNH1
Onevent CONTROL Call C_LINACC3(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC3(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC3 From W2PNH1
Return

$AV_LINACC3
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
If GFMTCOA(3)<>""
 Chgfmt [M]LINACC3(indice) With GFMTCOA(3)
Else
 Chgfmt [M]LINACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC3(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC3(INDIC) = VALEUR
 Affzo LINACC3(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC3(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC3(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC3(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC3(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(3))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(3))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(3)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC3(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC3
Call AM_LINACC3(zc)
If !mkstat & GOBJET
 zoncou = "LINACC3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC3(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(3)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC3(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(3))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(3))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(3))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC4
Onevent BEFORE_AREA Gosub AV_LINACC4 From W2PNH1
Onevent CONTROL Call C_LINACC4(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC4(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC4 From W2PNH1
Return

$AV_LINACC4
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
If GFMTCOA(4)<>""
 Chgfmt [M]LINACC4(indice) With GFMTCOA(4)
Else
 Chgfmt [M]LINACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC4(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC4(INDIC) = VALEUR
 Affzo LINACC4(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC4(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC4(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC4(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC4(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(4))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(4))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(4)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC4(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC4
Call AM_LINACC4(zc)
If !mkstat & GOBJET
 zoncou = "LINACC4" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC4(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(4)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC4(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(4))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(4))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(4))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC5
Onevent BEFORE_AREA Gosub AV_LINACC5 From W2PNH1
Onevent CONTROL Call C_LINACC5(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC5(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC5 From W2PNH1
Return

$AV_LINACC5
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
If GFMTCOA(5)<>""
 Chgfmt [M]LINACC5(indice) With GFMTCOA(5)
Else
 Chgfmt [M]LINACC5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC5(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC5(INDIC) = VALEUR
 Affzo LINACC5(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC5(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC5(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC5(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC5(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(5))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(5))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(5)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC5(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC5
Call AM_LINACC5(zc)
If !mkstat & GOBJET
 zoncou = "LINACC5" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC5(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(5)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC5(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(5))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(5))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(5))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC6
Onevent BEFORE_AREA Gosub AV_LINACC6 From W2PNH1
Onevent CONTROL Call C_LINACC6(zc) From W2PNH1
Onevent BEFORE_INPUT Call AS_LINACC6(zc) From W2PNH1
Onevent AFTER_CHANGE Gosub AMM_LINACC6 From W2PNH1
Return

$AV_LINACC6
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(6))) From SETGLBCOA
If GFMTCOA(6)<>""
 Chgfmt [M]LINACC6(indice) With GFMTCOA(6)
Else
 Chgfmt [M]LINACC6(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC6(VALEUR) From SUBPNH
If mkstat=2
 [M]LINACC6(INDIC) = VALEUR
 Affzo LINACC6(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC6(zc) From W2PNH1
Onkey   2 Titled GBOUTS Call S_LINACC6(zc) From W2PNH1
Onkey 144 Titled GBOUTP Call P_LINACC6(zc) From W2PNH1
Onkey 146 Titled GBOUTA Call SA_LINACC6(zc) From W2PNH1
Gosub _AFF
End

Subprog C_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(6))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(6))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(6)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC6(VALEUR) From SUBPNH
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC6
Call AM_LINACC6(zc)
If !mkstat & GOBJET
 zoncou = "LINACC6" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC6(VALEUR) From SUBPNH
If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(6)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PNH1]RTNDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PNH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC6(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(6))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(6))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(6))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$TIT_COL
Gosub TIT_COL From W4PNH1
Return


