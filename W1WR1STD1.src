#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management WR1STD1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [16/04/2018]
A_HEURE = "14:35:43"
A_USER  = "ADMIN"
A_STAMP = "20180416143543"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WR1STD1 [MFG1]
Gosub HORODAT
Local Inpbox "WR1STD1" From GFONCTION At A_STAMP With A_WINDPREV Mask [MFG1] As [SIM_]
Grizo [MFG1]5
Grizo [MFG1]10
Grizo [MFG1]20
Grizo [MFG1]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MFG1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=82 : Y1(0)=1 : Y2(0)=13
X1(1)=1 : X2(1)=29 : Y1(1)=14 : Y2(1)=19
X1(2)=30 : X2(2)=82 : Y1(2)=14 : Y2(2)=19
X1(3)=1 : X2(3)=82 : Y1(3)=20 : Y2(3)=23
Return

$ON_NBLIG
Onevent CONTROL Call C_NBLIG From W1WR1STD1
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WR1STD1
Onevent AFTER_LINE Call APRES_NBLIG From W1WR1STD1
Onevent BEFORE_INPUT Call AS_NBLIG From W1WR1STD1
Onevent BEFORE_AREA Call AV_NBLIG From W1WR1STD1
Return

Subprog IB_NBLIG
Local Decimal BASPAG
## Action STD
Call IB_NBLIG From SUBMFG
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W4WR1STD1
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
Call TEXTE(454,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
Call TEXTE(454,GBOUT4) From OBJDIV
Call TEXTE(10976,GBOUT5) From OBJDIV
Call TEXTE(7977,GBOUT6) From OBJDIV
Call TEXTE(6273,GBOUT7) From OBJDIV
Call TEXTE(29120,GBOUT8) From OBJDIV
Call TEXTE(28900,GBOUT9) From OBJDIV
Call TEXTE(6989,GBOUT10) From OBJDIV
Call TEXTE(49019,GBOUT11) From OBJDIV
Call TEXTE(10069,GBOUT12) From OBJDIV
Call IB_NBLIG
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WR1STD1
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WR1STD1
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WR1STD1
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WR1STD1
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WR1STD1
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WR1STD1
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WR1STD1
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WR1STD1
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WR1STD1
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WR1STD1
Onkey 139 Titled GBOUT11 Call B11_NBLIG From W1WR1STD1
Onkey 140 Titled GBOUT12 Call B12_NBLIG From W1WR1STD1
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBMFG
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVLINCONT
 Call INSERE("MFGLIN") From TABLEAUX
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFIFICH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFIFICH"
 PARMSK(1) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFIW","MFGWINLIB","XWIMFIW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFITRKSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFITRKSTA"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MFG1"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFIQTY","MFGWINLIB","XWIMFIQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = [M:MFG0]MFGFCY
 PARMSK(3) = [M]ITMREF(nolign-1)
 PARMSK(4) = ""
 Call CONSULT_NUM(BASPAG,"SFC",PARMSK) From GCONSULT
 ACTION = "BB3_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUITF"
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = [M]ITMREF(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IVISUITF","VISUITF","XWIVISUITF") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBMFG
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action DIVLINNUM
Call LINNUM("MFGLIN") From TABLEAUX
If mkstat : End : Endif
## Action STD
Call APRES_NBLIG From SUBMFG
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSSPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSPR"
 PARMSK(1) = "0"
 PARMSK(2) = [M:MFG0]MFGFCY
 PARMSK(3) = [M]ITMREF(nolign-1)
 PARMSK(4) = ""
 Call CONSULT_NUM(BASPAG,"SPR",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSSDI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSDI"
 PARMSK(1) = "0"
 PARMSK(2) = [M:MFG0]MFGFCY
 PARMSK(3) = [M]ITMREF(nolign-1)
 PARMSK(4) = ""
 Call CONSULT_NUM(BASPAG,"SDI",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC"
 Call OBJET_CHAR([M:MFG1]VCRNUMORI(nolign-1),"SOH","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFISUBFICH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFISUBFICH"
 PARMSK(1) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFMW","MFGWINLIB","XWIMFMW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action FMLKB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "FMLKB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB9_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = GUSER
 PARMSK(3) = ""
 PARMSK(4) = [M]ITMREF(nolign-1)
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = func TRTX3FNC.VALFLD_C("[M]ECCVALMAJ(nolign-1)")
 PARMSK(10) = func TRTX3FNC.VALFLD_C("[M]ECCVALMIN(nolign-1)")
 Call TRAITE_NUM(BASPAG,PARMSK,"FMLKB","FUNMLINK","FMLINKB",5,"XYZFUNMLINK") From GTRAITE
 ACTION = "BB9_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC6A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC6A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB10_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M]MFGFCY
 Call OBJET_CHAR(OBJCLE,"ITF",[M]ITMREF(nolign-1)) From GOBJET
 ACTION = "BB10_NBLIG" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = [M]ITMREF(nolign-1)
 PARMSK(2) = "ITMREF"
 Call TRAITE_NUM(BASPAG,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B12_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B12_NBLIG From SUBMFG
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1WR1STD1
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3651,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
If !(GMODIF=2)
 Affzo ITMREF : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ITMREF(VALEUR) From SUBMFG
 If mkstat=2
  [M]ITMREF(INDIC) = VALEUR
  Affzo ITMREF(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ITMREF(zc) From W1WR1STD1
 Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action ITMCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "ITMCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","C",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREF(VALEUR) From SUBMFG
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREF(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action NOTE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "NOTE"
  PARMSK(1) = VALEUR
  PARMSK(2) = "ITMREF"
  Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = "2"
 PARMSK(3) = "1"
 PARMSK(4) = "234"
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = [M]ITMFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJET
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJET"
 Call OBJET_CHAR(VALEUR,"ITM","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ECCVALMAJ
Onevent BEFORE_INPUT Call AS_ECCVALMAJ(zc) From W1WR1STD1
Onevent CONTROL Call C_ECCVALMAJ(zc) From W1WR1STD1
Return

Subprog AS_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMAJ(VALEUR) From SUBMFG
If mkstat=2
 [M]ECCVALMAJ(INDIC) = VALEUR
 Affzo ECCVALMAJ(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMAJ(zc) From W1WR1STD1
Gosub _AFF
End

Subprog C_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
If !mkstat
 ## Action STD
 Call C_ECCVALMAJ(VALEUR) From SUBMFG
 If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Endif
Gosub _AFF
End

Subprog S_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:MFG1]ITMREF(nolign-1)
 PARMSK(2) = VALEUR
 PARMSK(3) = "[M:MFG1]ECCVALMIN(nolign-1)"
 PARMSK(4) = "2"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "MFG1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ECCVALMIN
Onevent BEFORE_INPUT Call AS_ECCVALMIN(zc) From W1WR1STD1
Onevent CONTROL Call C_ECCVALMIN(zc) From W1WR1STD1
Return

Subprog AS_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMIN(VALEUR) From SUBMFG
If mkstat=2
 [M]ECCVALMIN(INDIC) = VALEUR
 Affzo ECCVALMIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMIN(zc) From W1WR1STD1
Gosub _AFF
End

Subprog C_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
If !mkstat
 ## Action STD
 Call C_ECCVALMIN(VALEUR) From SUBMFG
 If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
Endif
Gosub _AFF
End

Subprog S_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:MFG1]ITMREF(nolign-1)
 PARMSK(2) = [M:MFG1]ECCVALMAJ(nolign-1)
 PARMSK(3) = ""
 PARMSK(4) = "2"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "MFG1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ITMSTA
Onevent INIT_AREA Call D_ITMSTA(zc) From W1WR1STD1
Return

Subprog D_ITMSTA(VALEUR)
Variable Integer VALEUR
If varinit([M]ITMSTA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_UOM
Onevent BEFORE_INPUT Call AS_UOM(zc) From W1WR1STD1
Onevent CONTROL Call C_UOM(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_UOM From W1WR1STD1
Return

Subprog AS_UOM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3612,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !(GMODIF<>1&[M]ITMTYP(nolign-1)=1)
 Affzo UOM : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_UOM(VALEUR) From SUBMFG
 If mkstat=2
  [M]UOM(INDIC) = VALEUR
  Affzo UOM(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_UOM(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_UOM(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_UOM(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_UOM(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_UOM(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TUN","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 9598 : Endif
If !mkstat
 ## Action STD
 Call C_UOM(VALEUR) From SUBMFG
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 9598 : Endif
Endif
Gosub _AFF
End

$AMM_UOM
Call AM_UOM(zc)
If !mkstat & GOBJET
 zoncou = "UOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_UOM(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 9598 : Endif
Gosub _AFF
End

Subprog S_UOM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELUOMN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELUOMN"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 Call S_LIS_CHAR(VALEUR,PARMSK,"STKSELUOMN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_UOM(VALEUR)
Variable Char    VALEUR()
## Action VISUUNI
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "VISUUNI"
PARMSK(1) = [M:MFG1]ITMREF(nolign-1)
Call SAISIE_CHAR(VALEUR,PARMSK,"IVISUUNI","VISUITF","XWVISUITF") From GSAISIE
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_UOMEXTQTY
Onevent BEFORE_AREA Gosub AV_UOMEXTQTY From W1WR1STD1
Onevent BEFORE_INPUT Call AS_UOMEXTQTY(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_UOMEXTQTY From W1WR1STD1
Onevent CONTROL Call C_UOMEXTQTY(zc) From W1WR1STD1
Return

Subprog IB_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call IB_UOMEXTQTY From SUBMFG
Gosub _AFF
End

$AV_UOMEXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]UOMEXTQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4874,GBOUT1) From OBJDIV
Call TEXTE(4874,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
Call TEXTE(454,GBOUT4) From OBJDIV
Call TEXTE(16848,GBOUT5) From OBJDIV
Call IB_UOMEXTQTY(VALEUR)
If !(GMODIF<>1)
 Affzo UOMEXTQTY : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_UOMEXTQTY(VALEUR) From SUBMFG
 If mkstat=2
  [M]UOMEXTQTY(INDIC) = VALEUR
  Affzo UOMEXTQTY(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_UOMEXTQTY(zc) From W1WR1STD1
 Onkey 130 Titled GBOUT2 Call B2_UOMEXTQTY(zc) From W1WR1STD1
 Onkey 131 Titled GBOUT3 Call B3_UOMEXTQTY(zc) From W1WR1STD1
 Onkey 132 Titled GBOUT4 Call B4_UOMEXTQTY(zc) From W1WR1STD1
 Onkey 133 Titled GBOUT5 Call B5_UOMEXTQTY(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "UOMEXTQTY" : GZNUM = 9599 : Endif
Gosub _AFF
End

$AMM_UOMEXTQTY
Call AM_UOMEXTQTY(zc)
If !mkstat & GOBJET
 zoncou = "UOMEXTQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_UOMEXTQTY(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "UOMEXTQTY" : GZNUM = 9599 : Endif
Gosub _AFF
End

Subprog B1_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B1_UOMEXTQTY(VALEUR) From SUBMFG
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B2_UOMEXTQTY(VALEUR) From SUBMFG
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action MFITRKSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFITRKSTA"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MFG1"
 Call SAISIE_NUM(VALEUR,PARMSK,"IMFIQTY","MFGWINLIB","XWIMFIQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action FDISPNOW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "FDISPNOW"
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = "5"
 PARMSK(3) = num$([M:MFG0]MFGSTA)
 PARMSK(4) = [M:MFG0]MFGNUM
 PARMSK(5) = [M:MFG1]STU(nolign-1)
 PARMSK(6) = num$([M:MFG1]EXTQTY(nolign-1))
 PARMSK(7) = num$([M:MFG1]EXTQTY(nolign-1))
 Call SAISIE_NUM(VALEUR,PARMSK,"IDISPNOW","BENCHLIB","XYZBENCHLIB") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_UOMEXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action FMLKB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "FMLKB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_UOMEXTQTY" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = GUSER
 PARMSK(3) = [M:MFG1]ENDDAT
 PARMSK(4) = [M:MFG1]ITMREF(nolign-1)
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = func TRTX3FNC.VALFLD_C("[M]ECCVALMAJ(nolign-1)")
 PARMSK(10) = func TRTX3FNC.VALFLD_C("[M]ECCVALMIN(nolign-1)")
 Call TRAITE_NUM(VALEUR,PARMSK,"FMLKB","FUNMLINK","FMLINKB",5,"XYZFUNMLINK") From GTRAITE
 ACTION = "BB5_UOMEXTQTY" : PROGSUB = "SUBMFG" : PROGSPE = "SPEMFG" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_UOMSTUCOE
Onevent AFTER_CHANGE Gosub AMM_UOMSTUCOE From W1WR1STD1
Onevent CONTROL Call C_UOMSTUCOE(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_UOMSTUCOE(zc) From W1WR1STD1
Return

Subprog AS_UOMSTUCOE(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF<>1&[M]ITMTYP(nolign-1)=1)
 Affzo UOMSTUCOE : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

Subprog C_UOMSTUCOE(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_UOMSTUCOE
Call AM_UOMSTUCOE(zc)
If !mkstat & GOBJET
 zoncou = "UOMSTUCOE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOMSTUCOE(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_UOMSTUCOE(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "UOMSTUCOE" : GZNUM = 11202 : Endif
Gosub _AFF
End

$ON_STU
Return

$ON_EXTQTY
Onevent BEFORE_AREA Gosub AV_EXTQTY From W1WR1STD1
Return

$AV_EXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTY(indice) With "NP+z:"+GUNTFMT
Gosub _AFF
Return

$ON_BOMALT
Onevent BEFORE_INPUT Call AS_BOMALT(zc) From W1WR1STD1
Onevent CONTROL Call C_BOMALT(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_BOMALT From W1WR1STD1
Return

Subprog AS_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7718,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
If !(GMODIF<>1 & [M]ITMTYP(nolign-1)=1)
 Affzo BOMALT : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_BOMALT(VALEUR) From SUBMFG
 If mkstat=2
  [M]BOMALT(INDIC) = VALEUR
  Affzo BOMALT(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_BOMALT(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_BOMALT(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_BOMALT(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 4258 : Endif
Gosub _AFF
End

$AMM_BOMALT
Call AM_BOMALT(zc)
If !mkstat & GOBJET
 zoncou = "BOMALT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_BOMALT(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 4258 : Endif
Gosub _AFF
End

Subprog S_BOMALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELMFGNOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNOM"
 PARMSK(1) = [M:MFG0]MFGFCY
 PARMSK(2) = [M:MFG1]ITMREF(nolign-1)
 Call S_TAB_NUM(VALEUR,PARMSK,"SELMFGNOM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_BOMALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B1_BOMALT(VALEUR) From SUBMFG
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1WR1STD1
Onevent CONTROL Call C_PJT(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_PJT From W1WR1STD1
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
If !(GMODIF<>1 & [M]ITMTYP(nolign-1)=1)
 Affzo PJT : mkstat = 2
Endif
If !mkstat
 ## Action PJTBEFZON
 Call PJT_BEFORE_ZONE(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
 If mkstat=2
  [M]PJT(INDIC) = VALEUR
  Affzo PJT(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1WR1STD1
 Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1WR1STD1
 Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1WR1STD1
 Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1WR1STD1
 Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1WR1STD1
 Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1WR1STD1
 Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1WR1STD1
 Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1WR1STD1
 Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJT(VALEUR) From SUBMFG
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MFG1","PJT",nolign-1,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:MFG0]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MFG1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:MFG0]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFG0]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LOT
Onevent BEFORE_INPUT Call AS_LOT(zc) From W1WR1STD1
Onevent CONTROL Call C_LOT(zc) From W1WR1STD1
Return

Subprog AS_LOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
If !(GMODIF<>1)
 Affzo LOT : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_LOT(VALEUR) From SUBMFG
 If mkstat=2
  [M]LOT(INDIC) = VALEUR
  Affzo LOT(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_LOT(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_LOT(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_LOT(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

Subprog S_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCLOT"
 PARMSK(1) = [M]ITMREF(nolign-1)
 PARMSK(2) = func TRTX3FNC.VALFLD_C("[M]ECCVALMAJ(nolign-1)")
 PARMSK(3) = func TRTX3FNC.VALFLD_C("[M]ECCVALMIN(nolign-1)")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCLOT","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_BPCTYPDEN
Onevent BEFORE_INPUT Call AS_BPCTYPDEN(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_BPCTYPDEN From W1WR1STD1
Onevent INIT_AREA Call D_BPCTYPDEN(zc) From W1WR1STD1
Onevent CONTROL Call C_BPCTYPDEN(zc) From W1WR1STD1
Return

Subprog D_BPCTYPDEN(VALEUR)
Variable Integer VALEUR
If varinit([M]BPCTYPDEN,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_BPCTYPDEN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF<>1&[M]ITMTYP(nolign-1)=1)
 Affzo BPCTYPDEN : mkstat = 2
Endif
If !mkstat
 Call INICOMBO(722) From COMBOS
 ## Action STD
 Call AS_BPCTYPDEN(VALEUR) From SUBMFG
 If mkstat=2
  [M]BPCTYPDEN(INDIC) = VALEUR
  Affzo BPCTYPDEN(INDIC) : mkstat = 2
 Endif
 If VALEUR<1 | GMENLOC(VALEUR)=1
  VALEUR = find(0,GMENLOC(1..len(mess(0,722,1))))
 Endif
 If !mkstat
  Discombo 0 From BPCTYPDEN(INDIC)
  If sum(GMENLOC)<>0
   Gosub COMBOS From COMBOS
   For WI=1 to WN : Discombo WCOMBO(WI) From BPCTYPDEN(INDIC) : Next WI
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog C_BPCTYPDEN(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$AMM_BPCTYPDEN
Call AM_BPCTYPDEN(zc)
If !mkstat & GOBJET
 zoncou = "BPCTYPDEN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCTYPDEN(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_BPCTYPDEN(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "BPCTYPDEN" : GZNUM = 7858 : Endif
Gosub _AFF
End

$ON_BPCNUM
Onevent BEFORE_INPUT Call AS_BPCNUM(zc) From W1WR1STD1
Onevent CONTROL Call C_BPCNUM(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_BPCNUM From W1WR1STD1
Onevent INIT_AREA Call D_BPCNUM(zc) From W1WR1STD1
Return

Subprog D_BPCNUM(VALEUR)
Variable Char    VALEUR()
If varinit([M]BPCNUM,indice)=0
 VALEUR = [M:MFG0]MFGFCY
Endif
Gosub _AFF
End

Subprog AS_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(22434,GBOUTS) From OBJDIV
If !(GMODIF<>1&[M]ITMTYP(nolign-1)=1)
 Affzo BPCNUM : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_BPCNUM(VALEUR) From SUBMFG
 If mkstat=2
  [M]BPCNUM(INDIC) = VALEUR
  Affzo BPCNUM(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_BPCNUM(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_BPCNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_BPCNUM(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 1292 : Endif
Gosub _AFF
End

$AMM_BPCNUM
Call AM_BPCNUM(zc)
If !mkstat & GOBJET
 zoncou = "BPCNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BPCNUM(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 1292 : Endif
Gosub _AFF
End

Subprog S_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPCNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPCNUM"
 PARMSK(1) = num$([M]BPCTYPDEN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPCNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRNUMORI
Onevent CONTROL Call C_VCRNUMORI(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_VCRNUMORI(zc) From W1WR1STD1
Onevent AFTER_CHANGE Gosub AMM_VCRNUMORI From W1WR1STD1
Return

Subprog AS_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
If !(GMODIF<>1&[M]ITMTYP(nolign-1)=1)
 Affzo VCRNUMORI : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_VCRNUMORI(VALEUR) From SUBMFG
 If mkstat=2
  [M]VCRNUMORI(INDIC) = VALEUR
  Affzo VCRNUMORI(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_VCRNUMORI(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMORI" : GZNUM = 5421 : Endif
Endif
Gosub _AFF
End

$AMM_VCRNUMORI
Call AM_VCRNUMORI(zc)
If !mkstat & GOBJET
 zoncou = "VCRNUMORI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRNUMORI(VALEUR) From SUBMFG
If mkstat : GERR = 1 : GZONE = "VCRNUMORI" : GZNUM = 5421 : Endif
Gosub _AFF
End

Subprog S_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 PARMSK(3) = [M:MFG0]MFGFCY
 PARMSK(4) = [M:MFG1]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGDES
Onevent BEFORE_INPUT Call AS_MFGDES(zc) From W1WR1STD1
Return

Subprog AS_MFGDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF<>1)
 Affzo MFGDES : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

$ON_ITMTYP
Onevent BEFORE_AREA Gosub AV_ITMTYP From W1WR1STD1
Onevent INIT_AREA Call D_ITMTYP(zc) From W1WR1STD1
Return

$AV_ITMTYP
## Action STD
Call AV_ITMTYP(zc) From SUBMFG
Gosub _AFF
Return

Subprog D_ITMTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]ITMTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PLANNER
Return

$ON_XFMI
Onevent INIT_AREA Call D_XFMI(zc) From W1WR1STD1
Return

Subprog D_XFMI(VALEUR)
Variable Integer VALEUR
If varinit([M]XFMI,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CCE1
Onevent BEFORE_AREA Gosub AV_CCE1 From W1WR1STD1
Onevent CONTROL Call C_CCE1(zc) From W1WR1STD1
Onevent INIT_AREA Call D_CCE1(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_CCE1(zc) From W1WR1STD1
Return

$AV_CCE1
## Action INICCEFMT
Call INICCEFMT(num$(GDIE(1))) From SETGLBDIE
If GFMTDIE(1)<>""
 Chgfmt [M]CCE1(indice) With GFMTDIE(1)
Else
 Chgfmt [M]CCE1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE1,indice)=0
 ## Action STD
 Call D_CCE1(VALEUR) From SUBMFG
Endif
Gosub _AFF
End

Subprog AS_CCE1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !(GMODIF<>1)
 Affzo CCE1 : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE1(VALEUR) From SUBMFG
 If mkstat=2
  [M]CCE1(INDIC) = VALEUR
  Affzo CCE1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE1(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_CCE1(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_CCE1(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_CCE1(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_CCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$(GDIE(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$(GDIE(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE1(VALEUR) From SUBMFG
  If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$(GDIE(1))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE1(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$(GDIE(1))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$(GDIE(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GDIE(1))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE2
Onevent BEFORE_AREA Gosub AV_CCE2 From W1WR1STD1
Onevent CONTROL Call C_CCE2(zc) From W1WR1STD1
Onevent INIT_AREA Call D_CCE2(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_CCE2(zc) From W1WR1STD1
Return

$AV_CCE2
## Action INICCEFMT
Call INICCEFMT(num$(GDIE(2))) From SETGLBDIE
If GFMTDIE(2)<>""
 Chgfmt [M]CCE2(indice) With GFMTDIE(2)
Else
 Chgfmt [M]CCE2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE2,indice)=0
 ## Action STD
 Call D_CCE2(VALEUR) From SUBMFG
Endif
Gosub _AFF
End

Subprog AS_CCE2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !(GMODIF<>1)
 Affzo CCE2 : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE2(VALEUR) From SUBMFG
 If mkstat=2
  [M]CCE2(INDIC) = VALEUR
  Affzo CCE2(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE2(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_CCE2(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_CCE2(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_CCE2(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$(GDIE(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$(GDIE(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE2(VALEUR) From SUBMFG
  If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$(GDIE(2))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE2(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$(GDIE(2))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$(GDIE(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GDIE(2))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE3
Onevent BEFORE_AREA Gosub AV_CCE3 From W1WR1STD1
Onevent CONTROL Call C_CCE3(zc) From W1WR1STD1
Onevent INIT_AREA Call D_CCE3(zc) From W1WR1STD1
Onevent BEFORE_INPUT Call AS_CCE3(zc) From W1WR1STD1
Return

$AV_CCE3
## Action INICCEFMT
Call INICCEFMT(num$(GDIE(3))) From SETGLBDIE
If GFMTDIE(3)<>""
 Chgfmt [M]CCE3(indice) With GFMTDIE(3)
Else
 Chgfmt [M]CCE3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE3(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE3,indice)=0
 ## Action STD
 Call D_CCE3(VALEUR) From SUBMFG
Endif
Gosub _AFF
End

Subprog AS_CCE3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !(GMODIF<>1)
 Affzo CCE3 : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE3(VALEUR) From SUBMFG
 If mkstat=2
  [M]CCE3(INDIC) = VALEUR
  Affzo CCE3(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE3(zc) From W1WR1STD1
 Onkey   2 Titled GBOUTS Call S_CCE3(zc) From W1WR1STD1
 Onkey 144 Titled GBOUTP Call P_CCE3(zc) From W1WR1STD1
 Onkey 146 Titled GBOUTA Call SA_CCE3(zc) From W1WR1STD1
Endif
Gosub _AFF
End

Subprog C_CCE3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$(GDIE(3))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$(GDIE(3)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE3(VALEUR) From SUBMFG
  If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CCE3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$(GDIE(3))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE3(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$(GDIE(3))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$(GDIE(3))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GDIE(3))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W4WR1STD1
Return

$TIT_COL
Gosub TIT_COL From W4WR1STD1
Return


