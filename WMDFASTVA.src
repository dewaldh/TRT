#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
## BI-DIMENSION ## Synchronization rule FASTVA

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".FXDASSETS" : If clalev([F:FAS])=0 : Local File =OUVTAB [FAS] : Endif
OUVTAB = GDOSSIER+".SECACT" : If clalev([F:SEA])=0 : Local File =OUVTAB [SEA] : Endif
OUVTAB = "Link [FAS]"
Link [FAS] With
& [SEA]SEA0 = [F:FAS]CPY;[F:FAS]AASBUS
& As [LNK_]
& Order By Key CLE = [FAS]AASREF
FILTRE = ""
Return

$FERME
If clalev([F:FAS]) : Close local File [FAS] : Endif
If clalev([F:SEA]) : Close local File [SEA] : Endif
Return

$DCLE
Local Char    DCLE(GLONAVA)(1..1)
Local Integer DTYP(1..1)
Local Integer NBDCLE
NBDCLE = 1
DCLE(1) = "AASREFTVA"
DTYP(1) =  7
Return

$CHARGE_CLE
If dim([F:AAA_]AASREFTVA)>0
 [F:AAA_]AASREFTVA = [F:FAS]AASREF
Endif
Return

########################################################################
# Return the filter necessary for incremental delete in synchroonization
Subprog GET_FLTDELINC(PFLT)
Variable Clbfile PFLT
PFLT = "1=1"
Append PFLT, " & [F:AAA_]AASREFTVA=[F:FAS]AASREF"

End

$MAJFLD
### AASREFTVA
[L]FLD="AASREFTVA"
[L]FORMULE='[F:FAS]AASREF'
If dim([F:AAA_]AASREFTVA)>0
 [F:AAA_]AASREFTVA = [F:FAS]AASREF
Endif

### AASBUS
[L]FLD="AASBUS"
[L]FORMULE='[F:FAS]AASBUS'
If dim([F:AAA_]AASBUS)>0
 [F:AAA_]AASBUS = [F:FAS]AASBUS
Endif

### SACDES
[L]FLD="SACDES"
[L]FORMULE='[F:SEA]SACDES'
If dim([F:AAA_]SACDES)>0
 [F:AAA_]SACDES = [F:SEA]SACDES
Endif

### VATREGDAT
[L]FLD="VATREGDAT"
[L]FORMULE='[F:FAS]VATREGDAT'
If dim([F:AAA_]VATREGDAT)>0
 [F:AAA_]VATREGDAT = [F:FAS]VATREGDAT
Endif

### THESLI
[L]FLD="THESLI"
[L]FORMULE='[F:FAS]THESLI'
If dim([F:AAA_]THESLI)>0
 [F:AAA_]THESLI = [F:FAS]THESLI
Endif

### VATYEAFLG
[L]FLD="VATYEAFLG"
[L]FORMULE='[F:FAS]VATYEAFLG'
If dim([F:AAA_]VATYEAFLG)>0
 [F:AAA_]VATYEAFLG = [F:FAS]VATYEAFLG
Endif

### VATRSD
[L]FLD="VATRSD"
[L]FORMULE='[F:FAS]VATRSD'
If dim([F:AAA_]VATRSD)>0
 [F:AAA_]VATRSD = [F:FAS]VATRSD
Endif

### ASJCOER
[L]FLD="ASJCOER"
[L]FORMULE='[F:FAS]ASJCOER'
If dim([F:AAA_]ASJCOER)>0
 [F:AAA_]ASJCOER = [F:FAS]ASJCOER
Endif

### TAXCOER
[L]FLD="TAXCOER"
[L]FORMULE='[F:FAS]TAXCOER'
If dim([F:AAA_]TAXCOER)>0
 [F:AAA_]TAXCOER = [F:FAS]TAXCOER
Endif

### ADMCOER
[L]FLD="ADMCOER"
[L]FORMULE='[F:FAS]ADMCOER'
If dim([F:AAA_]ADMCOER)>0
 [F:AAA_]ADMCOER = [F:FAS]ADMCOER
Endif

### DEDCOER
[L]FLD="DEDCOER"
[L]FORMULE='[F:FAS]DEDCOER'
If dim([F:AAA_]DEDCOER)>0
 [F:AAA_]DEDCOER = [F:FAS]DEDCOER
Endif

### ASJCOE
[L]FLD="ASJCOE"
[L]FORMULE='[F:FAS]ASJCOE'
If dim([F:AAA_]ASJCOE)>0
 [F:AAA_]ASJCOE = [F:FAS]ASJCOE
Endif

### TAXCOE
[L]FLD="TAXCOE"
[L]FORMULE='[F:FAS]TAXCOE'
If dim([F:AAA_]TAXCOE)>0
 [F:AAA_]TAXCOE = [F:FAS]TAXCOE
Endif

### ADMCOE
[L]FLD="ADMCOE"
[L]FORMULE='[F:FAS]ADMCOE'
If dim([F:AAA_]ADMCOE)>0
 [F:AAA_]ADMCOE = [F:FAS]ADMCOE
Endif

### DEDCOE
[L]FLD="DEDCOE"
[L]FORMULE='[F:FAS]DEDCOE'
If dim([F:AAA_]DEDCOE)>0
 [F:AAA_]DEDCOE = [F:FAS]DEDCOE
Endif

### ASJCOEF
[L]FLD="ASJCOEF"
[L]FORMULE='[F:FAS]ASJCOEF'
If dim([F:AAA_]ASJCOEF)>0
 [F:AAA_]ASJCOEF = [F:FAS]ASJCOEF
Endif

### TAXCOEF
[L]FLD="TAXCOEF"
[L]FORMULE='[F:FAS]TAXCOEF'
If dim([F:AAA_]TAXCOEF)>0
 [F:AAA_]TAXCOEF = [F:FAS]TAXCOEF
Endif

### ADMCOEF
[L]FLD="ADMCOEF"
[L]FORMULE='[F:FAS]ADMCOEF'
If dim([F:AAA_]ADMCOEF)>0
 [F:AAA_]ADMCOEF = [F:FAS]ADMCOEF
Endif

### DEDCOEF
[L]FLD="DEDCOEF"
[L]FORMULE='[F:FAS]DEDCOEF'
If dim([F:AAA_]DEDCOEF)>0
 [F:AAA_]DEDCOEF = [F:FAS]DEDCOEF
Endif


Return

