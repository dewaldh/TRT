#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management AEXP4 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [27/08/2018]
A_HEURE = "23:48:07"
A_USER  = "ADMIN"
A_STAMP = "20180827234807"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask AEXP4 [AEX4]
Gosub HORODAT
Local Inpbox "AEXP4" From GFONCTION At A_STAMP With A_WINDPREV Mask [AEX4] As [SIM_]
Grizo [AEX4]5
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [AEX4]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=100 : Y1(0)=1 : Y2(0)=20
Return

$ON_STYTIT
Onevent CONTROL Call C_STYTIT(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYTIT(zc) From W1AEXP4
Return

Subprog AS_STYTIT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYTIT(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYTIT(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYTIT(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYTIT(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYTIT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYTIT" : GZNUM = 30472 : Endif
Gosub _AFF
End

Subprog S_STYTIT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYTIT(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYTIT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYTIT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISTIT
Onevent BEFORE_AREA Gosub AV_VISTIT From W1AEXP4
Return

$AV_VISTIT
## Action STD
Call AV_VISTIT(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYINTH
Onevent CONTROL Call C_STYINTH(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYINTH(zc) From W1AEXP4
Return

Subprog AS_STYINTH(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYINTH(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYINTH(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYINTH(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYINTH(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYINTH(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYINTH" : GZNUM = 30554 : Endif
Gosub _AFF
End

Subprog S_STYINTH(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYINTH(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYINTH(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYINTH(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISINTH
Onevent BEFORE_AREA Gosub AV_VISINTH From W1AEXP4
Return

$AV_VISINTH
## Action STD
Call AV_VISINTH(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYVALH
Onevent CONTROL Call C_STYVALH(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYVALH(zc) From W1AEXP4
Return

Subprog AS_STYVALH(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYVALH(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYVALH(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYVALH(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYVALH(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYVALH(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYVALH" : GZNUM = 30555 : Endif
Gosub _AFF
End

Subprog S_STYVALH(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYVALH(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYVALH(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYVALH(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISVALH
Onevent BEFORE_AREA Gosub AV_VISVALH From W1AEXP4
Return

$AV_VISVALH
## Action STD
Call AV_VISVALH(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYCOL
Onevent CONTROL Call C_STYCOL(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYCOL(zc) From W1AEXP4
Return

Subprog AS_STYCOL(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYCOL(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYCOL(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYCOL(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYCOL(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYCOL(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYCOL" : GZNUM = 30468 : Endif
Gosub _AFF
End

Subprog S_STYCOL(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYCOL(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYCOL(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYCOL(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISCOL
Onevent BEFORE_AREA Gosub AV_VISCOL From W1AEXP4
Return

$AV_VISCOL
## Action STD
Call AV_VISCOL(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYALT
Onevent CONTROL Call C_STYALT(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYALT(zc) From W1AEXP4
Return

Subprog AS_STYALT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYALT(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYALT(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYALT(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYALT(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYALT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYALT" : GZNUM = 30466 : Endif
Gosub _AFF
End

Subprog S_STYALT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYALT(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYALT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYALT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISALT
Onevent BEFORE_AREA Gosub AV_VISALT From W1AEXP4
Return

$AV_VISALT
## Action STD
Call AV_VISALT(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYALT1
Onevent CONTROL Call C_STYALT1(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYALT1(zc) From W1AEXP4
Return

Subprog AS_STYALT1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYALT1(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYALT1(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYALT1(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYALT1(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYALT1(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYALT1" : GZNUM = 30467 : Endif
Gosub _AFF
End

Subprog S_STYALT1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYALT1(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYALT1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYALT1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISALT1
Onevent BEFORE_AREA Gosub AV_VISALT1 From W1AEXP4
Return

$AV_VISALT1
## Action STD
Call AV_VISALT1(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYCUM
Onevent CONTROL Call C_STYCUM(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYCUM(zc) From W1AEXP4
Return

Subprog AS_STYCUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYCUM(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYCUM(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYCUM(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYCUM(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYCUM(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYCUM" : GZNUM = 30469 : Endif
Gosub _AFF
End

Subprog S_STYCUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYCUM(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYCUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYCUM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISCUM
Onevent BEFORE_AREA Gosub AV_VISCUM From W1AEXP4
Return

$AV_VISCUM
## Action STD
Call AV_VISCUM(zc) From SUBAEXP
Gosub _AFF
Return

$ON_STYFOOT
Onevent CONTROL Call C_STYFOOT(zc) From W1AEXP4
Onevent BEFORE_INPUT Call AS_STYFOOT(zc) From W1AEXP4
Return

Subprog AS_STYFOOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24707,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STYFOOT(zc) From W1AEXP4
Onkey   2 Titled GBOUTS Call S_STYFOOT(zc) From W1AEXP4
Onkey 144 Titled GBOUTP Call P_STYFOOT(zc) From W1AEXP4
Onkey 146 Titled GBOUTA Call SA_STYFOOT(zc) From W1AEXP4
Gosub _AFF
End

Subprog C_STYFOOT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ASY","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "STYFOOT" : GZNUM = 30553 : Endif
Gosub _AFF
End

Subprog S_STYFOOT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ASY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STYFOOT(VALEUR)
Variable Char    VALEUR()
Call OBJET("ASY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STYFOOT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ASY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STYFOOT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ASY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VISFOOT
Onevent BEFORE_AREA Gosub AV_VISFOOT From W1AEXP4
Return

$AV_VISFOOT
## Action STD
Call AV_VISFOOT(zc) From SUBAEXP
Gosub _AFF
Return

$CHG_STY
Return


