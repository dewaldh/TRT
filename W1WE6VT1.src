#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WE6VT1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:19:25"
A_USER  = "ADMIN"
A_STAMP = "20180828001925"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If GFMTCOA(1)<>""
    Chgfmt LINACC1 With GFMTCOA(1)
   Else
    Chgfmt LINACC1 With "-K:1X"
   Endif
   If GFMTCOA(2)<>""
    Chgfmt LINACC2 With GFMTCOA(2)
   Else
    Chgfmt LINACC2 With "-K:1X"
   Endif
   If GFMTCOA(3)<>""
    Chgfmt LINACC3 With GFMTCOA(3)
   Else
    Chgfmt LINACC3 With "-K:1X"
   Endif
   If GFMTCOA(4)<>""
    Chgfmt LINACC4 With GFMTCOA(4)
   Else
    Chgfmt LINACC4 With "-K:1X"
   Endif
   If GFMTCOA(5)<>""
    Chgfmt LINACC5 With GFMTCOA(5)
   Else
    Chgfmt LINACC5 With "-K:1X"
   Endif
   If GFMTCOA(6)<>""
    Chgfmt LINACC6 With GFMTCOA(6)
   Else
    Chgfmt LINACC6 With "-K:1X"
   Endif
   If GFMTCOA(7)<>""
    Chgfmt LINACC7 With GFMTCOA(7)
   Else
    Chgfmt LINACC7 With "-K:1X"
   Endif
   If GFMTCOA(8)<>""
    Chgfmt LINACC8 With GFMTCOA(8)
   Else
    Chgfmt LINACC8 With "-K:1X"
   Endif
   If GFMTCOA(9)<>""
    Chgfmt LINACC9 With GFMTCOA(9)
   Else
    Chgfmt LINACC9 With "-K:1X"
   Endif
   If GFMTCOA(10)<>""
    Chgfmt LINACC10 With GFMTCOA(10)
   Else
    Chgfmt LINACC10 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WE6VT1 [PTH1]
Gosub HORODAT
Local Inpbox "WE6VT1" From GFONCTION At A_STAMP With A_WINDPREV Mask [PTH1] As [SIM_]
Grizo [PTH1]0
Grizo [PTH1]10
Grizo [PTH1]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [PTH1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=0
X1(1)=1 : X2(1)=74 : Y1(1)=1 : Y2(1)=17
X1(2)=1 : X2(2)=74 : Y1(2)=18 : Y2(2)=20
Return

$ON_NBLIG
Onevent BEFORE_INPUT Call AS_NBLIG From W1WE6VT1
Onevent CONTROL Call C_NBLIG From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_NBLIG From W1WE6VT1
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WE6VT1
Onevent AFTER_LINE Call APRES_NBLIG From W1WE6VT1
Onevent BEFORE_AREA Call AV_NBLIG From W1WE6VT1
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBPTH
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
GDEV1(1) = "EUR"
GDEV1(1) = [M:PTH1]NETCUR(nolign-1)
Gosub SETDEV From TRTDIV
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W3WE6VT1
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3312,GBOUT1) From OBJDIV
Call TEXTE(17084,GBOUT2) From OBJDIV
Call TEXTE(19862,GBOUT3) From OBJDIV
Call TEXTE(19863,GBOUT4) From OBJDIV
Call TEXTE(19585,GBOUT5) From OBJDIV
Call TEXTE(49959,GBOUT6) From OBJDIV
Call TEXTE(16652,GBOUT7) From OBJDIV
Call TEXTE(4685,GBOUT8) From OBJDIV
Call TEXTE(17875,GBOUT9) From OBJDIV
Call TEXTE(15405,GBOUT10) From OBJDIV
Call TEXTE(23138,GBOUT11) From OBJDIV
Call TEXTE(23306,GBOUT12) From OBJDIV
Call TEXTE(22739,GBOUT13) From OBJDIV
Call TEXTE(22921,GBOUT14) From OBJDIV
Call TEXTE(30056,GBOUT15) From OBJDIV
Call TEXTE(12817,GBOUT16) From OBJDIV
Call TEXTE(50506,GBOUT17) From OBJDIV
Call TEXTE(38447,GBOUT18) From OBJDIV
Call IB_NBLIG
## Action STD
Call AS_NBLIG From SUBPTH
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WE6VT1
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WE6VT1
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WE6VT1
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WE6VT1
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WE6VT1
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WE6VT1
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WE6VT1
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WE6VT1
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WE6VT1
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WE6VT1
Onkey 139 Titled GBOUT11 Call B11_NBLIG From W1WE6VT1
Onkey 140 Titled GBOUT12 Call B12_NBLIG From W1WE6VT1
Onkey 170 Titled GBOUT13 Call B13_NBLIG From W1WE6VT1
Onkey 171 Titled GBOUT14 Call B14_NBLIG From W1WE6VT1
Onkey 172 Titled GBOUT15 Call B15_NBLIG From W1WE6VT1
Onkey 173 Titled GBOUT16 Call B16_NBLIG From W1WE6VT1
Onkey 174 Titled GBOUT17 Call B17_NBLIG From W1WE6VT1
Onkey 175 Titled GBOUT18 Call B18_NBLIG From W1WE6VT1
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBPTH
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVLINCONT
 Call INSERE("PTDLIN") From TABLEAUX
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_NBLIG
Call AM_NBLIG
If !mkstat & GOBJET
 zoncou = "NBLIG" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NBLIG
Local Decimal BASPAG
## Action STD
Call AM_NBLIG From SUBPTH
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB1_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ENTRCLI
 GOUVENT = 16384
Endif
## Action SAISTOENT
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SAISTOENT"
Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
ACTION = "AB2_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
PARMSK(1) = "6"
PARMSK(2) = "PTH1"
PARMSK(3) = "WQPTH"+GFLAG+mid$("SM",(!!([M:PTH1]CREFLG(nolign-1)))+1,1)
PARMSK(4) = num$(nolign-1)
PARMSK(5) = [M:PTH0]PRHFCY
PARMSK(6) = [M:PTH0]BPSNUM
PARMSK(7) = "3"
PARMSK(8) = [M:PTH0]TRSCOD
Call TRAITE_NUM(BASPAG,PARMSK,"","TRTSTOENT","",1,"XYTRTSTOENT") From GTRAITE
ACTION = "BB2_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STKINFLOT
 Call INFOLOT("PTH1",nolign-1) From STKENT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B4_NBLIG From SUBPTH
Endif
If !GWEBSERV
 ## Action SAIENTLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIENTLOT"
 PARMSK(1) = "PTH1"
 PARMSK(2) = "PTR"
 PARMSK(3) = num$(nolign-1)
 Call TRAITE_NUM(BASPAG,PARMSK,"ISTOENTLO","SUBENTL","",1,"SPEENT") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action LECFICENT
Call LECFICENT([M:PTH0]PRHFCY,[M:PTH0]BPSNUM,"",nolign-1,3,[M:PTH0]TRSCOD,0) From STKECR
If mkstat : End : Endif
## Action STD
Call AVANT_NBLIG From SUBPTH
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action DIVLINNUM
Call LINNUM("PTDLIN") From TABLEAUX
If mkstat : End : Endif
## Action SAISTOENT
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SAISTOENT"
Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
ACTION = "AAPRES_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
PARMSK(1) = "6"
PARMSK(2) = "PTH1"
PARMSK(3) = "WQPTH"+GFLAG+mid$("SM",(!!([M:PTH1]CREFLG(nolign-1)))+1,1)
PARMSK(4) = num$(nolign-1)
PARMSK(5) = [M:PTH0]PRHFCY
PARMSK(6) = [M:PTH0]BPSNUM
PARMSK(7) = "3"
PARMSK(8) = [M:PTH0]TRSCOD
Call TRAITE_NUM(BASPAG,PARMSK,"","TRTSTOENT","",1,"XYTRTSTOENT") From GTRAITE
ACTION = "BAPRES_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
GACTION = SAVACT
If mkstat : End : Endif
## Action SAIENTLOT
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SAIENTLOT"
PARMSK(1) = "PTH1"
PARMSK(2) = "PTR"
PARMSK(3) = num$(nolign-1)
Call TRAITE_NUM(BASPAG,PARMSK,"ISTOENTLO","SUBENTL","",1,"SPEENT") From GTRAITE
GACTION = SAVACT
If mkstat : End : Endif
## Action STD
Call APRES_NBLIG From SUBPTH
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAISTOENTM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAISTOENTM"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "6"
 PARMSK(2) = "PTH1"
 PARMSK(3) = "WQPTH"+GFLAG+mid$("SM",(!!([M:PTH1]CREFLG(nolign-1)))+1,1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = [M:PTH0]PRHFCY
 PARMSK(6) = [M:PTH0]BPSNUM
 PARMSK(7) = "3"
 PARMSK(8) = [M:PTH0]TRSCOD
 Call TRAITE_NUM(BASPAG,PARMSK,"ISTOENTM","TRTSTOENM","",1,"XYTRTSTOENM") From GTRAITE
 ACTION = "BB5_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STCLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STCLIN"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB6_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "PTH1"
 PARMSK(2) = num$(nolign-1)
 PARMSK(3) = [M:PTH1]NETCUR(nolign-1)
 PARMSK(4) = num$([M:PTH0]CHGTYP)
 PARMSK(5) = "6"
 PARMSK(6) = [M:PTH0]PTHNUM
 PARMSK(7) = num$([M:PTH1]PTDLIN(nolign-1))
 PARMSK(8) = "0"
 PARMSK(9) = [M:PCEX]EECICT
 PARMSK(10) = [M:PTH0]BPSNUM
 PARMSK(11) = [M:PTH0]RCPDAT
 Call TRAITE_NUM(BASPAG,PARMSK,"ISTCLIN","TRTSTCD","",1,"SPESTCD") From GTRAITE
 [M:PTH1]NETCUR(nolign-1) = PARMSK(3)
 [M:PTH0]CHGTYP = val(PARMSK(4))
 ACTION = "BB6_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUETAPTD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUETAPTD"
 PARMSK(1) = [M:PTH0]PTHNUM
 PARMSK(2) = num$([M:PTH1]PTDLIN(nolign-1))
 PARMSK(3) = "PTH1"
 PARMSK(4) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYPTD","SUBPDQ6","SPEPDQ") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ACLOB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ACLOB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB8_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:PTH1]LINTEX(nolign-1)
 PARMSK(2) = "PTD"
 PARMSK(3) = "TRTX3TEX"
 PARMSK(4) = "PTH1"
 PARMSK(5) = num$(nolign)
 PARMSK(6) = "1"
 Call TRAITE_NUM(BASPAG,PARMSK,"","ACLOB","ACLOB",3,"XYACLOB") From GTRAITE
 [M:PTH1]LINTEX(nolign-1) = PARMSK(1)
 ACTION = "BB8_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B9_NBLIG From SUBPTH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUCLCPRI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCLCPRI"
 PARMSK(1) = "PTH"
 PARMSK(2) = [M:PTH1]NETCUR(nolign-1)
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 Call SAISIE_NUM(BASPAG,PARMSK,"IDETPRI","TRTPRICE","XWIDETPRI") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action TRTPSAISTT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "TRTPSAISTT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB11_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "WIPTH"+GFLAG
 PARMSK(2) = num$(nolign-1)
 Call TRAITE_NUM(BASPAG,PARMSK,"IPSAISTT","TRTPSAISTT","",1,"XYTRTPSAISTT") From GTRAITE
 ACTION = "BB11_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B12_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB12_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB12_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIBENCHI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIBENCHI"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB13_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:PTH0]PRHFCY
 PARMSK(2) = string$(GWRHACT-1,num$(sigma(1,dim([M:PTH0]WRHE),[M:PTH0]WRHE)))
 PARMSK(3) = WCLE1
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = "PTH"
 PARMSK(7) = GUSER
 PARMSK(8) = num$(WRET)
 PARMSK(9) = "0"
 Call TRAITE_NUM(BASPAG,PARMSK,"IMBI","FUNBENCHI","",5,"XYBENHCI") From GTRAITE
 WRET = val(PARMSK(8))
 ACTION = "BB13_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B14_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIBENCHM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIBENCHM"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB14_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:PTH0]PRHFCY
 PARMSK(2) = string$(GWRHACT-1,num$(sigma(1,dim([M:PTH0]WRHE),[M:PTH0]WRHE)))
 PARMSK(3) = WCLE1
 PARMSK(4) = ""
 PARMSK(5) = "0"
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = "0"
 PARMSK(9) = "PTH"
 PARMSK(10) = GUSER
 PARMSK(11) = "0"
 PARMSK(12) = "0"
 PARMSK(13) = num$(WRET)
 PARMSK(14) = ""
 Call TRAITE_NUM(BASPAG,PARMSK,"IMBM","FUNBENCHM","",5,"XYBENHCM") From GTRAITE
 WRET = val(PARMSK(13))
 ACTION = "BB14_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action TRTPSAISCM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "TRTPSAISCM"
 PARMSK(1) = "WIPTH"+GFLAG
 PARMSK(2) = num$(nolign-1)
 Call TRAITE_NUM(BASPAG,PARMSK,"IPSAISCM","TRTPSAISCM","",1,"SPEPSAISCM") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB16_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = [M:PTH0]PRHFCY
 PARMSK(3) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(4) = ""
 Call CONSULT_NUM(BASPAG,"SFC",PARMSK) From GCONSULT
 ACTION = "BB16_NBLIG" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUCSTLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCSTLIN"
 PARMSK(1) = [M:PTH0]PTHNUM
 PARMSK(2) = num$([M:PTH1]PTDLIN(nolign-1))
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = "PTH1"
 PARMSK(6) = num$(nolign-1)
 PARMSK(7) = [M:PCEX]EECICT
 Call SAISIE_NUM(BASPAG,PARMSK,"IPCSTLIN","SUBPCST","SPEPCST") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSPIA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSPIA"
 PARMSK(1) = "PTH"
 PARMSK(2) = [M:PTH0]PTHNUM
 PARMSK(3) = num$([M:PTH1]PTDLIN(nolign-1))
 Call CONSULT_NUM(BASPAG,"PIA",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_POHNUM
Onevent CONTROL Call C_POHNUM(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_POHNUM(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_POHNUM From W1WE6VT1
Return

Subprog IB_POHNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_POHNUM From SUBPTH
Endif
Gosub _AFF
End

Subprog AS_POHNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_POHNUM(VALEUR)
## Action PASLINCRE
If [M]CREFLG(nolign-1)<>0 : mkstat=2 : Endif
If mkstat=2
 [M]POHNUM(INDIC) = VALEUR
 Affzo POHNUM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_POHNUM(VALEUR) From SUBPTH
 If mkstat=2
  [M]POHNUM(INDIC) = VALEUR
  Affzo POHNUM(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_POHNUM(zc) From W1WE6VT1
 Onkey   2 Titled GBOUTS Call S_POHNUM(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog C_POHNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "POHNUM" : GZNUM = 3312 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_POHNUM(VALEUR) From SUBPTH
 If mkstat : GERR = 1 : GZONE = "POHNUM" : GZNUM = 3312 : Endif
Endif
Gosub _AFF
End

$AMM_POHNUM
Call AM_POHNUM(zc)
If !mkstat & GOBJET
 zoncou = "POHNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_POHNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_POHNUM(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "POHNUM" : GZNUM = 3312 : Endif
Gosub _AFF
End

Subprog S_POHNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPTHPOH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPTHPOH"
 PARMSK(1) = [M:PTH0]BPSNUM
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPTHPOH","TRTACHSEL1","") From GACTION
 [M:PTH0]BPSNUM = PARMSK(1)
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_POHNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_POHNUM" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB1_POHNUM" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_POPLIN
Onevent BEFORE_INPUT Call AS_POPLIN(zc) From W1WE6VT1
Onevent CONTROL Call C_POPLIN(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_POPLIN From W1WE6VT1
Return

Subprog AS_POPLIN(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]POPLIN(INDIC) = VALEUR
 Affzo POPLIN(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLINCRE
 If [M]CREFLG(nolign-1)<>0 : mkstat=2 : Endif
 If mkstat=2
  [M]POPLIN(INDIC) = VALEUR
  Affzo POPLIN(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_POPLIN(VALEUR) From SUBPTH
  If mkstat=2
   [M]POPLIN(INDIC) = VALEUR
   Affzo POPLIN(INDIC) : mkstat = 2
  Endif
  Onkey   2 Titled GBOUTS Call S_POPLIN(zc) From W1WE6VT1
 Endif
Endif
Gosub _AFF
End

Subprog C_POPLIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_POPLIN(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "POPLIN" : GZNUM = 641 : Endif
Gosub _AFF
End

$AMM_POPLIN
Call AM_POPLIN(zc)
If !mkstat & GOBJET
 zoncou = "POPLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_POPLIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_POPLIN(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "POPLIN" : GZNUM = 641 : Endif
If !GWEBSERV
 If !mkstat
  ## Action SELLIGPOQ
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "SELLIGPOQ"
  PARMSK(1) = [M:PTH1]POHNUM(nolign-1)
  Call S_TAB_NUM(VALEUR,PARMSK,"SELLIGPOQ","TRTACHSEL1","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "POPLIN" : GZNUM = 641 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_POPLIN(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELLIGPOQ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELLIGPOQ"
 PARMSK(1) = [M:PTH1]POHNUM(nolign-1)
 Call S_TAB_NUM(VALEUR,PARMSK,"SELLIGPOQ","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1WE6VT1
Onevent BEFORE_AREA Gosub AV_ITMREF From W1WE6VT1
Onevent INIT_AREA Call D_ITMREF(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1WE6VT1
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
If !GWEBSERV
 ## Action STD
 Call IB_ITMREF From SUBPTH
Endif
Gosub _AFF
End

$AV_ITMREF
## Action STD
Call AV_ITMREF(zc) From SUBPTH
Gosub _AFF
Return

Subprog D_ITMREF(VALEUR)
Variable Char    VALEUR()
If varinit([M]ITMREF,indice)=0
 ## Action PJTINIBATA
 Call PJT_INIBATA(nolign-1,"[M:PTH0]PJTH","[M:PTH1]PJT") From TRTPJT
Endif
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(735,GBOUT2) From OBJDIV
Call TEXTE(16673,GBOUT3) From OBJDIV
Call TEXTE(12817,GBOUT4) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]ITMREF(INDIC) = VALEUR
 Affzo ITMREF(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLINCRE
 If [M]CREFLG(nolign-1)<>0 : mkstat=2 : Endif
 If mkstat=2
  [M]ITMREF(INDIC) = VALEUR
  Affzo ITMREF(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_ITMREF(VALEUR) From SUBPTH
  If mkstat=2
   [M]ITMREF(INDIC) = VALEUR
   Affzo ITMREF(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_ITMREF(zc) From W1WE6VT1
  Onkey 130 Titled GBOUT2 Call B2_ITMREF(zc) From W1WE6VT1
  Onkey 131 Titled GBOUT3 Call B3_ITMREF(zc) From W1WE6VT1
  Onkey 132 Titled GBOUT4 Call B4_ITMREF(zc) From W1WE6VT1
  Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1WE6VT1
  Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1WE6VT1
  Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1WE6VT1
  Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1WE6VT1
 Endif
Endif
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action ITMCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "ITMCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action CTLPCOITMR
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "CTLPCOITMR"
   Call S_AFF_CHAR(VALEUR,PARMSK,"CTLPCOITMR","TRTACHCTL1","") From GACTION
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action SELITMPOQ
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELITMPOQ"
PARMSK(1) = [M:PTH1]POHNUM(nolign-1)
Call S_TAB_CHAR(VALEUR,PARMSK,"SELITMPOQ","TRTACHSEL1","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !mkstat
 ## Action STD
 Call AM_ITMREF(VALEUR) From SUBPTH
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !GWEBSERV
  If !mkstat
   ## Action NOTE
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "NOTE"
   PARMSK(1) = VALEUR
   PARMSK(2) = "ITMREF"
   Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPITMREF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPITMREF"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPITMREF","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREF(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB2_ITMREF" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PTH0]PRHFCY
 Call OBJET_CHAR(OBJCLE,"ITF",VALEUR) From GOBJET
 ACTION = "BB2_ITMREF" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITMPOQ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMPOQ"
 PARMSK(1) = [M:PTH1]POHNUM(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITMPOQ","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_ITMREF" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "1"
 PARMSK(2) = [M:PTH0]PRHFCY
 PARMSK(3) = VALEUR
 PARMSK(4) = ""
 Call CONSULT_CHAR(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB4_ITMREF" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ITMDES
Onevent BEFORE_INPUT Call AS_ITMDES(zc) From W1WE6VT1
Return

Subprog IB_ITMDES(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ITMDES From SUBPTH
Gosub _AFF
End

Subprog AS_ITMDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(49019,GBOUT2) From OBJDIV
Call IB_ITMDES(VALEUR)
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]ITMDES(INDIC) = VALEUR
 Affzo ITMDES(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ITMDES(VALEUR) From SUBPTH
 If mkstat=2
  [M]ITMDES(INDIC) = VALEUR
  Affzo ITMDES(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ITMDES(zc) From W1WE6VT1
 Onkey 130 Titled GBOUT2 Call B2_ITMDES(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog B1_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ITMDES" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PTH1]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 ACTION = "BB1_ITMDES" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(2) = "ITMREF"
 Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMDES1
Onevent BEFORE_INPUT Call AS_ITMDES1(zc) From W1WE6VT1
Return

Subprog IB_ITMDES1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ITMDES1 From SUBPTH
Gosub _AFF
End

Subprog AS_ITMDES1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call IB_ITMDES1(VALEUR)
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]ITMDES1(INDIC) = VALEUR
 Affzo ITMDES1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ITMDES1(VALEUR) From SUBPTH
 If mkstat=2
  [M]ITMDES1(INDIC) = VALEUR
  Affzo ITMDES1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ITMDES1(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog B1_ITMDES1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ITMDES1" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PTH1]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 ACTION = "BB1_ITMDES1" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_UOM
Onevent BEFORE_INPUT Call AS_UOM(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_UOM From W1WE6VT1
Onevent CONTROL Call C_UOM(zc) From W1WE6VT1
Return

Subprog AS_UOM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3612,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action SAIZONENT
Call SAIZONENT("UOM",nolign-1) From STKECR
If mkstat=2
 [M]UOM(INDIC) = VALEUR
 Affzo UOM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]UOM(INDIC) = VALEUR
  Affzo UOM(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_UOM(VALEUR) From SUBPTH
  If mkstat=2
   [M]UOM(INDIC) = VALEUR
   Affzo UOM(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_UOM(zc) From W1WE6VT1
  Onkey   2 Titled GBOUTS Call S_UOM(zc) From W1WE6VT1
  Onkey 144 Titled GBOUTP Call P_UOM(zc) From W1WE6VT1
  Onkey 146 Titled GBOUTA Call SA_UOM(zc) From W1WE6VT1
 Endif
Endif
Gosub _AFF
End

Subprog C_UOM(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TUN","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
Endif
Gosub _AFF
End

$AMM_UOM
Call AM_UOM(zc)
If !mkstat & GOBJET
 zoncou = "UOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_UOM(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PTH1",nolign-1,"UOM") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
Endif
Gosub _AFF
End

Subprog S_UOM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELUOMN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELUOMN"
 PARMSK(1) = "3"
 PARMSK(2) = "1"
 Call S_LIS_CHAR(VALEUR,PARMSK,"STKSELUOMN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_UOM(VALEUR)
Variable Char    VALEUR()
Call OBJET("TUN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_QTYUOM
Onevent BEFORE_AREA Gosub AV_QTYUOM From W1WE6VT1
Onevent BEFORE_INPUT Call AS_QTYUOM(zc) From W1WE6VT1
Onevent CONTROL Call C_QTYUOM(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_QTYUOM From W1WE6VT1
Return

$AV_QTYUOM
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PTH1]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYUOM(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTYUOM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONENT
Call SAIZONENT("QTYUOM",nolign-1) From STKECR
If mkstat=2
 [M]QTYUOM(INDIC) = VALEUR
 Affzo QTYUOM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]QTYUOM(INDIC) = VALEUR
  Affzo QTYUOM(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_QTYUOM(VALEUR) From SUBPTH
  If mkstat=2
   [M]QTYUOM(INDIC) = VALEUR
   Affzo QTYUOM(INDIC) : mkstat = 2
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog C_QTYUOM(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 271 : Endif
If !mkstat
 ## Action STD
 Call C_QTYUOM(VALEUR) From SUBPTH
 If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 271 : Endif
Endif
Gosub _AFF
End

$AMM_QTYUOM
Call AM_QTYUOM(zc)
If !mkstat & GOBJET
 zoncou = "QTYUOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYUOM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_QTYUOM(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 271 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PTH1",nolign-1,"QTYUOM") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 271 : Endif
Endif
Gosub _AFF
End

$ON_PUU
Return

$ON_QTYPUU
Onevent BEFORE_AREA Gosub AV_QTYPUU From W1WE6VT1
Return

$AV_QTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PTH1]PUU (nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_UOMSTUCOE
Onevent BEFORE_INPUT Call AS_UOMSTUCOE(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_UOMSTUCOE From W1WE6VT1
Return

Subprog AS_UOMSTUCOE(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONENT
Call SAIZONENT("UOMSTUCOE",nolign-1) From STKECR
If mkstat=2
 [M]UOMSTUCOE(INDIC) = VALEUR
 Affzo UOMSTUCOE(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]UOMSTUCOE(INDIC) = VALEUR
  Affzo UOMSTUCOE(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_UOMSTUCOE(VALEUR) From SUBPTH
  If mkstat=2
   [M]UOMSTUCOE(INDIC) = VALEUR
   Affzo UOMSTUCOE(INDIC) : mkstat = 2
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_UOMSTUCOE
Call AM_UOMSTUCOE(zc)
If !mkstat & GOBJET
 zoncou = "UOMSTUCOE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOMSTUCOE(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_UOMSTUCOE(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "UOMSTUCOE" : GZNUM = 9225 : Endif
Gosub _AFF
End

$ON_STU
Return

$ON_QTYSTU
Onevent BEFORE_AREA Gosub AV_QTYSTU From W1WE6VT1
Return

$AV_QTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PTH1]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYSTU(indice) With "NPz:"+GUNTFMT
Gosub _AFF
Return

$ON_RRRQTYSTU
Onevent BEFORE_AREA Gosub AV_RRRQTYSTU From W1WE6VT1
Onevent BEFORE_INPUT Call AS_RRRQTYSTU(zc) From W1WE6VT1
Onevent CONTROL Call C_RRRQTYSTU(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_RRRQTYSTU From W1WE6VT1
Return

$AV_RRRQTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:PTH1]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]RRRQTYSTU(indice) With "Nz:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_RRRQTYSTU(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]RRRQTYSTU(INDIC) = VALEUR
 Affzo RRRQTYSTU(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_RRRQTYSTU(VALEUR) From SUBPTH
 If mkstat=2
  [M]RRRQTYSTU(INDIC) = VALEUR
  Affzo RRRQTYSTU(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_RRRQTYSTU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_RRRQTYSTU(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "RRRQTYSTU" : GZNUM = 23043 : Endif
Gosub _AFF
End

$AMM_RRRQTYSTU
Call AM_RRRQTYSTU(zc)
If !mkstat & GOBJET
 zoncou = "RRRQTYSTU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RRRQTYSTU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_RRRQTYSTU(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "RRRQTYSTU" : GZNUM = 23043 : Endif
Gosub _AFF
End

$ON_WRH
Return

$ON_QUAFLG
Onevent INIT_AREA Call D_QUAFLG(zc) From W1WE6VT1
Return

Subprog D_QUAFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]QUAFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_STA
Onevent BEFORE_INPUT Call AS_STA(zc) From W1WE6VT1
Onevent CONTROL Call C_STA(zc) From W1WE6VT1
Return

Subprog AS_STA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action SAIZONENT
Call SAIZONENT("STA",nolign-1) From STKECR
If mkstat=2
 [M]STA(INDIC) = VALEUR
 Affzo STA(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]STA(INDIC) = VALEUR
  Affzo STA(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_STA(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog C_STA(VALEUR)
Variable Char    VALEUR()
## Action STKCTRSTA
Call STKCTRSTA(VALEUR,[F:SRU]AUZSST,[M:PTH1]QUAFLG(nolign-1),0,[M:PTH1]QUAFRE(nolign-1),mkstat) From STKACT
If mkstat : GERR = 1 : GZONE = "STA" : GZNUM = 1287 : Endif
Gosub _AFF
End

Subprog S_STA(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSTA"
 PARMSK(1) = [F:SRU]AUZSST
 PARMSK(2) = num$([M:PTH1]QUAFLG(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSTA","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_LOCTYP
Onevent CONTROL Call C_LOCTYP(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_LOCTYP(zc) From W1WE6VT1
Return

Subprog AS_LOCTYP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24189,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action SAIZONENT
Call SAIZONENT("LOCTYP",nolign-1) From STKECR
If mkstat=2
 [M]LOCTYP(INDIC) = VALEUR
 Affzo LOCTYP(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]LOCTYP(INDIC) = VALEUR
  Affzo LOCTYP(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STKSUGTLO
  Call STKSUGTLO([M:PTH1]WLOCSEQ(nolign-1),3,[M:PTH0]TRSCOD,[M:PTH0]PRHFCY,[M:PTH1]ITMREF(nolign-1),[M:PTH1]UOM(nolign-1),[M:PTH1]QTYUOM(nolign-1),[M:PTH1]STA(nolign-1)
&  ,VALEUR,"Q"+string$([M:PTH1]STA(nolign-1)="","S"),string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2'),string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PTH1]WRH)),[M:PTH1]WRH(nolign-1)))),[M:PTH1]LOC(nolign-1)) From STKLOC
  If mkstat=2
   [M]LOCTYP(INDIC) = VALEUR
   Affzo LOCTYP(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_LOCTYP(zc) From W1WE6VT1
  Onkey   2 Titled GBOUTS Call S_LOCTYP(zc) From W1WE6VT1
 Endif
Endif
Gosub _AFF
End

Subprog C_LOCTYP(VALEUR)
Variable Char    VALEUR()
## Action CTLTEMFMT
Call CTLTEMFMT(VALEUR,"") From STKACT
If mkstat : GERR = 1 : GZONE = "LOCTYP" : GZNUM = 3197 : Endif
If !mkstat
 ## Action STD
 Call C_LOCTYP(VALEUR) From SUBPTH
 If mkstat : GERR = 1 : GZONE = "LOCTYP" : GZNUM = 3197 : Endif
 If !mkstat
  ## Action STKCTRTLO
  Call STKCTRTLO([M:PTH1]WLOCSEQ(nolign-1),3,[M:PTH0]TRSCOD,[M:PTH0]PRHFCY,[M:PTH1]ITMREF(nolign-1),[M:PTH1]UOM(nolign-1),[M:PTH1]QTYUOM(nolign-1),[M:PTH1]STA(nolign-1)
&  ,0,VALEUR,mkstat,"Q"+string$([M:PTH1]STA(nolign-1)="","S"),string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2'),string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PTH1]WRH)),[M:PTH1]WRH(nolign-1))))) From STKLOC
  If mkstat : GERR = 1 : GZONE = "LOCTYP" : GZNUM = 3197 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_LOCTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELTLO1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELTLO1"
 PARMSK(1) = num$([M:PTH1]WLOCSEQ(nolign-1))
 PARMSK(2) = "3"
 PARMSK(3) = [M:PTH0]TRSCOD
 PARMSK(4) = [M:PTH0]PRHFCY
 PARMSK(5) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(6) = [M:PTH1]UOM(nolign-1)
 PARMSK(7) = num$([M:PTH1]QTYUOM(nolign-1))
 PARMSK(8) = [M:PTH1]STA(nolign-1)
 PARMSK(9) = "Q"+string$([M:PTH1]STA(nolign-1)="","S")
 PARMSK(10) = string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2')
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELTLO1","STKLOC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LOCTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJET
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJET"
 Call OBJET_CHAR(VALEUR,"TLO",[M:PTH0]PRHFCY) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_LOC
Onevent CONTROL Call C_LOC(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_LOC(zc) From W1WE6VT1
Return

Subprog IB_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_LOC From SUBPTH
Endif
Gosub _AFF
End

Subprog AS_LOC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3623,GBOUT1) From OBJDIV
Call TEXTE(6426,GBOUT2) From OBJDIV
Call TEXTE(8902,GBOUT3) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_LOC(VALEUR)
## Action SAIZONENT
Call SAIZONENT("LOC",nolign-1) From STKECR
If mkstat=2
 [M]LOC(INDIC) = VALEUR
 Affzo LOC(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]LOC(INDIC) = VALEUR
  Affzo LOC(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STKSUGEMP
  Call STKSUGEMP([M:PTH1]WLOCSEQ(nolign-1),3,[M:PTH0]TRSCOD,[M:PTH0]PRHFCY,[M:PTH1]ITMREF(nolign-1),[M:PTH1]UOM(nolign-1),[M:PTH1]QTYUOM(nolign-1),[M:PTH1]STA(nolign-1)
&  ,[M:PTH1]LOCTYP(nolign-1),VALEUR,[M:PTH0]BPSNUM,string$([M:PTH1]STA(nolign-1)="","S"),string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2'),string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PTH1]WRH)),[M:PTH1]WRH(nolign-1))))) From STKLOC
  If mkstat=2
   [M]LOC(INDIC) = VALEUR
   Affzo LOC(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_LOC(zc) From W1WE6VT1
  Onkey 130 Titled GBOUT2 Call B2_LOC(zc) From W1WE6VT1
  Onkey 131 Titled GBOUT3 Call B3_LOC(zc) From W1WE6VT1
  Onkey   2 Titled GBOUTS Call S_LOC(zc) From W1WE6VT1
 Endif
Endif
Gosub _AFF
End

Subprog C_LOC(VALEUR)
Variable Char    VALEUR()
## Action CTLEMPFMT
Call CTLEMPFMT(VALEUR,"") From STKACT
If mkstat : GERR = 1 : GZONE = "LOC" : GZNUM = 3623 : Endif
If !mkstat
 ## Action STKCTREMP
 Call STKCTREMP([M:PTH1]WLOCSEQ(nolign-1),3,[M:PTH0]TRSCOD,[M:PTH0]PRHFCY,[M:PTH1]ITMREF(nolign-1),[M:PTH1]UOM(nolign-1),[M:PTH1]QTYUOM(nolign-1),[M:PTH1]STA(nolign-1)
& ,[M:PTH1]LOCTYP(nolign-1),VALEUR,[M:PTH0]BPSNUM,0,mkstat,GBIDD1,string$([M:PTH1]STA(nolign-1)="","S"),string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2')
& ,string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PTH1]WRH)),[M:PTH1]WRH(nolign-1))))) From STKLOC
 If mkstat : GERR = 1 : GZONE = "LOC" : GZNUM = 3623 : Endif
Endif
Gosub _AFF
End

Subprog S_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SAIEMPLIB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIEMPLIB"
 PARMSK(1) = num$([M:PTH1]WLOCSEQ(nolign-1))
 PARMSK(2) = "3"
 PARMSK(3) = [M:PTH0]TRSCOD
 PARMSK(4) = [M:PTH0]PRHFCY
 PARMSK(5) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(6) = [M:PTH1]UOM(nolign-1)
 PARMSK(7) = num$([M:PTH1]QTYUOM(nolign-1))
 PARMSK(8) = [M:PTH1]STA(nolign-1)
 PARMSK(9) = [M:PTH1]LOCTYP(nolign-1)
 PARMSK(10) = VALEUR
 PARMSK(11) = [M:PTH0]BPSNUM
 PARMSK(12) = string$([M:PTH1]STA(nolign-1)="","S")
 PARMSK(13) = string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2')
 PARMSK(14) = string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:PTH1]WRH)),[M:PTH1]WRH(nolign-1))))
 Call SAISIE_CHAR(VALEUR,PARMSK,"ISELEMP","STKLOC","XWISELEMP") From GSAISIE
 [M:PTH1]WLOCSEQ(nolign-1) = val(PARMSK(1))
 [M:PTH1]LOCTYP(nolign-1) = PARMSK(9)
 VALEUR = PARMSK(10)
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_LOC" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(VALEUR,"LOC",[M:PTH0]PRHFCY) From GOBJET
 ACTION = "BB1_LOC" : PROGSUB = "SUBPTH" : PROGSPE = "SPEPTH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSEA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSEA"
 PARMSK(1) = "1"
 PARMSK(2) = [M:PTH0]PRHFCY
 PARMSK(3) = VALEUR
 PARMSK(4) = [M:PTH1]LOCTYP(nolign-1)
 PARMSK(5) = ""
 PARMSK(6) = "3"
 PARMSK(7) = "1"
 PARMSK(8) = string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2')
 PARMSK(9) = VALEUR
 Call CONSULT_CHAR(VALEUR,"SEA",PARMSK) From GCONSULT
 VALEUR = PARMSK(9)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_LOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSED
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSED"
 PARMSK(1) = "1"
 PARMSK(2) = [M:PTH0]PRHFCY
 PARMSK(3) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(4) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(5) = "0"
 PARMSK(6) = string$([F:PTR]SRGWAIFLG<>2,'[F:TLO]LOCCAT<>2')
 PARMSK(7) = VALEUR
 Call CONSULT_CHAR(VALEUR,"SED",PARMSK) From GCONSULT
 VALEUR = PARMSK(7)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_BPSLOT
Onevent BEFORE_INPUT Call AS_BPSLOT(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_BPSLOT From W1WE6VT1
Return

Subprog AS_BPSLOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action SAIZONENT
Call SAIZONENT("BPSLOT",nolign-1) From STKECR
If mkstat=2
 [M]BPSLOT(INDIC) = VALEUR
 Affzo BPSLOT(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]BPSLOT(INDIC) = VALEUR
  Affzo BPSLOT(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_BPSLOT(zc) From W1WE6VT1
Endif
Gosub _AFF
End

$AMM_BPSLOT
Call AM_BPSLOT(zc)
If !mkstat & GOBJET
 zoncou = "BPSLOT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPSLOT(VALEUR)
Variable Char    VALEUR()
## Action STKAMLOF
Call STKAMLOF(VALEUR,"PTH1",nolign-1,[M:PTH1]ITMREF(nolign-1),[M:PTH0]PRHFCY,[M:PTH1]BPSLOT(nolign-1),"LOT","SLO"
&,"LOCTYP",[M:PTH1]GESLOT(nolign-1)) From STKACT
If mkstat : GERR = 1 : GZONE = "BPSLOT" : GZNUM = 5115 : Endif
Gosub _AFF
End

Subprog S_BPSLOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELBPLN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELBPLN"
 PARMSK(1) = [M:PTH0]PRHFCY
 PARMSK(2) = [M:PTH1]ITMREF(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELBPLN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_LOT
Onevent BEFORE_INPUT Call AS_LOT(zc) From W1WE6VT1
Onevent CONTROL Call C_LOT(zc) From W1WE6VT1
Onevent AFTER_AREA Call AP_LOT(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_LOT From W1WE6VT1
Return

Subprog IB_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKIBLOT
 Call STKIBLOT(VALEUR,sigma(1,dim([M:PTH1]NBSLO)>0,[M:PTH1]NBSLO(nolign-1)),2,3,4) From STKACT
Endif
Gosub _AFF
End

Subprog AS_LOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(20545,GBOUT2) From OBJDIV
Call TEXTE(19918,GBOUT3) From OBJDIV
Call TEXTE(19862,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_LOT(VALEUR)
## Action SAIZONENT
Call SAIZONENT("LOT",nolign-1) From STKECR
If mkstat=2
 [M]LOT(INDIC) = VALEUR
 Affzo LOT(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]LOT(INDIC) = VALEUR
  Affzo LOT(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_LOT(zc) From W1WE6VT1
 Onkey 131 Titled GBOUT3 Call B3_LOT(zc) From W1WE6VT1
 Onkey 132 Titled GBOUT4 Call B4_LOT(zc) From W1WE6VT1
 Onkey   2 Titled GBOUTS Call S_LOT(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog C_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKCTRLOT
Call STKCTRLOT(VALEUR,"PTH1",nolign-1,[M:PTH1]ITMREF(nolign-1),[M:PTH1]BPSLOT(nolign-1),6,[M:PTH0]PTHNUM,[M:PTH1]PTDLIN(nolign-1)
&,[M:PTH1]SDHNUM(nolign-1),4*([M:PTH1]SDHNUM(nolign-1)<>""),[M:PTH1]SDDLIN(nolign-1),0,[M:PTH0]PRHFCY,"LOCTYP",[M:PTH1]GESLOT(nolign-1)) From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
If !mkstat
 ## Action STD
 Call C_LOT(VALEUR) From SUBPTH
 If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Endif
Gosub _AFF
End

Subprog AP_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKINIECC
Call STKINIECC([M:PTH1]ITMREF(nolign-1),VALEUR,"PTH1",2,2,nolign-1,2,func TRTX3FNC.VALFLD_C("[M]ECCVALMAJ(nolign-1)")
&,"ECCVALMAJ","ECCVALMIN","ECCVALMAJORI","ECCVALMINORI",1,[M:PTH0]BPSNUM) From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

$AMM_LOT
Call AM_LOT(zc)
If !mkstat & GOBJET
 zoncou = "LOT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKAMLOT
Call STKAMLOT(VALEUR,"PTH1",nolign-1,[M:PTH1]ITMREF(nolign-1),"SLO") From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

Subprog S_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELLOT"
 PARMSK(1) = [M:PTH1]ITMREF(nolign-1)
 PARMSK(2) = [M:PTH0]PRHFCY
 PARMSK(3) = "PTH1"
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELLOT","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B2_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action LOTNUMCPT
 Call LOTNUMCPT(VALEUR,[M:PTH0]PRHFCY,[M:PTH0]RCPDAT,[M:PTH1]ITMREF(nolign-1)) From STKACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action LOTBLANC
 Call STKLOTBLAN(VALEUR) From STKACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKINFLOT
 Call INFOLOT("PTH1",nolign-1) From STKENT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NBSLO
Onevent BEFORE_INPUT Call AS_NBSLO(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_NBSLO From W1WE6VT1
Return

Subprog AS_NBSLO(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONENT
Call SAIZONENT("NBSLO",nolign-1) From STKECR
If mkstat=2
 [M]NBSLO(INDIC) = VALEUR
 Affzo NBSLO(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]NBSLO(INDIC) = VALEUR
  Affzo NBSLO(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

$AMM_NBSLO
Call AM_NBSLO(zc)
If !mkstat & GOBJET
 zoncou = "NBSLO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NBSLO(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_NBSLO(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "NBSLO" : GZNUM = 19271 : Endif
Gosub _AFF
End

$ON_SLO
Onevent BEFORE_INPUT Call AS_SLO(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_SLO From W1WE6VT1
Return

Subprog IB_SLO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_SLO From SUBPTH
Endif
Gosub _AFF
End

Subprog AS_SLO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
Call IB_SLO(VALEUR)
## Action SAIZONENT
Call SAIZONENT("SLO",nolign-1) From STKECR
If mkstat=2
 [M]SLO(INDIC) = VALEUR
 Affzo SLO(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]SLO(INDIC) = VALEUR
  Affzo SLO(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_SLO(zc) From W1WE6VT1
Endif
Gosub _AFF
End

$AMM_SLO
Call AM_SLO(zc)
If !mkstat & GOBJET
 zoncou = "SLO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SLO(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SLO(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "SLO" : GZNUM = 18960 : Endif
Gosub _AFF
End

Subprog B1_SLO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call B1_SLO(VALEUR) From SUBPTH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_SERNUM
Onevent BEFORE_INPUT Call AS_SERNUM(zc) From W1WE6VT1
Onevent CONTROL Call C_SERNUM(zc) From W1WE6VT1
Return

Subprog AS_SERNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONENT
Call SAIZONENT("SERNUM",nolign-1) From STKECR
If mkstat=2
 [M]SERNUM(INDIC) = VALEUR
 Affzo SERNUM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]SERNUM(INDIC) = VALEUR
  Affzo SERNUM(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_SERNUM(VALEUR)
Variable Char    VALEUR()
## Action STKCTRSER
Call STKCTRSER(VALEUR,[M:PTH1]ITMREF(nolign-1),nolign-1,[M:PTH1]NBLIG,[M:PTH1]WSTOSEQ(nolign-1),3,6,[M:PTH0]PTHNUM
&,[M:PTH1]PTDLIN(nolign-1),4*([M:PTH1]SDHNUM(nolign-1)<>""),[M:PTH1]SDHNUM(nolign-1),[M:PTH1]SDDLIN(nolign-1),0,0,"") From STKACT
If mkstat : GERR = 1 : GZONE = "SERNUM" : GZNUM = 19273 : Endif
Gosub _AFF
End

$ON_ECCVALMIN
Return

$ON_PALNUM
Return

$ON_CTRNUM
Return

$ON_ECCSTA
Onevent INIT_AREA Call D_ECCSTA(zc) From W1WE6VT1
Return

Subprog D_ECCSTA(VALEUR)
Variable Integer VALEUR
If varinit([M]ECCSTA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_WSOLDE
Onevent BEFORE_INPUT Call AS_WSOLDE(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_WSOLDE From W1WE6VT1
Onevent INIT_AREA Call D_WSOLDE(zc) From W1WE6VT1
Return

Subprog D_WSOLDE(VALEUR)
Variable Integer VALEUR
If varinit([M]WSOLDE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_WSOLDE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]WSOLDE(INDIC) = VALEUR
 Affzo WSOLDE(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_WSOLDE(VALEUR) From SUBPTH
 If mkstat=2
  [M]WSOLDE(INDIC) = VALEUR
  Affzo WSOLDE(INDIC) : mkstat = 2
 Endif
 If VALEUR<1
  VALEUR = 1
 Endif
Endif
Gosub _AFF
End

$AMM_WSOLDE
Call AM_WSOLDE(zc)
If !mkstat & GOBJET
 zoncou = "WSOLDE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WSOLDE(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_WSOLDE(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "WSOLDE" : GZNUM = 17875 : Endif
Gosub _AFF
End

$ON_WSHDSOLDE
Onevent BEFORE_INPUT Call AS_WSHDSOLDE(zc) From W1WE6VT1
Onevent INIT_AREA Call D_WSHDSOLDE(zc) From W1WE6VT1
Return

Subprog D_WSHDSOLDE(VALEUR)
Variable Integer VALEUR
If varinit([M]WSHDSOLDE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_WSHDSOLDE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WSHDSOLDE(VALEUR) From SUBPTH
If mkstat=2
 [M]WSHDSOLDE(INDIC) = VALEUR
 Affzo WSHDSOLDE(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PJT
Return

$ON_GROPRI
Onevent BEFORE_AREA Gosub AV_GROPRI From W1WE6VT1
Onevent AFTER_AREA Call AP_GROPRI(zc) From W1WE6VT1
Return

$AV_GROPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

Subprog AP_GROPRI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AP_GROPRI(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
Gosub _AFF
End

$ON_DISCRGVAL1
Return

$ON_DISCRGVAL2
Return

$ON_DISCRGVAL3
Return

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W1WE6VT1
Return

$AV_NETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_LINAMT
Onevent BEFORE_AREA Gosub AV_LINAMT From W1WE6VT1
Return

$AV_LINAMT
Chgfmt [M]LINAMT(indice) With "NPz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_NETCUR
Return

$ON_CPRPRI
Onevent BEFORE_AREA Gosub AV_CPRPRI From W1WE6VT1
Return

$AV_CPRPRI
## Action PARDEV
Gosub _AFF
Return

$ON_CPRCOE
Return

$ON_CPRAMT
Onevent BEFORE_AREA Gosub AV_CPRAMT From W1WE6VT1
Return

$AV_CPRAMT
## Action PARDEV
Gosub _AFF
Return

$ON_STCNUM
Return

$ON_CSTPUR
Onevent BEFORE_AREA Gosub AV_CSTPUR From W1WE6VT1
Return

$AV_CSTPUR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_LINCSTPUR
Onevent BEFORE_AREA Gosub AV_LINCSTPUR From W1WE6VT1
Return

$AV_LINCSTPUR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_CPR
Onevent BEFORE_AREA Gosub AV_CPR From W1WE6VT1
Return

$AV_CPR
## Action PARDEV
Gosub _AFF
Return

$ON_CPRCLC
Onevent BEFORE_AREA Gosub AV_CPRCLC From W1WE6VT1
Return

$AV_CPRCLC
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_PRIORD
Onevent BEFORE_AREA Gosub AV_PRIORD From W1WE6VT1
Return

$AV_PRIORD
## Action PARDEV
Gosub _AFF
Return

$ON_LINAMTCPR
Onevent BEFORE_AREA Gosub AV_LINAMTCPR From W1WE6VT1
Return

$AV_LINAMTCPR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_CPRCUR
Return

$ON_MVTDES
Onevent BEFORE_INPUT Call AS_MVTDES(zc) From W1WE6VT1
Return

Subprog AS_MVTDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action SAIZONENT
Call SAIZONENT("MVTDES",nolign-1) From STKECR
If mkstat=2
 [M]MVTDES(INDIC) = VALEUR
 Affzo MVTDES(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLIN
 If GMODIF<>2 mkstat=2 : Endif
 If mkstat=2
  [M]MVTDES(INDIC) = VALEUR
  Affzo MVTDES(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

$ON_TRSFAM
Onevent INIT_AREA Call D_TRSFAM(zc) From W1WE6VT1
Onevent CONTROL Call C_TRSFAM(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_TRSFAM(zc) From W1WE6VT1
Return

Subprog D_TRSFAM(VALEUR)
Variable Char    VALEUR()
If varinit([M]TRSFAM,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"9","") From SUBADI
Endif
Gosub _AFF
End

Subprog AS_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TITADI(GBOUT1,"9") From TRTDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action PASLIN
If GMODIF<>2 mkstat=2 : Endif
If mkstat=2
 [M]TRSFAM(INDIC) = VALEUR
 Affzo TRSFAM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_TRSFAM(VALEUR) From SUBPTH
 If mkstat=2
  [M]TRSFAM(INDIC) = VALEUR
  Affzo TRSFAM(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_TRSFAM(zc) From W1WE6VT1
 Onkey   2 Titled GBOUTS Call S_TRSFAM(zc) From W1WE6VT1
 Onkey 144 Titled GBOUTP Call P_TRSFAM(zc) From W1WE6VT1
 Onkey 146 Titled GBOUTA Call SA_TRSFAM(zc) From W1WE6VT1
Endif
Gosub _AFF
End

Subprog C_TRSFAM(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"9","") From SUBADI
If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 53175 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"9",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 53175 : Endif
Endif
Gosub _AFF
End

Subprog S_TRSFAM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "9"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_TRSFAM(VALEUR)
Variable Char    VALEUR()
Call OBJET("ADI",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog SA_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC1
Onevent BEFORE_AREA Gosub AV_LINACC1 From W1WE6VT1
Onevent CONTROL Call C_LINACC1(zc) From W1WE6VT1
Onevent BEFORE_INPUT Call AS_LINACC1(zc) From W1WE6VT1
Onevent AFTER_CHANGE Gosub AMM_LINACC1 From W1WE6VT1
Return

$AV_LINACC1
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
If GFMTCOA(1)<>""
 Chgfmt [M]LINACC1(indice) With GFMTCOA(1)
Else
 Chgfmt [M]LINACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC1(VALEUR) From SUBPTH
If mkstat=2
 [M]LINACC1(INDIC) = VALEUR
 Affzo LINACC1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC1(zc) From W1WE6VT1
Onkey   2 Titled GBOUTS Call S_LINACC1(zc) From W1WE6VT1
Onkey 144 Titled GBOUTP Call P_LINACC1(zc) From W1WE6VT1
Onkey 146 Titled GBOUTA Call SA_LINACC1(zc) From W1WE6VT1
Gosub _AFF
End

Subprog C_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC1(VALEUR) From SUBPTH
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC1
Call AM_LINACC1(zc)
If !mkstat & GOBJET
 zoncou = "LINACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC1(VALEUR) From SUBPTH
If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PTH0]RCPDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PTH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(1))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W3WE6VT1
Return

$TIT_COL
Gosub TIT_COL From W3WE6VT1
Return


