#<AdxTL>@(#)0.0.0.0 $Revision$Class Project
# Supervisor
## ACLA-CLASSE ## OPPOR
# 2018-09-17 03:54:13 613


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : TCHISPJM PJM active ( Field Local menu number 1)
####################################################################

$SET_TCHISPJM
If [L]_AOLDVAL<>this.TCHISPJM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHISPJM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHISPJM
 Gosub PROPAGATE_TCHISPJM
Endif
Return

$INIT_TCHISPJM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHISPJM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TCHISPJM=0 and fmet this.AGETATTRIBUTE("TCHISPJM","$isMandatory")="true"
 this.TCHISPJM = 1
Endif
Return
 
$CONTROL_TCHISPJM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHISPJM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHISPJM              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHISPJM              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHISPJM
[L]CURPRO = "TCHISPJM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TCHISPJM=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHISPJM
[L]CURPRO = "TCHISPJM"
If this.TCHISPJM<0 or this.TCHISPJM>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.TCHISPJM)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_TCHISPJM
[L]CURPRO = "TCHISPJM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHISPJM
[L]CURPRO = "TCHISPJM"
Return

$PROPAGATE_TCHISPJM
this.isReadonly = 0
[L]CURPRO = "TCHISPJM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHISPJM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHISPJM"
$_LNKPRO_TCHISPJM
Return


####################################################################
# 2 : TCHIMPORT Import ( Field Local menu number 1)
####################################################################

$SET_TCHIMPORT
If [L]_AOLDVAL<>this.TCHIMPORT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHIMPORT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHIMPORT
 Gosub PROPAGATE_TCHIMPORT
Endif
Return

$INIT_TCHIMPORT
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHIMPORT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TCHIMPORT=0 and fmet this.AGETATTRIBUTE("TCHIMPORT","$isMandatory")="true"
 this.TCHIMPORT = 1
Endif
Return
 
$CONTROL_TCHIMPORT
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHIMPORT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHIMPORT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHIMPORT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHIMPORT
[L]CURPRO = "TCHIMPORT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TCHIMPORT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHIMPORT
[L]CURPRO = "TCHIMPORT"
If this.TCHIMPORT<0 or this.TCHIMPORT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.TCHIMPORT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_TCHIMPORT
[L]CURPRO = "TCHIMPORT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHIMPORT
[L]CURPRO = "TCHIMPORT"
Return

$PROPAGATE_TCHIMPORT
this.isReadonly = 0
[L]CURPRO = "TCHIMPORT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHIMPORT
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHIMPORT"
$_LNKPRO_TCHIMPORT
Return

$_ALOADATTRIBUTE_TCHIMPORT
[L]ASTATUS = fmet this.ASETATTRIBUTE("TCHIMPORT","$isMandatory","true")
Return


####################################################################
# 3 : TCHMODULE Module ( Field Local menu number 14)
####################################################################

$SET_TCHMODULE
If [L]_AOLDVAL<>this.TCHMODULE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHMODULE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHMODULE
 Gosub PROPAGATE_TCHMODULE
Endif
Return

$INIT_TCHMODULE
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHMODULE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TCHMODULE=0 and fmet this.AGETATTRIBUTE("TCHMODULE","$isMandatory")="true"
 this.TCHMODULE = 1
Endif
Return
 
$CONTROL_TCHMODULE
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHMODULE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHMODULE             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHMODULE             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHMODULE
[L]CURPRO = "TCHMODULE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TCHMODULE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHMODULE
[L]CURPRO = "TCHMODULE"
If this.TCHMODULE<0 or this.TCHMODULE>len(mess(0,14,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"14 ->"-num$(this.TCHMODULE)-mess(99,123,1)):  Return : # Local menu "14 -> Invalid option
Endif
Return

$_AOTHERS_TCHMODULE
[L]CURPRO = "TCHMODULE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHMODULE
[L]CURPRO = "TCHMODULE"
Return

$PROPAGATE_TCHMODULE
this.isReadonly = 0
[L]CURPRO = "TCHMODULE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHMODULE
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHMODULE"
$_LNKPRO_TCHMODULE
Return

$_ALOADATTRIBUTE_TCHMODULE
[L]ASTATUS = fmet this.ASETATTRIBUTE("TCHMODULE","$isMandatory","true")
Return


####################################################################
# 4 : TCHTOREAD To read ( Field A 3)
####################################################################

$SET_TCHTOREAD
If [L]_AOLDVAL<>this.TCHTOREAD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHTOREAD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHTOREAD
 Gosub PROPAGATE_TCHTOREAD
Endif
Return

$INIT_TCHTOREAD
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHTOREAD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TCHTOREAD
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHTOREAD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHTOREAD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHTOREAD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHTOREAD
[L]CURPRO = "TCHTOREAD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TCHTOREAD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHTOREAD
[L]CURPRO = "TCHTOREAD"
Return

$_AOTHERS_TCHTOREAD
[L]CURPRO = "TCHTOREAD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHTOREAD
[L]CURPRO = "TCHTOREAD"
Return

$PROPAGATE_TCHTOREAD
this.isReadonly = 0
[L]CURPRO = "TCHTOREAD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHTOREAD
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "TCHTOREAD"
$_LNKPRO_TCHTOREAD
Return

$_ALOADATTRIBUTE_TCHTOREAD
[L]ASTATUS = fmet this.ASETATTRIBUTE("TCHTOREAD","$isMandatory","true")
Return


####################################################################
# 5 : SALFCY Sales site ( Field FCY 5)
####################################################################

$SET_SALFCY
If [L]_AOLDVAL<>this.SALFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SALFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SALFCY
 Gosub PROPAGATE_SALFCY
Endif
Return

$INIT_SALFCY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "SALFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SALFCY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "SALFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SALFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SALFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SALFCY
[L]CURPRO = "SALFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SALFCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SALFCY
[L]CURPRO = "SALFCY"
If vireblc(this.SALFCY,2)<>vireblc(format$("K:5c",this.SALFCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SALFCY
[L]CURPRO = "SALFCY"
If vireblc(this.SALFCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"SALFCY",this.SALFCY,this.SALFCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.SALFCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SALFCY
[L]CURPRO = "SALFCY"
Return

$PROPAGATE_SALFCY
this.isReadonly = 0
[L]CURPRO = "SALFCY"
Gosub _LNKPRO_SALFCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SALFCY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "SALFCY"
$_LNKPRO_SALFCY
If vireblc(this.SALFCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.SALFCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return

$_ALOADATTRIBUTE_SALFCY
[L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$isMandatory","true")
Return


####################################################################
# 6 : CPY Company ( Field CPY 5)
####################################################################

$SET_CPY
If [L]_AOLDVAL<>this.CPY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CPY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CPY
 Gosub PROPAGATE_CPY
Endif
Return

$INIT_CPY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CPY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CPY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CPY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CPY
[L]CURPRO = "CPY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CPY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>vireblc(format$("K:5c",this.CPY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCPY.ACTRLREF(this,"CPY",this.CPY,this.CPY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CPY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CPY
[L]CURPRO = "CPY"
Return

$PROPAGATE_CPY
this.isReadonly = 0
[L]CURPRO = "CPY"
Gosub _LNKPRO_CPY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CPY
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CPY"
$_LNKPRO_CPY
If vireblc(this.CPY,2)<>""
 # Link COMPANY
 Local File COMPANY [WCPY]
 Read [F:WCPY]CPY0 = this.CPY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$title",[F:WCPY]CPYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$description",[F:WCPY]CPYNAM)
 Endif
 LogicClose File [WCPY]
Endif
Return


####################################################################
# 7 : OPPNUM Project chrono ( Field VCR 20)
####################################################################

$SET_OPPNUM
If [L]_AOLDVAL<>this.OPPNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPNUM
 Gosub PROPAGATE_OPPNUM
Endif
Return

$INIT_OPPNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPNUM
[L]CURPRO = "OPPNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPNUM
[L]CURPRO = "OPPNUM"
If vireblc(this.OPPNUM,2)<>vireblc(format$("K:20X",this.OPPNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPNUM
[L]CURPRO = "OPPNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPNUM
[L]CURPRO = "OPPNUM"
Return

$PROPAGATE_OPPNUM
this.isReadonly = 0
[L]CURPRO = "OPPNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPNUM"
$_LNKPRO_OPPNUM
Return

$_ALOADATTRIBUTE_OPPNUM
[L]ASTATUS = fmet this.ASETATTRIBUTE("OPPNUM","$isMandatory","true")
Return


####################################################################
# 8 : OPPEXTNUM External identifier ( Field A 20)
####################################################################

$SET_OPPEXTNUM
If [L]_AOLDVAL<>this.OPPEXTNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPEXTNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPEXTNUM
 Gosub PROPAGATE_OPPEXTNUM
Endif
Return

$INIT_OPPEXTNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPEXTNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPEXTNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPEXTNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPEXTNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPEXTNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPEXTNUM
[L]CURPRO = "OPPEXTNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPEXTNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPEXTNUM
[L]CURPRO = "OPPEXTNUM"
Return

$_AOTHERS_OPPEXTNUM
[L]CURPRO = "OPPEXTNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPEXTNUM
[L]CURPRO = "OPPEXTNUM"
Return

$PROPAGATE_OPPEXTNUM
this.isReadonly = 0
[L]CURPRO = "OPPEXTNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPEXTNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPEXTNUM"
$_LNKPRO_OPPEXTNUM
Return


####################################################################
# 9 : OPPCMP BP ( Field BPR 15)
####################################################################

$SET_OPPCMP
If [L]_AOLDVAL<>this.OPPCMP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPCMP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPCMP
 Gosub PROPAGATE_OPPCMP
Endif
Return

$INIT_OPPCMP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPCMP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPCMP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPCMP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPCMP
[L]CURPRO = "OPPCMP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPCMP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPCMP
[L]CURPRO = "OPPCMP"
If vireblc(this.OPPCMP,2)<>vireblc(format$("K:15c",this.OPPCMP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPCMP
[L]CURPRO = "OPPCMP"
If vireblc(this.OPPCMP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPR.ACTRLREF(this,"OPPCMP",this.OPPCMP,this.OPPCMP,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPPCMP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPCMP
[L]CURPRO = "OPPCMP"
Return

$PROPAGATE_OPPCMP
this.isReadonly = 0
[L]CURPRO = "OPPCMP"
Gosub _LNKPRO_OPPCMP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPCMP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMP"
$_LNKPRO_OPPCMP
If vireblc(this.OPPCMP,2)<>""
 # Link BPARTNER
 Local File BPARTNER [WBPR]
 Read [F:WBPR]BPR0 = this.OPPCMP
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPCMP","$title",[F:WBPR]BPRSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPCMP","$description",[F:WBPR]BPRNAM)
 Endif
 LogicClose File [WBPR]
Endif
Return


####################################################################
# 10 : OPPMCN Main contact ( Field AIN 15)
####################################################################

$SET_OPPMCN
If [L]_AOLDVAL<>this.OPPMCN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPMCN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPMCN
 Gosub PROPAGATE_OPPMCN
Endif
Return

$INIT_OPPMCN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPMCN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPMCN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPMCN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPMCN
[L]CURPRO = "OPPMCN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPMCN,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPMCN
[L]CURPRO = "OPPMCN"
If vireblc(this.OPPMCN,2)<>vireblc(format$("K:15c",this.OPPMCN),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPMCN
[L]CURPRO = "OPPMCN"
If vireblc(this.OPPMCN,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPAIN.ACTRLREF(this,"OPPMCN",this.OPPMCN,this.OPPMCN,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPPMCN<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPMCN
[L]CURPRO = "OPPMCN"
Return

$PROPAGATE_OPPMCN
this.isReadonly = 0
[L]CURPRO = "OPPMCN"
Gosub _LNKPRO_OPPMCN
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPMCN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCN"
$_LNKPRO_OPPMCN
If vireblc(this.OPPMCN,2)<>""
 # Link CONTACTCRM
 Local File CONTACTCRM [WAIN]
 Read [F:WAIN]AIN0 = this.OPPMCN
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPMCN","$description",[F:WAIN]CNTLNA)
 Endif
 LogicClose File [WAIN]
Endif
Return


####################################################################
# 11 : OPPMCNNAM Full name ( Field NAM 35)
####################################################################

$SET_OPPMCNNAM
If [L]_AOLDVAL<>this.OPPMCNNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPMCNNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPMCNNAM
 Gosub PROPAGATE_OPPMCNNAM
Endif
Return

$INIT_OPPMCNNAM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCNNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPMCNNAM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCNNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPMCNNAM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPMCNNAM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPMCNNAM
[L]CURPRO = "OPPMCNNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPMCNNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPMCNNAM
[L]CURPRO = "OPPMCNNAM"
If vireblc(this.OPPMCNNAM,2)<>vireblc(format$("K:35X",this.OPPMCNNAM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPMCNNAM
[L]CURPRO = "OPPMCNNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPMCNNAM
[L]CURPRO = "OPPMCNNAM"
Return

$PROPAGATE_OPPMCNNAM
this.isReadonly = 0
[L]CURPRO = "OPPMCNNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPMCNNAM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPMCNNAM"
$_LNKPRO_OPPMCNNAM
Return


####################################################################
# 12 : OPPDATOPN Opening date ( Field D)
####################################################################

$SET_OPPDATOPN
If [L]_AOLDVAL<>this.OPPDATOPN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDATOPN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPDATOPN
 Gosub PROPAGATE_OPPDATOPN
Endif
Return

$INIT_OPPDATOPN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPDATOPN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDATOPN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPDATOPN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDATOPN             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDATOPN             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDATOPN
[L]CURPRO = "OPPDATOPN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPDATOPN=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDATOPN
[L]CURPRO = "OPPDATOPN"
Return

$_AOTHERS_OPPDATOPN
[L]CURPRO = "OPPDATOPN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDATOPN
[L]CURPRO = "OPPDATOPN"
Return

$PROPAGATE_OPPDATOPN
this.isReadonly = 0
[L]CURPRO = "OPPDATOPN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDATOPN
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPDATOPN"
$_LNKPRO_OPPDATOPN
Return


####################################################################
# 13 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return

$_ALOADATTRIBUTE_CUR
[L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$isMandatory","true")
Return


####################################################################
# 14 : CHGTYP Rate type ( Field Local menu number 202)
####################################################################

$SET_CHGTYP
If [L]_AOLDVAL<>this.CHGTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CHGTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CHGTYP
 Gosub PROPAGATE_CHGTYP
Endif
Return

$INIT_CHGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CHGTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CHGTYP=0 and fmet this.AGETATTRIBUTE("CHGTYP","$isMandatory")="true"
 this.CHGTYP = 1
Endif
Return
 
$CONTROL_CHGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CHGTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CHGTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CHGTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CHGTYP
[L]CURPRO = "CHGTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CHGTYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CHGTYP
[L]CURPRO = "CHGTYP"
If this.CHGTYP<0 or this.CHGTYP>len(mess(0,202,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"202 ->"-num$(this.CHGTYP)-mess(99,123,1)):  Return : # Local menu "202 -> Invalid option
Endif
Return

$_AOTHERS_CHGTYP
[L]CURPRO = "CHGTYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CHGTYP
[L]CURPRO = "CHGTYP"
Return

$PROPAGATE_CHGTYP
this.isReadonly = 0
[L]CURPRO = "CHGTYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CHGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CHGTYP"
$_LNKPRO_CHGTYP
Return

$_ALOADATTRIBUTE_CHGTYP
[L]ASTATUS = fmet this.ASETATTRIBUTE("CHGTYP","$isMandatory","true")
Return


####################################################################
# 15 : OPPCLO Closed project ( Field Local menu number 1)
####################################################################

$SET_OPPCLO
If [L]_AOLDVAL<>this.OPPCLO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPCLO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPCLO
 Gosub PROPAGATE_OPPCLO
Endif
Return

$INIT_OPPCLO
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCLO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPCLO=0 and fmet this.AGETATTRIBUTE("OPPCLO","$isMandatory")="true"
 this.OPPCLO = 1
Endif
Return
 
$CONTROL_OPPCLO
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCLO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPCLO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPCLO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPCLO
[L]CURPRO = "OPPCLO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPCLO=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPCLO
[L]CURPRO = "OPPCLO"
If this.OPPCLO<0 or this.OPPCLO>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPCLO)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPCLO
[L]CURPRO = "OPPCLO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPCLO
[L]CURPRO = "OPPCLO"
Return

$PROPAGATE_OPPCLO
this.isReadonly = 0
[L]CURPRO = "OPPCLO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPCLO
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCLO"
$_LNKPRO_OPPCLO
Return


####################################################################
# 16 : OPPTYP Category ( Field Miscellaneous table number)
####################################################################

$SET_OPPTYP
If [L]_AOLDVAL<>this.OPPTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPTYP
 Gosub PROPAGATE_OPPTYP
Endif
Return

$INIT_OPPTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPTYP"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"OPPTYP",this.OPPTYP,434)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPTYP
[L]CURPRO = "OPPTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPTYP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPTYP
[L]CURPRO = "OPPTYP"
If vireblc(this.OPPTYP,2)<>vireblc(format$("K:20B",this.OPPTYP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPTYP
[L]CURPRO = "OPPTYP"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"OPPTYP",this.OPPTYP,434,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPTYP
[L]CURPRO = "OPPTYP"
Return

$PROPAGATE_OPPTYP
this.isReadonly = 0
[L]CURPRO = "OPPTYP"
Gosub _LNKPRO_OPPTYP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPTYP"
$_LNKPRO_OPPTYP
If vireblc(this.OPPTYP,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 434;this.OPPTYP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPTYP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPTYP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 17 : OPPREP Sales rep ( Field REP 15)
####################################################################

$SET_OPPREP
If [L]_AOLDVAL<>this.OPPREP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPREP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPREP
 Gosub PROPAGATE_OPPREP
Endif
Return

$INIT_OPPREP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPREP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPREP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPREP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPREP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPREP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPREP
[L]CURPRO = "OPPREP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPREP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPREP
[L]CURPRO = "OPPREP"
If vireblc(this.OPPREP,2)<>vireblc(format$("K:15c",this.OPPREP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPREP
[L]CURPRO = "OPPREP"
If vireblc(this.OPPREP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPREP.ACTRLREF(this,"OPPREP",this.OPPREP,this.OPPREP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPPREP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPREP
[L]CURPRO = "OPPREP"
Return

$PROPAGATE_OPPREP
this.isReadonly = 0
[L]CURPRO = "OPPREP"
Gosub _LNKPRO_OPPREP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPREP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPREP"
$_LNKPRO_OPPREP
If vireblc(this.OPPREP,2)<>""
 # Link SALESREP
 Local File SALESREP [WREP]
 Read [F:WREP]REP0 = this.OPPREP
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPREP","$description",[F:WREP]REPNAM)
 Endif
 LogicClose File [WREP]
Endif
Return


####################################################################
# 23 : OPPCMGNUM Campaign code ( Field CMG 20)
####################################################################

$SET_OPPCMGNUM
If [L]_AOLDVAL<>this.OPPCMGNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPCMGNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPCMGNUM
 Gosub PROPAGATE_OPPCMGNUM
Endif
Return

$INIT_OPPCMGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMGNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPCMGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMGNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPCMGNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPCMGNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPCMGNUM
[L]CURPRO = "OPPCMGNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPCMGNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPCMGNUM
[L]CURPRO = "OPPCMGNUM"
If vireblc(this.OPPCMGNUM,2)<>vireblc(format$("K:20X",this.OPPCMGNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPCMGNUM
[L]CURPRO = "OPPCMGNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPCMGNUM
[L]CURPRO = "OPPCMGNUM"
Return

$PROPAGATE_OPPCMGNUM
this.isReadonly = 0
[L]CURPRO = "OPPCMGNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPCMGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPCMGNUM"
$_LNKPRO_OPPCMGNUM
Return


####################################################################
# 24 : OPPOPGNUM Operation code ( Field VCR 20)
####################################################################

$SET_OPPOPGNUM
If [L]_AOLDVAL<>this.OPPOPGNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPOPGNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPOPGNUM
 Gosub PROPAGATE_OPPOPGNUM
Endif
Return

$INIT_OPPOPGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPOPGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPOPGNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPOPGNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPOPGNUM
[L]CURPRO = "OPPOPGNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPOPGNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPOPGNUM
[L]CURPRO = "OPPOPGNUM"
If vireblc(this.OPPOPGNUM,2)<>vireblc(format$("K:20X",this.OPPOPGNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPOPGNUM
[L]CURPRO = "OPPOPGNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPOPGNUM
[L]CURPRO = "OPPOPGNUM"
Return

$PROPAGATE_OPPOPGNUM
this.isReadonly = 0
[L]CURPRO = "OPPOPGNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPOPGNUM
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGNUM"
$_LNKPRO_OPPOPGNUM
Return


####################################################################
# 25 : OPPOPGTYP Operation type ( Field AOB 8)
####################################################################

$SET_OPPOPGTYP
If [L]_AOLDVAL<>this.OPPOPGTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPOPGTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPOPGTYP
 Gosub PROPAGATE_OPPOPGTYP
Endif
Return

$INIT_OPPOPGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPOPGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPOPGTYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPOPGTYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPOPGTYP
[L]CURPRO = "OPPOPGTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPOPGTYP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPOPGTYP
[L]CURPRO = "OPPOPGTYP"
If vireblc(this.OPPOPGTYP,2)<>vireblc(format$("KTD:8B",this.OPPOPGTYP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPOPGTYP
[L]CURPRO = "OPPOPGTYP"
If vireblc(this.OPPOPGTYP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPAOB.ACTRLREF(this,"OPPOPGTYP",this.OPPOPGTYP,this.OPPOPGTYP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPPOPGTYP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPOPGTYP
[L]CURPRO = "OPPOPGTYP"
Return

$PROPAGATE_OPPOPGTYP
this.isReadonly = 0
[L]CURPRO = "OPPOPGTYP"
Gosub _LNKPRO_OPPOPGTYP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPOPGTYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPOPGTYP"
$_LNKPRO_OPPOPGTYP
If vireblc(this.OPPOPGTYP,2)<>""
 # Link AOBJET
 Local File AOBJET [WAOB]
 Read [F:WAOB]ABREV = this.OPPOPGTYP
 If !fstat
  Local File ATEXTE [WATX]
  For [F:WATX] Where NUMERO=[F:WAOB]LIBSHO & LAN=this.ACTX.LAN
   [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPOPGTYP","$title",[WATX]TEXTE)
  Next WATX
  LogicClose File [WATX]
  Local File ATEXTE [WATX]
  For [F:WATX] Where NUMERO=[F:WAOB]LIBEL & LAN=this.ACTX.LAN
   [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPOPGTYP","$description",[WATX]TEXTE)
  Next WATX
  LogicClose File [WATX]
 Endif
 LogicClose File [WAOB]
Endif
Return


####################################################################
# 26 : OPPORI Source ( Field Local menu number 2995)
####################################################################

$SET_OPPORI
If [L]_AOLDVAL<>this.OPPORI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPORI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPORI
 Gosub PROPAGATE_OPPORI
Endif
Return

$INIT_OPPORI
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPORI=0 and fmet this.AGETATTRIBUTE("OPPORI","$isMandatory")="true"
 this.OPPORI = 1
Endif
Return
 
$CONTROL_OPPORI
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPORI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPORI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPORI
[L]CURPRO = "OPPORI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPORI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPORI
[L]CURPRO = "OPPORI"
If this.OPPORI<0 or this.OPPORI>len(mess(0,2995,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2995 ->"-num$(this.OPPORI)-mess(99,123,1)):  Return : # Local menu "2995 -> Invalid option
Endif
Return

$_AOTHERS_OPPORI
[L]CURPRO = "OPPORI"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPORI
[L]CURPRO = "OPPORI"
Return

$PROPAGATE_OPPORI
this.isReadonly = 0
[L]CURPRO = "OPPORI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPORI
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORI"
$_LNKPRO_OPPORI
Return


####################################################################
# 27 : OPPORIVCR Original item number ( Field VCR 20)
####################################################################

$SET_OPPORIVCR
If [L]_AOLDVAL<>this.OPPORIVCR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPORIVCR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPORIVCR
 Gosub PROPAGATE_OPPORIVCR
Endif
Return

$INIT_OPPORIVCR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPORIVCR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPORIVCR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPORIVCR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPORIVCR
[L]CURPRO = "OPPORIVCR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPORIVCR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPORIVCR
[L]CURPRO = "OPPORIVCR"
If vireblc(this.OPPORIVCR,2)<>vireblc(format$("K:20X",this.OPPORIVCR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPORIVCR
[L]CURPRO = "OPPORIVCR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPORIVCR
[L]CURPRO = "OPPORIVCR"
Return

$PROPAGATE_OPPORIVCR
this.isReadonly = 0
[L]CURPRO = "OPPORIVCR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPORIVCR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCR"
$_LNKPRO_OPPORIVCR
Return


####################################################################
# 28 : OPPORIVCRL Original line number ( Field L 8)
####################################################################

$SET_OPPORIVCRL
If [L]_AOLDVAL<>this.OPPORIVCRL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPORIVCRL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPORIVCRL
 Gosub PROPAGATE_OPPORIVCRL
Endif
Return

$INIT_OPPORIVCRL
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCRL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPORIVCRL
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCRL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPORIVCRL            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPORIVCRL            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPORIVCRL
[L]CURPRO = "OPPORIVCRL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPORIVCRL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPORIVCRL
[L]CURPRO = "OPPORIVCRL"
Return

$_AOTHERS_OPPORIVCRL
[L]CURPRO = "OPPORIVCRL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPORIVCRL
[L]CURPRO = "OPPORIVCRL"
Return

$PROPAGATE_OPPORIVCRL
this.isReadonly = 0
[L]CURPRO = "OPPORIVCRL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPORIVCRL
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORIVCRL"
$_LNKPRO_OPPORIVCRL
Return


####################################################################
# 29 : OPPORITYP Source type ( Field Local menu number 3037)
####################################################################

$SET_OPPORITYP
If [L]_AOLDVAL<>this.OPPORITYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPORITYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPORITYP
 Gosub PROPAGATE_OPPORITYP
Endif
Return

$INIT_OPPORITYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORITYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPORITYP=0 and fmet this.AGETATTRIBUTE("OPPORITYP","$isMandatory")="true"
 this.OPPORITYP = 1
Endif
Return
 
$CONTROL_OPPORITYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORITYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPORITYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPORITYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPORITYP
[L]CURPRO = "OPPORITYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPORITYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPORITYP
[L]CURPRO = "OPPORITYP"
If this.OPPORITYP<0 or this.OPPORITYP>len(mess(0,3037,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"3037 ->"-num$(this.OPPORITYP)-mess(99,123,1)):  Return : # Local menu "3037 -> Invalid option
Endif
Return

$_AOTHERS_OPPORITYP
[L]CURPRO = "OPPORITYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPORITYP
[L]CURPRO = "OPPORITYP"
Return

$PROPAGATE_OPPORITYP
this.isReadonly = 0
[L]CURPRO = "OPPORITYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPORITYP
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "OPPORITYP"
$_LNKPRO_OPPORITYP
Return


####################################################################
# 30 : CREUSR Creation user ( Field A 5)
####################################################################

$SET_CREUSR
If [L]_AOLDVAL<>this.CREUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREUSR
 Gosub PROPAGATE_CREUSR
Endif
Return

$INIT_CREUSR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CREUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CREUSR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CREUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREUSR
[L]CURPRO = "CREUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CREUSR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREUSR
[L]CURPRO = "CREUSR"
Return

$_AOTHERS_CREUSR
[L]CURPRO = "CREUSR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREUSR
[L]CURPRO = "CREUSR"
Return

$PROPAGATE_CREUSR
this.isReadonly = 0
[L]CURPRO = "CREUSR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREUSR
Gosub DECLARE_VAR From WMC0OPPOR
[L]CURPRO = "CREUSR"
$_LNKPRO_CREUSR
Return




