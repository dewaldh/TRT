#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management MFGBCRIT5 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:05:32"
A_USER  = "ADMIN"
A_STAMP = "20180828000532"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask MFGBCRIT5 [MFB5]
Gosub HORODAT
Local Inpbox "MFGBCRIT5" From GFONCTION At A_STAMP With A_WINDPREV Mask [MFB5] As [SIM_]
Grizo [MFB5]2
Grizo [MFB5]5
Grizo [MFB5]10
Grizo [MFB5]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MFB5]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=15 : X2(0)=98 : Y1(0)=5 : Y2(0)=8
X1(1)=15 : X2(1)=98 : Y1(1)=9 : Y2(1)=15
X1(2)=15 : X2(2)=98 : Y1(2)=16 : Y2(2)=21
X1(3)=15 : X2(3)=98 : Y1(3)=22 : Y2(3)=23
Return

$ON_FORMULE
Onevent CONTROL Call C_FORMULE(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_FORMULE(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_FORMULE From W1MFGBCRIT5
Return

Subprog AS_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_FORMULE(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_FORMULE(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_FORMULE(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_FORMULE(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_FORMULE(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"10",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "FORMULE" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_FORMULE
Call AM_FORMULE(zc)
If !mkstat & GOBJET
 zoncou = "FORMULE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FORMULE(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZFORMULE)")>indice
 [M]FORMULE(indice) = VALEUR
 Affzo ZFORMULE(indice)
Endif
Gosub _AFF
End

Subprog S_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "10"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FORMULE(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"10") From GOBJET
Gosub _AFF
End

Subprog SA_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "10"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "10"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZFORMULE
Onevent BEFORE_AREA Gosub AV_ZFORMULE From W1MFGBCRIT5
Return

$AV_ZFORMULE
Call LECTEXTRA(zc,"TABFOR","DES","10",num$([M]FORMULE(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_ITMREFS
Onevent CONTROL Call C_ITMREFS(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_ITMREFS From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_ITMREFS(zc) From W1MFGBCRIT5
Return

Subprog IB_ITMREFS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFS(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFS(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ITMREFS(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_ITMREFS(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_ITMREFS(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_ITMREFS(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_ITMREFS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFS" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFS" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFS" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREFS(VALEUR) From FUNMPICK
   If mkstat : GERR = 1 : GZONE = "ITMREFS" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFS
Call AM_ITMREFS(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFS" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFS(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFS(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "ITMREFS" : GZNUM = 3651 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFS)")>indice
 [M]ITMREFS(indice) = VALEUR
 Affzo ZITMREFS(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M:MGP]FCY
 PARMSK(2) = [M:MGP]ITMCAT
 PARMSK(3) = "1"
 PARMSK(4) = "1234"
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = [M:MGP]ITMFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREFS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFS(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFS(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFS
Onevent BEFORE_AREA Gosub AV_ZITMREFS From W1MFGBCRIT5
Return

$AV_ZITMREFS
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFS(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_BPRNUMSTR
Onevent CONTROL Call C_BPRNUMSTR(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_BPRNUMSTR From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_BPRNUMSTR(zc) From W1MFGBCRIT5
Return

Subprog AS_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPRNUMSTR(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_BPRNUMSTR(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_BPRNUMSTR(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_BPRNUMSTR(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPRNUMSTR" : GZNUM = 1500 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPRNUMSTR" : GZNUM = 1500 : Endif
Endif
Gosub _AFF
End

$AMM_BPRNUMSTR
Call AM_BPRNUMSTR(zc)
If !mkstat & GOBJET
 zoncou = "BPRNUMSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BPRNUMSTR(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "BPRNUMSTR" : GZNUM = 1500 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZBPRNUMSTR)")>indice
 [M]BPRNUMSTR(indice) = VALEUR
 Affzo ZBPRNUMSTR(indice)
Endif
Gosub _AFF
End

Subprog S_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPRNUMSTR
Onevent BEFORE_AREA Gosub AV_ZBPRNUMSTR From W1MFGBCRIT5
Return

$AV_ZBPRNUMSTR
If clalev([F:BPR])=0
 If dim(GTABCPT)>0 & GTABCPT<>"" & find("BPR",GABRCPT(1..GNBTABCPT))
  Local File =GTABCPT+"BPARTNER" [BPR]
 Else 
  Local File BPARTNER [BPR]
 Endif
Endif
Call LECTURE("BPR",num$([M]BPRNUMSTR(indice)),"") From CONTOBJ
zc = [F:BPR]BPRNAM
Gosub _AFF
Return

$ON_BPRNUMEND
Onevent CONTROL Call C_BPRNUMEND(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_BPRNUMEND(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_BPRNUMEND From W1MFGBCRIT5
Return

Subprog AS_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPRNUMEND(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_BPRNUMEND(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_BPRNUMEND(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_BPRNUMEND(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPRNUMEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPRNUMEND" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]BPRNUMSTR) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "BPRNUMEND" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_BPRNUMEND
Call AM_BPRNUMEND(zc)
If !mkstat & GOBJET
 zoncou = "BPRNUMEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZBPRNUMEND)")>indice
 [M]BPRNUMEND(indice) = VALEUR
 Affzo ZBPRNUMEND(indice)
Endif
Gosub _AFF
End

Subprog S_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPRNUMEND
Onevent BEFORE_AREA Gosub AV_ZBPRNUMEND From W1MFGBCRIT5
Return

$AV_ZBPRNUMEND
If clalev([F:BPR])=0
 If dim(GTABCPT)>0 & GTABCPT<>"" & find("BPR",GABRCPT(1..GNBTABCPT))
  Local File =GTABCPT+"BPARTNER" [BPR]
 Else 
  Local File BPARTNER [BPR]
 Endif
Endif
Call LECTURE("BPR",num$([M]BPRNUMEND(indice)),"") From CONTOBJ
zc = [F:BPR]BPRNAM
Gosub _AFF
Return

$ON_ENDDATSTR
Onevent AFTER_CHANGE Gosub AMM_ENDDATSTR From W1MFGBCRIT5
Onevent BEFORE_AREA Gosub AV_ENDDATSTR From W1MFGBCRIT5
Return

$AV_ENDDATSTR
Chgfmt [M]ENDDATSTR(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$AMM_ENDDATSTR
Call AM_ENDDATSTR(zc)
If !mkstat & GOBJET
 zoncou = "ENDDATSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDATSTR(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_ENDDATSTR(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "ENDDATSTR" : GZNUM = 1806 : Endif
Gosub _AFF
End

$ON_ENDDATEND
Onevent CONTROL Call C_ENDDATEND(zc) From W1MFGBCRIT5
Onevent BEFORE_AREA Gosub AV_ENDDATEND From W1MFGBCRIT5
Return

$AV_ENDDATEND
Chgfmt [M]ENDDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_ENDDATEND(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_ENDDATEND(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "ENDDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_PJTSTR
Onevent BEFORE_INPUT Call AS_PJTSTR(zc) From W1MFGBCRIT5
Onevent CONTROL Call C_PJTSTR(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_PJTSTR From W1MFGBCRIT5
Return

Subprog IB_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTSTR(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat=2
 [M]PJTSTR(INDIC) = VALEUR
 Affzo PJTSTR(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTSTR(zc) From W1MFGBCRIT5
Onkey 130 Titled GBOUT2 Call B2_PJTSTR(zc) From W1MFGBCRIT5
Onkey 131 Titled GBOUT3 Call B3_PJTSTR(zc) From W1MFGBCRIT5
Onkey 132 Titled GBOUT4 Call B4_PJTSTR(zc) From W1MFGBCRIT5
Onkey 172 Titled GBOUT15 Call B15_PJTSTR(zc) From W1MFGBCRIT5
Onkey 173 Titled GBOUT16 Call B16_PJTSTR(zc) From W1MFGBCRIT5
Onkey 174 Titled GBOUT17 Call B17_PJTSTR(zc) From W1MFGBCRIT5
Onkey 175 Titled GBOUT18 Call B18_PJTSTR(zc) From W1MFGBCRIT5
Onkey 176 Titled GBOUT19 Call B19_PJTSTR(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_PJTSTR(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_PJTSTR(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_PJTSTR(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJTSTR
Call AM_PJTSTR(zc)
If !mkstat & GOBJET
 zoncou = "PJTSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTSTR(VALEUR) From FUNMPICK
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MFB5","PJTSTR",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PJTEND
Onevent BEFORE_INPUT Call AS_PJTEND(zc) From W1MFGBCRIT5
Onevent CONTROL Call C_PJTEND(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_PJTEND From W1MFGBCRIT5
Return

Subprog IB_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTEND(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat=2
 [M]PJTEND(INDIC) = VALEUR
 Affzo PJTEND(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTEND(zc) From W1MFGBCRIT5
Onkey 130 Titled GBOUT2 Call B2_PJTEND(zc) From W1MFGBCRIT5
Onkey 131 Titled GBOUT3 Call B3_PJTEND(zc) From W1MFGBCRIT5
Onkey 132 Titled GBOUT4 Call B4_PJTEND(zc) From W1MFGBCRIT5
Onkey 172 Titled GBOUT15 Call B15_PJTEND(zc) From W1MFGBCRIT5
Onkey 173 Titled GBOUT16 Call B16_PJTEND(zc) From W1MFGBCRIT5
Onkey 174 Titled GBOUT17 Call B17_PJTEND(zc) From W1MFGBCRIT5
Onkey 175 Titled GBOUT18 Call B18_PJTEND(zc) From W1MFGBCRIT5
Onkey 176 Titled GBOUT19 Call B19_PJTEND(zc) From W1MFGBCRIT5
Onkey   2 Titled GBOUTS Call S_PJTEND(zc) From W1MFGBCRIT5
Onkey 144 Titled GBOUTP Call P_PJTEND(zc) From W1MFGBCRIT5
Onkey 146 Titled GBOUTA Call SA_PJTEND(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]PJTSTR) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTEND
Call AM_PJTEND(zc)
If !mkstat & GOBJET
 zoncou = "PJTEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MFB5","PJTEND",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB5]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MFB5"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB5]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB5]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VCRNUMSTR
Onevent CONTROL Call C_VCRNUMSTR(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_VCRNUMSTR(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_VCRNUMSTR From W1MFGBCRIT5
Return

Subprog AS_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRNUMSTR(VALEUR) From FUNMPICK
If mkstat=2
 [M]VCRNUMSTR(INDIC) = VALEUR
 Affzo VCRNUMSTR(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRNUMSTR(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMSTR" : GZNUM = 3170 : Endif
Endif
Gosub _AFF
End

$AMM_VCRNUMSTR
Call AM_VCRNUMSTR(zc)
If !mkstat & GOBJET
 zoncou = "VCRNUMSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRNUMSTR(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "VCRNUMSTR" : GZNUM = 3170 : Endif
Gosub _AFF
End

Subprog S_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:MGP]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRNUMEND
Onevent CONTROL Call C_VCRNUMEND(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_VCRNUMEND(zc) From W1MFGBCRIT5
Return

Subprog AS_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRNUMEND(VALEUR) From FUNMPICK
If mkstat=2
 [M]VCRNUMEND(INDIC) = VALEUR
 Affzo VCRNUMEND(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRNUMEND(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]VCRNUMSTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:MGP]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORISTR
Onevent CONTROL Call C_VCRORISTR(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_VCRORISTR(zc) From W1MFGBCRIT5
Onevent AFTER_CHANGE Gosub AMM_VCRORISTR From W1MFGBCRIT5
Return

Subprog AS_VCRORISTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRORISTR(VALEUR) From FUNMPICK
If mkstat=2
 [M]VCRORISTR(INDIC) = VALEUR
 Affzo VCRORISTR(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRORISTR(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_VCRORISTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Endif
Gosub _AFF
End

$AMM_VCRORISTR
Call AM_VCRORISTR(zc)
If !mkstat & GOBJET
 zoncou = "VCRORISTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRORISTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRORISTR(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Gosub _AFF
End

Subprog S_VCRORISTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRORI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRORI"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:MGP]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRORI","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORIEND
Onevent CONTROL Call C_VCRORIEND(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_VCRORIEND(zc) From W1MFGBCRIT5
Return

Subprog AS_VCRORIEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRORIEND(VALEUR) From FUNMPICK
If mkstat=2
 [M]VCRORIEND(INDIC) = VALEUR
 Affzo VCRORIEND(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRORIEND(zc) From W1MFGBCRIT5
Gosub _AFF
End

Subprog C_VCRORIEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]VCRORISTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRORIEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRORI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRORI"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:MGP]FCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRORI","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_STRDATSTR
Onevent AFTER_CHANGE Gosub AMM_STRDATSTR From W1MFGBCRIT5
Onevent BEFORE_AREA Gosub AV_STRDATSTR From W1MFGBCRIT5
Return

$AV_STRDATSTR
Chgfmt [M]STRDATSTR(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$AMM_STRDATSTR
Call AM_STRDATSTR(zc)
If !mkstat & GOBJET
 zoncou = "STRDATSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STRDATSTR(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_STRDATSTR(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "STRDATSTR" : GZNUM = 1805 : Endif
Gosub _AFF
End

$ON_STRDATEND
Onevent CONTROL Call C_STRDATEND(zc) From W1MFGBCRIT5
Onevent BEFORE_AREA Gosub AV_STRDATEND From W1MFGBCRIT5
Return

$AV_STRDATEND
Chgfmt [M]STRDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_STRDATEND(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_STRDATEND(VALEUR) From FUNMPICK
If mkstat : GERR = 1 : GZONE = "STRDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_EOS
Onevent INIT_AREA Call D_EOS(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_EOS(zc) From W1MFGBCRIT5
Return

Subprog D_EOS(VALEUR)
Variable Integer VALEUR
If varinit([M]EOS,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_EOS(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_MRPFLG
Onevent INIT_AREA Call D_MRPFLG(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_MRPFLG(zc) From W1MFGBCRIT5
Return

Subprog D_MRPFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]MRPFLG,indice)=0
 VALEUR = 3
Endif
Gosub _AFF
End

Subprog AS_MRPFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EOP
Onevent INIT_AREA Call D_EOP(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_EOP(zc) From W1MFGBCRIT5
Return

Subprog D_EOP(VALEUR)
Variable Integer VALEUR
If varinit([M]EOP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_EOP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SOF
Onevent INIT_AREA Call D_SOF(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_SOF(zc) From W1MFGBCRIT5
Return

Subprog D_SOF(VALEUR)
Variable Integer VALEUR
If varinit([M]SOF,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SOF(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_MSF
Onevent INIT_AREA Call D_MSF(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_MSF(zc) From W1MFGBCRIT5
Return

Subprog D_MSF(VALEUR)
Variable Integer VALEUR
If varinit([M]MSF,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MSF(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_TPF
Onevent INIT_AREA Call D_TPF(zc) From W1MFGBCRIT5
Onevent BEFORE_INPUT Call AS_TPF(zc) From W1MFGBCRIT5
Return

Subprog D_TPF(VALEUR)
Variable Integer VALEUR
If varinit([M]TPF,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_TPF(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SRTCOD
Onevent BEFORE_INPUT Call AS_SRTCOD(zc) From W1MFGBCRIT5
Onevent INIT_AREA Call D_SRTCOD(zc) From W1MFGBCRIT5
Onevent CONTROL Call C_SRTCOD(zc) From W1MFGBCRIT5
Return

Subprog D_SRTCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]SRTCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SRTCOD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(373) From COMBOS
## Action STD
Call AS_SRTCOD(VALEUR) From FUNMPICK
If mkstat=2
 [M]SRTCOD(INDIC) = VALEUR
 Affzo SRTCOD(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,373,1))))
Endif
If !mkstat
 Discombo 0 From SRTCOD(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From SRTCOD(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_SRTCOD(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_FCY
Return

$ON_PLANNER
Return

$CHG_STY
Return


