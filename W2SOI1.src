#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management SOI1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$ON_SAUSTUCOE
Onevent CONTROL Call C_SAUSTUCOE(zc) From W2SOI1
Return

Subprog C_SAUSTUCOE(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "SAUSTUCOE" : GZNUM = 3377 : Endif
Gosub _AFF
End

$ON_STU
Return

$ON_FIMHOR
Onevent BEFORE_INPUT Call AS_FIMHOR(zc) From W2SOI1
Return

Subprog IB_FIMHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_FIMHOR From SUBSOI
Endif
Gosub _AFF
End

Subprog AS_FIMHOR(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6902,GBOUT1) From OBJDIV
Call IB_FIMHOR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_FIMHOR(zc) From W2SOI1
Gosub _AFF
End

Subprog B1_FIMHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREPART
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREPART"
 Call SAISIE_NUM(VALEUR,PARMSK,"IREPARTI","SUBRPTI","SPERPT") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_VACBPR
Onevent CONTROL Call C_VACBPR(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_VACBPR From W2SOI1
Onevent BEFORE_INPUT Call AS_VACBPR(zc) From W2SOI1
Return

Subprog IB_VACBPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_VACBPR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(28739,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_VACBPR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_VACBPR(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_VACBPR(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_VACBPR(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_VACBPR(zc) From W2SOI1
Gosub _AFF
End

Subprog C_VACBPR(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "VACBPR" : GZNUM = 3673 : Endif
If !mkstat
 ## Action CONTTVB
 Call CONTTVB(VALEUR,GCURLEG,"SOI1","VACBPR",[M:SOI1]SALFCY,"",GSOCIETE) From SUBTVB
 If mkstat : GERR = 1 : GZONE = "VACBPR" : GZNUM = 3673 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "VACBPR" : GZNUM = 3673 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_VACBPR
Call AM_VACBPR(zc)
If !mkstat & GOBJET
 zoncou = "VACBPR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VACBPR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VACBPR(VALEUR) From SUBSOI
If mkstat : GERR = 1 : GZONE = "VACBPR" : GZNUM = 3673 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZVACBPR)")>indice
 [M]VACBPR(indice) = VALEUR
 Affzo ZVACBPR(indice)
Endif
Gosub _AFF
End

Subprog S_VACBPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVBLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVBLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:SOI1]SALFCY
 PARMSK(3) = ""
 PARMSK(4) = GSOCIETE
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVB","SUBTVB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VACBPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVB
 Call TUNTVB(VALEUR,GCURLEG) From SUBTVB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_VACBPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVB"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_VACBPR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVB",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZVACBPR
Onevent BEFORE_AREA Gosub AV_ZVACBPR From W2SOI1
Return

$AV_ZVACBPR
Call LECTEXTRA(zc,"TABVACBPR","SHOAXX",num$([M]VACBPR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_VACITM1
Onevent CONTROL Call C_VACITM1(zc) From W2SOI1
Onevent BEFORE_INPUT Call AS_VACITM1(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_VACITM1 From W2SOI1
Return

Subprog IB_VACITM1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_VACITM1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43290,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_VACITM1(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_VACITM1(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_VACITM1(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_VACITM1(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_VACITM1(zc) From W2SOI1
Gosub _AFF
End

Subprog C_VACITM1(VALEUR)
Variable Char    VALEUR()
## Action CONTTVI
Call CONTTVI(VALEUR,GCURLEG,"","",[M:SOI1]SALFCY,"",GSOCIETE) From SUBTVI
If mkstat : GERR = 1 : GZONE = "VACITM1" : GZNUM = 3705 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "VACITM1" : GZNUM = 3705 : Endif
 If !mkstat
  ## Action STD
  Call C_VACITM1(VALEUR) From SUBSOI
  If mkstat : GERR = 1 : GZONE = "VACITM1" : GZNUM = 3705 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_VACITM1
Call AM_VACITM1(zc)
If !mkstat & GOBJET
 zoncou = "VACITM1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VACITM1(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZVACITM1)")>indice
 [M]VACITM1(indice) = VALEUR
 Affzo ZVACITM1(indice)
Endif
Gosub _AFF
End

Subprog S_VACITM1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVILEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVILEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:SOI1]SALFCY
 PARMSK(3) = ""
 PARMSK(4) = GSOCIETE
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVI","SUBTVI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VACITM1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVI
 Call TUNTVI(VALEUR,GCURLEG) From SUBTVI
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_VACITM1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVI"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_VACITM1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZVACITM1
Onevent BEFORE_AREA Gosub AV_ZVACITM1 From W2SOI1
Return

$AV_ZVACITM1
Call LECTEXTRA(zc,"TABVACITM","DESAXX",num$([M]VACITM1(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_VACITM2
Onevent CONTROL Call C_VACITM2(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_VACITM2 From W2SOI1
Onevent BEFORE_INPUT Call AS_VACITM2(zc) From W2SOI1
Return

Subprog IB_VACITM2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_VACITM2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43290,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_VACITM2(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_VACITM2(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_VACITM2(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_VACITM2(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_VACITM2(zc) From W2SOI1
Gosub _AFF
End

Subprog C_VACITM2(VALEUR)
Variable Char    VALEUR()
## Action CONTTVI
Call CONTTVI(VALEUR,GCURLEG,"","",[M:SOI1]SALFCY,"",GSOCIETE) From SUBTVI
If mkstat : GERR = 1 : GZONE = "VACITM2" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "VACITM2" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_VACITM2
Call AM_VACITM2(zc)
If !mkstat & GOBJET
 zoncou = "VACITM2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VACITM2(VALEUR)
Variable Char    VALEUR()
## Action ALIVAT
Call ALIVAT(VALEUR,12,1,[M:SOI1]BPCORD,[M:SOI1]ITMREF,"SOI1",-1,[M:SOI1]VAT(1)) From TRTX3
If mkstat : GERR = 1 : GZONE = "VACITM2" : GZNUM = 0 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZVACITM2)")>indice
 [M]VACITM2(indice) = VALEUR
 Affzo ZVACITM2(indice)
Endif
Gosub _AFF
End

Subprog S_VACITM2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVILEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVILEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:SOI1]SALFCY
 PARMSK(3) = ""
 PARMSK(4) = GSOCIETE
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVI","SUBTVI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VACITM2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVI
 Call TUNTVI(VALEUR,GCURLEG) From SUBTVI
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_VACITM2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVI"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_VACITM2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZVACITM2
Onevent BEFORE_AREA Gosub AV_ZVACITM2 From W2SOI1
Return

$AV_ZVACITM2
Call LECTEXTRA(zc,"TABVACITM","DESAXX",num$([M]VACITM2(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_VACITM3
Onevent CONTROL Call C_VACITM3(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_VACITM3 From W2SOI1
Onevent BEFORE_INPUT Call AS_VACITM3(zc) From W2SOI1
Return

Subprog IB_VACITM3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_VACITM3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43290,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_VACITM3(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_VACITM3(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_VACITM3(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_VACITM3(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_VACITM3(zc) From W2SOI1
Gosub _AFF
End

Subprog C_VACITM3(VALEUR)
Variable Char    VALEUR()
## Action CONTTVI
Call CONTTVI(VALEUR,GCURLEG,"","",[M:SOI1]SALFCY,"",GSOCIETE) From SUBTVI
If mkstat : GERR = 1 : GZONE = "VACITM3" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "VACITM3" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_VACITM3
Call AM_VACITM3(zc)
If !mkstat & GOBJET
 zoncou = "VACITM3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VACITM3(VALEUR)
Variable Char    VALEUR()
## Action ALIVAT
Call ALIVAT(VALEUR,13,1,[M:SOI1]BPCORD,[M:SOI1]ITMREF,"SOI1",-1,[M:SOI1]VAT(2)) From TRTX3
If mkstat : GERR = 1 : GZONE = "VACITM3" : GZNUM = 0 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZVACITM3)")>indice
 [M]VACITM3(indice) = VALEUR
 Affzo ZVACITM3(indice)
Endif
Gosub _AFF
End

Subprog S_VACITM3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVILEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVILEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:SOI1]SALFCY
 PARMSK(3) = ""
 PARMSK(4) = GSOCIETE
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVI","SUBTVI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VACITM3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVI
 Call TUNTVI(VALEUR,GCURLEG) From SUBTVI
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_VACITM3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVI"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_VACITM3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZVACITM3
Onevent BEFORE_AREA Gosub AV_ZVACITM3 From W2SOI1
Return

$AV_ZVACITM3
Call LECTEXTRA(zc,"TABVACITM","DESAXX",num$([M]VACITM3(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_SSTCOD
Onevent INIT_AREA Call D_SSTCOD(zc) From W2SOI1
Onevent CONTROL Call C_SSTCOD(zc) From W2SOI1
Onevent BEFORE_INPUT Call AS_SSTCOD(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_SSTCOD From W2SOI1
Return

Subprog D_SSTCOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]SSTCOD,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"203","") From SUBADI
Endif
Gosub _AFF
End

Subprog AS_SSTCOD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TITADI(GBOUT1,"203") From TRTDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_SSTCOD(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_SSTCOD(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_SSTCOD(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_SSTCOD(zc) From W2SOI1
Gosub _AFF
End

Subprog C_SSTCOD(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"203","") From SUBADI
If mkstat : GERR = 1 : GZONE = "SSTCOD" : GZNUM = 48666 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"203",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "SSTCOD" : GZNUM = 48666 : Endif
Endif
Gosub _AFF
End

$AMM_SSTCOD
Call AM_SSTCOD(zc)
If !mkstat & GOBJET
 zoncou = "SSTCOD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SSTCOD(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSSTCOD)")>indice
 [M]SSTCOD(indice) = VALEUR
 Affzo ZSSTCOD(indice)
Endif
Gosub _AFF
End

Subprog S_SSTCOD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "203"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SSTCOD(VALEUR)
Variable Char    VALEUR()
Call OBJET("ADI",VALEUR,"203") From GOBJET
Gosub _AFF
End

Subprog SA_SSTCOD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "203"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SSTCOD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "203"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSSTCOD
Onevent BEFORE_AREA Gosub AV_ZSSTCOD From W2SOI1
Return

$AV_ZSSTCOD
Call LECTEXTRA(zc,"ATABDIV","LNGDES","203",num$([M]SSTCOD(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_DPJT
Onevent BEFORE_INPUT Call AS_DPJT(zc) From W2SOI1
Onevent CONTROL Call C_DPJT(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_DPJT From W2SOI1
Return

Subprog IB_DPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
&,"","[M:SOI1]PJT","","") From TRTPJT
Gosub _AFF
End

Subprog AS_DPJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_DPJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
&,"","[M:SOI1]PJT","","") From TRTPJT
If mkstat=2
 [M]DPJT(INDIC) = VALEUR
 Affzo DPJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_DPJT(zc) From W2SOI1
Onkey 130 Titled GBOUT2 Call B2_DPJT(zc) From W2SOI1
Onkey 131 Titled GBOUT3 Call B3_DPJT(zc) From W2SOI1
Onkey 132 Titled GBOUT4 Call B4_DPJT(zc) From W2SOI1
Onkey 172 Titled GBOUT15 Call B15_DPJT(zc) From W2SOI1
Onkey 173 Titled GBOUT16 Call B16_DPJT(zc) From W2SOI1
Onkey 174 Titled GBOUT17 Call B17_DPJT(zc) From W2SOI1
Onkey 175 Titled GBOUT18 Call B18_DPJT(zc) From W2SOI1
Onkey 176 Titled GBOUT19 Call B19_DPJT(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_DPJT(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_DPJT(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_DPJT(zc) From W2SOI1
Gosub _AFF
End

Subprog C_DPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
&,"","[M:SOI1]PJT","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "DPJT" : GZNUM = 18260 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DPJT" : GZNUM = 18260 : Endif
Endif
Gosub _AFF
End

$AMM_DPJT
Call AM_DPJT(zc)
If !mkstat & GOBJET
 zoncou = "DPJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
&,"","[M:SOI1]PJT","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "DPJT" : GZNUM = 18260 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZDPJT)")>indice
 [M]DPJT(indice) = VALEUR
 Affzo ZDPJT(indice)
Endif
Gosub _AFF
End

Subprog S_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
& ,"","[M:SOI1]PJT","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
& ,"","[M:SOI1]PJT","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
& ,"","[M:SOI1]PJT","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"SOI1","DPJT",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SOI1]SALFCY,[M:SOI1]BPCORD
& ,"","[M:SOI1]PJT","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_DPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "DPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SOI1]SALFCY
 PARMSK(15) = [M:SOI1]BPCORD
 PARMSK(16) = ""
 PARMSK(17) = "[M:SOI1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DPJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DPJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZDPJT
Onevent BEFORE_AREA Gosub AV_ZDPJT From W2SOI1
Return

$AV_ZDPJT
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]DPJT(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_EECICT
Onevent CONTROL Call C_EECICT(zc) From W2SOI1
Onevent BEFORE_INPUT Call AS_EECICT(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_EECICT From W2SOI1
Return

Subprog AS_EECICT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_EECICT(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_EECICT(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_EECICT(zc) From W2SOI1
Gosub _AFF
End

Subprog C_EECICT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ICT","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "EECICT" : GZNUM = 2523 : Endif
Gosub _AFF
End

$AMM_EECICT
Call AM_EECICT(zc)
If !mkstat & GOBJET
 zoncou = "EECICT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EECICT(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZEECICT)")>indice
 [M]EECICT(indice) = VALEUR
 Affzo ZEECICT(indice)
Endif
Gosub _AFF
End

Subprog S_EECICT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ICT"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_EECICT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ICT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_EECICT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ICT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZEECICT
Onevent BEFORE_AREA Gosub AV_ZEECICT From W2SOI1
Return

$AV_ZEECICT
Call LECTEXTRA(zc,"INCOTERM","DES",num$([M]EECICT(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PJTSAV
Return

$ON_PJT
Return

$ON_ICTCTY
Onevent BEFORE_INPUT Call AS_ICTCTY(zc) From W2SOI1
Return

Subprog AS_ICTCTY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ICTCTY(zc) From W2SOI1
Gosub _AFF
End

Subprog S_ICTCTY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELCTY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCTY"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELCTY","SUBPOS","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VAT
Return

$ON_TSICOD
Onevent INIT_AREA Call D_TSICOD(zc) From W2SOI1
Return

Subprog D_TSICOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]TSICOD,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"","") From SUBADI
Endif
Gosub _AFF
End

$ON_XREP1
Return

$ON_XREP2
Return

$ON_XBPTNUM
Return

$ON_XPCK
Return

$ON_STOMGTCOD
Onevent INIT_AREA Call D_STOMGTCOD(zc) From W2SOI1
Return

Subprog D_STOMGTCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]STOMGTCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_DACSAUCOE
Onevent INIT_AREA Call D_DACSAUCOE(zc) From W2SOI1
Return

Subprog D_DACSAUCOE(VALEUR)
Variable Integer VALEUR
If varinit([M]DACSAUCOE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EXTQTY
Onevent BEFORE_AREA Gosub AV_EXTQTY From W2SOI1
Onevent CONTROL Call C_EXTQTY(zc) From W2SOI1
Return

$AV_EXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]SAU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog C_EXTQTY(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_EXTAMT
Onevent BEFORE_AREA Gosub AV_EXTAMT From W2SOI1
Return

$AV_EXTAMT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]XCUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]EXTAMT(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

$ON_CPLAMT
Onevent BEFORE_AREA Gosub AV_CPLAMT From W2SOI1
Return

$AV_CPLAMT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]XCUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]CPLAMT(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

$ON_NBLIG
Onevent BEFORE_INPUT Call AS_NBLIG From W2SOI1
Onevent CONTROL Call C_NBLIG From W2SOI1
Onevent BEFORE_LINE Call AVANT_NBLIG From W2SOI1
Onevent AFTER_LINE Call APRES_NBLIG From W2SOI1
Onevent BEFORE_AREA Call AV_NBLIG From W2SOI1
Return

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W3SOI1
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_NBLIG From SUBSOI
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action DIVLINCONT
Call INSERE("SOPSEQ") From TABLEAUX
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_NBLIG From SUBSOI
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBSOI
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action DIVLINNUM
Call LINNUM("SOPSEQ") From TABLEAUX
If mkstat : End : Endif
## Action STD
Call APRES_NBLIG From SUBSOI
If mkstat : End : Endif
Gosub _AFF
End

$ON_STRDAT
Onevent BEFORE_INPUT Call AS_STRDAT(zc) From W2SOI1
Onevent CONTROL Call C_STRDAT(zc) From W2SOI1
Onevent BEFORE_AREA Gosub AV_STRDAT From W2SOI1
Return

$AV_STRDAT
Chgfmt [M]STRDAT(indice) With "D:"+GFMDAT
Gosub _AFF
Return

Subprog AS_STRDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_STRDAT(VALEUR) From SUBSOI
If mkstat=2
 [M]STRDAT(INDIC) = VALEUR
 Affzo STRDAT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_STRDAT(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "STRDAT" : GZNUM = 6968 : Endif
If !mkstat
 ## Action STD
 Call C_STRDAT(VALEUR) From SUBSOI
 If mkstat : GERR = 1 : GZONE = "STRDAT" : GZNUM = 6968 : Endif
Endif
Gosub _AFF
End

$ON_GROPRI
Onevent BEFORE_AREA Gosub AV_GROPRI From W2SOI1
Onevent BEFORE_INPUT Call AS_GROPRI(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_GROPRI From W2SOI1
Onevent CONTROL Call C_GROPRI(zc) From W2SOI1
Return

Subprog IB_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "GROPRI"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_GROPRI
## Action PARDEV
Gosub _AFF
Return

Subprog AS_GROPRI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7087,GBOUT2) From OBJDIV
Call IB_GROPRI(VALEUR)
## Action STD
Call AS_GROPRI(VALEUR) From SUBSOI
If mkstat=2
 [M]GROPRI(INDIC) = VALEUR
 Affzo GROPRI(INDIC) : mkstat = 2
Endif
Onkey 130 Titled GBOUT2 Call B2_GROPRI(zc) From W2SOI1
Gosub _AFF
End

Subprog C_GROPRI(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
Gosub _AFF
End

$AMM_GROPRI
Call AM_GROPRI(zc)
If !mkstat & GOBJET
 zoncou = "GROPRI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_GROPRI(VALEUR)
Variable Decimal VALEUR
## Action DIVDISCRG
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "DIVDISCRG"
PARMSK(1) = "SOI1"
PARMSK(2) = "0"
PARMSK(3) = num$(nolign-1)
Call S_AFF_NUM(VALEUR,PARMSK,"DIVDISCRG","TRTVENTAR","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
If !mkstat
 ## Action DIVPRIPFMO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVPRIPFMO"
 PARMSK(1) = "0"
 PARMSK(2) = "0"
 PARMSK(3) = [M:SOI1]BPCORD
 PARMSK(4) = num$([M:SOR1]CHGTYP)
 PARMSK(5) = [M:SOI1]STRDAT(nolign-1)
 PARMSK(6) = [M:SOI1]XCUR
 PARMSK(7) = num$(nolign-1)
 PARMSK(8) = [M:SOI1]STOFCY
 PARMSK(9) = num$([M:SOR1]PRITYP)
 PARMSK(10) = "GROPRI"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVPRIPFMO","TRTVENPRI","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "GROPRI" : GZNUM = 2541 : Endif
Endif
Gosub _AFF
End

Subprog B2_GROPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"ISALREN","TRTPRICE","XWISALREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL1
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL1 From W2SOI1
Onevent BEFORE_INPUT Call AS_DISCRGVAL1(zc) From W2SOI1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL1 From W2SOI1
Return

Subprog IB_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL1"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL1
If GFORREM(0)<>""
 Chgfmt [M]DISCRGVAL1(indice) With GFORREM(0)
Else
 Chgfmt [M]DISCRGVAL1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12526,GBOUT2) From OBJDIV
Call IB_DISCRGVAL1(VALEUR)
Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL1(zc) From W2SOI1
Gosub _AFF
End

$AMM_DISCRGVAL1
Call AM_DISCRGVAL1(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
## Action DIVDISCRG
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "DIVDISCRG"
PARMSK(1) = "SOI1"
PARMSK(2) = "1"
PARMSK(3) = num$(nolign-1)
Call S_AFF_NUM(VALEUR,PARMSK,"DIVDISCRG","TRTVENTAR","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "DISCRGVAL1" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVPRIPFMO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVPRIPFMO"
 PARMSK(1) = "1"
 PARMSK(2) = "0"
 PARMSK(3) = [M:SOI1]BPCORD
 PARMSK(4) = num$([M:SOR1]CHGTYP)
 PARMSK(5) = [M:SOI1]STRDAT(nolign-1)
 PARMSK(6) = [M:SOI1]XCUR
 PARMSK(7) = num$(nolign-1)
 PARMSK(8) = [M:SOI1]STOFCY
 PARMSK(9) = num$([M:SOR1]PRITYP)
 PARMSK(10) = "DISCRGVAL1"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVPRIPFMO","TRTVENPRI","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DISCRGVAL1" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"ISALREN","TRTPRICE","XWISALREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL2
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL2 From W2SOI1
Onevent BEFORE_INPUT Call AS_DISCRGVAL2(zc) From W2SOI1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL2 From W2SOI1
Return

Subprog IB_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL2"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL2
If GFORREM(1)<>""
 Chgfmt [M]DISCRGVAL2(indice) With GFORREM(1)
Else
 Chgfmt [M]DISCRGVAL2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7082,GBOUT1) From OBJDIV
Call TEXTE(12526,GBOUT2) From OBJDIV
Call IB_DISCRGVAL2(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DISCRGVAL2(zc) From W2SOI1
Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL2(zc) From W2SOI1
Gosub _AFF
End

$AMM_DISCRGVAL2
Call AM_DISCRGVAL2(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
## Action DIVDISCRG
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "DIVDISCRG"
PARMSK(1) = "SOI1"
PARMSK(2) = "2"
PARMSK(3) = num$(nolign-1)
Call S_AFF_NUM(VALEUR,PARMSK,"DIVDISCRG","TRTVENTAR","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "DISCRGVAL2" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVPRIPFMO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVPRIPFMO"
 PARMSK(1) = "2"
 PARMSK(2) = "0"
 PARMSK(3) = [M:SOI1]BPCORD
 PARMSK(4) = num$([M:SOR1]CHGTYP)
 PARMSK(5) = [M:SOI1]STRDAT(nolign-1)
 PARMSK(6) = [M:SOI1]XCUR
 PARMSK(7) = num$(nolign-1)
 PARMSK(8) = [M:SOI1]STOFCY
 PARMSK(9) = num$([M:SOR1]PRITYP)
 PARMSK(10) = "DISCRGVAL2"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVPRIPFMO","TRTVENPRI","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DISCRGVAL2" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL2"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"ISALREN","TRTPRICE","XWISALREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DISCRGVAL3
Onevent AFTER_CHANGE Gosub AMM_DISCRGVAL3 From W2SOI1
Onevent BEFORE_INPUT Call AS_DISCRGVAL3(zc) From W2SOI1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL3 From W2SOI1
Return

Subprog IB_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL3"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$AV_DISCRGVAL3
If GFORREM(2)<>""
 Chgfmt [M]DISCRGVAL3(indice) With GFORREM(2)
Else
 Chgfmt [M]DISCRGVAL3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7082,GBOUT1) From OBJDIV
Call TEXTE(12526,GBOUT2) From OBJDIV
Call IB_DISCRGVAL3(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DISCRGVAL3(zc) From W2SOI1
Onkey 130 Titled GBOUT2 Call B2_DISCRGVAL3(zc) From W2SOI1
Gosub _AFF
End

$AMM_DISCRGVAL3
Call AM_DISCRGVAL3(zc)
If !mkstat & GOBJET
 zoncou = "DISCRGVAL3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
## Action DIVDISCRG
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "DIVDISCRG"
PARMSK(1) = "SOI1"
PARMSK(2) = "3"
PARMSK(3) = num$(nolign-1)
Call S_AFF_NUM(VALEUR,PARMSK,"DIVDISCRG","TRTVENTAR","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "DISCRGVAL3" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVPRIPFMO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVPRIPFMO"
 PARMSK(1) = "3"
 PARMSK(2) = "0"
 PARMSK(3) = [M:SOI1]BPCORD
 PARMSK(4) = num$([M:SOR1]CHGTYP)
 PARMSK(5) = [M:SOI1]STRDAT(nolign-1)
 PARMSK(6) = [M:SOI1]XCUR
 PARMSK(7) = num$(nolign-1)
 PARMSK(8) = [M:SOI1]STOFCY
 PARMSK(9) = num$([M:SOR1]PRITYP)
 PARMSK(10) = "DISCRGVAL3"
 Call S_AFF_NUM(VALEUR,PARMSK,"DIVPRIPFMO","TRTVENPRI","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DISCRGVAL3" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action INIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "INIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "DISCRGVAL3"
 Call S_AFF_NUM(VALEUR,PARMSK,"INIREN","TRTPRICE","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_DISCRGVAL3(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREN"
 PARMSK(1) = "SOI1"
 PARMSK(2) = "5"
 PARMSK(3) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"ISALREN","TRTPRICE","XWISALREN") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W2SOI1
Return

$AV_NETPRI
## Action PARDEV
Gosub _AFF
Return

$ON_PFM
Onevent BEFORE_AREA Gosub AV_PFM From W2SOI1
Return

$AV_PFM
## Action PARDEV
Gosub _AFF
Return

$ON_REP1
Onevent CONTROL Call C_REP1(zc) From W2SOI1
Onevent AFTER_CHANGE Gosub AMM_REP1 From W2SOI1
Onevent BEFORE_INPUT Call AS_REP1(zc) From W2SOI1
Return

Subprog AS_REP1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5385,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_REP1(zc) From W2SOI1
Onkey   2 Titled GBOUTS Call S_REP1(zc) From W2SOI1
Onkey 144 Titled GBOUTP Call P_REP1(zc) From W2SOI1
Onkey 146 Titled GBOUTA Call SA_REP1(zc) From W2SOI1
Gosub _AFF
End

Subprog C_REP1(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("REP","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "REP1" : GZNUM = 6865 : Endif
If !mkstat
 ## Action CTLBPRCPY
 Call CTLBPRCPY(VALEUR,[M:SOI1]SALFCY) From CONTX3
 If mkstat : GERR = 1 : GZONE = "REP1" : GZNUM = 6865 : Endif
Endif
Gosub _AFF
End

$AMM_REP1
Call AM_REP1(zc)
If !mkstat & GOBJET
 zoncou = "REP1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_REP1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_REP1(VALEUR) From SUBSOI
If mkstat : GERR = 1 : GZONE = "REP1" : GZNUM = 6865 : Endif
Gosub _AFF
End

Subprog S_REP1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "REP"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_REP1(VALEUR)
Variable Char    VALEUR()
Call OBJET("REP",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_REP1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "REP"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_REP1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("REP",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_REPRAT1
Onevent BEFORE_INPUT Call AS_REPRAT1(zc) From W2SOI1
Onevent CONTROL Call C_REPRAT1(zc) From W2SOI1
Return

Subprog AS_REPRAT1(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_REPRAT1(VALEUR) From SUBSOI
If mkstat=2
 [M]REPRAT1(INDIC) = VALEUR
 Affzo REPRAT1(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_REPRAT1(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$TIT_COL
Gosub TIT_COL From W3SOI1
Return


