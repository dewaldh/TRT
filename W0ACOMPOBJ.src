#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management ACOMPOBJ 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone DOSORG
mkstat = 0
zoncou = "DOSORG"
indice = 0
If varinit([M]DOSORG,indice)=0
 [M]DOSORG = nomap
 SAVACT = GACTION : GACTION = "STD"
 Call D_DOSORG([M]DOSORG) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]DOSORG,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_DOSORG([M]DOSORG) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat=1 : Raz [M]DOSORG : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "DOSORG" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If vireblc([M]DOSORG,2)=""
    mkstat = 1 : GMESSAGE = mess(10,123,1)
   Endif
   If mkstat : GERR = 1 : GZONE = "DOSORG" : GZNUM = 1402 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTDOS"
    Call C_DOSSIER([M]DOSORG) From DOSCONT
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "DOSORG" : GZNUM = 1402 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "ACCESDOS"
     Call CTL_DROIT_DOSSIER([M]DOSORG,"") From DOSCONT
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "DOSORG" : GZNUM = 1402 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone DOSDES
mkstat = 0
zoncou = "DOSDES"
indice = 0
If varmode([M]DOSDES,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_DOSDES([M]DOSDES) From ACOMPOBJ
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DOSDES : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "DOSDES" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If vireblc([M]DOSDES,2)=""
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "DOSDES" : GZNUM = 1403 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTDOS"
   Call C_DOSSIER([M]DOSDES) From DOSCONT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "DOSDES" : GZNUM = 1403 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACCESDOS"
    Call CTL_DROIT_DOSSIER([M]DOSDES,"") From DOSCONT
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "DOSDES" : GZNUM = 1403 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_DOSDES([M]DOSDES) From ACOMPOBJ
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "DOSDES" : GZNUM = 1403 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

####################################
## Bloc liste 2
####################################
IMPTBL = 0

## Zone AMK
mkstat = 0
zoncou = "AMK"
indice = 0
IMPENT = [M]AMK
WNUM = IMPENT
If varinit([M]AMK,indice)=0
 IMPENT = 1
Endif
If varmode([M]AMK,indice)=0
 [M]AMK(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AMK" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AMK(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AMK(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AMK" : GZNUM = 1041 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AMK = IMPENT

## Zone AWI
mkstat = 0
zoncou = "AWI"
indice = 0
IMPENT = [M]AWI
WNUM = IMPENT
If varinit([M]AWI,indice)=0
 IMPENT = 1
Endif
If varmode([M]AWI,indice)=0
 [M]AWI(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AWI" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AWI(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AWI(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AWI" : GZNUM = 12423 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AWI = IMPENT

## Zone AOB
mkstat = 0
zoncou = "AOB"
indice = 0
IMPENT = [M]AOB
WNUM = IMPENT
If varinit([M]AOB,indice)=0
 IMPENT = 1
Endif
If varmode([M]AOB,indice)=0
 [M]AOB(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AOB" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AOB(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AOB(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AOB" : GZNUM = 1053 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AOB = IMPENT

## Zone AOC
mkstat = 0
zoncou = "AOC"
indice = 0
IMPENT = [M]AOC
WNUM = IMPENT
If varinit([M]AOC,indice)=0
 IMPENT = 1
Endif
If varmode([M]AOC,indice)=0
 [M]AOC(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AOC" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AOC(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AOC(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AOC" : GZNUM = 12288 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AOC = IMPENT

## Zone AFC
mkstat = 0
zoncou = "AFC"
indice = 0
IMPENT = [M]AFC
WNUM = IMPENT
If varinit([M]AFC,indice)=0
 IMPENT = 1
Endif
If varmode([M]AFC,indice)=0
 [M]AFC(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AFC" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AFC(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AFC(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AFC" : GZNUM = 1043 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AFC = IMPENT

## Zone ACT
mkstat = 0
zoncou = "ACT"
indice = 0
IMPENT = [M]ACT
WNUM = IMPENT
If varinit([M]ACT,indice)=0
 IMPENT = 1
Endif
If varmode([M]ACT,indice)=0
 [M]ACT(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACT" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ACT(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ACT(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACT" : GZNUM = 1042 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ACT = IMPENT

## Zone ATY
mkstat = 0
zoncou = "ATY"
indice = 0
IMPENT = [M]ATY
WNUM = IMPENT
If varinit([M]ATY,indice)=0
 IMPENT = 1
Endif
If varmode([M]ATY,indice)=0
 [M]ATY(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ATY" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ATY(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ATY(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ATY" : GZNUM = 174 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ATY = IMPENT

## Zone ATB
mkstat = 0
zoncou = "ATB"
indice = 0
IMPENT = [M]ATB
WNUM = IMPENT
If varinit([M]ATB,indice)=0
 IMPENT = 1
Endif
If varmode([M]ATB,indice)=0
 [M]ATB(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ATB" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ATB(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ATB(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ATB" : GZNUM = 49 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ATB = IMPENT

## Zone ARP
mkstat = 0
zoncou = "ARP"
indice = 0
IMPENT = [M]ARP
WNUM = IMPENT
If varinit([M]ARP,indice)=0
 IMPENT = 1
Endif
If varmode([M]ARP,indice)=0
 [M]ARP(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ARP" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ARP(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ARP(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ARP" : GZNUM = 754 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ARP = IMPENT

## Zone ADI
mkstat = 0
zoncou = "ADI"
indice = 0
IMPENT = [M]ADI
WNUM = IMPENT
If varinit([M]ADI,indice)=0
 IMPENT = 1
Endif
If varmode([M]ADI,indice)=0
 [M]ADI(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ADI" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ADI(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ADI(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ADI" : GZNUM = 11495 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ADI = IMPENT

## Zone AST
mkstat = 0
zoncou = "AST"
indice = 0
IMPENT = [M]AST
WNUM = IMPENT
If varinit([M]AST,indice)=0
 IMPENT = 1
Endif
If varmode([M]AST,indice)=0
 [M]AST(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AST" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AST(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AST(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AST" : GZNUM = 1068 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AST = IMPENT

## Zone ACN
mkstat = 0
zoncou = "ACN"
indice = 0
IMPENT = [M]ACN
WNUM = IMPENT
If varinit([M]ACN,indice)=0
 IMPENT = 1
Endif
If varmode([M]ACN,indice)=0
 [M]ACN(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACN" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ACN(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ACN(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACN" : GZNUM = 6084 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ACN = IMPENT

## Zone ADC
mkstat = 0
zoncou = "ADC"
indice = 0
IMPENT = [M]ADC
WNUM = IMPENT
If varinit([M]ADC,indice)=0
 IMPENT = 1
Endif
If varmode([M]ADC,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_ADC(IMPENT) From ACOMPOBJ
 GACTION = SAVACT
 If mkstat=1 : Raz IMPENT : Endif
 [M]ADC(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ADC" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ADC(indice)
 Endif
 If !mkstat
  If WNUM<>IMPENT or IMPMOD
   SAVACT = GACTION : GACTION = "STD"
   Call AM_ADC(IMPENT) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ADC" : GZNUM = 30641 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif
[M]ADC = IMPENT

## Zone AOE
mkstat = 0
zoncou = "AOE"
indice = 0
IMPENT = [M]AOE
WNUM = IMPENT
If varinit([M]AOE,indice)=0
 IMPENT = 1
Endif
If varmode([M]AOE,indice)=0
 [M]AOE(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AOE" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AOE(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AOE(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AOE" : GZNUM = 7146 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AOE = IMPENT

## Zone AEV
mkstat = 0
zoncou = "AEV"
indice = 0
IMPENT = [M]AEV
WNUM = IMPENT
If varinit([M]AEV,indice)=0
 IMPENT = 1
Endif
If varmode([M]AEV,indice)=0
 [M]AEV(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AEV" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AEV(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_AEV(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AEV" : GZNUM = 33328 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]AEV = IMPENT

## Zone ACLA
mkstat = 0
zoncou = "ACLA"
indice = 0
IMPENT = [M]ACLA
WNUM = IMPENT
If varinit([M]ACLA,indice)=0
 IMPENT = 1
Endif
If varmode([M]ACLA,indice)=0
 [M]ACLA(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACLA" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ACLA(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ACLA(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACLA" : GZNUM = 48727 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ACLA = IMPENT

## Zone ASW
mkstat = 0
zoncou = "ASW"
indice = 0
IMPENT = [M]ASW
WNUM = IMPENT
If varinit([M]ASW,indice)=0
 IMPENT = 1
Endif
If varmode([M]ASW,indice)=0
 [M]ASW(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ASW" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ASW(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ASW(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ASW" : GZNUM = 48740 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ASW = IMPENT

## Zone ACV
mkstat = 0
zoncou = "ACV"
indice = 0
IMPENT = [M]ACV
WNUM = IMPENT
If varinit([M]ACV,indice)=0
 IMPENT = 1
Endif
If varmode([M]ACV,indice)=0
 [M]ACV(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACV" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ACV(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_ACV(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACV" : GZNUM = 186 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]ACV = IMPENT

####################################
## Bloc liste 3
####################################
IMPTBL = 0

## Zone AMKDEB
mkstat = 0
zoncou = "AMKDEB"
indice = 0
If varmode([M]AMKDEB,indice)=0
 If !([M]AMK=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AMKDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AMKDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AMKDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AMKDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AMKDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AMKFIN
mkstat = 0
zoncou = "AMKFIN"
indice = 0
If varinit([M]AMKFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AMKFIN([M]AMKFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AMKFIN,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "AMKFIN" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "STD"
  Call C_AMKFIN([M]AMKFIN) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AMKFIN" : GZNUM = 978 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]AMKFIN
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]AMKFIN = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AMKFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone AWIDEB
mkstat = 0
zoncou = "AWIDEB"
indice = 0
If varmode([M]AWIDEB,indice)=0
 If !([M]AWI=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AWIDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AWIDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AWIDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AWIDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AWIDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AWIFIN
mkstat = 0
zoncou = "AWIFIN"
indice = 0
If varinit([M]AWIFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AWIFIN([M]AWIFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AWIFIN,indice)=0
  If !([M]AWI=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AWIFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AWIFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_AWIFIN([M]AWIFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AWIFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]AWIFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]AWIFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AWIFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone AOBDEB
mkstat = 0
zoncou = "AOBDEB"
indice = 0
If varmode([M]AOBDEB,indice)=0
 If !([M]AOB=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AOBDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AOBDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AOBDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AOBDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AOBDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AOBFIN
mkstat = 0
zoncou = "AOBFIN"
indice = 0
If varinit([M]AOBFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AOBFIN([M]AOBFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AOBFIN,indice)=0
  If !([M]AOB=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AOBFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AOBFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_AOBFIN([M]AOBFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AOBFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]AOBFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]AOBFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AOBFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone AOCDEB
mkstat = 0
zoncou = "AOCDEB"
indice = 0
If varmode([M]AOCDEB,indice)=0
 If !([M]AOC=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AOCDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AOCDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AOCDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AOCDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AOCDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AOCFIN
mkstat = 0
zoncou = "AOCFIN"
indice = 0
If varinit([M]AOCFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AOCFIN([M]AOCFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AOCFIN,indice)=0
  If !([M]AOC=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AOCFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AOCFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_AOCFIN([M]AOCFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AOCFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]AOCFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]AOCFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AOCFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone AFCDEB
mkstat = 0
zoncou = "AFCDEB"
indice = 0
If varmode([M]AFCDEB,indice)=0
 If !([M]AFC=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AFCDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AFCDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AFCDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AFCDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AFCDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AFCFIN
mkstat = 0
zoncou = "AFCFIN"
indice = 0
If varinit([M]AFCFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AFCFIN([M]AFCFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AFCFIN,indice)=0
  If !([M]AFC=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AFCFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AFCFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_AFCFIN([M]AFCFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AFCFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]AFCFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]AFCFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AFCFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ACTDEB
mkstat = 0
zoncou = "ACTDEB"
indice = 0
If varmode([M]ACTDEB,indice)=0
 If !([M]ACT=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ACTDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACTDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ACTDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ACTDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACTDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ACTFIN
mkstat = 0
zoncou = "ACTFIN"
indice = 0
If varinit([M]ACTFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ACTFIN([M]ACTFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ACTFIN,indice)=0
  If !([M]ACT=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ACTFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACTFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ACTFIN([M]ACTFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ACTFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ACTFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ACTFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACTFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ATYDEB
mkstat = 0
zoncou = "ATYDEB"
indice = 0
If varmode([M]ATYDEB,indice)=0
 If !([M]ATY=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ATYDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ATYDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ATYDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ATYDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ATYDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ATYFIN
mkstat = 0
zoncou = "ATYFIN"
indice = 0
If varinit([M]ATYFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ATYFIN([M]ATYFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ATYFIN,indice)=0
  If !([M]ATY=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ATYFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ATYFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ATYFIN([M]ATYFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ATYFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ATYFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ATYFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ATYFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ATBDEB
mkstat = 0
zoncou = "ATBDEB"
indice = 0
If varmode([M]ATBDEB,indice)=0
 If !([M]ATB=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ATBDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ATBDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ATBDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ATBDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ATBDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ATBFIN
mkstat = 0
zoncou = "ATBFIN"
indice = 0
If varinit([M]ATBFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ATBFIN([M]ATBFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ATBFIN,indice)=0
  If !([M]ATB=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ATBFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ATBFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ATBFIN([M]ATBFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ATBFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ATBFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ATBFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ATBFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ARPDEB
mkstat = 0
zoncou = "ARPDEB"
indice = 0
If varmode([M]ARPDEB,indice)=0
 If !([M]ARP=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ARPDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ARPDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ARPDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ARPDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ARPDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ARPFIN
mkstat = 0
zoncou = "ARPFIN"
indice = 0
If varinit([M]ARPFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ARPFIN([M]ARPFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ARPFIN,indice)=0
  If !([M]ARP=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ARPFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ARPFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ARPFIN([M]ARPFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ARPFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ARPFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ARPFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ARPFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ADIDEB
mkstat = 0
zoncou = "ADIDEB"
indice = 0
If varmode([M]ADIDEB,indice)=0
 If !([M]ADI=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ADIDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ADIDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If [M]ADIDEB<0
   mkstat = 1 : GMESSAGE = mess(180,141,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "ADIDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Decimal VALEUR
   VALEUR = [M]ADIDEB
   Call S_AFF_NUM(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]ADIDEB = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ADIDEB" : GZNUM = 1400 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone ADIFIN
mkstat = 0
zoncou = "ADIFIN"
indice = 0
If varinit([M]ADIFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ADIFIN([M]ADIFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ADIFIN,indice)=0
  If !([M]ADI=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ADIFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ADIFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If [M]ADIFIN<0
    mkstat = 1 : GMESSAGE = mess(180,141,1)
   Endif
   If mkstat : GERR = 1 : GZONE = "ADIFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ADIFIN([M]ADIFIN) From ACOMPOBJ
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ADIFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "CONTOBJN"
     Local Decimal VALEUR
     VALEUR = [M]ADIFIN
     Call S_AFF_NUM(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
     [M]ADIFIN = VALEUR
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "ADIFIN" : GZNUM = 978 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ASTDEB
mkstat = 0
zoncou = "ASTDEB"
indice = 0
If varmode([M]ASTDEB,indice)=0
 If !([M]AST=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ASTDEB : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "BOUTMNL"
  Call BOUTMNL([M]ASTDEB) From APLSTD
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ASTDEB : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ASTDEB" : Gosub ACTION From =IMPTRT
  Endif
 Endif
Endif

## Zone ASTFIN
mkstat = 0
zoncou = "ASTFIN"
indice = 0
If varinit([M]ASTFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ASTFIN([M]ASTFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ASTFIN,indice)=0
  If !([M]AST=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ASTFIN : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "BOUTMNL"
   Call BOUTMNL([M]ASTFIN) From APLSTD
   GACTION = SAVACT
   If mkstat=1 : Raz [M]ASTFIN : Endif
   If !mkstat
    IMPMOD = 0 : IMPZON = "ASTFIN" : Gosub ACTION From =IMPTRT
   Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ASTFIN([M]ASTFIN) From ACOMPOBJ
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ASTFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ACNDEB
mkstat = 0
zoncou = "ACNDEB"
indice = 0
If varmode([M]ACNDEB,indice)=0
 If !([M]ACN=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ACNDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACNDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ACNDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ACNDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACNDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ACNFIN
mkstat = 0
zoncou = "ACNFIN"
indice = 0
If varinit([M]ACNFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ACNFIN([M]ACNFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ACNFIN,indice)=0
  If !([M]ACN=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ACNFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACNFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ACNFIN([M]ACNFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ACNFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ACNFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ACNFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACNFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ADCDEB
mkstat = 0
zoncou = "ADCDEB"
indice = 0
If varmode([M]ADCDEB,indice)=0
 If !([M]ADC=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ADCDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ADCDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ADCDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ADCDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ADCDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ADCFIN
mkstat = 0
zoncou = "ADCFIN"
indice = 0
If varinit([M]ADCFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ADCFIN([M]ADCFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ADCFIN,indice)=0
  If !([M]ADC=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ADCFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ADCFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ADCFIN([M]ADCFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ADCFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ADCFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ADCFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ADCFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone AOEDEB
mkstat = 0
zoncou = "AOEDEB"
indice = 0
If varinit([M]AOEDEB,indice)=0
 SAVACT = GACTION : GACTION = "ACVLIBBUT"
 Call ACVLIBBUT([M]AOEDEB,"","") From SUBACV
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AOEDEB,indice)=0
  If !([M]AOE=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AOEDEB : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AOEDEB" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]AOEDEB
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]AOEDEB = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AOEDEB" : GZNUM = 1400 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone AOEFIN
mkstat = 0
zoncou = "AOEFIN"
indice = 0
If varinit([M]AOEFIN,indice)=0
 SAVACT = GACTION : GACTION = "ACVLIBBUT"
 Call ACVLIBBUT([M]AOEFIN,"","") From SUBACV
 GACTION = SAVACT
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call D_AOEFIN([M]AOEFIN) From ACOMPOBJ
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]AOEFIN,indice)=0
  If !([M]AOE=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AOEFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AOEFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]AOEFIN
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]AOEFIN = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AOEFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_AOEFIN([M]AOEFIN) From ACOMPOBJ
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AOEFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone AEVDEB
mkstat = 0
zoncou = "AEVDEB"
indice = 0
If varmode([M]AEVDEB,indice)=0
 If !([M]AEV=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]AEVDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "AEVDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]AEVDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]AEVDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "AEVDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone AEVFIN
mkstat = 0
zoncou = "AEVFIN"
indice = 0
If varinit([M]AEVFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_AEVFIN([M]AEVFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]AEVFIN,indice)=0
  If !([M]AEV=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]AEVFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AEVFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_AEVFIN([M]AEVFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "AEVFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]AEVFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]AEVFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AEVFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ACLADEB
mkstat = 0
zoncou = "ACLADEB"
indice = 0
If varmode([M]ACLADEB,indice)=0
 If !([M]ACLA=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ACLADEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACLADEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ACLADEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ACLADEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACLADEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ACLAFIN
mkstat = 0
zoncou = "ACLAFIN"
indice = 0
If varinit([M]ACLAFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ACLAFIN([M]ACLAFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ACLAFIN,indice)=0
  If !([M]ACLA=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ACLAFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACLAFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ACLAFIN([M]ACLAFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ACLAFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ACLAFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ACLAFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACLAFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ASWDEB
mkstat = 0
zoncou = "ASWDEB"
indice = 0
If varmode([M]ASWDEB,indice)=0
 If !([M]ASW=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ASWDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ASWDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ASWDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ASWDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ASWDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ASWFIN
mkstat = 0
zoncou = "ASWFIN"
indice = 0
If varinit([M]ASWFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ASWFIN([M]ASWFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ASWFIN,indice)=0
  If !([M]ASW=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ASWFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ASWFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ASWFIN([M]ASWFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ASWFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ASWFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ASWFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ASWFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ACVDEB
mkstat = 0
zoncou = "ACVDEB"
indice = 0
If varmode([M]ACVDEB,indice)=0
 If !([M]ACV=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]ACVDEB : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "ACVDEB" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Local Char    VALEUR(250)
  VALEUR = [M]ACVDEB
  Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
  [M]ACVDEB = VALEUR
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACVDEB" : GZNUM = 1400 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone ACVFIN
mkstat = 0
zoncou = "ACVFIN"
indice = 0
If varinit([M]ACVFIN,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_ACVFIN([M]ACVFIN) From ACOMPOBJ
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]ACVFIN,indice)=0
  If !([M]ACV=2)
   mkstat = 2
  Endif
  If mkstat=1 : Raz [M]ACVFIN : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACVFIN" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_ACVFIN([M]ACVFIN) From ACOMPOBJ
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ACVFIN" : GZNUM = 978 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]ACVFIN
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]ACVFIN = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACVFIN" : GZNUM = 978 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

####################################
## Bloc liste 5
####################################
IMPTBL = 0

## Zone DETAIL
mkstat = 0
zoncou = "DETAIL"
indice = 0
IMPENT = [M]DETAIL
If varinit([M]DETAIL,indice)=0
 IMPENT = 2
Endif
If varmode([M]DETAIL,indice)=0
 [M]DETAIL(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "DETAIL" : Gosub ACTION From =IMPTRT
  IMPENT = [M]DETAIL(indice)
 Endif
Endif
[M]DETAIL = IMPENT

## Zone LANGUE
mkstat = 0
zoncou = "LANGUE"
indice = 0
If varinit([M]LANGUE,indice)=0
 [M]LANGUE = GLANGUE
Endif
If varmode([M]LANGUE,indice)=0
 If !([M]AST=2)
  mkstat = 2
 Endif
 If mkstat=1 : Raz [M]LANGUE : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "LANGUE" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  Call CONTROLE("TLA","!",[M]LANGUE,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "LANGUE" : GZNUM = 3587 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone TECHNI
mkstat = 0
zoncou = "TECHNI"
indice = 0
IMPENT = [M]TECHNI
If varinit([M]TECHNI,indice)=0
 IMPENT = 1
Endif
If varmode([M]TECHNI,indice)=0
 [M]TECHNI(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "TECHNI" : Gosub ACTION From =IMPTRT
  IMPENT = [M]TECHNI(indice)
 Endif
Endif
[M]TECHNI = IMPENT

## Zone FICHIER
mkstat = 0
zoncou = "FICHIER"
indice = 0
IMPENT = [M]FICHIER
WNUM = IMPENT
If varinit([M]FICHIER,indice)=0
 IMPENT = 1
Endif
If varmode([M]FICHIER,indice)=0
 [M]FICHIER(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "FICHIER" : Gosub ACTION From =IMPTRT
  IMPENT = [M]FICHIER(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_FICHIER(IMPENT) From ACOMPOBJ
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "FICHIER" : GZNUM = 799 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]FICHIER = IMPENT

## Zone FORMAT
mkstat = 0
zoncou = "FORMAT"
indice = 0
IMPENT = [M]FORMAT
If varinit([M]FORMAT,indice)=0
 IMPENT = 1
Endif
If varmode([M]FORMAT,indice)=0
 [M]FORMAT(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "FORMAT" : Gosub ACTION From =IMPTRT
  IMPENT = [M]FORMAT(indice)
 Endif
Endif
[M]FORMAT = IMPENT

####################################
## Bloc tableau 4
####################################
IMPTBL = 1

## Zone NBMOD
mkstat = 0
zoncou = "NBMOD"
indice = 0
status = 1
zoncou = "NBMOD"
If varmode([M]NBMOD,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_NBMOD From ACOMPOBJ
 GACTION = SAVACT
 If mkstat=1 : Raz [M]NBMOD : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBMOD" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBMOD
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBMOD = nolign
   status = 75
   Call SAI_NBMOD(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
 Endif
Endif

####################################
## Bloc liste 6
####################################
IMPTBL = 0

## Zone CODACT
mkstat = 0
zoncou = "CODACT"
indice = 0
If varmode([M]CODACT,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "CODACT" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("ACV","!",[M]CODACT,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CODACT" : GZNUM = 4 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

mkstat = 0

End

####################################
## Bloc tableau 4
####################################
Subprog SAI_NBMOD(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBMOD
mkstat = 0
zoncou = "NBMOD"

## Zone MODULE
mkstat = 0
zoncou = "MODULE"
IMPENT = [M]MODULE(indice)
IMPENT = nolign
[M]MODULE(indice) = IMPENT
If varinit([M]MODULE,indice)=0
 IMPENT = 1
Endif
[M]MODULE(indice) = IMPENT

## Zone COPMOD
mkstat = 0
zoncou = "COPMOD"
IMPENT = [M]COPMOD(indice)
If varinit([M]COPMOD,indice)=0
 IMPENT = 2
Endif
If varmode([M]COPMOD,indice)=0
 [M]COPMOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "COPMOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]COPMOD(indice)
 Endif
Endif
[M]COPMOD(indice) = IMPENT

## Zone NBMOD
mkstat = 0
zoncou = "NBMOD"

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "ACOMPOBJ"
Return

