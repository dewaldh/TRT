#<AdxTL>@(#)0.0.0.0 $Revision$Class Purchase price inquiry
# Supervisor
## ACLA-CLASSE ## PPRICSEARCHM
# 2018-08-27 13:25:24 469

 
####################################################################
# Labels of the main class and methods 
####################################################################
 
####################################################################
# 1 : BPSNUM_REP BP ( Field BPS 15)
####################################################################
 
$SET_BPSNUM_REP
If [L]_AOLDVAL<>this.BPSNUM_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSNUM_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSNUM_REP
 Gosub PROPAGATE_BPSNUM_REP
Endif
Return

$INIT_BPSNUM_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSNUM_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSNUM_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSNUM_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSNUM_REP
[L]CURPRO = "BPSNUM_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSNUM_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSNUM_REP
[L]CURPRO = "BPSNUM_REP"
If vireblc(this.BPSNUM_REP,2)<>vireblc(format$("K:15c",this.BPSNUM_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSNUM_REP
[L]CURPRO = "BPSNUM_REP"
If vireblc(this.BPSNUM_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPS.ACTRLREF(this,"BPSNUM_REP",this.BPSNUM_REP,this.BPSNUM_REP,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPSNUM_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSNUM_REP
[L]CURPRO = "BPSNUM_REP"
Return

$PROPAGATE_BPSNUM_REP
this.isReadonly = 0
[L]CURPRO = "BPSNUM_REP"
Gosub _LNKPRO_BPSNUM_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSNUM_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_REP"
$_LNKPRO_BPSNUM_REP
If vireblc(this.BPSNUM_REP,2)<>""
 # Link BPSUPPLIER
 Local File BPSUPPLIER [WBPS]
 Read [F:WBPS]BPS0 = this.BPSNUM_REP
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM_REP","$title",[F:WBPS]BPSSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM_REP","$description",[F:WBPS]BPSNAM)
 Endif
 LogicClose File [WBPS]
Endif
Return

$_ALOADATTRIBUTE_BPSNUM_REP
[L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM_REP","$isMandatory","true")
Return


####################################################################
# 2 : BPSNUM_GETDF Flag ( Field Local menu number 1)
####################################################################
 
$SET_BPSNUM_GETDF
If [L]_AOLDVAL<>this.BPSNUM_GETDF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSNUM_GETDF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSNUM_GETDF
 Gosub PROPAGATE_BPSNUM_GETDF
Endif
Return

$INIT_BPSNUM_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_GETDF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.BPSNUM_GETDF=0 and fmet this.AGETATTRIBUTE("BPSNUM_GETDF","$isMandatory")="true"
 this.BPSNUM_GETDF = 1
Endif
Return
 
$CONTROL_BPSNUM_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_GETDF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSNUM_GETDF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSNUM_GETDF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSNUM_GETDF
[L]CURPRO = "BPSNUM_GETDF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BPSNUM_GETDF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSNUM_GETDF
[L]CURPRO = "BPSNUM_GETDF"
If this.BPSNUM_GETDF<0 or this.BPSNUM_GETDF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.BPSNUM_GETDF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_BPSNUM_GETDF
[L]CURPRO = "BPSNUM_GETDF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSNUM_GETDF
[L]CURPRO = "BPSNUM_GETDF"
Return

$PROPAGATE_BPSNUM_GETDF
this.isReadonly = 0
[L]CURPRO = "BPSNUM_GETDF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSNUM_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "BPSNUM_GETDF"
$_LNKPRO_BPSNUM_GETDF
Return


####################################################################
# 3 : ITMREF_REP Product ( Field ITM 20)
####################################################################
 
$SET_ITMREF_REP
If [L]_AOLDVAL<>this.ITMREF_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ITMREF_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ITMREF_REP
 Gosub PROPAGATE_ITMREF_REP
Endif
Return

$INIT_ITMREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ITMREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ITMREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ITMREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ITMREF_REP
[L]CURPRO = "ITMREF_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ITMREF_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ITMREF_REP
[L]CURPRO = "ITMREF_REP"
If vireblc(this.ITMREF_REP,2)<>vireblc(format$("K:20c",this.ITMREF_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_ITMREF_REP
[L]CURPRO = "ITMREF_REP"
If vireblc(this.ITMREF_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPITM.ACTRLREF(this,"ITMREF_REP",this.ITMREF_REP,this.ITMREF_REP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ITMREF_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ITMREF_REP
[L]CURPRO = "ITMREF_REP"
Return

$PROPAGATE_ITMREF_REP
this.isReadonly = 0
[L]CURPRO = "ITMREF_REP"
Gosub _LNKPRO_ITMREF_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ITMREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_REP"
$_LNKPRO_ITMREF_REP
If vireblc(this.ITMREF_REP,2)<>""
 # Link ITMMASTER
 Local File ITMMASTER [WITM]
 Read [F:WITM]ITM0 = this.ITMREF_REP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ITMMASTER" & ZONE="DES1AXX" & IDENT1=[F:WITM]ITMREF & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("ITMREF_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WITM]
Endif
Return

$_ALOADATTRIBUTE_ITMREF_REP
[L]ASTATUS = fmet this.ASETATTRIBUTE("ITMREF_REP","$isMandatory","true")
Return


####################################################################
# 4 : ITMREF_GETDF Flag ( Field Local menu number 1)
####################################################################
 
$SET_ITMREF_GETDF
If [L]_AOLDVAL<>this.ITMREF_GETDF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ITMREF_GETDF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ITMREF_GETDF
 Gosub PROPAGATE_ITMREF_GETDF
Endif
Return

$INIT_ITMREF_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_GETDF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.ITMREF_GETDF=0 and fmet this.AGETATTRIBUTE("ITMREF_GETDF","$isMandatory")="true"
 this.ITMREF_GETDF = 1
Endif
Return
 
$CONTROL_ITMREF_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_GETDF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ITMREF_GETDF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ITMREF_GETDF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ITMREF_GETDF
[L]CURPRO = "ITMREF_GETDF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ITMREF_GETDF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ITMREF_GETDF
[L]CURPRO = "ITMREF_GETDF"
If this.ITMREF_GETDF<0 or this.ITMREF_GETDF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.ITMREF_GETDF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_ITMREF_GETDF
[L]CURPRO = "ITMREF_GETDF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ITMREF_GETDF
[L]CURPRO = "ITMREF_GETDF"
Return

$PROPAGATE_ITMREF_GETDF
this.isReadonly = 0
[L]CURPRO = "ITMREF_GETDF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ITMREF_GETDF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "ITMREF_GETDF"
$_LNKPRO_ITMREF_GETDF
Return


####################################################################
# 5 : CURREF_REP Currency ( Field CUR 3)
####################################################################
 
$SET_CURREF_REP
If [L]_AOLDVAL<>this.CURREF_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CURREF_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CURREF_REP
 Gosub PROPAGATE_CURREF_REP
Endif
Return

$INIT_CURREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CURREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CURREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CURREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CURREF_REP
[L]CURPRO = "CURREF_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CURREF_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CURREF_REP
[L]CURPRO = "CURREF_REP"
If vireblc(this.CURREF_REP,2)<>vireblc(format$("K:3c",this.CURREF_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CURREF_REP
[L]CURPRO = "CURREF_REP"
If vireblc(this.CURREF_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CURREF_REP",this.CURREF_REP,this.CURREF_REP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CURREF_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CURREF_REP
[L]CURPRO = "CURREF_REP"
Return

$PROPAGATE_CURREF_REP
this.isReadonly = 0
[L]CURPRO = "CURREF_REP"
Gosub _LNKPRO_CURREF_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CURREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_REP"
$_LNKPRO_CURREF_REP
If vireblc(this.CURREF_REP,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CURREF_REP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CURREF_REP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CURREF_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CURREF_REP","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CURREF_REP","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CURREF_REP","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return


####################################################################
# 6 : CURREF_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_CURREF_ISDEF
If [L]_AOLDVAL<>this.CURREF_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CURREF_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CURREF_ISDEF
 Gosub PROPAGATE_CURREF_ISDEF
Endif
Return

$INIT_CURREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CURREF_ISDEF=0 and fmet this.AGETATTRIBUTE("CURREF_ISDEF","$isMandatory")="true"
 this.CURREF_ISDEF = 1
Endif
Return
 
$CONTROL_CURREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CURREF_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CURREF_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CURREF_ISDEF
[L]CURPRO = "CURREF_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CURREF_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CURREF_ISDEF
[L]CURPRO = "CURREF_ISDEF"
If this.CURREF_ISDEF<0 or this.CURREF_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.CURREF_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_CURREF_ISDEF
[L]CURPRO = "CURREF_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CURREF_ISDEF
[L]CURPRO = "CURREF_ISDEF"
Return

$PROPAGATE_CURREF_ISDEF
this.isReadonly = 0
[L]CURPRO = "CURREF_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CURREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "CURREF_ISDEF"
$_LNKPRO_CURREF_ISDEF
Return


####################################################################
# 7 : PRITYP_REP Price - / +tax ( Field Local menu number 243)
####################################################################
 
$SET_PRITYP_REP
If [L]_AOLDVAL<>this.PRITYP_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRITYP_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRITYP_REP
 Gosub PROPAGATE_PRITYP_REP
Endif
Return

$INIT_PRITYP_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PRITYP_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PRITYP_REP=0 and fmet this.AGETATTRIBUTE("PRITYP_REP","$isMandatory")="true"
 this.PRITYP_REP = 1
Endif
Return
 
$CONTROL_PRITYP_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PRITYP_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRITYP_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRITYP_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRITYP_REP
[L]CURPRO = "PRITYP_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PRITYP_REP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRITYP_REP
[L]CURPRO = "PRITYP_REP"
If this.PRITYP_REP<0 or this.PRITYP_REP>len(mess(0,243,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"243 ->"-num$(this.PRITYP_REP)-mess(99,123,1)):  Return : # Local menu "243 -> Invalid option
Endif
Return

$_AOTHERS_PRITYP_REP
[L]CURPRO = "PRITYP_REP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRITYP_REP
[L]CURPRO = "PRITYP_REP"
Return

$PROPAGATE_PRITYP_REP
this.isReadonly = 0
[L]CURPRO = "PRITYP_REP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRITYP_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PRITYP_REP"
$_LNKPRO_PRITYP_REP
Return


####################################################################
# 8 : PUUREF_REP Unit ( Field UOM 3)
####################################################################
 
$SET_PUUREF_REP
If [L]_AOLDVAL<>this.PUUREF_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PUUREF_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PUUREF_REP
 Gosub PROPAGATE_PUUREF_REP
Endif
Return

$INIT_PUUREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PUUREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PUUREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PUUREF_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PUUREF_REP
[L]CURPRO = "PUUREF_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PUUREF_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PUUREF_REP
[L]CURPRO = "PUUREF_REP"
If vireblc(this.PUUREF_REP,2)<>vireblc(format$("K:3X",this.PUUREF_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PUUREF_REP
[L]CURPRO = "PUUREF_REP"
If vireblc(this.PUUREF_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPUOM.ACTRLREF(this,"PUUREF_REP",this.PUUREF_REP,this.PUUREF_REP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.PUUREF_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PUUREF_REP
[L]CURPRO = "PUUREF_REP"
Return

$PROPAGATE_PUUREF_REP
this.isReadonly = 0
[L]CURPRO = "PUUREF_REP"
Gosub _LNKPRO_PUUREF_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PUUREF_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_REP"
$_LNKPRO_PUUREF_REP
If vireblc(this.PUUREF_REP,2)<>""
 # Link TABUNIT
 Local File TABUNIT [WTUN]
 Read [F:WTUN]TUN0 = this.PUUREF_REP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABUNIT" & ZONE="DESSHO" & IDENT1=[F:WTUN]UOM & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PUUREF_REP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABUNIT" & ZONE="DES" & IDENT1=[F:WTUN]UOM & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PUUREF_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("PUUREF_REP","$symbol",[F:WTUN]UOMSYM)
  If int([WTUN]UOMDEC)>0
   Local Char WSCALE(10)
   WSCALE=num$([F:WTUN]UOMDEC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("PUUREF_REP","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTUN]
Endif
Return


####################################################################
# 9 : PUUREF_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_PUUREF_ISDEF
If [L]_AOLDVAL<>this.PUUREF_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PUUREF_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PUUREF_ISDEF
 Gosub PROPAGATE_PUUREF_ISDEF
Endif
Return

$INIT_PUUREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PUUREF_ISDEF=0 and fmet this.AGETATTRIBUTE("PUUREF_ISDEF","$isMandatory")="true"
 this.PUUREF_ISDEF = 1
Endif
Return
 
$CONTROL_PUUREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PUUREF_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PUUREF_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PUUREF_ISDEF
[L]CURPRO = "PUUREF_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PUUREF_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PUUREF_ISDEF
[L]CURPRO = "PUUREF_ISDEF"
If this.PUUREF_ISDEF<0 or this.PUUREF_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.PUUREF_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_PUUREF_ISDEF
[L]CURPRO = "PUUREF_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PUUREF_ISDEF
[L]CURPRO = "PUUREF_ISDEF"
Return

$PROPAGATE_PUUREF_ISDEF
this.isReadonly = 0
[L]CURPRO = "PUUREF_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PUUREF_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PUUREF_ISDEF"
$_LNKPRO_PUUREF_ISDEF
Return


####################################################################
# 10 : VACBPR_REP Tax rule ( Field TVB 5)
####################################################################
 
$SET_VACBPR_REP
If [L]_AOLDVAL<>this.VACBPR_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VACBPR_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VACBPR_REP
 Gosub PROPAGATE_VACBPR_REP
Endif
Return

$INIT_VACBPR_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VACBPR_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VACBPR_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VACBPR_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VACBPR_REP
[L]CURPRO = "VACBPR_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VACBPR_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VACBPR_REP
[L]CURPRO = "VACBPR_REP"
If vireblc(this.VACBPR_REP,2)<>vireblc(format$("K:5c",this.VACBPR_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VACBPR_REP
[L]CURPRO = "VACBPR_REP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VACBPR_REP
[L]CURPRO = "VACBPR_REP"
If vireblc(this.VACBPR_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTVB.ACTRLREF(this,"VACBPR_REP",this.VACBPR_REP,this.VACBPR_REP,this.PPRISEA.VACBPR_LEG,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.VACBPR_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_VACBPR_REP
this.isReadonly = 0
[L]CURPRO = "VACBPR_REP"
Gosub _LNKPRO_VACBPR_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VACBPR_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_REP"
$_LNKPRO_VACBPR_REP
If vireblc(this.VACBPR_REP,2)<>""
 # Link TABVACBPR
 Local File TABVACBPR [WTVB]
 Read [F:WTVB]TVB0 = this.VACBPR_REP;this.PPRISEA.VACBPR_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="SHOAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACBPR_REP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="DESAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACBPR_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVB]
Endif
Return


####################################################################
# 11 : VACBPR_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_VACBPR_ISDEF
If [L]_AOLDVAL<>this.VACBPR_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VACBPR_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VACBPR_ISDEF
 Gosub PROPAGATE_VACBPR_ISDEF
Endif
Return

$INIT_VACBPR_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.VACBPR_ISDEF=0 and fmet this.AGETATTRIBUTE("VACBPR_ISDEF","$isMandatory")="true"
 this.VACBPR_ISDEF = 1
Endif
Return
 
$CONTROL_VACBPR_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VACBPR_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VACBPR_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VACBPR_ISDEF
[L]CURPRO = "VACBPR_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.VACBPR_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VACBPR_ISDEF
[L]CURPRO = "VACBPR_ISDEF"
If this.VACBPR_ISDEF<0 or this.VACBPR_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.VACBPR_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_VACBPR_ISDEF
[L]CURPRO = "VACBPR_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VACBPR_ISDEF
[L]CURPRO = "VACBPR_ISDEF"
Return

$PROPAGATE_VACBPR_ISDEF
this.isReadonly = 0
[L]CURPRO = "VACBPR_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VACBPR_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "VACBPR_ISDEF"
$_LNKPRO_VACBPR_ISDEF
Return


####################################################################
# 12 : PTE_REP Payment terms ( Field PTE 15)
####################################################################
 
$SET_PTE_REP
If [L]_AOLDVAL<>this.PTE_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PTE_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PTE_REP
 Gosub PROPAGATE_PTE_REP
Endif
Return

$INIT_PTE_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PTE_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PTE_REP               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PTE_REP               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PTE_REP
[L]CURPRO = "PTE_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PTE_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PTE_REP
[L]CURPRO = "PTE_REP"
If vireblc(this.PTE_REP,2)<>vireblc(format$("K:15c",this.PTE_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PTE_REP
[L]CURPRO = "PTE_REP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PTE_REP
[L]CURPRO = "PTE_REP"
If vireblc(this.PTE_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPPTE.ACTRLREF(this,"PTE_REP",this.PTE_REP,this.PTE_REP,this.PPRISEA.PTE_LEG,1,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.PTE_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_PTE_REP
this.isReadonly = 0
[L]CURPRO = "PTE_REP"
Gosub _LNKPRO_PTE_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PTE_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_REP"
$_LNKPRO_PTE_REP
If vireblc(this.PTE_REP,2)<>""
 # Link TABPAYTERM
 Local File TABPAYTERM [WTPT]
 Read [F:WTPT]TPT0 = this.PTE_REP;this.PPRISEA.PTE_LEG;1
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="SHOAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE_REP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="DESAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTPT]
Endif
Return


####################################################################
# 13 : PTE_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_PTE_ISDEF
If [L]_AOLDVAL<>this.PTE_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PTE_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PTE_ISDEF
 Gosub PROPAGATE_PTE_ISDEF
Endif
Return

$INIT_PTE_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PTE_ISDEF=0 and fmet this.AGETATTRIBUTE("PTE_ISDEF","$isMandatory")="true"
 this.PTE_ISDEF = 1
Endif
Return
 
$CONTROL_PTE_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PTE_ISDEF             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PTE_ISDEF             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PTE_ISDEF
[L]CURPRO = "PTE_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PTE_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PTE_ISDEF
[L]CURPRO = "PTE_ISDEF"
If this.PTE_ISDEF<0 or this.PTE_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.PTE_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_PTE_ISDEF
[L]CURPRO = "PTE_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PTE_ISDEF
[L]CURPRO = "PTE_ISDEF"
Return

$PROPAGATE_PTE_ISDEF
this.isReadonly = 0
[L]CURPRO = "PTE_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PTE_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PTE_ISDEF"
$_LNKPRO_PTE_ISDEF
Return


####################################################################
# 14 : EECICT_REP Incoterm ( Field ICT 5)
####################################################################
 
$SET_EECICT_REP
If [L]_AOLDVAL<>this.EECICT_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECICT_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECICT_REP
 Gosub PROPAGATE_EECICT_REP
Endif
Return

$INIT_EECICT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EECICT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECICT_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECICT_REP            : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECICT_REP
[L]CURPRO = "EECICT_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.EECICT_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECICT_REP
[L]CURPRO = "EECICT_REP"
If vireblc(this.EECICT_REP,2)<>vireblc(format$("K:5c",this.EECICT_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_EECICT_REP
[L]CURPRO = "EECICT_REP"
If vireblc(this.EECICT_REP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPICT.ACTRLREF(this,"EECICT_REP",this.EECICT_REP,this.EECICT_REP,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.EECICT_REP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECICT_REP
[L]CURPRO = "EECICT_REP"
Return

$PROPAGATE_EECICT_REP
this.isReadonly = 0
[L]CURPRO = "EECICT_REP"
Gosub _LNKPRO_EECICT_REP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECICT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_REP"
$_LNKPRO_EECICT_REP
If vireblc(this.EECICT_REP,2)<>""
 # Link INCOTERM
 Local File INCOTERM [WICTH]
 Read [F:WICTH]ICT0 = this.EECICT_REP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="INCOTERM" & ZONE="DES" & IDENT1=[F:WICTH]ICTCOD & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("EECICT_REP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WICTH]
Endif
Return


####################################################################
# 15 : EECICT_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_EECICT_ISDEF
If [L]_AOLDVAL<>this.EECICT_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECICT_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECICT_ISDEF
 Gosub PROPAGATE_EECICT_ISDEF
Endif
Return

$INIT_EECICT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.EECICT_ISDEF=0 and fmet this.AGETATTRIBUTE("EECICT_ISDEF","$isMandatory")="true"
 this.EECICT_ISDEF = 1
Endif
Return
 
$CONTROL_EECICT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECICT_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECICT_ISDEF          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECICT_ISDEF
[L]CURPRO = "EECICT_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EECICT_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECICT_ISDEF
[L]CURPRO = "EECICT_ISDEF"
If this.EECICT_ISDEF<0 or this.EECICT_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.EECICT_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_EECICT_ISDEF
[L]CURPRO = "EECICT_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECICT_ISDEF
[L]CURPRO = "EECICT_ISDEF"
Return

$PROPAGATE_EECICT_ISDEF
this.isReadonly = 0
[L]CURPRO = "EECICT_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECICT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "EECICT_ISDEF"
$_LNKPRO_EECICT_ISDEF
Return


####################################################################
# 16 : PJT_REP Project ( Field PJT 40)
####################################################################
 
$SET_PJT_REP
If [L]_AOLDVAL<>this.PJT_REP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PJT_REP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PJT_REP
 Gosub PROPAGATE_PJT_REP
Endif
Return

$INIT_PJT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_REP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PJT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_REP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PJT_REP               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PJT_REP               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PJT_REP
[L]CURPRO = "PJT_REP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PJT_REP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PJT_REP
[L]CURPRO = "PJT_REP"
If vireblc(this.PJT_REP,2)<>vireblc(format$("K:40X",this.PJT_REP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PJT_REP
[L]CURPRO = "PJT_REP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PJT_REP
[L]CURPRO = "PJT_REP"
Return

$PROPAGATE_PJT_REP
this.isReadonly = 0
[L]CURPRO = "PJT_REP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PJT_REP
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_REP"
$_LNKPRO_PJT_REP
Return


####################################################################
# 17 : PJT_ISDEF Flag ( Field Local menu number 1)
####################################################################
 
$SET_PJT_ISDEF
If [L]_AOLDVAL<>this.PJT_ISDEF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PJT_ISDEF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PJT_ISDEF
 Gosub PROPAGATE_PJT_ISDEF
Endif
Return

$INIT_PJT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_ISDEF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PJT_ISDEF=0 and fmet this.AGETATTRIBUTE("PJT_ISDEF","$isMandatory")="true"
 this.PJT_ISDEF = 1
Endif
Return
 
$CONTROL_PJT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_ISDEF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PJT_ISDEF             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PJT_ISDEF             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PJT_ISDEF
[L]CURPRO = "PJT_ISDEF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PJT_ISDEF=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PJT_ISDEF
[L]CURPRO = "PJT_ISDEF"
If this.PJT_ISDEF<0 or this.PJT_ISDEF>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.PJT_ISDEF)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_PJT_ISDEF
[L]CURPRO = "PJT_ISDEF"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PJT_ISDEF
[L]CURPRO = "PJT_ISDEF"
Return

$PROPAGATE_PJT_ISDEF
this.isReadonly = 0
[L]CURPRO = "PJT_ISDEF"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PJT_ISDEF
Gosub DECLARE_VAR From WMR0PPRICSEARCHM
[L]CURPRO = "PJT_ISDEF"
$_LNKPRO_PJT_ISDEF
Return




