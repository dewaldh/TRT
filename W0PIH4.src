#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management PIH4 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc tableau 1
####################################
IMPTBL = 1

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
indice = 0
status = 1
zoncou = "NBFAC"
If varmode([M]NBFAC,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBFAC" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBFAC
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBFAC = nolign
   status = 75
   Call SAI_NBFAC(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
  SAVACT = GACTION : GACTION = "STD"
  Call C_NBFAC From SUBPIH
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "NBFAC" : GZNUM = 0 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

####################################
## Bloc tableau 2
####################################
IMPTBL = 1

## Zone NBTAX
mkstat = 0
zoncou = "NBTAX"
indice = 0
status = 1
zoncou = "NBTAX"
If varmode([M]NBTAX,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBTAX" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBTAX
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBTAX = nolign
   status = 75
   Call SAI_NBTAX(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
 Endif
Endif

####################################
## Bloc liste 3
####################################
IMPTBL = 0

####################################
## Bloc liste 4
####################################
IMPTBL = 0

## Zone TOTTAXAMT
mkstat = 0
zoncou = "TOTTAXAMT"
indice = 0
WNUM = [M]TOTTAXAMT
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]TOTTAXAMT : Endif
If !mkstat
 If varmode([M]TOTTAXAMT,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_TOTTAXAMT([M]TOTTAXAMT) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]TOTTAXAMT : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "TOTTAXAMT" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If WNUM<>[M]TOTTAXAMT or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_TOTTAXAMT([M]TOTTAXAMT) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "TOTTAXAMT" : GZNUM = 8509 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone TOTTAXCLC
mkstat = 0
zoncou = "TOTTAXCLC"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]TOTTAXCLC : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_TOTTAXCLC([M]TOTTAXCLC) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]TOTTAXCLC : Endif
Endif

## Zone DIFTAXAMT
mkstat = 0
zoncou = "DIFTAXAMT"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DIFTAXAMT : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_DIFTAXAMT([M]DIFTAXAMT) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DIFTAXAMT : Endif
Endif

####################################
## Bloc liste 5
####################################
IMPTBL = 0

## Zone TOTLINAMT
mkstat = 0
zoncou = "TOTLINAMT"
indice = 0
WNUM = [M]TOTLINAMT
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]TOTLINAMT : Endif
If !mkstat
 If varmode([M]TOTLINAMT,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "TOTLINAMT" : Gosub ACTION From =IMPTRT
  Endif
  If WNUM<>[M]TOTLINAMT or IMPMOD
   SAVACT = GACTION : GACTION = "STD"
   Call AM_TOTLINAMT([M]TOTLINAMT) From SUBPIH
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "TOTLINAMT" : GZNUM = 8512 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone CLCLINAMT
mkstat = 0
zoncou = "CLCLINAMT"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]CLCLINAMT : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_CLCLINAMT([M]CLCLINAMT) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]CLCLINAMT : Endif
Endif

## Zone DIFLINAMT
mkstat = 0
zoncou = "DIFLINAMT"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DIFLINAMT : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_DIFLINAMT([M]DIFLINAMT) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DIFLINAMT : Endif
Endif

####################################
## Bloc liste 6
####################################
IMPTBL = 0

## Zone AMTATI
mkstat = 0
zoncou = "AMTATI"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]AMTATI : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_AMTATI([M]AMTATI) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]AMTATI : Endif
Endif

## Zone DIFAMTATI
mkstat = 0
zoncou = "DIFAMTATI"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DIFAMTATI : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_DIFAMTATI([M]DIFAMTATI) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DIFAMTATI : Endif
Endif

## Zone BASDEP
mkstat = 0
zoncou = "BASDEP"
indice = 0
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]BASDEP : Endif

####################################
## Bloc tableau 7
####################################
IMPTBL = 1

indice = 0
status = 1
zoncou = "NBPFI"
If !mkstat
 NBLIG = [M]NBPFI
 For nolign=1 To NBLIG
  indice = nolign-1
  [M]NBPFI = nolign
  status = 75
  Call SAI_NBPFI(IMPFIC,ACTION,IMPTRT)
  If mkstat : Break : Endif
 Next nolign
 If mkstat : End : Endif
 indice = 0
Endif

mkstat = 0

End

####################################
## Bloc tableau 1
####################################
Subprog SAI_NBFAC(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
SAVACT = GACTION : GACTION = "STD"
Call C_NBFAC From SUBPIH
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "NBFAC" : GZNUM = 0 : Endif
Gosub AFF From GSAISIE
If mkstat : End : Endif
SAVACT = GACTION : GACTION = "STD"
Call AVANT_NBFAC From SUBPIH
GACTION = SAVACT

## Zone INVDTA
mkstat = 0
zoncou = "INVDTA"
WNUM = [M]INVDTA(indice)
If varmode([M]INVDTA,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_INVDTA([M]INVDTA(indice)) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]INVDTA(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "INVDTA" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If [M]INVDTA(indice)=0
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTNUM("PFI","AB",[M]INVDTA(indice),"",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_INVDTA([M]INVDTA(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WNUM<>[M]INVDTA(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_INVDTA([M]INVDTA(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone INVDTAAMT
mkstat = 0
zoncou = "INVDTAAMT"
WNUM = [M]INVDTAAMT(indice)
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVDTAAMT(indice) : Endif
If !mkstat
 If varmode([M]INVDTAAMT,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_INVDTAAMT([M]INVDTAAMT(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]INVDTAAMT(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "INVDTAAMT" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If WNUM<>[M]INVDTAAMT(indice) or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_INVDTAAMT([M]INVDTAAMT(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "INVDTAAMT" : GZNUM = 8504 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone INVORDAMT
mkstat = 0
zoncou = "INVORDAMT"
WNUM = [M]INVORDAMT(indice)
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVORDAMT(indice) : Endif
If !mkstat
 If varmode([M]INVORDAMT,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_INVORDAMT([M]INVORDAMT(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]INVORDAMT(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "INVORDAMT" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If WNUM<>[M]INVORDAMT(indice) or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_INVORDAMT([M]INVORDAMT(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "INVORDAMT" : GZNUM = 10367 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone RCPCPLAMT
mkstat = 0
zoncou = "RCPCPLAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]RCPCPLAMT(indice) : Endif

## Zone INVLINAMT
mkstat = 0
zoncou = "INVLINAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVLINAMT(indice) : Endif

## Zone INVORDFLG
mkstat = 0
zoncou = "INVORDFLG"
IMPENT = [M]INVORDFLG(indice)
If varinit([M]INVORDFLG,indice)=0
 IMPENT = 1
Endif
[M]INVORDFLG(indice) = IMPENT

## Zone DISVATFLG
mkstat = 0
zoncou = "DISVATFLG"
IMPENT = [M]DISVATFLG(indice)
If varinit([M]DISVATFLG,indice)=0
 IMPENT = 1
Endif
[M]DISVATFLG(indice) = IMPENT

## Zone INVDIFAMT
mkstat = 0
zoncou = "INVDIFAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVDIFAMT(indice) : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call AV_INVDIFAMT([M]INVDIFAMT(indice)) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]INVDIFAMT(indice) : Endif
Endif

## Zone DEBCDT
mkstat = 0
zoncou = "DEBCDT"
IMPENT = [M]DEBCDT(indice)
If varinit([M]DEBCDT,indice)=0
 IMPENT = 1
Endif
[M]DEBCDT(indice) = IMPENT

## Zone INVDTAVAT
mkstat = 0
zoncou = "INVDTAVAT"
If varmode([M]INVDTAVAT,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_INVDTAVAT([M]INVDTAVAT(indice)) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]INVDTAVAT(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "INVDTAVAT" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If vireblc([M]INVDTAVAT(indice),2)=""
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "INVDTAVAT" : GZNUM = 2554 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTTVT"
   Call CONTTVT([M]INVDTAVAT(indice),GCURLEG,"PIH4","INVDTAVAT",[M:PIH0]FCY,"",GSOCIETE) From SUBTVT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "INVDTAVAT" : GZNUM = 2554 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "PCOVAT"
    Call PCOVAT([M]INVDTAVAT(indice),[M:PIH1]VAC) From TRTACHCTL1
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "INVDTAVAT" : GZNUM = 2554 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone DTADISBAS
mkstat = 0
zoncou = "DTADISBAS"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DTADISBAS(indice) : Endif

## Zone DTAAMTTAX
mkstat = 0
zoncou = "DTAAMTTAX"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DTAAMTTAX(indice) : Endif

## Zone DTADEDTAX
mkstat = 0
zoncou = "DTADEDTAX"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DTADEDTAX(indice) : Endif

## Zone DTADEP
mkstat = 0
zoncou = "DTADEP"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DTADEP(indice) : Endif

## Zone CLCBAS
mkstat = 0
zoncou = "CLCBAS"
IMPENT = [M]CLCBAS(indice)
If varinit([M]CLCBAS,indice)=0
 IMPENT = 1
Endif
[M]CLCBAS(indice) = IMPENT

## Zone ACC1
mkstat = 0
zoncou = "ACC1"
WCHAR = [M]ACC1(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC1(indice) : Endif
If !mkstat
 If varinit([M]ACC1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC1([M]ACC1(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC1([M]ACC1(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!G",[M]ACC1(indice),num$(GCOA(1)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC1([M]ACC1(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC1(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC1([M]ACC1(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC2
mkstat = 0
zoncou = "ACC2"
WCHAR = [M]ACC2(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC2(indice) : Endif
If !mkstat
 If varinit([M]ACC2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC2([M]ACC2(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC2([M]ACC2(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!G",[M]ACC2(indice),num$(GCOA(2)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC2([M]ACC2(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC2(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC2([M]ACC2(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC3
mkstat = 0
zoncou = "ACC3"
WCHAR = [M]ACC3(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC3(indice) : Endif
If !mkstat
 If varinit([M]ACC3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC3([M]ACC3(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC3([M]ACC3(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC3(indice),num$(GCOA(3)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC3([M]ACC3(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC3(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC3([M]ACC3(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC4
mkstat = 0
zoncou = "ACC4"
WCHAR = [M]ACC4(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC4(indice) : Endif
If !mkstat
 If varinit([M]ACC4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC4([M]ACC4(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC4([M]ACC4(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC4(indice),num$(GCOA(4)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC4([M]ACC4(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC4(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC4([M]ACC4(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC5
mkstat = 0
zoncou = "ACC5"
WCHAR = [M]ACC5(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC5(indice) : Endif
If !mkstat
 If varinit([M]ACC5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC5([M]ACC5(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC5([M]ACC5(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC5(indice),num$(GCOA(5)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC5([M]ACC5(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC5(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC5([M]ACC5(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC6
mkstat = 0
zoncou = "ACC6"
WCHAR = [M]ACC6(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(6))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC6(indice) : Endif
If !mkstat
 If varinit([M]ACC6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC6([M]ACC6(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC6([M]ACC6(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC6(indice),num$(GCOA(6)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC6([M]ACC6(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC6(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC6([M]ACC6(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC7
mkstat = 0
zoncou = "ACC7"
WCHAR = [M]ACC7(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(7))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC7(indice) : Endif
If !mkstat
 If varinit([M]ACC7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC7([M]ACC7(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC7([M]ACC7(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC7(indice),num$(GCOA(7)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC7([M]ACC7(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC7(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC7([M]ACC7(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC8
mkstat = 0
zoncou = "ACC8"
WCHAR = [M]ACC8(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(8))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC8(indice) : Endif
If !mkstat
 If varinit([M]ACC8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC8([M]ACC8(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC8([M]ACC8(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC8(indice),num$(GCOA(8)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC8([M]ACC8(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC8(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC8([M]ACC8(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC9
mkstat = 0
zoncou = "ACC9"
WCHAR = [M]ACC9(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(9))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC9(indice) : Endif
If !mkstat
 If varinit([M]ACC9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC9([M]ACC9(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC9([M]ACC9(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC9(indice),num$(GCOA(9)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC9([M]ACC9(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC9(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC9([M]ACC9(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC10
mkstat = 0
zoncou = "ACC10"
WCHAR = [M]ACC10(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(10))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC10(indice) : Endif
If !mkstat
 If varinit([M]ACC10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC10([M]ACC10(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC10([M]ACC10(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC10(indice),num$(GCOA(10)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC10([M]ACC10(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC10(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC10([M]ACC10(indice)) From SUBPIH
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone DSP
mkstat = 0
zoncou = "DSP"
WCHAR = [M]DSP(indice)
If varmode([M]DSP,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_DSP([M]DSP(indice)) From SUBPIH
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DSP(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "DSP" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  Call CONTROLE("DSP","!",[M]DSP(indice),"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CTLDSP"
   Call CTRL_DSP([M]DSP(indice),[M:PIH0]FCY,[M:PIH0]ACCDAT) From TRTX3CPT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]DSP(indice) or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_DSP([M]DSP(indice)) From SUBPIH
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE1
mkstat = 0
zoncou = "PFICCE1"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(1))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE1(indice) : Endif
If !mkstat
 If varinit([M]PFICCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE1([M]PFICCE1(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE1([M]PFICCE1(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE1(indice),num$(GDIE(1)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE1([M]PFICCE1(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE2
mkstat = 0
zoncou = "PFICCE2"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(2))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE2(indice) : Endif
If !mkstat
 If varinit([M]PFICCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE2([M]PFICCE2(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE2([M]PFICCE2(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE2(indice),num$(GDIE(2)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE2([M]PFICCE2(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE3
mkstat = 0
zoncou = "PFICCE3"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(3))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE3(indice) : Endif
If !mkstat
 If varinit([M]PFICCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE3([M]PFICCE3(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE3([M]PFICCE3(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE3(indice),num$(GDIE(3)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE3([M]PFICCE3(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE4
mkstat = 0
zoncou = "PFICCE4"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(4))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE4(indice) : Endif
If !mkstat
 If varinit([M]PFICCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE4([M]PFICCE4(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE4([M]PFICCE4(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE4(indice),num$(GDIE(4)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE4([M]PFICCE4(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE5
mkstat = 0
zoncou = "PFICCE5"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(5))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE5(indice) : Endif
If !mkstat
 If varinit([M]PFICCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE5([M]PFICCE5(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE5([M]PFICCE5(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE5(indice),num$(GDIE(5)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE5([M]PFICCE5(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE6
mkstat = 0
zoncou = "PFICCE6"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(6))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE6(indice) : Endif
If !mkstat
 If varinit([M]PFICCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE6([M]PFICCE6(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE6([M]PFICCE6(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE6(indice),num$(GDIE(6)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE6([M]PFICCE6(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE7
mkstat = 0
zoncou = "PFICCE7"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(7))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE7(indice) : Endif
If !mkstat
 If varinit([M]PFICCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE7([M]PFICCE7(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE7([M]PFICCE7(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE7(indice),num$(GDIE(7)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE7([M]PFICCE7(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE8
mkstat = 0
zoncou = "PFICCE8"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(8))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE8(indice) : Endif
If !mkstat
 If varinit([M]PFICCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE8([M]PFICCE8(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE8([M]PFICCE8(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE8(indice),num$(GDIE(8)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE8([M]PFICCE8(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE9
mkstat = 0
zoncou = "PFICCE9"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(9))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE9(indice) : Endif
If !mkstat
 If varinit([M]PFICCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE9([M]PFICCE9(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE9([M]PFICCE9(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE9(indice),num$(GDIE(9)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE9([M]PFICCE9(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE10
mkstat = 0
zoncou = "PFICCE10"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(10))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE10(indice) : Endif
If !mkstat
 If varinit([M]PFICCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE10([M]PFICCE10(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE10([M]PFICCE10(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE10(indice),num$(GDIE(10)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE10([M]PFICCE10(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE11
mkstat = 0
zoncou = "PFICCE11"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(11))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE11(indice) : Endif
If !mkstat
 If varinit([M]PFICCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE11([M]PFICCE11(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE11([M]PFICCE11(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE11(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE11" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE11(indice),num$(GDIE(11)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE11" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE11([M]PFICCE11(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE11" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE12
mkstat = 0
zoncou = "PFICCE12"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(12))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE12(indice) : Endif
If !mkstat
 If varinit([M]PFICCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE12([M]PFICCE12(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE12([M]PFICCE12(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE12(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE12" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE12(indice),num$(GDIE(12)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE12" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE12([M]PFICCE12(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE12" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE13
mkstat = 0
zoncou = "PFICCE13"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(13))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE13(indice) : Endif
If !mkstat
 If varinit([M]PFICCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE13([M]PFICCE13(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE13([M]PFICCE13(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE13(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE13" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE13(indice),num$(GDIE(13)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE13" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE13([M]PFICCE13(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE13" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE14
mkstat = 0
zoncou = "PFICCE14"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(14))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE14(indice) : Endif
If !mkstat
 If varinit([M]PFICCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE14([M]PFICCE14(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE14([M]PFICCE14(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE14(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE14" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE14(indice),num$(GDIE(14)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE14" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE14([M]PFICCE14(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE14" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE15
mkstat = 0
zoncou = "PFICCE15"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(15))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE15(indice) : Endif
If !mkstat
 If varinit([M]PFICCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE15([M]PFICCE15(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE15([M]PFICCE15(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE15(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE15" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE15(indice),num$(GDIE(15)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE15" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE15([M]PFICCE15(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE15" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE16
mkstat = 0
zoncou = "PFICCE16"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(16))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE16(indice) : Endif
If !mkstat
 If varinit([M]PFICCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE16([M]PFICCE16(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE16([M]PFICCE16(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE16(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE16" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE16(indice),num$(GDIE(16)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE16" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE16([M]PFICCE16(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE16" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE17
mkstat = 0
zoncou = "PFICCE17"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(17))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE17(indice) : Endif
If !mkstat
 If varinit([M]PFICCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE17([M]PFICCE17(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE17([M]PFICCE17(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE17(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE17" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE17(indice),num$(GDIE(17)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE17" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE17([M]PFICCE17(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE17" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE18
mkstat = 0
zoncou = "PFICCE18"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(18))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE18(indice) : Endif
If !mkstat
 If varinit([M]PFICCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE18([M]PFICCE18(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE18([M]PFICCE18(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE18(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE18" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE18(indice),num$(GDIE(18)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE18" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE18([M]PFICCE18(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE18" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE19
mkstat = 0
zoncou = "PFICCE19"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(19))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE19(indice) : Endif
If !mkstat
 If varinit([M]PFICCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE19([M]PFICCE19(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE19([M]PFICCE19(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE19(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE19" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE19(indice),num$(GDIE(19)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE19" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE19([M]PFICCE19(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE19" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE20
mkstat = 0
zoncou = "PFICCE20"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(20))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE20(indice) : Endif
If !mkstat
 If varinit([M]PFICCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE20([M]PFICCE20(indice)) From SUBPIH
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE20([M]PFICCE20(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE20(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE20" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE20(indice),num$(GDIE(20)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE20" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE20([M]PFICCE20(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE20" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone INCDCR
mkstat = 0
zoncou = "INCDCR"
IMPENT = [M]INCDCR(indice)
If varinit([M]INCDCR,indice)=0
 IMPENT = 1
Endif
[M]INCDCR(indice) = IMPENT

## Zone DEPFLG
mkstat = 0
zoncou = "DEPFLG"
IMPENT = [M]DEPFLG(indice)
If varinit([M]DEPFLG,indice)=0
 IMPENT = 1
Endif
[M]DEPFLG(indice) = IMPENT

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
status = 71
SAVACT = GACTION : GACTION = "STD"
Call APRES_NBFAC From SUBPIH
GACTION = SAVACT

End

####################################
## Bloc tableau 2
####################################
Subprog SAI_NBTAX(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBTAX
mkstat = 0
zoncou = "NBTAX"

## Zone NOTAX
mkstat = 0
zoncou = "NOTAX"
[M]NOTAX(indice) = nolign

## Zone DISBAS
mkstat = 0
zoncou = "DISBAS"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DISBAS(indice) : Endif

## Zone BASTAX
mkstat = 0
zoncou = "BASTAX"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]BASTAX(indice) : Endif

## Zone AMTTAX
mkstat = 0
zoncou = "AMTTAX"
WNUM = [M]AMTTAX(indice)
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]AMTTAX(indice) : Endif
If !mkstat
 If varmode([M]AMTTAX,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_AMTTAX([M]AMTTAX(indice)) From SUBPIH
  GACTION = SAVACT
  If mkstat=1 : Raz [M]AMTTAX(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "AMTTAX" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If WNUM<>[M]AMTTAX(indice) or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_AMTTAX([M]AMTTAX(indice)) From SUBPIH
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "AMTTAX" : GZNUM = 6733 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone DEDTAX
mkstat = 0
zoncou = "DEDTAX"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]DEDTAX(indice) : Endif

## Zone PURTYP
mkstat = 0
zoncou = "PURTYP"
IMPENT = [M]PURTYP(indice)
If varinit([M]PURTYP,indice)=0
 IMPENT = 1
Endif
[M]PURTYP(indice) = IMPENT

## Zone VATTYP
mkstat = 0
zoncou = "VATTYP"
IMPENT = [M]VATTYP(indice)
If varinit([M]VATTYP,indice)=0
 IMPENT = 1
Endif
[M]VATTYP(indice) = IMPENT

## Zone VATCHA
mkstat = 0
zoncou = "VATCHA"
IMPENT = [M]VATCHA(indice)
If varinit([M]VATCHA,indice)=0
 IMPENT = 1
Endif
[M]VATCHA(indice) = IMPENT

## Zone VATGRO
mkstat = 0
zoncou = "VATGRO"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]VATGRO(indice) : Endif

## Zone BASDEPNOT
mkstat = 0
zoncou = "BASDEPNOT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]BASDEPNOT(indice) : Endif

## Zone BASDEPATI
mkstat = 0
zoncou = "BASDEPATI"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]BASDEPATI(indice) : Endif

## Zone VATSUPAMT
mkstat = 0
zoncou = "VATSUPAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:PIH1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]VATSUPAMT(indice) : Endif

## Zone NBTAX
mkstat = 0
zoncou = "NBTAX"

End

####################################
## Bloc tableau 7
####################################
Subprog SAI_NBPFI(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1



End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "PIH4"
Return

