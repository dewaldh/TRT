#<AdxTL>@(#)0.0.0.0 $Revision$Class Change request
# Sage X3 supervisor
## ACLA-CLASSE ## CCMCHGREQ
# 2018-06-20 06:39:43 413


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : CRID Request ID ( Field CCMCRID 20)
####################################################################

$SET_CRID
If [L]_AOLDVAL<>this.CRID
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CRID
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CRID
 Gosub PROPAGATE_CRID
Endif
Return

$INIT_CRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRID"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRID"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CRID                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CRID                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CRID
[L]CURPRO = "CRID"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CRID,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CRID
[L]CURPRO = "CRID"
If vireblc(this.CRID,2)<>vireblc(format$("K:20X",this.CRID),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CRID
[L]CURPRO = "CRID"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CRID
[L]CURPRO = "CRID"
Return

$PROPAGATE_CRID
this.isReadonly = 0
[L]CURPRO = "CRID"
Gosub _LNKPRO_CRID
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRID"
$_LNKPRO_CRID
If vireblc(this.CRID,2)<>""
 # Link CCMCHGREQ
 Local File CCMCHGREQ [WCCMCR]
 Read [F:WCCMCR]CCMCR0 = this.CRID
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CRID","$title",[F:WCCMCR]TITLE)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CRID","$description",[F:WCCMCR]TITLE)
 Endif
 LogicClose File [WCCMCR]
Endif
Return


####################################################################
# 2 : TITLE Description ( Field DES 30)
####################################################################

$SET_TITLE
If [L]_AOLDVAL<>this.TITLE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TITLE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TITLE
 Gosub PROPAGATE_TITLE
Endif
Return

$INIT_TITLE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "TITLE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TITLE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "TITLE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TITLE                 : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TITLE                 : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TITLE
[L]CURPRO = "TITLE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TITLE,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TITLE
[L]CURPRO = "TITLE"
If vireblc(this.TITLE,2)<>vireblc(format$("K:30X",this.TITLE),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TITLE
[L]CURPRO = "TITLE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TITLE
[L]CURPRO = "TITLE"
Return

$PROPAGATE_TITLE
this.isReadonly = 0
[L]CURPRO = "TITLE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TITLE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "TITLE"
$_LNKPRO_TITLE
Return

$_ALOADATTRIBUTE_TITLE
[L]ASTATUS = fmet this.ASETATTRIBUTE("TITLE","$isMandatory","true")
Return


####################################################################
# 3 : DATEREQ Required date ( Field D)
####################################################################

$SET_DATEREQ
If [L]_AOLDVAL<>this.DATEREQ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DATEREQ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DATEREQ
 Gosub PROPAGATE_DATEREQ
Endif
Return

$INIT_DATEREQ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "DATEREQ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DATEREQ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "DATEREQ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DATEREQ               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DATEREQ               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DATEREQ
[L]CURPRO = "DATEREQ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DATEREQ=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DATEREQ
[L]CURPRO = "DATEREQ"
Return

$_AOTHERS_DATEREQ
[L]CURPRO = "DATEREQ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DATEREQ
[L]CURPRO = "DATEREQ"
Return

$PROPAGATE_DATEREQ
this.isReadonly = 0
[L]CURPRO = "DATEREQ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DATEREQ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "DATEREQ"
$_LNKPRO_DATEREQ
Return


####################################################################
# 4 : CRSTATUS Status ( Field Local menu number 2033)
####################################################################

$SET_CRSTATUS
If [L]_AOLDVAL<>this.CRSTATUS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CRSTATUS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CRSTATUS
 Gosub PROPAGATE_CRSTATUS
Endif
Return

$INIT_CRSTATUS
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRSTATUS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CRSTATUS=0 and fmet this.AGETATTRIBUTE("CRSTATUS","$isMandatory")="true"
 this.CRSTATUS = 1
Endif
Return
 
$CONTROL_CRSTATUS
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRSTATUS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CRSTATUS              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CRSTATUS              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CRSTATUS
[L]CURPRO = "CRSTATUS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CRSTATUS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CRSTATUS
[L]CURPRO = "CRSTATUS"
If this.CRSTATUS<0 or this.CRSTATUS>len(mess(0,2033,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2033 ->"-num$(this.CRSTATUS)-mess(99,123,1)):  Return : # Local menu "2033 -> Invalid option
Endif
Return

$_AOTHERS_CRSTATUS
[L]CURPRO = "CRSTATUS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CRSTATUS
[L]CURPRO = "CRSTATUS"
Return

$PROPAGATE_CRSTATUS
this.isReadonly = 0
[L]CURPRO = "CRSTATUS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CRSTATUS
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRSTATUS"
$_LNKPRO_CRSTATUS
Return

$_ALOADATTRIBUTE_CRSTATUS
[L]ASTATUS = fmet this.ASETATTRIBUTE("CRSTATUS","$isMandatory","true")
Return


####################################################################
# 5 : CLOSEDST Closed state ( Field Local menu number 2042)
####################################################################

$SET_CLOSEDST
If [L]_AOLDVAL<>this.CLOSEDST
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLOSEDST
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLOSEDST
 Gosub PROPAGATE_CLOSEDST
Endif
Return

$INIT_CLOSEDST
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDST"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CLOSEDST=0 and fmet this.AGETATTRIBUTE("CLOSEDST","$isMandatory")="true"
 this.CLOSEDST = 1
Endif
Return
 
$CONTROL_CLOSEDST
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDST"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLOSEDST              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLOSEDST              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLOSEDST
[L]CURPRO = "CLOSEDST"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLOSEDST=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLOSEDST
[L]CURPRO = "CLOSEDST"
If this.CLOSEDST<0 or this.CLOSEDST>len(mess(0,2042,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2042 ->"-num$(this.CLOSEDST)-mess(99,123,1)):  Return : # Local menu "2042 -> Invalid option
Endif
Return

$_AOTHERS_CLOSEDST
[L]CURPRO = "CLOSEDST"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLOSEDST
[L]CURPRO = "CLOSEDST"
Return

$PROPAGATE_CLOSEDST
this.isReadonly = 0
[L]CURPRO = "CLOSEDST"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLOSEDST
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDST"
$_LNKPRO_CLOSEDST
Return


####################################################################
# 6 : CLOSEDATE Closed on ( Field D)
####################################################################

$SET_CLOSEDATE
If [L]_AOLDVAL<>this.CLOSEDATE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLOSEDATE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLOSEDATE
 Gosub PROPAGATE_CLOSEDATE
Endif
Return

$INIT_CLOSEDATE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDATE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CLOSEDATE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDATE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLOSEDATE             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLOSEDATE             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLOSEDATE
[L]CURPRO = "CLOSEDATE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLOSEDATE=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLOSEDATE
[L]CURPRO = "CLOSEDATE"
Return

$_AOTHERS_CLOSEDATE
[L]CURPRO = "CLOSEDATE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLOSEDATE
[L]CURPRO = "CLOSEDATE"
Return

$PROPAGATE_CLOSEDATE
this.isReadonly = 0
[L]CURPRO = "CLOSEDATE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLOSEDATE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CLOSEDATE"
$_LNKPRO_CLOSEDATE
Return


####################################################################
# 7 : CREDATTIM Created on ( Field ADATIM 0)
####################################################################

$SET_CREDATTIM
If [L]_AOLDVAL<>this.CREDATTIM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREDATTIM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREDATTIM
 Gosub PROPAGATE_CREDATTIM
Endif
Return

$INIT_CREDATTIM
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CREDATTIM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CREDATTIM
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CREDATTIM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREDATTIM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREDATTIM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREDATTIM
[L]CURPRO = "CREDATTIM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CREDATTIM=AVOID.ADATTIM
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREDATTIM
[L]CURPRO = "CREDATTIM"
Return

$_AOTHERS_CREDATTIM
[L]CURPRO = "CREDATTIM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREDATTIM
[L]CURPRO = "CREDATTIM"
Return

$PROPAGATE_CREDATTIM
this.isReadonly = 0
[L]CURPRO = "CREDATTIM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREDATTIM
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CREDATTIM"
$_LNKPRO_CREDATTIM
Return


####################################################################
# 8 : REASON Reason for change ( Field Local menu number 2034)
####################################################################

$SET_REASON
If [L]_AOLDVAL<>this.REASON
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_REASON
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.REASON
 Gosub PROPAGATE_REASON
Endif
Return

$INIT_REASON
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REASON"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.REASON=0 and fmet this.AGETATTRIBUTE("REASON","$isMandatory")="true"
 this.REASON = 1
Endif
Return
 
$CONTROL_REASON
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REASON"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_REASON                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_REASON                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_REASON
[L]CURPRO = "REASON"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.REASON=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_REASON
[L]CURPRO = "REASON"
If this.REASON<0 or this.REASON>len(mess(0,2034,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2034 ->"-num$(this.REASON)-mess(99,123,1)):  Return : # Local menu "2034 -> Invalid option
Endif
Return

$_AOTHERS_REASON
[L]CURPRO = "REASON"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_REASON
[L]CURPRO = "REASON"
Return

$PROPAGATE_REASON
this.isReadonly = 0
[L]CURPRO = "REASON"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_REASON
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REASON"
$_LNKPRO_REASON
Return

$_ALOADATTRIBUTE_REASON
[L]ASTATUS = fmet this.ASETATTRIBUTE("REASON","$isMandatory","true")
Return


####################################################################
# 9 : SITE Site ( Field FCY 5)
####################################################################

$SET_SITE
If [L]_AOLDVAL<>this.SITE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SITE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SITE
 Gosub PROPAGATE_SITE
Endif
Return

$INIT_SITE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SITE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SITE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SITE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SITE                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SITE                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SITE
[L]CURPRO = "SITE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SITE,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SITE
[L]CURPRO = "SITE"
If vireblc(this.SITE,2)<>vireblc(format$("K:5c",this.SITE),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SITE
[L]CURPRO = "SITE"
If vireblc(this.SITE,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"SITE",this.SITE,this.SITE,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.SITE<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SITE
[L]CURPRO = "SITE"
Return

$PROPAGATE_SITE
this.isReadonly = 0
[L]CURPRO = "SITE"
Gosub _LNKPRO_SITE
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SITE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SITE"
$_LNKPRO_SITE
If vireblc(this.SITE,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.SITE
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SITE","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SITE","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return


####################################################################
# 10 : PRODUCT Product ( Field ITM 20)
####################################################################

$SET_PRODUCT
If [L]_AOLDVAL<>this.PRODUCT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRODUCT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRODUCT
 Gosub PROPAGATE_PRODUCT
Endif
Return

$INIT_PRODUCT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODUCT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRODUCT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODUCT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRODUCT               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRODUCT               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRODUCT
[L]CURPRO = "PRODUCT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRODUCT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRODUCT
[L]CURPRO = "PRODUCT"
If vireblc(this.PRODUCT,2)<>vireblc(format$("K:20c",this.PRODUCT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PRODUCT
[L]CURPRO = "PRODUCT"
If vireblc(this.PRODUCT,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPITM.ACTRLREF(this,"PRODUCT",this.PRODUCT,this.PRODUCT,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.PRODUCT<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRODUCT
[L]CURPRO = "PRODUCT"
Return

$PROPAGATE_PRODUCT
this.isReadonly = 0
[L]CURPRO = "PRODUCT"
Gosub _LNKPRO_PRODUCT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRODUCT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODUCT"
$_LNKPRO_PRODUCT
If vireblc(this.PRODUCT,2)<>""
 # Link ITMMASTER
 Local File ITMMASTER [WITM]
 Read [F:WITM]ITM0 = this.PRODUCT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ITMMASTER" & ZONE="DES1AXX" & IDENT1=[F:WITM]ITMREF & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PRODUCT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WITM]
Endif
Return


####################################################################
# 11 : PRODDESC Description (if product unknown) ( Field A 50)
####################################################################

$SET_PRODDESC
If [L]_AOLDVAL<>this.PRODDESC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRODDESC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRODDESC
 Gosub PROPAGATE_PRODDESC
Endif
Return

$INIT_PRODDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODDESC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRODDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODDESC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRODDESC              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRODDESC              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRODDESC
[L]CURPRO = "PRODDESC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRODDESC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRODDESC
[L]CURPRO = "PRODDESC"
Return

$_AOTHERS_PRODDESC
[L]CURPRO = "PRODDESC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRODDESC
[L]CURPRO = "PRODDESC"
Return

$PROPAGATE_PRODDESC
this.isReadonly = 0
[L]CURPRO = "PRODDESC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRODDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "PRODDESC"
$_LNKPRO_PRODDESC
Return


####################################################################
# 12 : CRDESC Additional information ( Field ACRTF 1)
####################################################################

$GET_CRDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRDESC"
Local Char _CNT(100)
Local Tinyint _EXI : [L]_EXI=1
[L]ASTATUS = fmet this.AREAD_CLB("CRDESC",
& this.CRID
& ,[L]_CNT,this.CRDESC)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isLoaded")<>"true"
 [L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
Endif
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_CRDESC
If fmet this.AGETATTRIBUTE("CRDESC","$isLoaded")<>"true" or [L]_AOLDVAL<>this.CRDESC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CRDESC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE("CRDESC","$isLoaded")<>"true" or [L]_AOLDVAL<>this.CRDESC
 Gosub PROPAGATE_CRDESC
Endif
Return

$INIT_CRDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRDESC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CRDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRDESC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CRDESC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CRDESC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CRDESC
[L]CURPRO = "CRDESC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & len(this.CRDESC)=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CRDESC
[L]CURPRO = "CRDESC"
Return

$_AOTHERS_CRDESC
[L]CURPRO = "CRDESC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CRDESC
[L]CURPRO = "CRDESC"
Return

$PROPAGATE_CRDESC
this.isReadonly = 0
[L]CURPRO = "CRDESC"
[L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CRDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CRDESC"
$_LNKPRO_CRDESC
Local Tinyint _EXI : [L]_EXI=1
Gosub READ_EXI_CRDESC From WMC0CCMCHGREQ
[L]ASTATUS = fmet this.ASETATTRIBUTE("CRDESC","$isLobFound",func ASYRSUB.BOOLEAN_TO_SYR([L]_EXI+1))
Return


####################################################################
# 13 : IMPACT Change impact ( Field Local menu number 2031)
####################################################################

$SET_IMPACT
If [L]_AOLDVAL<>this.IMPACT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_IMPACT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.IMPACT
 Gosub PROPAGATE_IMPACT
Endif
Return

$INIT_IMPACT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "IMPACT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.IMPACT=0 and fmet this.AGETATTRIBUTE("IMPACT","$isMandatory")="true"
 this.IMPACT = 1
Endif
Return
 
$CONTROL_IMPACT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "IMPACT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_IMPACT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_IMPACT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_IMPACT
[L]CURPRO = "IMPACT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.IMPACT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_IMPACT
[L]CURPRO = "IMPACT"
If this.IMPACT<0 or this.IMPACT>len(mess(0,2031,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2031 ->"-num$(this.IMPACT)-mess(99,123,1)):  Return : # Local menu "2031 -> Invalid option
Endif
Return

$_AOTHERS_IMPACT
[L]CURPRO = "IMPACT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_IMPACT
[L]CURPRO = "IMPACT"
Return

$PROPAGATE_IMPACT
this.isReadonly = 0
[L]CURPRO = "IMPACT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_IMPACT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "IMPACT"
$_LNKPRO_IMPACT
Return

$_ALOADATTRIBUTE_IMPACT
[L]ASTATUS = fmet this.ASETATTRIBUTE("IMPACT","$isMandatory","true")
Return


####################################################################
# 14 : SEVERITY Severity ( Field Local menu number 2030)
####################################################################

$SET_SEVERITY
If [L]_AOLDVAL<>this.SEVERITY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SEVERITY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SEVERITY
 Gosub PROPAGATE_SEVERITY
Endif
Return

$INIT_SEVERITY
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SEVERITY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.SEVERITY=0 and fmet this.AGETATTRIBUTE("SEVERITY","$isMandatory")="true"
 this.SEVERITY = 1
Endif
Return
 
$CONTROL_SEVERITY
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SEVERITY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SEVERITY              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SEVERITY              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SEVERITY
[L]CURPRO = "SEVERITY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SEVERITY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SEVERITY
[L]CURPRO = "SEVERITY"
If this.SEVERITY<0 or this.SEVERITY>len(mess(0,2030,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2030 ->"-num$(this.SEVERITY)-mess(99,123,1)):  Return : # Local menu "2030 -> Invalid option
Endif
Return

$_AOTHERS_SEVERITY
[L]CURPRO = "SEVERITY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SEVERITY
[L]CURPRO = "SEVERITY"
Return

$PROPAGATE_SEVERITY
this.isReadonly = 0
[L]CURPRO = "SEVERITY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SEVERITY
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "SEVERITY"
$_LNKPRO_SEVERITY
Return

$_ALOADATTRIBUTE_SEVERITY
[L]ASTATUS = fmet this.ASETATTRIBUTE("SEVERITY","$isMandatory","true")
Return


####################################################################
# 15 : CCMUSRID Change manager ( Field CCMAUSCM 5)
####################################################################

$SET_CCMUSRID
If [L]_AOLDVAL<>this.CCMUSRID
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CCMUSRID
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CCMUSRID
 Gosub PROPAGATE_CCMUSRID
Endif
Return

$INIT_CCMUSRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CCMUSRID"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CCMUSRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CCMUSRID"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CCMUSRID              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CCMUSRID              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CCMUSRID
[L]CURPRO = "CCMUSRID"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CCMUSRID,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CCMUSRID
[L]CURPRO = "CCMUSRID"
If vireblc(this.CCMUSRID,2)<>vireblc(format$("K:5B",this.CCMUSRID),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CCMUSRID
[L]CURPRO = "CCMUSRID"
If vireblc(this.CCMUSRID,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCCMAUSCM.ACTRLREF(this,"CCMUSRID",this.CCMUSRID,this.CCMUSRID,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CCMUSRID<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CCMUSRID
[L]CURPRO = "CCMUSRID"
Return

$PROPAGATE_CCMUSRID
this.isReadonly = 0
[L]CURPRO = "CCMUSRID"
Gosub _LNKPRO_CCMUSRID
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CCMUSRID
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CCMUSRID"
$_LNKPRO_CCMUSRID
If vireblc(this.CCMUSRID,2)<>""
 # Link AUTILIS
 Local File AUTILIS [WAUS]
 Read [F:WAUS]CODUSR = this.CCMUSRID
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CCMUSRID","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CCMUSRID","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WAUS]
Endif
Return

$_ALOADATTRIBUTE_CCMUSRID
[L]ASTATUS = fmet this.ASETATTRIBUTE("CCMUSRID","$isMandatory","true")
Return


####################################################################
# 16 : CHGMANUSR Reassigned by ( Field CCMAUS 5)
####################################################################

$SET_CHGMANUSR
If [L]_AOLDVAL<>this.CHGMANUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CHGMANUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CHGMANUSR
 Gosub PROPAGATE_CHGMANUSR
Endif
Return

$INIT_CHGMANUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CHGMANUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CHGMANUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CHGMANUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CHGMANUSR
[L]CURPRO = "CHGMANUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CHGMANUSR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CHGMANUSR
[L]CURPRO = "CHGMANUSR"
If vireblc(this.CHGMANUSR,2)<>vireblc(format$("K:5B",this.CHGMANUSR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CHGMANUSR
[L]CURPRO = "CHGMANUSR"
If vireblc(this.CHGMANUSR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCCMAUS.ACTRLREF(this,"CHGMANUSR",this.CHGMANUSR,this.CHGMANUSR,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CHGMANUSR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CHGMANUSR
[L]CURPRO = "CHGMANUSR"
Return

$PROPAGATE_CHGMANUSR
this.isReadonly = 0
[L]CURPRO = "CHGMANUSR"
Gosub _LNKPRO_CHGMANUSR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CHGMANUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANUSR"
$_LNKPRO_CHGMANUSR
If vireblc(this.CHGMANUSR,2)<>""
 # Link AUTILIS
 Local File AUTILIS [WAUS]
 Read [F:WAUS]CODUSR = this.CHGMANUSR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CHGMANUSR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CHGMANUSR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WAUS]
Endif
Return


####################################################################
# 17 : CHGMANDAT Reassigned on ( Field D)
####################################################################

$SET_CHGMANDAT
If [L]_AOLDVAL<>this.CHGMANDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CHGMANDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CHGMANDAT
 Gosub PROPAGATE_CHGMANDAT
Endif
Return

$INIT_CHGMANDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CHGMANDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CHGMANDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CHGMANDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CHGMANDAT
[L]CURPRO = "CHGMANDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CHGMANDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CHGMANDAT
[L]CURPRO = "CHGMANDAT"
Return

$_AOTHERS_CHGMANDAT
[L]CURPRO = "CHGMANDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CHGMANDAT
[L]CURPRO = "CHGMANDAT"
Return

$PROPAGATE_CHGMANDAT
this.isReadonly = 0
[L]CURPRO = "CHGMANDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CHGMANDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "CHGMANDAT"
$_LNKPRO_CHGMANDAT
Return


####################################################################
# 23 : REJECTCOD Rejection reasons ( Field Local menu number 2035)
####################################################################

$SET_REJECTCOD
If [L]_AOLDVAL<>this.REJECTCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_REJECTCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.REJECTCOD
 Gosub PROPAGATE_REJECTCOD
Endif
Return

$INIT_REJECTCOD
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.REJECTCOD=0 and fmet this.AGETATTRIBUTE("REJECTCOD","$isMandatory")="true"
 this.REJECTCOD = 1
Endif
Return
 
$CONTROL_REJECTCOD
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_REJECTCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_REJECTCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_REJECTCOD
[L]CURPRO = "REJECTCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.REJECTCOD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_REJECTCOD
[L]CURPRO = "REJECTCOD"
If this.REJECTCOD<0 or this.REJECTCOD>len(mess(0,2035,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2035 ->"-num$(this.REJECTCOD)-mess(99,123,1)):  Return : # Local menu "2035 -> Invalid option
Endif
Return

$_AOTHERS_REJECTCOD
[L]CURPRO = "REJECTCOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_REJECTCOD
[L]CURPRO = "REJECTCOD"
Return

$PROPAGATE_REJECTCOD
this.isReadonly = 0
[L]CURPRO = "REJECTCOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_REJECTCOD
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTCOD"
$_LNKPRO_REJECTCOD
Return


####################################################################
# 24 : REJDESC Additional information ( Field ACRTF 1)
####################################################################

$GET_REJDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJDESC"
Local Char _CNT(100)
Local Tinyint _EXI : [L]_EXI=1
[L]ASTATUS = fmet this.AREAD_CLB("REJDESC",
& this.CRID
& ,[L]_CNT,this.REJDESC)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isLoaded")<>"true"
 [L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
Endif
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_REJDESC
If fmet this.AGETATTRIBUTE("REJDESC","$isLoaded")<>"true" or [L]_AOLDVAL<>this.REJDESC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_REJDESC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE("REJDESC","$isLoaded")<>"true" or [L]_AOLDVAL<>this.REJDESC
 Gosub PROPAGATE_REJDESC
Endif
Return

$INIT_REJDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJDESC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_REJDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJDESC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_REJDESC               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_REJDESC               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_REJDESC
[L]CURPRO = "REJDESC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & len(this.REJDESC)=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_REJDESC
[L]CURPRO = "REJDESC"
Return

$_AOTHERS_REJDESC
[L]CURPRO = "REJDESC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_REJDESC
[L]CURPRO = "REJDESC"
Return

$PROPAGATE_REJDESC
this.isReadonly = 0
[L]CURPRO = "REJDESC"
[L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_REJDESC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJDESC"
$_LNKPRO_REJDESC
Local Tinyint _EXI : [L]_EXI=1
Gosub READ_EXI_REJDESC From WMC0CCMCHGREQ
[L]ASTATUS = fmet this.ASETATTRIBUTE("REJDESC","$isLobFound",func ASYRSUB.BOOLEAN_TO_SYR([L]_EXI+1))
Return


####################################################################
# 25 : REJECTUSR Rejected by ( Field AUS 5)
####################################################################

$SET_REJECTUSR
If [L]_AOLDVAL<>this.REJECTUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_REJECTUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.REJECTUSR
 Gosub PROPAGATE_REJECTUSR
Endif
Return

$INIT_REJECTUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_REJECTUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_REJECTUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_REJECTUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_REJECTUSR
[L]CURPRO = "REJECTUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.REJECTUSR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_REJECTUSR
[L]CURPRO = "REJECTUSR"
If vireblc(this.REJECTUSR,2)<>vireblc(format$("K:5B",this.REJECTUSR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_REJECTUSR
[L]CURPRO = "REJECTUSR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_REJECTUSR
[L]CURPRO = "REJECTUSR"
Return

$PROPAGATE_REJECTUSR
this.isReadonly = 0
[L]CURPRO = "REJECTUSR"
Gosub _LNKPRO_REJECTUSR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_REJECTUSR
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTUSR"
$_LNKPRO_REJECTUSR
If vireblc(this.REJECTUSR,2)<>""
 # Link AUTILIS
 Local File AUTILIS [WAUS]
 Read [F:WAUS]CODUSR = this.REJECTUSR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("REJECTUSR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("REJECTUSR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WAUS]
Endif
Return


####################################################################
# 26 : REJECTDAT Rejection date ( Field D)
####################################################################

$SET_REJECTDAT
If [L]_AOLDVAL<>this.REJECTDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_REJECTDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.REJECTDAT
 Gosub PROPAGATE_REJECTDAT
Endif
Return

$INIT_REJECTDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_REJECTDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_REJECTDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_REJECTDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_REJECTDAT
[L]CURPRO = "REJECTDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.REJECTDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_REJECTDAT
[L]CURPRO = "REJECTDAT"
Return

$_AOTHERS_REJECTDAT
[L]CURPRO = "REJECTDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_REJECTDAT
[L]CURPRO = "REJECTDAT"
Return

$PROPAGATE_REJECTDAT
this.isReadonly = 0
[L]CURPRO = "REJECTDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_REJECTDAT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "REJECTDAT"
$_LNKPRO_REJECTDAT
Return


####################################################################
# 27 : ECCVALMAJ Major version ( Field CCMECS 10)
####################################################################

$SET_ECCVALMAJ
If [L]_AOLDVAL<>this.ECCVALMAJ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ECCVALMAJ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ECCVALMAJ
 Gosub PROPAGATE_ECCVALMAJ
Endif
Return

$INIT_ECCVALMAJ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMAJ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ECCVALMAJ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMAJ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ECCVALMAJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ECCVALMAJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ECCVALMAJ
[L]CURPRO = "ECCVALMAJ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ECCVALMAJ,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ECCVALMAJ
[L]CURPRO = "ECCVALMAJ"
Return

$_AOTHERS_ECCVALMAJ
[L]CURPRO = "ECCVALMAJ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ECCVALMAJ
[L]CURPRO = "ECCVALMAJ"
If vireblc(this.ECCVALMAJ,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCCMECS.ACTRLREF(this,"ECCVALMAJ",this.ECCVALMAJ,this.PRODUCT,this.ECCVALMAJ,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ECCVALMAJ<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_ECCVALMAJ
this.isReadonly = 0
[L]CURPRO = "ECCVALMAJ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ECCVALMAJ
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMAJ"
$_LNKPRO_ECCVALMAJ
Return


####################################################################
# 28 : ECCVALMIN Minor version ( Field CCMEVL 10)
####################################################################

$SET_ECCVALMIN
If [L]_AOLDVAL<>this.ECCVALMIN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ECCVALMIN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ECCVALMIN
 Gosub PROPAGATE_ECCVALMIN
Endif
Return

$INIT_ECCVALMIN
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMIN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ECCVALMIN
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMIN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ECCVALMIN             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ECCVALMIN             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ECCVALMIN
[L]CURPRO = "ECCVALMIN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ECCVALMIN,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ECCVALMIN
[L]CURPRO = "ECCVALMIN"
Return

$_AOTHERS_ECCVALMIN
[L]CURPRO = "ECCVALMIN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ECCVALMIN
[L]CURPRO = "ECCVALMIN"
If vireblc(this.ECCVALMIN,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCCMEVL.ACTRLREF(this,"ECCVALMIN",this.ECCVALMIN,this.PRODUCT,this.ECCVALMAJ,this.ECCVALMIN,4,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ECCVALMIN<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_ECCVALMIN
this.isReadonly = 0
[L]CURPRO = "ECCVALMIN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ECCVALMIN
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "ECCVALMIN"
$_LNKPRO_ECCVALMIN
Return


####################################################################
# 29 : NCSREC Non-conformance ( Field Local menu number 1)
####################################################################

$SET_NCSREC
If [L]_AOLDVAL<>this.NCSREC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NCSREC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NCSREC
 Gosub PROPAGATE_NCSREC
Endif
Return

$INIT_NCSREC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "NCSREC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.NCSREC=0 and fmet this.AGETATTRIBUTE("NCSREC","$isMandatory")="true"
 this.NCSREC = 1
Endif
Return
 
$CONTROL_NCSREC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "NCSREC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NCSREC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NCSREC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NCSREC
[L]CURPRO = "NCSREC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.NCSREC=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NCSREC
[L]CURPRO = "NCSREC"
If this.NCSREC<0 or this.NCSREC>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.NCSREC)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_NCSREC
[L]CURPRO = "NCSREC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NCSREC
[L]CURPRO = "NCSREC"
Return

$PROPAGATE_NCSREC
this.isReadonly = 0
[L]CURPRO = "NCSREC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NCSREC
Gosub DECLARE_VAR From WMC0CCMCHGREQ
[L]CURPRO = "NCSREC"
$_LNKPRO_NCSREC
Return




