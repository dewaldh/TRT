#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management GACCENT2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$ON_TAX
Onevent CONTROL Call C_TAX(zc) From W2GACCENT2
Onevent INIT_AREA Call D_TAX(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_TAX(zc) From W2GACCENT2
Return

Subprog IB_TAX(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog D_TAX(VALEUR)
Variable Char    VALEUR()
If varinit([M]TAX,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"TAX") From TRTGAS
 ## Action STD
 Call D_TAX(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_TAX(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_TAX(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"TAX") From TRTGAS
If mkstat=2
 [M]TAX(INDIC) = VALEUR
 Affzo TAX(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_TAX(VALEUR) From SUBGA0
 If mkstat=2
  [M]TAX(INDIC) = VALEUR
  Affzo TAX(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_TAX(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_TAX(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_TAX(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_TAX(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_TAX(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,GCURLEG,"GACCENT2","TAX",[M:HAE2]FCYLIN(nolign-1),"","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"TAX") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
 If !mkstat
  ## Action STD
  Call C_TAX(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_TAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = "GACCENT2"
 PARMSK(7) = "TAX"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_TAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVT
 Call TUNTVT(VALEUR,GCURLEG) From SUBTVT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_TAX(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_TAX(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_TAX2
Return

$ON_TAX3
Return

$ON_CPA1
Onevent INIT_AREA Call D_CPA1(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA1(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA1(zc) From W2GACCENT2
Return

Subprog D_CPA1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA1") From TRTGAS
If mkstat=2
 [M]CPA1(INDIC) = VALEUR
 Affzo CPA1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA1(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA1(INDIC) = VALEUR
  Affzo CPA1(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA1(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA1") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA1" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA1(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA1" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA2
Onevent INIT_AREA Call D_CPA2(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA2(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA2(zc) From W2GACCENT2
Return

Subprog D_CPA2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA2") From TRTGAS
If mkstat=2
 [M]CPA2(INDIC) = VALEUR
 Affzo CPA2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA2(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA2(INDIC) = VALEUR
  Affzo CPA2(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA2(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA2") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA2" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA2(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA2" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA3
Onevent INIT_AREA Call D_CPA3(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA3(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA3(zc) From W2GACCENT2
Return

Subprog D_CPA3(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA3") From TRTGAS
If mkstat=2
 [M]CPA3(INDIC) = VALEUR
 Affzo CPA3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA3(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA3(INDIC) = VALEUR
  Affzo CPA3(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA3(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA3") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA3" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA3(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA3" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA4
Onevent INIT_AREA Call D_CPA4(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA4(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA4(zc) From W2GACCENT2
Return

Subprog D_CPA4(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA4") From TRTGAS
If mkstat=2
 [M]CPA4(INDIC) = VALEUR
 Affzo CPA4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA4(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA4(INDIC) = VALEUR
  Affzo CPA4(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA4(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA4") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA4" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA4(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA4" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA5
Onevent INIT_AREA Call D_CPA5(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA5(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA5(zc) From W2GACCENT2
Return

Subprog D_CPA5(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA5,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA5") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA5") From TRTGAS
If mkstat=2
 [M]CPA5(INDIC) = VALEUR
 Affzo CPA5(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA5(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA5(INDIC) = VALEUR
  Affzo CPA5(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA5(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA5") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA5" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA5(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA5" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA6
Onevent INIT_AREA Call D_CPA6(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA6(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA6(zc) From W2GACCENT2
Return

Subprog D_CPA6(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA6,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA6") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA6") From TRTGAS
If mkstat=2
 [M]CPA6(INDIC) = VALEUR
 Affzo CPA6(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA6(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA6(INDIC) = VALEUR
  Affzo CPA6(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA6(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA6") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA6" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA6(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA6" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA7
Onevent INIT_AREA Call D_CPA7(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA7(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA7(zc) From W2GACCENT2
Return

Subprog D_CPA7(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA7,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA7") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA7(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA7") From TRTGAS
If mkstat=2
 [M]CPA7(INDIC) = VALEUR
 Affzo CPA7(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA7(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA7(INDIC) = VALEUR
  Affzo CPA7(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA7(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA7") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA7" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA7(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA7" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA8
Onevent INIT_AREA Call D_CPA8(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA8(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA8(zc) From W2GACCENT2
Return

Subprog D_CPA8(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA8,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA8") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA8(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA8") From TRTGAS
If mkstat=2
 [M]CPA8(INDIC) = VALEUR
 Affzo CPA8(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA8(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA8(INDIC) = VALEUR
  Affzo CPA8(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA8(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA8") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA8" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA8(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA8" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA9
Onevent INIT_AREA Call D_CPA9(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA9(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA9(zc) From W2GACCENT2
Return

Subprog D_CPA9(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA9,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA9") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA9(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA9") From TRTGAS
If mkstat=2
 [M]CPA9(INDIC) = VALEUR
 Affzo CPA9(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA9(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA9(INDIC) = VALEUR
  Affzo CPA9(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA9(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA9") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA9" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA9(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA9" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CPA10
Onevent INIT_AREA Call D_CPA10(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CPA10(zc) From W2GACCENT2
Onevent CONTROL Call C_CPA10(zc) From W2GACCENT2
Return

Subprog D_CPA10(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA10,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA10") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA10(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA10") From TRTGAS
If mkstat=2
 [M]CPA10(INDIC) = VALEUR
 Affzo CPA10(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA10(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA10(INDIC) = VALEUR
  Affzo CPA10(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPA10(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA10") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA10" : GZNUM = 4999 : Endif
If !mkstat
 ## Action STD
 Call C_CPA10(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA10" : GZNUM = 4999 : Endif
Endif
Gosub _AFF
End

$ON_CSLBPR
Onevent CONTROL Call C_CSLBPR(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CSLBPR(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CSLBPR(zc) From W2GACCENT2
Return

Subprog D_CSLBPR(VALEUR)
Variable Char    VALEUR()
If varinit([M]CSLBPR,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CSLBPR") From TRTGAS
 ## Action STD
 Call D_CSLBPR(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CSLBPR") From TRTGAS
If mkstat=2
 [M]CSLBPR(INDIC) = VALEUR
 Affzo CSLBPR(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CSLBPR(VALEUR) From SUBGA0
 If mkstat=2
  [M]CSLBPR(INDIC) = VALEUR
  Affzo CSLBPR(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CSLBPR(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CSLBPR(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CSLBPR(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CSLBPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CSLBPR") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
  If !mkstat
   ## Action STD
   Call C_CSLBPR(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CSLCOD
Onevent INIT_AREA Call D_CSLCOD(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CSLCOD(zc) From W2GACCENT2
Onevent CONTROL Call C_CSLCOD(zc) From W2GACCENT2
Return

Subprog D_CSLCOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]CSLCOD,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CSLC") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CSLCOD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CSLC") From TRTGAS
If mkstat=2
 [M]CSLCOD(INDIC) = VALEUR
 Affzo CSLCOD(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CSLCOD(VALEUR) From SUBGA0
 If mkstat=2
  [M]CSLCOD(INDIC) = VALEUR
  Affzo CSLCOD(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CSLCOD(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CSLC") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CSLCOD" : GZNUM = 12138 : Endif
Gosub _AFF
End

$ON_CSLFLO
Onevent INIT_AREA Call D_CSLFLO(zc) From W2GACCENT2
Onevent CONTROL Call C_CSLFLO(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CSLFLO(zc) From W2GACCENT2
Return

Subprog D_CSLFLO(VALEUR)
Variable Char    VALEUR()
If varinit([M]CSLFLO,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"324","") From SUBADI
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CSLF") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CSLF") From TRTGAS
If mkstat=2
 [M]CSLFLO(INDIC) = VALEUR
 Affzo CSLFLO(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CSLFLO(VALEUR) From SUBGA0
 If mkstat=2
  [M]CSLFLO(INDIC) = VALEUR
  Affzo CSLFLO(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CSLFLO(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CSLFLO(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CSLFLO(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CSLFLO(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"324","") From SUBADI
If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"324",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CSLF") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
  If !mkstat
   ## Action STD
   Call C_CSLFLO(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CSLFLO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "324"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "324"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "324"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_QTY
Onevent BEFORE_AREA Gosub AV_QTY From W2GACCENT2
Onevent INIT_AREA Call D_QTY(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_QTY(zc) From W2GACCENT2
Onevent CONTROL Call C_QTY(zc) From W2GACCENT2
Return

$AV_QTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTY(indice) With "Nz:"+GUNTFMT
Gosub _AFF
Return

Subprog D_QTY(VALEUR)
Variable Decimal VALEUR
If varinit([M]QTY,indice)=0
 ## Action STD
 Call D_QTY(VALEUR) From SUBGA0
 ## Action FLDDEFDCB
 Call FLDDEFDCB(VALEUR,"QTY") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_QTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTDCB
Call FLDAVTDCB(VALEUR,"QTY") From TRTGAS
If mkstat=2
 [M]QTY(INDIC) = VALEUR
 Affzo QTY(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_QTY(VALEUR) From SUBGA0
 If mkstat=2
  [M]QTY(INDIC) = VALEUR
  Affzo QTY(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_QTY(VALEUR)
Variable Decimal VALEUR
## Action FLDCTLDCB
Call FLDCTLDCB(VALEUR,"QTY") From TRTGAS
If mkstat : GERR = 1 : GZONE = "QTY" : GZNUM = 271 : Endif
Gosub _AFF
End

$ON_UOM
Onevent INIT_AREA Call D_UOM(zc) From W2GACCENT2
Return

Subprog D_UOM(VALEUR)
Variable Char    VALEUR()
If varinit([M]UOM,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"UOM") From TRTGAS
 ## Action STD
 Call D_UOM(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

$ON_PJTLIN
Onevent BEFORE_INPUT Call AS_PJTLIN(zc) From W2GACCENT2
Onevent CONTROL Call C_PJTLIN(zc) From W2GACCENT2
Onevent AFTER_CHANGE Gosub AMM_PJTLIN From W2GACCENT2
Onevent AFTER_AREA Call AP_PJTLIN(zc) From W2GACCENT2
Return

Subprog IB_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTLIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat=2
 [M]PJTLIN(INDIC) = VALEUR
 Affzo PJTLIN(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_PJTLIN(VALEUR) From SUBGA0
 If mkstat=2
  [M]PJTLIN(INDIC) = VALEUR
  Affzo PJTLIN(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJTLIN(zc) From W2GACCENT2
 Onkey 130 Titled GBOUT2 Call B2_PJTLIN(zc) From W2GACCENT2
 Onkey 131 Titled GBOUT3 Call B3_PJTLIN(zc) From W2GACCENT2
 Onkey 132 Titled GBOUT4 Call B4_PJTLIN(zc) From W2GACCENT2
 Onkey 172 Titled GBOUT15 Call B15_PJTLIN(zc) From W2GACCENT2
 Onkey 173 Titled GBOUT16 Call B16_PJTLIN(zc) From W2GACCENT2
 Onkey 174 Titled GBOUT17 Call B17_PJTLIN(zc) From W2GACCENT2
 Onkey 175 Titled GBOUT18 Call B18_PJTLIN(zc) From W2GACCENT2
 Onkey 176 Titled GBOUT19 Call B19_PJTLIN(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_PJTLIN(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_PJTLIN(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_PJTLIN(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog AP_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action SPE
Call AP_PJTLIN(VALEUR) From SPEGA0
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
Gosub _AFF
End

$AMM_PJTLIN
Call AM_PJTLIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
Gosub _AFF
End

Subprog S_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"",func SUBGA0.GET_NAME_FIELD("PJT"),"",func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = func SUBGA0.GET_NAME_FIELD("PJT")
 PARMSK(18) = ""
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_DSP
Onevent INIT_AREA Call D_DSP(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_DSP(zc) From W2GACCENT2
Onevent CONTROL Call C_DSP(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_DSP(zc) From W2GACCENT2
Return

Subprog D_DSP(VALEUR)
Variable Char    VALEUR()
If varinit([M]DSP,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DSP") From TRTGAS
 ## Action STD
 Call D_DSP(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_DSP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DSP") From TRTGAS
If mkstat=2
 [M]DSP(INDIC) = VALEUR
 Affzo DSP(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_DSP(VALEUR) From SUBGA0
 If mkstat=2
  [M]DSP(INDIC) = VALEUR
  Affzo DSP(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_DSP(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DSP") From TRTGAS
If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
If !mkstat
 ## Action STD
 Call C_DSP(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
Endif
Gosub _AFF
End

Subprog AP_DSP(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_DSP(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
Gosub _AFF
End

$ON_CCE1
Onevent BEFORE_AREA Gosub AV_CCE1 From W2GACCENT2
Onevent INIT_AREA Call D_CCE1(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE1(zc) From W2GACCENT2
Onevent CONTROL Call C_CCE1(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE1(zc) From W2GACCENT2
Return

$AV_CCE1
## Action STD
Call AV_CCE1(zc) From SUBGA0
If GFMTSEC(6)<>""
 Chgfmt [M]CCE1(indice) With "K:"+GFMTSEC(6)
Else
 Chgfmt [M]CCE1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"") From TRTGAS
 ## Action STD
 Call D_CCE1(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"") From TRTGAS
If mkstat=2
 [M]CCE1(INDIC) = VALEUR
 Affzo CCE1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE1(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE1(INDIC) = VALEUR
  Affzo CCE1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE1(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE1(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE1(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE1(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE1(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(0)),mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 3997 : Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE1(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action SPE
   Call C_CCE1(VALEUR) From SPEGA0
   If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 3997 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE1(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(0))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(0))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(0))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE2
Onevent BEFORE_AREA Gosub AV_CCE2 From W2GACCENT2
Onevent CONTROL Call C_CCE2(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE2(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE2(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE2(zc) From W2GACCENT2
Return

$AV_CCE2
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(1))) From SETGLBDIE
## Action STD
Call AV_CCE2(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE2(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"") From TRTGAS
 ## Action STD
 Call D_CCE2(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"") From TRTGAS
If mkstat=2
 [M]CCE2(INDIC) = VALEUR
 Affzo CCE2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE2(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE2(INDIC) = VALEUR
  Affzo CCE2(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE2(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE2(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE2(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE2(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE2(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
   If !mkstat
    ## Action SPE
    Call C_CCE2(VALEUR) From SPEGA0
    If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE2(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(1))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(1))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE3
Onevent BEFORE_AREA Gosub AV_CCE3 From W2GACCENT2
Onevent CONTROL Call C_CCE3(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE3(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE3(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE3(zc) From W2GACCENT2
Return

$AV_CCE3
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(2))) From SETGLBDIE
## Action STD
Call AV_CCE3(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE3(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE3(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"") From TRTGAS
 ## Action STD
 Call D_CCE3(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"") From TRTGAS
If mkstat=2
 [M]CCE3(INDIC) = VALEUR
 Affzo CCE3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE3(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE3(INDIC) = VALEUR
  Affzo CCE3(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE3(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE3(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE3(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE3(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE3(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
   If !mkstat
    ## Action SPE
    Call C_CCE3(VALEUR) From SPEGA0
    If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE3(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(2))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(2))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE4
Onevent BEFORE_AREA Gosub AV_CCE4 From W2GACCENT2
Onevent CONTROL Call C_CCE4(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE4(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE4(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE4(zc) From W2GACCENT2
Return

$AV_CCE4
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(3))) From SETGLBDIE
## Action STD
Call AV_CCE4(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE4(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE4(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"") From TRTGAS
 ## Action STD
 Call D_CCE4(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"") From TRTGAS
If mkstat=2
 [M]CCE4(INDIC) = VALEUR
 Affzo CCE4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE4(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE4(INDIC) = VALEUR
  Affzo CCE4(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE4(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE4(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE4(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE4(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(3))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(3)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE4(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
   If !mkstat
    ## Action SPE
    Call C_CCE4(VALEUR) From SPEGA0
    If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE4(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(3))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(3))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(3))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE5
Onevent BEFORE_AREA Gosub AV_CCE5 From W2GACCENT2
Onevent CONTROL Call C_CCE5(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE5(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE5(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE5(zc) From W2GACCENT2
Return

$AV_CCE5
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(4))) From SETGLBDIE
## Action STD
Call AV_CCE5(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE5(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE5(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE5,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"") From TRTGAS
 ## Action STD
 Call D_CCE5(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"") From TRTGAS
If mkstat=2
 [M]CCE5(INDIC) = VALEUR
 Affzo CCE5(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE5(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE5(INDIC) = VALEUR
  Affzo CCE5(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE5(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE5(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE5(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE5(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(4))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(4)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE5(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
   If !mkstat
    ## Action SPE
    Call C_CCE5(VALEUR) From SPEGA0
    If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE5(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE5(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(4))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(4))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE5(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(4))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE6
Onevent BEFORE_AREA Gosub AV_CCE6 From W2GACCENT2
Onevent CONTROL Call C_CCE6(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE6(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE6(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE6(zc) From W2GACCENT2
Return

$AV_CCE6
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(5))) From SETGLBDIE
## Action STD
Call AV_CCE6(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE6(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE6(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE6(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE6,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CCE6."+[M:HAEF]DIE(5)) From TRTGAS
 ## Action STD
 Call D_CCE6(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CCE6."+[M:HAEF]DIE(5)) From TRTGAS
If mkstat=2
 [M]CCE6(INDIC) = VALEUR
 Affzo CCE6(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE6(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE6(INDIC) = VALEUR
  Affzo CCE6(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE6(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE6(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE6(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE6(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(5))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(5)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CCE6."+[M:HAEF]DIE(5)) From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE6(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 3997 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE6(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$([M:HAE1]DIE(5))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE6(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(5))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(5))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE6(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(5))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE7
Onevent BEFORE_AREA Gosub AV_CCE7 From W2GACCENT2
Onevent CONTROL Call C_CCE7(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE7(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE7(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE7(zc) From W2GACCENT2
Return

$AV_CCE7
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(6))) From SETGLBDIE
## Action STD
Call AV_CCE7(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE7(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE7(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE7(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE7,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CCE7."+[M:HAEF]DIE(6)) From TRTGAS
 ## Action STD
 Call D_CCE7(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE7(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CCE7."+[M:HAEF]DIE(6)) From TRTGAS
If mkstat=2
 [M]CCE7(INDIC) = VALEUR
 Affzo CCE7(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE7(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE7(INDIC) = VALEUR
  Affzo CCE7(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CCE7(zc) From W2GACCENT2
 Onkey   2 Titled GBOUTS Call S_CCE7(zc) From W2GACCENT2
 Onkey 144 Titled GBOUTP Call P_CCE7(zc) From W2GACCENT2
 Onkey 146 Titled GBOUTA Call SA_CCE7(zc) From W2GACCENT2
Endif
Gosub _AFF
End

Subprog C_CCE7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(6))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(6)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CCE7."+[M:HAEF]DIE(6)) From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE7(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 3997 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE7(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE7(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$([M:HAE1]DIE(6))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE7(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(6))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(6))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE7(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(6))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE8
Onevent BEFORE_AREA Gosub AV_CCE8 From W2GACCENT2
Onevent CONTROL Call C_CCE8(zc) From W2GACCENT2
Onevent INIT_AREA Call D_CCE8(zc) From W2GACCENT2
Onevent BEFORE_INPUT Call AS_CCE8(zc) From W2GACCENT2
Onevent AFTER_AREA Call AP_CCE8(zc) From W2GACCENT2
Return

$AV_CCE8
## Action INICCEFMT
Call INICCEFMT(num$([M:HAE1]DIE(7))) From SETGLBDIE
## Action FLDAVTCAR
Call FLDAVTCAR(zc,"CCE8."+[M:HAEF]DIE(7)) From TRTGAS
## Action STD
Call AV_CCE8(zc) From SUBGA0
If GCCEFMT<>""
 Chgfmt [M]CCE8(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE8(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE8(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE8,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CCE8."+[M:HAEF]DIE(7)) From TRTGAS
 ## Action STD
 Call D_CCE8(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE8(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_CCE8(VALEUR) From SUBGA0
If mkstat=2
 [M]CCE8(INDIC) = VALEUR
 Affzo CCE8(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_CCE8(zc) From W2GACCENT2
Onkey   2 Titled GBOUTS Call S_CCE8(zc) From W2GACCENT2
Onkey 144 Titled GBOUTP Call P_CCE8(zc) From W2GACCENT2
Onkey 146 Titled GBOUTA Call SA_CCE8(zc) From W2GACCENT2
Gosub _AFF
End

Subprog C_CCE8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M:HAE1]DIE(7))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M:HAE1]DIE(7)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CCE8."+[M:HAEF]DIE(7)) From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 3997 : Endif
  If !mkstat
   ## Action STD
   Call C_CCE8(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 3997 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE8(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE8(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 3997 : Endif
Gosub _AFF
End

Subprog S_CCE8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
PARMSK(3) = num$([M:HAE1]DIE(7))
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CCE8(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M:HAE1]DIE(7))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M:HAE1]DIE(7))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE8(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M:HAE1]DIE(7))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$TIT_COL
Gosub TIT_COL From W4GACCENT2
Return


