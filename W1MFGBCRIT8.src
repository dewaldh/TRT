#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management MFGBCRIT8 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:05:34"
A_USER  = "ADMIN"
A_STAMP = "20180828000534"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask MFGBCRIT8 [MFB8]
Gosub HORODAT
Local Inpbox "MFGBCRIT8" From GFONCTION At A_STAMP With A_WINDPREV Mask [MFB8] As [SIM_]
Grizo [MFB8]2
Grizo [MFB8]5
Grizo [MFB8]10
Grizo [MFB8]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MFB8]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=6 : X2(0)=106 : Y1(0)=8 : Y2(0)=10
X1(1)=6 : X2(1)=106 : Y1(1)=11 : Y2(1)=17
X1(2)=6 : X2(2)=106 : Y1(2)=18 : Y2(2)=19
X1(3)=6 : X2(3)=106 : Y1(3)=20 : Y2(3)=21
Return

$ON_MEMO
Return

$ON_FORMULE
Onevent CONTROL Call C_FORMULE(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_FORMULE(zc) From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_FORMULE From W1MFGBCRIT8
Return

Subprog AS_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_FORMULE(zc) From W1MFGBCRIT8
Onkey   2 Titled GBOUTS Call S_FORMULE(zc) From W1MFGBCRIT8
Onkey 144 Titled GBOUTP Call P_FORMULE(zc) From W1MFGBCRIT8
Onkey 146 Titled GBOUTA Call SA_FORMULE(zc) From W1MFGBCRIT8
Gosub _AFF
End

Subprog C_FORMULE(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"10",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "FORMULE" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_FORMULE
Call AM_FORMULE(zc)
If !mkstat & GOBJET
 zoncou = "FORMULE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FORMULE(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZFORMULE)")>indice
 [M]FORMULE(indice) = VALEUR
 Affzo ZFORMULE(indice)
Endif
Gosub _AFF
End

Subprog S_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "10"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FORMULE(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"10") From GOBJET
Gosub _AFF
End

Subprog SA_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "10"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "10"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZFORMULE
Onevent BEFORE_AREA Gosub AV_ZFORMULE From W1MFGBCRIT8
Return

$AV_ZFORMULE
Call LECTEXTRA(zc,"TABFOR","DES","10",num$([M]FORMULE(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_EVRFCY
Onevent INIT_AREA Call D_EVRFCY(zc) From W1MFGBCRIT8
Return

Subprog D_EVRFCY(VALEUR)
Variable Integer VALEUR
If varinit([M]EVRFCY,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

$ON_MAXDAT
Onevent BEFORE_AREA Gosub AV_MAXDAT From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_MAXDAT From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_MAXDAT(zc) From W1MFGBCRIT8
Return

$AV_MAXDAT
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATSTRF) From ADATREL
Chgfmt [M]MAXDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MAXDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MAXDAT(zc) From W1MFGBCRIT8
Gosub _AFF
End

$AMM_MAXDAT
Call AM_MAXDAT(zc)
If !mkstat & GOBJET
 zoncou = "MAXDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MAXDAT(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATSTRF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MAXDAT" : GZNUM = 8047 : Endif
Gosub _AFF
End

Subprog B1_MAXDAT(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATSTRF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATSTRF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MAXDATEND
Onevent BEFORE_AREA Gosub AV_MAXDATEND From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_MAXDATEND From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_MAXDATEND(zc) From W1MFGBCRIT8
Return

$AV_MAXDATEND
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATENDF) From ADATREL
Chgfmt [M]MAXDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MAXDATEND(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MAXDATEND(zc) From W1MFGBCRIT8
Gosub _AFF
End

$AMM_MAXDATEND
Call AM_MAXDATEND(zc)
If !mkstat & GOBJET
 zoncou = "MAXDATEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MAXDATEND(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATENDF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MAXDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_MAXDATEND(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATENDF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATENDF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CHXDAT
Onevent INIT_AREA Call D_CHXDAT(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_CHXDAT(zc) From W1MFGBCRIT8
Return

Subprog D_CHXDAT(VALEUR)
Variable Integer VALEUR
If varinit([M]CHXDAT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CHXDAT(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PJTSTR
Onevent BEFORE_INPUT Call AS_PJTSTR(zc) From W1MFGBCRIT8
Onevent CONTROL Call C_PJTSTR(zc) From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_PJTSTR From W1MFGBCRIT8
Return

Subprog IB_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTSTR(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat=2
 [M]PJTSTR(INDIC) = VALEUR
 Affzo PJTSTR(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_PJTSTR(VALEUR) From SUBSCOB
 If mkstat=2
  [M]PJTSTR(INDIC) = VALEUR
  Affzo PJTSTR(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 130 Titled GBOUT2 Call B2_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 131 Titled GBOUT3 Call B3_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 132 Titled GBOUT4 Call B4_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 172 Titled GBOUT15 Call B15_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 173 Titled GBOUT16 Call B16_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 174 Titled GBOUT17 Call B17_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 175 Titled GBOUT18 Call B18_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 176 Titled GBOUT19 Call B19_PJTSTR(zc) From W1MFGBCRIT8
 Onkey   2 Titled GBOUTS Call S_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 144 Titled GBOUTP Call P_PJTSTR(zc) From W1MFGBCRIT8
 Onkey 146 Titled GBOUTA Call SA_PJTSTR(zc) From W1MFGBCRIT8
Endif
Gosub _AFF
End

Subprog C_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 54671 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

$AMM_PJTSTR
Call AM_PJTSTR(zc)
If !mkstat & GOBJET
 zoncou = "PJTSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 54671 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTSTR(VALEUR) From SUBSCOB
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 54671 : Endif
 If !mkstat & evalue("dim("+clanam([M])+"ZPJTSTR)")>indice
  [M]PJTSTR(indice) = VALEUR
  Affzo ZPJTSTR(indice)
 Endif
Endif
Gosub _AFF
End

Subprog S_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MFB8","PJTSTR",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTSTR
Onevent BEFORE_AREA Gosub AV_ZPJTSTR From W1MFGBCRIT8
Return

$AV_ZPJTSTR
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTSTR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PJTEND
Onevent BEFORE_INPUT Call AS_PJTEND(zc) From W1MFGBCRIT8
Onevent CONTROL Call C_PJTEND(zc) From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_PJTEND From W1MFGBCRIT8
Return

Subprog IB_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTEND(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat=2
 [M]PJTEND(INDIC) = VALEUR
 Affzo PJTEND(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_PJTEND(VALEUR) From SUBSCOB
 If mkstat=2
  [M]PJTEND(INDIC) = VALEUR
  Affzo PJTEND(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJTEND(zc) From W1MFGBCRIT8
 Onkey 130 Titled GBOUT2 Call B2_PJTEND(zc) From W1MFGBCRIT8
 Onkey 131 Titled GBOUT3 Call B3_PJTEND(zc) From W1MFGBCRIT8
 Onkey 132 Titled GBOUT4 Call B4_PJTEND(zc) From W1MFGBCRIT8
 Onkey 172 Titled GBOUT15 Call B15_PJTEND(zc) From W1MFGBCRIT8
 Onkey 173 Titled GBOUT16 Call B16_PJTEND(zc) From W1MFGBCRIT8
 Onkey 174 Titled GBOUT17 Call B17_PJTEND(zc) From W1MFGBCRIT8
 Onkey 175 Titled GBOUT18 Call B18_PJTEND(zc) From W1MFGBCRIT8
 Onkey 176 Titled GBOUT19 Call B19_PJTEND(zc) From W1MFGBCRIT8
 Onkey   2 Titled GBOUTS Call S_PJTEND(zc) From W1MFGBCRIT8
 Onkey 144 Titled GBOUTP Call P_PJTEND(zc) From W1MFGBCRIT8
 Onkey 146 Titled GBOUTA Call SA_PJTEND(zc) From W1MFGBCRIT8
Endif
Gosub _AFF
End

Subprog C_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 54672 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 54672 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]PJTSTR) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 54672 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTEND
Call AM_PJTEND(zc)
If !mkstat & GOBJET
 zoncou = "PJTEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 54672 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZPJTEND)")>indice
 [M]PJTEND(indice) = VALEUR
 Affzo ZPJTEND(indice)
Endif
Gosub _AFF
End

Subprog S_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"MFB8","PJTEND",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MFB8]FCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "MFB8"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MFB8]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MFB8]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTEND
Onevent BEFORE_AREA Gosub AV_ZPJTEND From W1MFGBCRIT8
Return

$AV_ZPJTEND
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTEND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_VCRNUMSTR
Onevent CONTROL Call C_VCRNUMSTR(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_VCRNUMSTR(zc) From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_VCRNUMSTR From W1MFGBCRIT8
Return

Subprog AS_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRNUMSTR(VALEUR) From SUBSCOB
If mkstat=2
 [M]VCRNUMSTR(INDIC) = VALEUR
 Affzo VCRNUMSTR(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRNUMSTR(zc) From W1MFGBCRIT8
Gosub _AFF
End

Subprog C_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMSTR" : GZNUM = 3170 : Endif
Endif
Gosub _AFF
End

$AMM_VCRNUMSTR
Call AM_VCRNUMSTR(zc)
If !mkstat & GOBJET
 zoncou = "VCRNUMSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRNUMSTR(VALEUR) From SUBSCOB
If mkstat : GERR = 1 : GZONE = "VCRNUMSTR" : GZNUM = 3170 : Endif
Gosub _AFF
End

Subprog S_VCRNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:PPI1]POHFCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRNUMEND
Onevent CONTROL Call C_VCRNUMEND(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_VCRNUMEND(zc) From W1MFGBCRIT8
Return

Subprog AS_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRNUMEND(VALEUR) From SUBSCOB
If mkstat=2
 [M]VCRNUMEND(INDIC) = VALEUR
 Affzo VCRNUMEND(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRNUMEND(zc) From W1MFGBCRIT8
Gosub _AFF
End

Subprog C_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]VCRNUMSTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:PPI1]POHFCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORISTR
Onevent CONTROL Call C_VCRORISTR(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_VCRORISTR(zc) From W1MFGBCRIT8
Onevent AFTER_CHANGE Gosub AMM_VCRORISTR From W1MFGBCRIT8
Return

Subprog AS_VCRORISTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRORISTR(VALEUR) From SUBSCOB
If mkstat=2
 [M]VCRORISTR(INDIC) = VALEUR
 Affzo VCRORISTR(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRORISTR(zc) From W1MFGBCRIT8
Gosub _AFF
End

Subprog C_VCRORISTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Endif
Gosub _AFF
End

$AMM_VCRORISTR
Call AM_VCRORISTR(zc)
If !mkstat & GOBJET
 zoncou = "VCRORISTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRORISTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRORISTR(VALEUR) From SUBSCOB
If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Gosub _AFF
End

Subprog S_VCRORISTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRORI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRORI"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:PPI1]POHFCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRORI","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORIEND
Onevent CONTROL Call C_VCRORIEND(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_VCRORIEND(zc) From W1MFGBCRIT8
Return

Subprog AS_VCRORIEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRORIEND(VALEUR) From SUBSCOB
If mkstat=2
 [M]VCRORIEND(INDIC) = VALEUR
 Affzo VCRORIEND(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRORIEND(zc) From W1MFGBCRIT8
Gosub _AFF
End

Subprog C_VCRORIEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M:MFB8]VCRORISTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRORIEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRORI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRORI"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = [M:PPI1]POHFCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRORI","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MRPFLG
Onevent INIT_AREA Call D_MRPFLG(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_MRPFLG(zc) From W1MFGBCRIT8
Return

Subprog D_MRPFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]MRPFLG,indice)=0
 VALEUR = 3
Endif
Gosub _AFF
End

Subprog AS_MRPFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_SRTCOD
Onevent INIT_AREA Call D_SRTCOD(zc) From W1MFGBCRIT8
Onevent BEFORE_INPUT Call AS_SRTCOD(zc) From W1MFGBCRIT8
Return

Subprog D_SRTCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]SRTCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SRTCOD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FCY
Return

$ON_PLANNER
Return

$CHG_STY
Return


