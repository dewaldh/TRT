#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management CONSCSN1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [27/08/2018]
A_HEURE = "23:56:21"
A_USER  = "ADMIN"
A_STAMP = "20180827235621"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CONSCSN1 [CSN1]
Gosub HORODAT
Local Inpbox "CONSCSN1" From GFONCTION At A_STAMP With A_WINDPREV Mask [CSN1] As [SIM_]
Grizo [CSN1]5
Grizo [CSN1]10
Grizo [CSN1]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [CSN1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=87 : Y1(0)=1 : Y2(0)=6
X1(1)=88 : X2(1)=118 : Y1(1)=1 : Y2(1)=6
X1(2)=119 : X2(2)=156 : Y1(2)=1 : Y2(2)=6
Return

$ON_CPY
Onevent CONTROL Call C_CPY(zc) From W1CONSCSN1
Onevent BEFORE_AREA Gosub AV_CPY From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_CPY From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_CPY(zc) From W1CONSCSN1
Return

$AV_CPY
## Action STD
Call AV_CPY(zc) From CNSCSNSTD
Gosub _AFF
Return

Subprog AS_CPY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3529,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_CPY(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_CPY(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_CPY(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_CPY(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_CPY(VALEUR)
Variable Char    VALEUR()
## Action ACONTCPY
Call CONTSOC(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CPY","!A",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
 If !mkstat
  ## Action STD
  Call C_CPY(VALEUR) From CNSCSNSTD
  If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_CPY
Call AM_CPY(zc)
If !mkstat & GOBJET
 zoncou = "CPY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPY(VALEUR) From CNSCSNSTD
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZCPY)")>indice
 [M]CPY(indice) = VALEUR
 Affzo ZCPY(indice)
Endif
Gosub _AFF
End

Subprog S_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CPY"
PARMSK(2) = "!A"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CPY(VALEUR)
Variable Char    VALEUR()
Call OBJET("CPY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CPY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CPY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCPY
Onevent BEFORE_AREA Gosub AV_ZCPY From W1CONSCSN1
Return

$AV_ZCPY
If clalev([F:CPY])=0 : Local File COMPANY [CPY] : Endif
Call LECTURE("CPY",num$([M]CPY(indice)),"") From CONTOBJ
zc = [F:CPY]CPYSHO
Gosub _AFF
Return

$ON_RTNFCY
Onevent CONTROL Call C_RTNFCY(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_RTNFCY From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNFCY(zc) From W1CONSCSN1
Return

Subprog AS_RTNFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_RTNFCY(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_RTNFCY(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_RTNFCY(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_RTNFCY(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_RTNFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "RTNFCY" : GZNUM = 2788 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "RTNFCY" : GZNUM = 2788 : Endif
 If !mkstat
  ## Action CONTFCY
  Call CONTFCY(VALEUR) From EXEFNC
  If mkstat : GERR = 1 : GZONE = "RTNFCY" : GZNUM = 2788 : Endif
  If !mkstat
   ## Action STD
   Call C_RTNFCY(VALEUR) From CNSCSNSTD
   If mkstat : GERR = 1 : GZONE = "RTNFCY" : GZNUM = 2788 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_RTNFCY
Call AM_RTNFCY(zc)
If !mkstat & GOBJET
 zoncou = "RTNFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_RTNFCY(VALEUR) From CNSCSNSTD
If mkstat : GERR = 1 : GZONE = "RTNFCY" : GZNUM = 2788 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZRTNFCY)")>indice
 [M]RTNFCY(indice) = VALEUR
 Affzo ZRTNFCY(indice)
Endif
Gosub _AFF
End

Subprog S_RTNFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_RTNFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_RTNFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_RTNFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZRTNFCY
Onevent BEFORE_AREA Gosub AV_ZRTNFCY From W1CONSCSN1
Return

$AV_ZRTNFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]RTNFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYSHO
Gosub _AFF
Return

$ON_BPCNUM
Onevent CONTROL Call C_BPCNUM(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_BPCNUM(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_BPCNUM From W1CONSCSN1
Return

Subprog AS_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1503,GBOUT1) From OBJDIV
Call TEXTE(43545,GBOUT11) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPCNUM(zc) From W1CONSCSN1
Onkey 139 Titled GBOUT11 Call B11_BPCNUM(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_BPCNUM(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_BPCNUM(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_BPCNUM(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPCCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPCCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPCCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 3662 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 3662 : Endif
Endif
Gosub _AFF
End

$AMM_BPCNUM
Call AM_BPCNUM(zc)
If !mkstat & GOBJET
 zoncou = "BPCNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZBPCNUM)")>indice
 [M]BPCNUM(indice) = VALEUR
 Affzo ZBPCNUM(indice)
Endif
Gosub _AFF
End

Subprog S_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPCNUM(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B11_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CUSSEAQ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CUSSEAQ"
 PARMSK(1) = ""
 Call TRAITE_CHAR(VALEUR,PARMSK,"CUSSEAQ","CUSSEAQ","",1,"XYCUSSEAQ") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPCNUM
Onevent BEFORE_AREA Gosub AV_ZBPCNUM From W1CONSCSN1
Return

$AV_ZBPCNUM
If clalev([F:BPC])=0 : Local File BPCUSTOMER [BPC] : Endif
Call LECTURE("BPC",num$([M]BPCNUM(indice)),"") From CONTOBJ
zc = [F:BPC]BPCNAM
Gosub _AFF
Return

$ON_PJTDEB
Onevent BEFORE_INPUT Call AS_PJTDEB(zc) From W1CONSCSN1
Onevent CONTROL Call C_PJTDEB(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_PJTDEB From W1CONSCSN1
Return

Subprog IB_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]PJTDEB(INDIC) = VALEUR
 Affzo PJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTDEB(zc) From W1CONSCSN1
Onkey 130 Titled GBOUT2 Call B2_PJTDEB(zc) From W1CONSCSN1
Onkey 131 Titled GBOUT3 Call B3_PJTDEB(zc) From W1CONSCSN1
Onkey 132 Titled GBOUT4 Call B4_PJTDEB(zc) From W1CONSCSN1
Onkey 172 Titled GBOUT15 Call B15_PJTDEB(zc) From W1CONSCSN1
Onkey 173 Titled GBOUT16 Call B16_PJTDEB(zc) From W1CONSCSN1
Onkey 174 Titled GBOUT17 Call B17_PJTDEB(zc) From W1CONSCSN1
Onkey 175 Titled GBOUT18 Call B18_PJTDEB(zc) From W1CONSCSN1
Onkey 176 Titled GBOUT19 Call B19_PJTDEB(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_PJTDEB(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_PJTDEB(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_PJTDEB(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

$AMM_PJTDEB
Call AM_PJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "PJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTDEB(VALEUR) From CNSCSNSTD
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
 If !mkstat & evalue("dim("+clanam([M])+"ZPJTDEB)")>indice
  [M]PJTDEB(indice) = VALEUR
  Affzo ZPJTDEB(indice)
 Endif
Endif
Gosub _AFF
End

Subprog S_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTDEB(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CSN1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTDEB
Onevent BEFORE_AREA Gosub AV_ZPJTDEB From W1CONSCSN1
Return

$AV_ZPJTDEB
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PJTFIN
Onevent BEFORE_INPUT Call AS_PJTFIN(zc) From W1CONSCSN1
Onevent CONTROL Call C_PJTFIN(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_PJTFIN From W1CONSCSN1
Return

Subprog IB_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]PJTFIN(INDIC) = VALEUR
 Affzo PJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTFIN(zc) From W1CONSCSN1
Onkey 130 Titled GBOUT2 Call B2_PJTFIN(zc) From W1CONSCSN1
Onkey 131 Titled GBOUT3 Call B3_PJTFIN(zc) From W1CONSCSN1
Onkey 132 Titled GBOUT4 Call B4_PJTFIN(zc) From W1CONSCSN1
Onkey 172 Titled GBOUT15 Call B15_PJTFIN(zc) From W1CONSCSN1
Onkey 173 Titled GBOUT16 Call B16_PJTFIN(zc) From W1CONSCSN1
Onkey 174 Titled GBOUT17 Call B17_PJTFIN(zc) From W1CONSCSN1
Onkey 175 Titled GBOUT18 Call B18_PJTFIN(zc) From W1CONSCSN1
Onkey 176 Titled GBOUT19 Call B19_PJTFIN(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_PJTFIN(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_PJTFIN(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_PJTFIN(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
 If !mkstat
  ## Action CTLALPVALW
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CTLALPVALW"
  PARMSK(1) = [M]PJTDEB
  Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTFIN
Call AM_PJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZPJTFIN)")>indice
 [M]PJTFIN(indice) = VALEUR
 Affzo ZPJTFIN(indice)
Endif
Gosub _AFF
End

Subprog S_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTFIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CSN1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CSN1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTFIN
Onevent BEFORE_AREA Gosub AV_ZPJTFIN From W1CONSCSN1
Return

$AV_ZPJTFIN
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RTNDATDEB
Onevent BEFORE_AREA Gosub AV_RTNDATDEB From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_RTNDATDEB From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNDATDEB(zc) From W1CONSCSN1
Return

$AV_RTNDATDEB
## Action ADATRELI
Call INIDAT(zc,[M:CCSN]RTNDATDEBF) From ADATREL
Chgfmt [M]RTNDATDEB(indice) With "DzZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_RTNDATDEB(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_RTNDATDEB(zc) From W1CONSCSN1
Gosub _AFF
End

$AMM_RTNDATDEB
Call AM_RTNDATDEB(zc)
If !mkstat & GOBJET
 zoncou = "RTNDATDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNDATDEB(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M:CCSN]RTNDATDEBF) From ADATREL
If mkstat : GERR = 1 : GZONE = "RTNDATDEB" : GZNUM = 1805 : Endif
If !mkstat
 ## Action STD
 Call AM_RTNDATDEB(VALEUR) From CNSCSNSTD
 If mkstat : GERR = 1 : GZONE = "RTNDATDEB" : GZNUM = 1805 : Endif
Endif
Gosub _AFF
End

Subprog B1_RTNDATDEB(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M:CCSN]RTNDATDEBF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M:CCSN]RTNDATDEBF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_RTNDATFIN
Onevent BEFORE_AREA Gosub AV_RTNDATFIN From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_RTNDATFIN From W1CONSCSN1
Onevent CONTROL Call C_RTNDATFIN(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNDATFIN(zc) From W1CONSCSN1
Return

$AV_RTNDATFIN
## Action ADATRELI
Call INIDAT(zc,[M:CCSN]RTNDATFINF) From ADATREL
Chgfmt [M]RTNDATFIN(indice) With "DzZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_RTNDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_RTNDATFIN(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_RTNDATFIN(VALEUR)
Variable Date    VALEUR
## Action DATDEBFIN
Call DATDEBFIN(VALEUR,[M]RTNDATDEB) From EXEFNC
If mkstat : GERR = 1 : GZONE = "RTNDATFIN" : GZNUM = 1806 : Endif
Gosub _AFF
End

$AMM_RTNDATFIN
Call AM_RTNDATFIN(zc)
If !mkstat & GOBJET
 zoncou = "RTNDATFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNDATFIN(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M:CCSN]RTNDATFINF) From ADATREL
If mkstat : GERR = 1 : GZONE = "RTNDATFIN" : GZNUM = 1806 : Endif
Gosub _AFF
End

Subprog B1_RTNDATFIN(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M:CCSN]RTNDATFINF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M:CCSN]RTNDATFINF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CUR
Return

$ON_ZCUR
Onevent BEFORE_AREA Gosub AV_ZCUR From W1CONSCSN1
Return

$AV_ZCUR
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CUR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_CURD
Return

$ON_ZCURD
Onevent BEFORE_AREA Gosub AV_ZCURD From W1CONSCSN1
Return

$AV_ZCURD
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CURD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RTNTYPNOR
Onevent AFTER_CHANGE Gosub AMM_RTNTYPNOR From W1CONSCSN1
Onevent INIT_AREA Call D_RTNTYPNOR(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNTYPNOR(zc) From W1CONSCSN1
Return

Subprog D_RTNTYPNOR(VALEUR)
Variable Integer VALEUR
If varinit([M]RTNTYPNOR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_RTNTYPNOR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_RTNTYPNOR
Call AM_RTNTYPNOR(zc)
If !mkstat & GOBJET
 zoncou = "RTNTYPNOR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNTYPNOR(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_RTNTYPNOR(VALEUR) From CNSCSNSTD
If mkstat : GERR = 1 : GZONE = "RTNTYPNOR" : GZNUM = 21741 : Endif
Gosub _AFF
End

$ON_SRHTYPNOR
Onevent CONTROL Call C_SRHTYPNOR(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_SRHTYPNOR(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_SRHTYPNOR From W1CONSCSN1
Return

Subprog IB_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(30251,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_SRHTYPNOR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_SRHTYPNOR(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_SRHTYPNOR(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_SRHTYPNOR(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_SRHTYPNOR(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
## Action CONTTRE
Call CONTTRE(VALEUR,"","CSN1","SRHTYPNOR",[M:CSN1]RTNFCY,"",1,[M:CSN1]CPY) From SUBTRE
If mkstat : GERR = 1 : GZONE = "SRHTYPNOR" : GZNUM = 29036 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SRHTYPNOR" : GZNUM = 29036 : Endif
Endif
Gosub _AFF
End

$AMM_SRHTYPNOR
Call AM_SRHTYPNOR(zc)
If !mkstat & GOBJET
 zoncou = "SRHTYPNOR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSRHTYPNOR)")>indice
 [M]SRHTYPNOR(indice) = VALEUR
 Affzo ZSRHTYPNOR(indice)
Endif
Gosub _AFF
End

Subprog S_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTRE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTRE"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSN1]RTNFCY
 PARMSK(3) = ""
 PARMSK(4) = "1"
 PARMSK(5) = [M:CSN1]CPY
 PARMSK(6) = "CSN1"
 PARMSK(7) = "SRHTYPNOR"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTRE","SUBTRE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTRE
 Call TUNTRE(VALEUR,"") From SUBTRE
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TRE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SRHTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSRHTYPNOR
Onevent BEFORE_AREA Gosub AV_ZSRHTYPNOR From W1CONSCSN1
Return

$AV_ZSRHTYPNOR
Call LECTEXTRA(zc,"TABSRHTYP","SHOAXX",num$([M]SRHTYPNOR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RTNTYPLND
Onevent AFTER_CHANGE Gosub AMM_RTNTYPLND From W1CONSCSN1
Onevent INIT_AREA Call D_RTNTYPLND(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNTYPLND(zc) From W1CONSCSN1
Return

Subprog D_RTNTYPLND(VALEUR)
Variable Integer VALEUR
If varinit([M]RTNTYPLND,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_RTNTYPLND(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_RTNTYPLND
Call AM_RTNTYPLND(zc)
If !mkstat & GOBJET
 zoncou = "RTNTYPLND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNTYPLND(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_RTNTYPLND(VALEUR) From CNSCSNSTD
If mkstat : GERR = 1 : GZONE = "RTNTYPLND" : GZNUM = 1695 : Endif
Gosub _AFF
End

$ON_SRHTYPLND
Onevent CONTROL Call C_SRHTYPLND(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_SRHTYPLND(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_SRHTYPLND From W1CONSCSN1
Return

Subprog IB_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(30251,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_SRHTYPLND(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_SRHTYPLND(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_SRHTYPLND(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_SRHTYPLND(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_SRHTYPLND(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
## Action CONTTRE
Call CONTTRE(VALEUR,"","CSN1","SRHTYPLND",[M:CSN1]RTNFCY,"",2,[M:CSN1]CPY) From SUBTRE
If mkstat : GERR = 1 : GZONE = "SRHTYPLND" : GZNUM = 29036 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SRHTYPLND" : GZNUM = 29036 : Endif
Endif
Gosub _AFF
End

$AMM_SRHTYPLND
Call AM_SRHTYPLND(zc)
If !mkstat & GOBJET
 zoncou = "SRHTYPLND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSRHTYPLND)")>indice
 [M]SRHTYPLND(indice) = VALEUR
 Affzo ZSRHTYPLND(indice)
Endif
Gosub _AFF
End

Subprog S_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTRE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTRE"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSN1]RTNFCY
 PARMSK(3) = ""
 PARMSK(4) = "2"
 PARMSK(5) = [M:CSN1]CPY
 PARMSK(6) = "CSN1"
 PARMSK(7) = "SRHTYPLND"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTRE","SUBTRE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTRE
 Call TUNTRE(VALEUR,"") From SUBTRE
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TRE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SRHTYPLND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSRHTYPLND
Onevent BEFORE_AREA Gosub AV_ZSRHTYPLND From W1CONSCSN1
Return

$AV_ZSRHTYPLND
Call LECTEXTRA(zc,"TABSRHTYP","SHOAXX",num$([M]SRHTYPLND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RTNTYPSCO
Onevent AFTER_CHANGE Gosub AMM_RTNTYPSCO From W1CONSCSN1
Onevent INIT_AREA Call D_RTNTYPSCO(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_RTNTYPSCO(zc) From W1CONSCSN1
Return

Subprog D_RTNTYPSCO(VALEUR)
Variable Integer VALEUR
If varinit([M]RTNTYPSCO,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_RTNTYPSCO(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_RTNTYPSCO
Call AM_RTNTYPSCO(zc)
If !mkstat & GOBJET
 zoncou = "RTNTYPSCO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RTNTYPSCO(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_RTNTYPSCO(VALEUR) From CNSCSNSTD
If mkstat : GERR = 1 : GZONE = "RTNTYPSCO" : GZNUM = 5727 : Endif
Gosub _AFF
End

$ON_SRHTYPSCO
Onevent CONTROL Call C_SRHTYPSCO(zc) From W1CONSCSN1
Onevent BEFORE_INPUT Call AS_SRHTYPSCO(zc) From W1CONSCSN1
Onevent AFTER_CHANGE Gosub AMM_SRHTYPSCO From W1CONSCSN1
Return

Subprog IB_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(30251,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_SRHTYPSCO(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_SRHTYPSCO(zc) From W1CONSCSN1
Onkey   2 Titled GBOUTS Call S_SRHTYPSCO(zc) From W1CONSCSN1
Onkey 144 Titled GBOUTP Call P_SRHTYPSCO(zc) From W1CONSCSN1
Onkey 146 Titled GBOUTA Call SA_SRHTYPSCO(zc) From W1CONSCSN1
Gosub _AFF
End

Subprog C_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
## Action CONTTRE
Call CONTTRE(VALEUR,"","CSN1","SRHTYPSCO",[M:CSN1]RTNFCY,"",3,[M:CSN1]CPY) From SUBTRE
If mkstat : GERR = 1 : GZONE = "SRHTYPSCO" : GZNUM = 29036 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SRHTYPSCO" : GZNUM = 29036 : Endif
Endif
Gosub _AFF
End

$AMM_SRHTYPSCO
Call AM_SRHTYPSCO(zc)
If !mkstat & GOBJET
 zoncou = "SRHTYPSCO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSRHTYPSCO)")>indice
 [M]SRHTYPSCO(indice) = VALEUR
 Affzo ZSRHTYPSCO(indice)
Endif
Gosub _AFF
End

Subprog S_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTRE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTRE"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSN1]RTNFCY
 PARMSK(3) = ""
 PARMSK(4) = "3"
 PARMSK(5) = [M:CSN1]CPY
 PARMSK(6) = "CSN1"
 PARMSK(7) = "SRHTYPSCO"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTRE","SUBTRE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTRE
 Call TUNTRE(VALEUR,"") From SUBTRE
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TRE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SRHTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSRHTYPSCO
Onevent BEFORE_AREA Gosub AV_ZSRHTYPSCO From W1CONSCSN1
Return

$AV_ZSRHTYPSCO
Call LECTEXTRA(zc,"TABSRHTYP","SHOAXX",num$([M]SRHTYPSCO(indice)),"") From ATEXTRA
Gosub _AFF
Return

$CHG_STY
Return


