#<AdxTL>@(#)0.0.0.0 $Revision$Class Customer invoices
# Sage X3 supervisor
## ACLA-CLASSE ## SINVOICE
# 2018-06-20 06:58:48 109

####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 31 : BPRFCT Factor ( Field FCT 15)
####################################################################

$SET_BPRFCT
If [L]_AOLDVAL<>this.BPRFCT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPRFCT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPRFCT
 Gosub PROPAGATE_BPRFCT
Endif
Return

$INIT_BPRFCT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPRFCT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPRFCT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPRFCT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPRFCT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPRFCT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPRFCT
[L]CURPRO = "BPRFCT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPRFCT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPRFCT
[L]CURPRO = "BPRFCT"
If vireblc(this.BPRFCT,2)<>vireblc(format$("K:15c",this.BPRFCT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPRFCT
[L]CURPRO = "BPRFCT"
If vireblc(this.BPRFCT,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCT.ACTRLREF(this,"BPRFCT",this.BPRFCT,this.BPRFCT,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPRFCT<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPRFCT
[L]CURPRO = "BPRFCT"
Return

$PROPAGATE_BPRFCT
this.isReadonly = 0
[L]CURPRO = "BPRFCT"
Gosub _LNKPRO_BPRFCT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPRFCT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPRFCT"
$_LNKPRO_BPRFCT
If vireblc(this.BPRFCT,2)<>""
 # Link FACTOR
 Local File FACTOR [WFCT]
 Read [F:WFCT]FCT0 = this.BPRFCT
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPRFCT","$title",[F:WFCT]FCTNAM)
 Endif
 LogicClose File [WFCT]
Endif
Return


####################################################################
# 32 : FCTVCR Receipt ( Field VCR 20)
####################################################################

$SET_FCTVCR
If [L]_AOLDVAL<>this.FCTVCR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_FCTVCR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.FCTVCR
 Gosub PROPAGATE_FCTVCR
Endif
Return

$INIT_FCTVCR
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_FCTVCR
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_FCTVCR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_FCTVCR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_FCTVCR
[L]CURPRO = "FCTVCR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.FCTVCR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_FCTVCR
[L]CURPRO = "FCTVCR"
If vireblc(this.FCTVCR,2)<>vireblc(format$("K:20X",this.FCTVCR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_FCTVCR
[L]CURPRO = "FCTVCR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_FCTVCR
[L]CURPRO = "FCTVCR"
Return

$PROPAGATE_FCTVCR
this.isReadonly = 0
[L]CURPRO = "FCTVCR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_FCTVCR
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCR"
$_LNKPRO_FCTVCR
Return


####################################################################
# 33 : FCTVCRFLG Validated receipt ( Field C 1)
####################################################################

$SET_FCTVCRFLG
If [L]_AOLDVAL<>this.FCTVCRFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_FCTVCRFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.FCTVCRFLG
 Gosub PROPAGATE_FCTVCRFLG
Endif
Return

$INIT_FCTVCRFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCRFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_FCTVCRFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCRFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_FCTVCRFLG             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_FCTVCRFLG             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_FCTVCRFLG
[L]CURPRO = "FCTVCRFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.FCTVCRFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_FCTVCRFLG
[L]CURPRO = "FCTVCRFLG"
Return

$_AOTHERS_FCTVCRFLG
[L]CURPRO = "FCTVCRFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_FCTVCRFLG
[L]CURPRO = "FCTVCRFLG"
Return

$PROPAGATE_FCTVCRFLG
this.isReadonly = 0
[L]CURPRO = "FCTVCRFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_FCTVCRFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "FCTVCRFLG"
$_LNKPRO_FCTVCRFLG
Return


####################################################################
# 34 : QTCACCNUM Receipt actng. entry no. ( Field L 8)
####################################################################

$SET_QTCACCNUM
If [L]_AOLDVAL<>this.QTCACCNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_QTCACCNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.QTCACCNUM
 Gosub PROPAGATE_QTCACCNUM
Endif
Return

$INIT_QTCACCNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "QTCACCNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_QTCACCNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "QTCACCNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_QTCACCNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_QTCACCNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_QTCACCNUM
[L]CURPRO = "QTCACCNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.QTCACCNUM=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_QTCACCNUM
[L]CURPRO = "QTCACCNUM"
Return

$_AOTHERS_QTCACCNUM
[L]CURPRO = "QTCACCNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_QTCACCNUM
[L]CURPRO = "QTCACCNUM"
Return

$PROPAGATE_QTCACCNUM
this.isReadonly = 0
[L]CURPRO = "QTCACCNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_QTCACCNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "QTCACCNUM"
$_LNKPRO_QTCACCNUM
Return


####################################################################
# 35 : STRDUDDAT Due date basis ( Field D)
####################################################################

$SET_STRDUDDAT
If [L]_AOLDVAL<>this.STRDUDDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_STRDUDDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.STRDUDDAT
 Gosub PROPAGATE_STRDUDDAT
Endif
Return

$INIT_STRDUDDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STRDUDDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_STRDUDDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STRDUDDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_STRDUDDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_STRDUDDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_STRDUDDAT
[L]CURPRO = "STRDUDDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.STRDUDDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_STRDUDDAT
[L]CURPRO = "STRDUDDAT"
Return

$_AOTHERS_STRDUDDAT
[L]CURPRO = "STRDUDDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_STRDUDDAT
[L]CURPRO = "STRDUDDAT"
Return

$PROPAGATE_STRDUDDAT
this.isReadonly = 0
[L]CURPRO = "STRDUDDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_STRDUDDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STRDUDDAT"
$_LNKPRO_STRDUDDAT
Return


####################################################################
# 36 : PTE Payment term ( Field PTE 15)
####################################################################

$SET_PTE
If [L]_AOLDVAL<>this.PTE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PTE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PTE
 Gosub PROPAGATE_PTE
Endif
Return

$INIT_PTE
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PTE
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PTE                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PTE                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PTE
[L]CURPRO = "PTE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PTE,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PTE
[L]CURPRO = "PTE"
If vireblc(this.PTE,2)<>vireblc(format$("K:15c",this.PTE),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PTE
[L]CURPRO = "PTE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PTE
[L]CURPRO = "PTE"
If vireblc(this.PTE,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPPTE.ACTRLREF(this,"PTE",this.PTE,this.PTE,this.PTE_LEG,1,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.PTE<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_PTE
this.isReadonly = 0
[L]CURPRO = "PTE"
Gosub _LNKPRO_PTE
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PTE
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE"
$_LNKPRO_PTE
If vireblc(this.PTE,2)<>""
 # Link TABPAYTERM
 Local File TABPAYTERM [WTPT]
 Read [F:WTPT]TPT0 = this.PTE;this.PTE_LEG;1
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="SHOAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="DESAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTPT]
Endif
Return

$_ALOADATTRIBUTE_PTE
[L]ASTATUS = fmet this.ASETATTRIBUTE("PTE","$isMandatory","true")
Return


####################################################################
# 37 : PTE_LEG Legislation ( Field Miscellaneous table number)
####################################################################

$SET_PTE_LEG
If [L]_AOLDVAL<>this.PTE_LEG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PTE_LEG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PTE_LEG
 Gosub PROPAGATE_PTE_LEG
Endif
Return

$INIT_PTE_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"PTE_LEG",this.PTE_LEG,909)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PTE_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE_LEG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PTE_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PTE_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PTE_LEG
[L]CURPRO = "PTE_LEG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PTE_LEG,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PTE_LEG
[L]CURPRO = "PTE_LEG"
If vireblc(this.PTE_LEG,2)<>vireblc(format$("K:20B",this.PTE_LEG),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PTE_LEG
[L]CURPRO = "PTE_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"PTE_LEG",this.PTE_LEG,909,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PTE_LEG
[L]CURPRO = "PTE_LEG"
Return

$PROPAGATE_PTE_LEG
this.isReadonly = 0
[L]CURPRO = "PTE_LEG"
Gosub _LNKPRO_PTE_LEG
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PTE_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "PTE_LEG"
$_LNKPRO_PTE_LEG
If vireblc(this.PTE_LEG,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 909;this.PTE_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE_LEG","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE_LEG","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 38 : DEP Early discount/Late charge ( Field TDA 5)
####################################################################

$SET_DEP
If [L]_AOLDVAL<>this.DEP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEP
 Gosub PROPAGATE_DEP
Endif
Return

$INIT_DEP
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEP
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEP
[L]CURPRO = "DEP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DEP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEP
[L]CURPRO = "DEP"
If vireblc(this.DEP,2)<>vireblc(format$("K:5c",this.DEP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DEP
[L]CURPRO = "DEP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEP
[L]CURPRO = "DEP"
If vireblc(this.DEP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTDA.ACTRLREF(this,"DEP",this.DEP,this.DEP,this.DEP_LEG,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.DEP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_DEP
this.isReadonly = 0
[L]CURPRO = "DEP"
Gosub _LNKPRO_DEP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEP
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP"
$_LNKPRO_DEP
If vireblc(this.DEP,2)<>""
 # Link TABDEPAGIO
 Local File TABDEPAGIO [WTDA]
 Read [F:WTDA]TDA0 = this.DEP;this.DEP_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABDEPAGIO" & ZONE="SHOAXX" & IDENT1=[F:WTDA]DEP & IDENT2=[F:WTDA]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABDEPAGIO" & ZONE="DESAXX" & IDENT1=[F:WTDA]DEP & IDENT2=[F:WTDA]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTDA]
Endif
Return


####################################################################
# 39 : DEP_LEG Legislation ( Field Miscellaneous table number)
####################################################################

$SET_DEP_LEG
If [L]_AOLDVAL<>this.DEP_LEG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEP_LEG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEP_LEG
 Gosub PROPAGATE_DEP_LEG
Endif
Return

$INIT_DEP_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"DEP_LEG",this.DEP_LEG,909)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEP_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP_LEG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEP_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEP_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEP_LEG
[L]CURPRO = "DEP_LEG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DEP_LEG,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEP_LEG
[L]CURPRO = "DEP_LEG"
If vireblc(this.DEP_LEG,2)<>vireblc(format$("K:20B",this.DEP_LEG),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DEP_LEG
[L]CURPRO = "DEP_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"DEP_LEG",this.DEP_LEG,909,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEP_LEG
[L]CURPRO = "DEP_LEG"
Return

$PROPAGATE_DEP_LEG
this.isReadonly = 0
[L]CURPRO = "DEP_LEG"
Gosub _LNKPRO_DEP_LEG
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEP_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DEP_LEG"
$_LNKPRO_DEP_LEG
If vireblc(this.DEP_LEG,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 909;this.DEP_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP_LEG","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP_LEG","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 40 : VAC Tax rule ( Field TVB 5)
####################################################################

$SET_VAC
If [L]_AOLDVAL<>this.VAC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VAC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VAC
 Gosub PROPAGATE_VAC
Endif
Return

$INIT_VAC
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VAC
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VAC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VAC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VAC
[L]CURPRO = "VAC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VAC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VAC
[L]CURPRO = "VAC"
If vireblc(this.VAC,2)<>vireblc(format$("K:5c",this.VAC),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VAC
[L]CURPRO = "VAC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VAC
[L]CURPRO = "VAC"
If vireblc(this.VAC,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTVB.ACTRLREF(this,"VAC",this.VAC,this.VAC,this.VAC_LEG,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.VAC<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_VAC
this.isReadonly = 0
[L]CURPRO = "VAC"
Gosub _LNKPRO_VAC
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VAC
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC"
$_LNKPRO_VAC
If vireblc(this.VAC,2)<>""
 # Link TABVACBPR
 Local File TABVACBPR [WTVB]
 Read [F:WTVB]TVB0 = this.VAC;this.VAC_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="SHOAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAC","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="DESAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAC","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVB]
Endif
Return

$_ALOADATTRIBUTE_VAC
[L]ASTATUS = fmet this.ASETATTRIBUTE("VAC","$isMandatory","true")
Return


####################################################################
# 41 : VAC_LEG Legislation ( Field Miscellaneous table number)
####################################################################

$SET_VAC_LEG
If [L]_AOLDVAL<>this.VAC_LEG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VAC_LEG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VAC_LEG
 Gosub PROPAGATE_VAC_LEG
Endif
Return

$INIT_VAC_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"VAC_LEG",this.VAC_LEG,909)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VAC_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC_LEG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VAC_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VAC_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VAC_LEG
[L]CURPRO = "VAC_LEG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VAC_LEG,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VAC_LEG
[L]CURPRO = "VAC_LEG"
If vireblc(this.VAC_LEG,2)<>vireblc(format$("K:20B",this.VAC_LEG),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VAC_LEG
[L]CURPRO = "VAC_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"VAC_LEG",this.VAC_LEG,909,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VAC_LEG
[L]CURPRO = "VAC_LEG"
Return

$PROPAGATE_VAC_LEG
this.isReadonly = 0
[L]CURPRO = "VAC_LEG"
Gosub _LNKPRO_VAC_LEG
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VAC_LEG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VAC_LEG"
$_LNKPRO_VAC_LEG
If vireblc(this.VAC_LEG,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 909;this.VAC_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAC_LEG","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAC_LEG","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 42 : SSTENTCOD Entity/Use ( Field Miscellaneous table number)
####################################################################

$SET_SSTENTCOD
If [L]_AOLDVAL<>this.SSTENTCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SSTENTCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SSTENTCOD
 Gosub PROPAGATE_SSTENTCOD
Endif
Return

$INIT_SSTENTCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SSTENTCOD"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"SSTENTCOD",this.SSTENTCOD,202)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SSTENTCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SSTENTCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SSTENTCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SSTENTCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SSTENTCOD
[L]CURPRO = "SSTENTCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SSTENTCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SSTENTCOD
[L]CURPRO = "SSTENTCOD"
If vireblc(this.SSTENTCOD,2)<>vireblc(format$("K:20B",this.SSTENTCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SSTENTCOD
[L]CURPRO = "SSTENTCOD"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"SSTENTCOD",this.SSTENTCOD,202,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SSTENTCOD
[L]CURPRO = "SSTENTCOD"
Return

$PROPAGATE_SSTENTCOD
this.isReadonly = 0
[L]CURPRO = "SSTENTCOD"
Gosub _LNKPRO_SSTENTCOD
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SSTENTCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SSTENTCOD"
$_LNKPRO_SSTENTCOD
If vireblc(this.SSTENTCOD,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 202;this.SSTENTCOD
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SSTENTCOD","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SSTENTCOD","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 43 : DIRINVFLG Direct inv ( Field Local menu number 1)
####################################################################

$SET_DIRINVFLG
If [L]_AOLDVAL<>this.DIRINVFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DIRINVFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DIRINVFLG
 Gosub PROPAGATE_DIRINVFLG
Endif
Return

$INIT_DIRINVFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DIRINVFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.DIRINVFLG=0 and fmet this.AGETATTRIBUTE("DIRINVFLG","$isMandatory")="true"
 this.DIRINVFLG = 1
Endif
Return
 
$CONTROL_DIRINVFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DIRINVFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DIRINVFLG             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DIRINVFLG             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DIRINVFLG
[L]CURPRO = "DIRINVFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DIRINVFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DIRINVFLG
[L]CURPRO = "DIRINVFLG"
If this.DIRINVFLG<0 or this.DIRINVFLG>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.DIRINVFLG)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_DIRINVFLG
[L]CURPRO = "DIRINVFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DIRINVFLG
[L]CURPRO = "DIRINVFLG"
Return

$PROPAGATE_DIRINVFLG
this.isReadonly = 0
[L]CURPRO = "DIRINVFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DIRINVFLG
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "DIRINVFLG"
$_LNKPRO_DIRINVFLG
Return


####################################################################
# 44 : EECNUMDEB EU Intrastat ( Field C 4)
####################################################################

$SET_EECNUMDEB
If [L]_AOLDVAL<>this.EECNUMDEB
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECNUMDEB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECNUMDEB
 Gosub PROPAGATE_EECNUMDEB
Endif
Return

$INIT_EECNUMDEB
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EECNUMDEB
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "EECNUMDEB"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECNUMDEB             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECNUMDEB             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EECNUMDEB=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
Return

$_AOTHERS_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
Return

$PROPAGATE_EECNUMDEB
this.isReadonly = 0
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECNUMDEB
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "EECNUMDEB"
$_LNKPRO_EECNUMDEB
Return


####################################################################
# 45 : STA Status ( Field Local menu number 2261)
####################################################################

$SET_STA
If [L]_AOLDVAL<>this.STA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_STA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.STA
 Gosub PROPAGATE_STA
Endif
Return

$INIT_STA
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.STA=0 and fmet this.AGETATTRIBUTE("STA","$isMandatory")="true"
 this.STA = 1
Endif
Return
 
$CONTROL_STA
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_STA                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_STA                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_STA
[L]CURPRO = "STA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.STA=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_STA
[L]CURPRO = "STA"
If this.STA<0 or this.STA>len(mess(0,2261,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2261 ->"-num$(this.STA)-mess(99,123,1)):  Return : # Local menu "2261 -> Invalid option
Endif
Return

$_AOTHERS_STA
[L]CURPRO = "STA"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_STA
[L]CURPRO = "STA"
Return

$PROPAGATE_STA
this.isReadonly = 0
[L]CURPRO = "STA"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_STA
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "STA"
$_LNKPRO_STA
Return


####################################################################
# 47 : INVNUM Invoice number ( Field VCR 20)
####################################################################

$SET_INVNUM
If [L]_AOLDVAL<>this.INVNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_INVNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.INVNUM
 Gosub PROPAGATE_INVNUM
Endif
Return

$INIT_INVNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "INVNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_INVNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "INVNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_INVNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_INVNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_INVNUM
[L]CURPRO = "INVNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.INVNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_INVNUM
[L]CURPRO = "INVNUM"
If vireblc(this.INVNUM,2)<>vireblc(format$("K:20X",this.INVNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_INVNUM
[L]CURPRO = "INVNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_INVNUM
[L]CURPRO = "INVNUM"
Return

$PROPAGATE_INVNUM
this.isReadonly = 0
[L]CURPRO = "INVNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_INVNUM
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "INVNUM"
$_LNKPRO_INVNUM
Return


####################################################################
# 48 : SNS Sign ( Field C 2)
####################################################################

$SET_SNS
If [L]_AOLDVAL<>this.SNS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SNS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SNS
 Gosub PROPAGATE_SNS
Endif
Return

$INIT_SNS
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SNS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SNS
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SNS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SNS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SNS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SNS
[L]CURPRO = "SNS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SNS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SNS
[L]CURPRO = "SNS"
Return

$_AOTHERS_SNS
[L]CURPRO = "SNS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SNS
[L]CURPRO = "SNS"
Return

$PROPAGATE_SNS
this.isReadonly = 0
[L]CURPRO = "SNS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SNS
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "SNS"
$_LNKPRO_SNS
Return


####################################################################
# 49 : AMTATI Amount + tax ( Field MD1 0)
####################################################################

$SET_AMTATI
If [L]_AOLDVAL<>this.AMTATI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTATI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTATI
 Gosub PROPAGATE_AMTATI
Endif
Return

$INIT_AMTATI
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTATI
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTATI
[L]CURPRO = "AMTATI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTATI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTATI
[L]CURPRO = "AMTATI"
Return

$_AOTHERS_AMTATI
[L]CURPRO = "AMTATI"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTATI",this.AMTATI,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTATI
[L]CURPRO = "AMTATI"
Return

$PROPAGATE_AMTATI
this.isReadonly = 0
[L]CURPRO = "AMTATI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTATI
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATI"
$_LNKPRO_AMTATI
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTATI",this.AMTATI,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTATI","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 50 : AMTNOT Amount - tax ( Field MD1 0)
####################################################################

$SET_AMTNOT
If [L]_AOLDVAL<>this.AMTNOT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTNOT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTNOT
 Gosub PROPAGATE_AMTNOT
Endif
Return

$INIT_AMTNOT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTNOT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTNOT
[L]CURPRO = "AMTNOT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTNOT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTNOT
[L]CURPRO = "AMTNOT"
Return

$_AOTHERS_AMTNOT
[L]CURPRO = "AMTNOT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTNOT",this.AMTNOT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTNOT
[L]CURPRO = "AMTNOT"
Return

$PROPAGATE_AMTNOT
this.isReadonly = 0
[L]CURPRO = "AMTNOT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTNOT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOT"
$_LNKPRO_AMTNOT
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTNOT",this.AMTNOT,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTNOT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 51 : AMTNOTL Amount - tax (co) ( Field MD1 0)
####################################################################

$SET_AMTNOTL
If [L]_AOLDVAL<>this.AMTNOTL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTNOTL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTNOTL
 Gosub PROPAGATE_AMTNOTL
Endif
Return

$INIT_AMTNOTL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOTL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTNOTL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOTL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTNOTL
[L]CURPRO = "AMTNOTL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTNOTL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTNOTL
[L]CURPRO = "AMTNOTL"
Return

$_AOTHERS_AMTNOTL
[L]CURPRO = "AMTNOTL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTNOTL",this.AMTNOTL,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTNOTL
[L]CURPRO = "AMTNOTL"
Return

$PROPAGATE_AMTNOTL
this.isReadonly = 0
[L]CURPRO = "AMTNOTL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTNOTL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTNOTL"
$_LNKPRO_AMTNOTL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTNOTL",this.AMTNOTL,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTNOTL","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 52 : AMTATIL Invoice amt. + tax (co) ( Field MD1 0)
####################################################################

$SET_AMTATIL
If [L]_AOLDVAL<>this.AMTATIL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTATIL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTATIL
 Gosub PROPAGATE_AMTATIL
Endif
Return

$INIT_AMTATIL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATIL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTATIL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATIL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTATIL
[L]CURPRO = "AMTATIL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTATIL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTATIL
[L]CURPRO = "AMTATIL"
Return

$_AOTHERS_AMTATIL
[L]CURPRO = "AMTATIL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTATIL",this.AMTATIL,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTATIL
[L]CURPRO = "AMTATIL"
Return

$PROPAGATE_AMTATIL
this.isReadonly = 0
[L]CURPRO = "AMTATIL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTATIL
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "AMTATIL"
$_LNKPRO_AMTATIL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTATIL",this.AMTATIL,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTATIL","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 53 : VATDAT Tax date on credit ( Field D)
####################################################################

$SET_VATDAT
If [L]_AOLDVAL<>this.VATDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VATDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VATDAT
 Gosub PROPAGATE_VATDAT
Endif
Return

$INIT_VATDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VATDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VATDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VATDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VATDAT
[L]CURPRO = "VATDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.VATDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VATDAT
[L]CURPRO = "VATDAT"
Return

$_AOTHERS_VATDAT
[L]CURPRO = "VATDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VATDAT
[L]CURPRO = "VATDAT"
Return

$PROPAGATE_VATDAT
this.isReadonly = 0
[L]CURPRO = "VATDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VATDAT
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "VATDAT"
$_LNKPRO_VATDAT
Return


####################################################################
# 54 : NBRTAX Number of taxes ( Field C 2)
####################################################################

$SET_NBRTAX
If [L]_AOLDVAL<>this.NBRTAX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NBRTAX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NBRTAX
 Gosub PROPAGATE_NBRTAX
Endif
Return

$INIT_NBRTAX
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "NBRTAX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_NBRTAX
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "NBRTAX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NBRTAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NBRTAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NBRTAX
[L]CURPRO = "NBRTAX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.NBRTAX=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NBRTAX
[L]CURPRO = "NBRTAX"
Return

$_AOTHERS_NBRTAX
[L]CURPRO = "NBRTAX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NBRTAX
[L]CURPRO = "NBRTAX"
Return

$PROPAGATE_NBRTAX
this.isReadonly = 0
[L]CURPRO = "NBRTAX"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NBRTAX
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "NBRTAX"
$_LNKPRO_NBRTAX
Return


####################################################################
# 57 : BPAINV Address ( Field ADR 5)
####################################################################

$SET_BPAINV
If [L]_AOLDVAL<>this.BPAINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPAINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPAINV
 Gosub PROPAGATE_BPAINV
Endif
Return

$INIT_BPAINV
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPAINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPAINV
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPAINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPAINV
[L]CURPRO = "BPAINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPAINV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>vireblc(format$("K:5c",this.BPAINV),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPAINV
[L]CURPRO = "BPAINV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPADR.ACTRLREF(this,"BPAINV",this.BPAINV,1,this.BPR,this.BPAINV,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPAINV<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_BPAINV
this.isReadonly = 0
[L]CURPRO = "BPAINV"
Gosub _LNKPRO_BPAINV
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPAINV
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "BPAINV"
$_LNKPRO_BPAINV
If vireblc(this.BPAINV,2)<>""
 # Link BPADDRESS
 Local File BPADDRESS [WBPA]
 Read [F:WBPA]BPA0 = 1;this.BPR;this.BPAINV
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPAINV","$description",[F:WBPA]BPADES)
 Endif
 LogicClose File [WBPA]
Endif
Return


####################################################################
# 60 : POSCOD Postal code ( Field POS 10)
####################################################################

$SET_POSCOD
If [L]_AOLDVAL<>this.POSCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_POSCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.POSCOD
 Gosub PROPAGATE_POSCOD
Endif
Return

$INIT_POSCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "POSCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_POSCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "POSCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_POSCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_POSCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_POSCOD
[L]CURPRO = "POSCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.POSCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_POSCOD
[L]CURPRO = "POSCOD"
If vireblc(this.POSCOD,2)<>vireblc(format$("K:10X",this.POSCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_POSCOD
[L]CURPRO = "POSCOD"
[L]ASTATUS =  func ASYRTRTATY.CONTROLPOS(this,"POSCOD",this.POSCOD,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_POSCOD
[L]CURPRO = "POSCOD"
Return

$PROPAGATE_POSCOD
this.isReadonly = 0
[L]ASTATUS =  func ASYRTRTATY.PROPAGATEPOS(this,"POSCOD",this.POSCOD,this.CTY,this.SAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]CURPRO = "POSCOD"
Gosub _LNKPRO_POSCOD
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_POSCOD
Gosub DECLARE_VAR From WMC0SINVOICE
[L]CURPRO = "POSCOD"
$_LNKPRO_POSCOD
If vireblc(this.POSCOD,2)<>""
 # Link POSCOD
 Local File POSCOD [WPOS]
 Read [F:WPOS]POS0 = this.CRY;this.POSCOD;this.CTY;AVOID.ACHAR
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("POSCOD","$description",[F:WPOS]POSCTY)
 Endif
 LogicClose File [WPOS]
Endif
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATPOS(this,"POSCOD",this.POSCOD,[L]AFORMAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("POSCOD","$x3Format",[L]AFORMAT)
Endif
Return




