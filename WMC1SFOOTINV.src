#<AdxTL>@(#)0.0.0.0 $Revision$Class Invoicing elements
# Supervisor
## ACLA-CLASSE ## SFOOTINV
# 2018-08-27 12:45:27 442


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : SFINUM Invoicing element ( Field SFI 0)
####################################################################

$SET_SFINUM
If [L]_AOLDVAL<>this.SFINUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SFINUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SFINUM
 Gosub PROPAGATE_SFINUM
Endif
Return

$INIT_SFINUM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SFINUM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SFINUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SFINUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SFINUM
[L]CURPRO = "SFINUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SFINUM=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SFINUM
[L]CURPRO = "SFINUM"
Return

$_AOTHERS_SFINUM
[L]CURPRO = "SFINUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SFINUM
[L]CURPRO = "SFINUM"
Return

$PROPAGATE_SFINUM
this.isReadonly = 0
[L]CURPRO = "SFINUM"
Gosub _LNKPRO_SFINUM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SFINUM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUM"
$_LNKPRO_SFINUM
If this.SFINUM<>0
 # Link SFOOTINV
 Local File SFOOTINV [WSFI]
 Read [F:WSFI]SFI0 = this.SFINUM
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="SFOOTINV" & ZONE="SHOAXX" & IDENT1=num$([F:WSFI]SFINUM) & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SFINUM","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="SFOOTINV" & ZONE="DESAXX" & IDENT1=num$([F:WSFI]SFINUM) & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SFINUM","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WSFI]
Endif
Return

$_ALOADATTRIBUTE_SFINUM
[L]ASTATUS = fmet this.ASETATTRIBUTE("SFINUM","$isMandatory","true")
Return


####################################################################
# 2 : SFINUMCAR Alpha no. ( Field A 3)
####################################################################

$SET_SFINUMCAR
If [L]_AOLDVAL<>this.SFINUMCAR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SFINUMCAR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SFINUMCAR
 Gosub PROPAGATE_SFINUMCAR
Endif
Return

$INIT_SFINUMCAR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUMCAR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SFINUMCAR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUMCAR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SFINUMCAR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SFINUMCAR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SFINUMCAR
[L]CURPRO = "SFINUMCAR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SFINUMCAR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SFINUMCAR
[L]CURPRO = "SFINUMCAR"
Return

$_AOTHERS_SFINUMCAR
[L]CURPRO = "SFINUMCAR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SFINUMCAR
[L]CURPRO = "SFINUMCAR"
Return

$PROPAGATE_SFINUMCAR
this.isReadonly = 0
[L]CURPRO = "SFINUMCAR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SFINUMCAR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SFINUMCAR"
$_LNKPRO_SFINUMCAR
Return


####################################################################
# 3 : DESAXX Description ( Field AX2)
####################################################################

$GET_DESAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DESAXX"
this.DESAXX = fmet this.AGETTEXTRA(CURPRO)
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_DESAXX
If [L]_AOLDVAL<>this.DESAXX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DESAXX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DESAXX
 Gosub PROPAGATE_DESAXX
Endif
Return

$INIT_DESAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DESAXX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DESAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DESAXX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DESAXX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DESAXX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DESAXX
[L]CURPRO = "DESAXX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DESAXX,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DESAXX
[L]CURPRO = "DESAXX"
If vireblc(fmet this.AGETTEXTRA("DESAXX"),2)<>vireblc(format$("K:20X",fmet this.AGETTEXTRA("DESAXX")),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DESAXX
[L]CURPRO = "DESAXX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DESAXX
[L]CURPRO = "DESAXX"
Return

$PROPAGATE_DESAXX
this.isReadonly = 0
[L]CURPRO = "DESAXX"
[L]ASTATUS = fmet this.ASETTEXTRA(CURPRO,this.DESAXX)
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DESAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DESAXX"
$_LNKPRO_DESAXX
Return


####################################################################
# 4 : SHOAXX Short description ( Field AX1)
####################################################################

$GET_SHOAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SHOAXX"
this.SHOAXX = fmet this.AGETTEXTRA(CURPRO)
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_SHOAXX
If [L]_AOLDVAL<>this.SHOAXX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SHOAXX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SHOAXX
 Gosub PROPAGATE_SHOAXX
Endif
Return

$INIT_SHOAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SHOAXX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SHOAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SHOAXX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SHOAXX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SHOAXX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SHOAXX
[L]CURPRO = "SHOAXX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SHOAXX,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SHOAXX
[L]CURPRO = "SHOAXX"
If vireblc(fmet this.AGETTEXTRA("SHOAXX"),2)<>vireblc(format$("K:12X",fmet this.AGETTEXTRA("SHOAXX")),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SHOAXX
[L]CURPRO = "SHOAXX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SHOAXX
[L]CURPRO = "SHOAXX"
Return

$PROPAGATE_SHOAXX
this.isReadonly = 0
[L]CURPRO = "SHOAXX"
[L]ASTATUS = fmet this.ASETTEXTRA(CURPRO,this.SHOAXX)
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SHOAXX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "SHOAXX"
$_LNKPRO_SHOAXX
Return


####################################################################
# 5 : LANDESSHO Descriptions ( Field A 50)
####################################################################

$SET_LANDESSHO
If [L]_AOLDVAL<>this.LANDESSHO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LANDESSHO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LANDESSHO
 Gosub PROPAGATE_LANDESSHO
Endif
Return

$INIT_LANDESSHO
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "LANDESSHO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LANDESSHO
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "LANDESSHO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LANDESSHO             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LANDESSHO             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LANDESSHO
[L]CURPRO = "LANDESSHO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LANDESSHO,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LANDESSHO
[L]CURPRO = "LANDESSHO"
Return

$_AOTHERS_LANDESSHO
[L]CURPRO = "LANDESSHO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LANDESSHO
[L]CURPRO = "LANDESSHO"
Return

$PROPAGATE_LANDESSHO
this.isReadonly = 0
[L]CURPRO = "LANDESSHO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LANDESSHO
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "LANDESSHO"
$_LNKPRO_LANDESSHO
Return


####################################################################
# 6 : ITMREF Product ( Field ITM 20)
####################################################################

$SET_ITMREF
If [L]_AOLDVAL<>this.ITMREF
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ITMREF
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ITMREF
 Gosub PROPAGATE_ITMREF
Endif
Return

$INIT_ITMREF
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ITMREF"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ITMREF
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ITMREF"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ITMREF                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ITMREF                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ITMREF
[L]CURPRO = "ITMREF"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ITMREF,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ITMREF
[L]CURPRO = "ITMREF"
If vireblc(this.ITMREF,2)<>vireblc(format$("K:20c",this.ITMREF),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_ITMREF
[L]CURPRO = "ITMREF"
If vireblc(this.ITMREF,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPITM.ACTRLREF(this,"ITMREF",this.ITMREF,this.ITMREF,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ITMREF<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ITMREF
[L]CURPRO = "ITMREF"
Return

$PROPAGATE_ITMREF
this.isReadonly = 0
[L]CURPRO = "ITMREF"
Gosub _LNKPRO_ITMREF
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ITMREF
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ITMREF"
$_LNKPRO_ITMREF
If vireblc(this.ITMREF,2)<>""
 # Link ITMMASTER
 Local File ITMMASTER [WITM]
 Read [F:WITM]ITM0 = this.ITMREF
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ITMMASTER" & ZONE="DES1AXX" & IDENT1=[F:WITM]ITMREF & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("ITMREF","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WITM]
Endif
Return


####################################################################
# 7 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return


####################################################################
# 8 : PROCOD Processing mode ( Field Local menu number 271)
####################################################################

$SET_PROCOD
If [L]_AOLDVAL<>this.PROCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PROCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PROCOD
 Gosub PROPAGATE_PROCOD
Endif
Return

$INIT_PROCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PROCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PROCOD=0 and fmet this.AGETATTRIBUTE("PROCOD","$isMandatory")="true"
 this.PROCOD = 1
Endif
Return
 
$CONTROL_PROCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PROCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PROCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PROCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PROCOD
[L]CURPRO = "PROCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PROCOD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PROCOD
[L]CURPRO = "PROCOD"
If this.PROCOD<0 or this.PROCOD>len(mess(0,271,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"271 ->"-num$(this.PROCOD)-mess(99,123,1)):  Return : # Local menu "271 -> Invalid option
Endif
Return

$_AOTHERS_PROCOD
[L]CURPRO = "PROCOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PROCOD
[L]CURPRO = "PROCOD"
Return

$PROPAGATE_PROCOD
this.isReadonly = 0
[L]CURPRO = "PROCOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PROCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PROCOD"
$_LNKPRO_PROCOD
Return


####################################################################
# 9 : AMTCOD Amount code ( Field Local menu number 269)
####################################################################

$SET_AMTCOD
If [L]_AOLDVAL<>this.AMTCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTCOD
 Gosub PROPAGATE_AMTCOD
Endif
Return

$INIT_AMTCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "AMTCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.AMTCOD=0 and fmet this.AGETATTRIBUTE("AMTCOD","$isMandatory")="true"
 this.AMTCOD = 1
Endif
Return
 
$CONTROL_AMTCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "AMTCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTCOD
[L]CURPRO = "AMTCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTCOD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTCOD
[L]CURPRO = "AMTCOD"
If this.AMTCOD<0 or this.AMTCOD>len(mess(0,269,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"269 ->"-num$(this.AMTCOD)-mess(99,123,1)):  Return : # Local menu "269 -> Invalid option
Endif
Return

$_AOTHERS_AMTCOD
[L]CURPRO = "AMTCOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTCOD
[L]CURPRO = "AMTCOD"
Return

$PROPAGATE_AMTCOD
this.isReadonly = 0
[L]CURPRO = "AMTCOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTCOD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "AMTCOD"
$_LNKPRO_AMTCOD
Return


####################################################################
# 10 : INCDCR Increase/Decrease ( Field Local menu number 254)
####################################################################

$SET_INCDCR
If [L]_AOLDVAL<>this.INCDCR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_INCDCR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.INCDCR
 Gosub PROPAGATE_INCDCR
Endif
Return

$INIT_INCDCR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "INCDCR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.INCDCR=0 and fmet this.AGETATTRIBUTE("INCDCR","$isMandatory")="true"
 this.INCDCR = 1
Endif
Return
 
$CONTROL_INCDCR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "INCDCR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_INCDCR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_INCDCR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_INCDCR
[L]CURPRO = "INCDCR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.INCDCR=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_INCDCR
[L]CURPRO = "INCDCR"
If this.INCDCR<0 or this.INCDCR>len(mess(0,254,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"254 ->"-num$(this.INCDCR)-mess(99,123,1)):  Return : # Local menu "254 -> Invalid option
Endif
Return

$_AOTHERS_INCDCR
[L]CURPRO = "INCDCR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_INCDCR
[L]CURPRO = "INCDCR"
Return

$PROPAGATE_INCDCR
this.isReadonly = 0
[L]CURPRO = "INCDCR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_INCDCR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "INCDCR"
$_LNKPRO_INCDCR
Return


####################################################################
# 11 : BPCORI Original customer ( Field Local menu number 2218)
####################################################################

$SET_BPCORI
If [L]_AOLDVAL<>this.BPCORI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPCORI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPCORI
 Gosub PROPAGATE_BPCORI
Endif
Return

$INIT_BPCORI
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "BPCORI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.BPCORI=0 and fmet this.AGETATTRIBUTE("BPCORI","$isMandatory")="true"
 this.BPCORI = 1
Endif
Return
 
$CONTROL_BPCORI
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "BPCORI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPCORI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPCORI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPCORI
[L]CURPRO = "BPCORI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BPCORI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPCORI
[L]CURPRO = "BPCORI"
If this.BPCORI<0 or this.BPCORI>len(mess(0,2218,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2218 ->"-num$(this.BPCORI)-mess(99,123,1)):  Return : # Local menu "2218 -> Invalid option
Endif
Return

$_AOTHERS_BPCORI
[L]CURPRO = "BPCORI"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPCORI
[L]CURPRO = "BPCORI"
Return

$PROPAGATE_BPCORI
this.isReadonly = 0
[L]CURPRO = "BPCORI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPCORI
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "BPCORI"
$_LNKPRO_BPCORI
Return


####################################################################
# 12 : DACBPC Customer entry ( Field C 2)
####################################################################

$SET_DACBPC
If [L]_AOLDVAL<>this.DACBPC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DACBPC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DACBPC
 Gosub PROPAGATE_DACBPC
Endif
Return

$INIT_DACBPC
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACBPC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DACBPC
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACBPC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DACBPC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DACBPC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DACBPC
[L]CURPRO = "DACBPC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DACBPC=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DACBPC
[L]CURPRO = "DACBPC"
Return

$_AOTHERS_DACBPC
[L]CURPRO = "DACBPC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DACBPC
[L]CURPRO = "DACBPC"
Return

$PROPAGATE_DACBPC
this.isReadonly = 0
[L]CURPRO = "DACBPC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DACBPC
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACBPC"
$_LNKPRO_DACBPC
Return


####################################################################
# 13 : DACORD Order entry ( Field C 2)
####################################################################

$SET_DACORD
If [L]_AOLDVAL<>this.DACORD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DACORD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DACORD
 Gosub PROPAGATE_DACORD
Endif
Return

$INIT_DACORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACORD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DACORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACORD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DACORD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DACORD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DACORD
[L]CURPRO = "DACORD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DACORD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DACORD
[L]CURPRO = "DACORD"
Return

$_AOTHERS_DACORD
[L]CURPRO = "DACORD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DACORD
[L]CURPRO = "DACORD"
Return

$PROPAGATE_DACORD
this.isReadonly = 0
[L]CURPRO = "DACORD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DACORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACORD"
$_LNKPRO_DACORD
Return


####################################################################
# 14 : DACDLV Delivery entry ( Field C 2)
####################################################################

$SET_DACDLV
If [L]_AOLDVAL<>this.DACDLV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DACDLV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DACDLV
 Gosub PROPAGATE_DACDLV
Endif
Return

$INIT_DACDLV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACDLV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DACDLV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACDLV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DACDLV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DACDLV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DACDLV
[L]CURPRO = "DACDLV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DACDLV=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DACDLV
[L]CURPRO = "DACDLV"
Return

$_AOTHERS_DACDLV
[L]CURPRO = "DACDLV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DACDLV
[L]CURPRO = "DACDLV"
Return

$PROPAGATE_DACDLV
this.isReadonly = 0
[L]CURPRO = "DACDLV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DACDLV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACDLV"
$_LNKPRO_DACDLV
Return


####################################################################
# 15 : DACINV Invoice entry ( Field C 2)
####################################################################

$SET_DACINV
If [L]_AOLDVAL<>this.DACINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DACINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DACINV
 Gosub PROPAGATE_DACINV
Endif
Return

$INIT_DACINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DACINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DACINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DACINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DACINV
[L]CURPRO = "DACINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DACINV=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DACINV
[L]CURPRO = "DACINV"
Return

$_AOTHERS_DACINV
[L]CURPRO = "DACINV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DACINV
[L]CURPRO = "DACINV"
Return

$PROPAGATE_DACINV
this.isReadonly = 0
[L]CURPRO = "DACINV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DACINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DACINV"
$_LNKPRO_DACINV
Return


####################################################################
# 16 : TRFDLY Include in ord-deliv ( Field Local menu number 442)
####################################################################

$SET_TRFDLY
If [L]_AOLDVAL<>this.TRFDLY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TRFDLY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TRFDLY
 Gosub PROPAGATE_TRFDLY
Endif
Return

$INIT_TRFDLY
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFDLY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TRFDLY=0 and fmet this.AGETATTRIBUTE("TRFDLY","$isMandatory")="true"
 this.TRFDLY = 1
Endif
Return
 
$CONTROL_TRFDLY
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFDLY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TRFDLY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TRFDLY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TRFDLY
[L]CURPRO = "TRFDLY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TRFDLY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TRFDLY
[L]CURPRO = "TRFDLY"
If this.TRFDLY<0 or this.TRFDLY>len(mess(0,442,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"442 ->"-num$(this.TRFDLY)-mess(99,123,1)):  Return : # Local menu "442 -> Invalid option
Endif
Return

$_AOTHERS_TRFDLY
[L]CURPRO = "TRFDLY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TRFDLY
[L]CURPRO = "TRFDLY"
Return

$PROPAGATE_TRFDLY
this.isReadonly = 0
[L]CURPRO = "TRFDLY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TRFDLY
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFDLY"
$_LNKPRO_TRFDLY
Return


####################################################################
# 17 : TRFINV Include in ord-inv ( Field Local menu number 442)
####################################################################

$SET_TRFINV
If [L]_AOLDVAL<>this.TRFINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TRFINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TRFINV
 Gosub PROPAGATE_TRFINV
Endif
Return

$INIT_TRFINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TRFINV=0 and fmet this.AGETATTRIBUTE("TRFINV","$isMandatory")="true"
 this.TRFINV = 1
Endif
Return
 
$CONTROL_TRFINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TRFINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TRFINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TRFINV
[L]CURPRO = "TRFINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TRFINV=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TRFINV
[L]CURPRO = "TRFINV"
If this.TRFINV<0 or this.TRFINV>len(mess(0,442,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"442 ->"-num$(this.TRFINV)-mess(99,123,1)):  Return : # Local menu "442 -> Invalid option
Endif
Return

$_AOTHERS_TRFINV
[L]CURPRO = "TRFINV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TRFINV
[L]CURPRO = "TRFINV"
Return

$PROPAGATE_TRFINV
this.isReadonly = 0
[L]CURPRO = "TRFINV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TRFINV
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TRFINV"
$_LNKPRO_TRFINV
Return


####################################################################
# 18 : DEFVAL Default value ( Field DCB 11)
####################################################################

$SET_DEFVAL
If [L]_AOLDVAL<>this.DEFVAL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEFVAL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEFVAL
 Gosub PROPAGATE_DEFVAL
Endif
Return

$INIT_DEFVAL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DEFVAL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEFVAL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DEFVAL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEFVAL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEFVAL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEFVAL
[L]CURPRO = "DEFVAL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DEFVAL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEFVAL
[L]CURPRO = "DEFVAL"
Return

$_AOTHERS_DEFVAL
[L]CURPRO = "DEFVAL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEFVAL
[L]CURPRO = "DEFVAL"
Return

$PROPAGATE_DEFVAL
this.isReadonly = 0
[L]CURPRO = "DEFVAL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEFVAL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "DEFVAL"
$_LNKPRO_DEFVAL
Return


####################################################################
# 19 : VALTYP Value type ( Field Local menu number 2227)
####################################################################

$SET_VALTYP
If [L]_AOLDVAL<>this.VALTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VALTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VALTYP
 Gosub PROPAGATE_VALTYP
Endif
Return

$INIT_VALTYP
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VALTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.VALTYP=0 and fmet this.AGETATTRIBUTE("VALTYP","$isMandatory")="true"
 this.VALTYP = 1
Endif
Return
 
$CONTROL_VALTYP
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VALTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VALTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VALTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VALTYP
[L]CURPRO = "VALTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.VALTYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VALTYP
[L]CURPRO = "VALTYP"
If this.VALTYP<0 or this.VALTYP>len(mess(0,2227,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2227 ->"-num$(this.VALTYP)-mess(99,123,1)):  Return : # Local menu "2227 -> Invalid option
Endif
Return

$_AOTHERS_VALTYP
[L]CURPRO = "VALTYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VALTYP
[L]CURPRO = "VALTYP"
Return

$PROPAGATE_VALTYP
this.isReadonly = 0
[L]CURPRO = "VALTYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VALTYP
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VALTYP"
$_LNKPRO_VALTYP
Return


####################################################################
# 20 : MISRULSTD Sundry std rule ( Field Local menu number 463)
####################################################################

$SET_MISRULSTD
If [L]_AOLDVAL<>this.MISRULSTD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MISRULSTD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MISRULSTD
 Gosub PROPAGATE_MISRULSTD
Endif
Return

$INIT_MISRULSTD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULSTD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.MISRULSTD=0 and fmet this.AGETATTRIBUTE("MISRULSTD","$isMandatory")="true"
 this.MISRULSTD = 1
Endif
Return
 
$CONTROL_MISRULSTD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULSTD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MISRULSTD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MISRULSTD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MISRULSTD
[L]CURPRO = "MISRULSTD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.MISRULSTD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MISRULSTD
[L]CURPRO = "MISRULSTD"
If this.MISRULSTD<0 or this.MISRULSTD>len(mess(0,463,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"463 ->"-num$(this.MISRULSTD)-mess(99,123,1)):  Return : # Local menu "463 -> Invalid option
Endif
Return

$_AOTHERS_MISRULSTD
[L]CURPRO = "MISRULSTD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MISRULSTD
[L]CURPRO = "MISRULSTD"
Return

$PROPAGATE_MISRULSTD
this.isReadonly = 0
[L]CURPRO = "MISRULSTD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MISRULSTD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULSTD"
$_LNKPRO_MISRULSTD
Return


####################################################################
# 21 : MISRULUSR User rule ( Field Local menu number 464)
####################################################################

$SET_MISRULUSR
If [L]_AOLDVAL<>this.MISRULUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MISRULUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MISRULUSR
 Gosub PROPAGATE_MISRULUSR
Endif
Return

$INIT_MISRULUSR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.MISRULUSR=0 and fmet this.AGETATTRIBUTE("MISRULUSR","$isMandatory")="true"
 this.MISRULUSR = 1
Endif
Return
 
$CONTROL_MISRULUSR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MISRULUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MISRULUSR             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MISRULUSR
[L]CURPRO = "MISRULUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.MISRULUSR=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MISRULUSR
[L]CURPRO = "MISRULUSR"
If this.MISRULUSR<0 or this.MISRULUSR>len(mess(0,464,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"464 ->"-num$(this.MISRULUSR)-mess(99,123,1)):  Return : # Local menu "464 -> Invalid option
Endif
Return

$_AOTHERS_MISRULUSR
[L]CURPRO = "MISRULUSR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MISRULUSR
[L]CURPRO = "MISRULUSR"
Return

$PROPAGATE_MISRULUSR
this.isReadonly = 0
[L]CURPRO = "MISRULUSR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MISRULUSR
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "MISRULUSR"
$_LNKPRO_MISRULUSR
Return


####################################################################
# 22 : CLCBAS Calculation basis ( Field Local menu number 2219)
####################################################################

$SET_CLCBAS
If [L]_AOLDVAL<>this.CLCBAS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLCBAS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLCBAS
 Gosub PROPAGATE_CLCBAS
Endif
Return

$INIT_CLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCBAS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CLCBAS=0 and fmet this.AGETATTRIBUTE("CLCBAS","$isMandatory")="true"
 this.CLCBAS = 1
Endif
Return
 
$CONTROL_CLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCBAS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLCBAS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLCBAS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLCBAS
[L]CURPRO = "CLCBAS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLCBAS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLCBAS
[L]CURPRO = "CLCBAS"
If this.CLCBAS<0 or this.CLCBAS>len(mess(0,2219,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2219 ->"-num$(this.CLCBAS)-mess(99,123,1)):  Return : # Local menu "2219 -> Invalid option
Endif
Return

$_AOTHERS_CLCBAS
[L]CURPRO = "CLCBAS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLCBAS
[L]CURPRO = "CLCBAS"
Return

$PROPAGATE_CLCBAS
this.isReadonly = 0
[L]CURPRO = "CLCBAS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCBAS"
$_LNKPRO_CLCBAS
Return


####################################################################
# 23 : CLCORD Calculation order ( Field C 2)
####################################################################

$SET_CLCORD
If [L]_AOLDVAL<>this.CLCORD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLCORD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLCORD
 Gosub PROPAGATE_CLCORD
Endif
Return

$INIT_CLCORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCORD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CLCORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCORD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLCORD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLCORD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLCORD
[L]CURPRO = "CLCORD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLCORD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLCORD
[L]CURPRO = "CLCORD"
Return

$_AOTHERS_CLCORD
[L]CURPRO = "CLCORD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLCORD
[L]CURPRO = "CLCORD"
Return

$PROPAGATE_CLCORD
this.isReadonly = 0
[L]CURPRO = "CLCORD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLCORD
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCORD"
$_LNKPRO_CLCORD
Return


####################################################################
# 24 : ACTCLCBAS Action calcul. ( Field A 10)
####################################################################

$SET_ACTCLCBAS
If [L]_AOLDVAL<>this.ACTCLCBAS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ACTCLCBAS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ACTCLCBAS
 Gosub PROPAGATE_ACTCLCBAS
Endif
Return

$INIT_ACTCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ACTCLCBAS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ACTCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ACTCLCBAS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ACTCLCBAS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ACTCLCBAS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ACTCLCBAS
[L]CURPRO = "ACTCLCBAS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ACTCLCBAS,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ACTCLCBAS
[L]CURPRO = "ACTCLCBAS"
Return

$_AOTHERS_ACTCLCBAS
[L]CURPRO = "ACTCLCBAS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ACTCLCBAS
[L]CURPRO = "ACTCLCBAS"
Return

$PROPAGATE_ACTCLCBAS
this.isReadonly = 0
[L]CURPRO = "ACTCLCBAS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ACTCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "ACTCLCBAS"
$_LNKPRO_ACTCLCBAS
Return


####################################################################
# 25 : PRGCLCBAS Program calcul. ( Field A 10)
####################################################################

$SET_PRGCLCBAS
If [L]_AOLDVAL<>this.PRGCLCBAS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRGCLCBAS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRGCLCBAS
 Gosub PROPAGATE_PRGCLCBAS
Endif
Return

$INIT_PRGCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PRGCLCBAS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRGCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PRGCLCBAS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRGCLCBAS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRGCLCBAS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRGCLCBAS
[L]CURPRO = "PRGCLCBAS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRGCLCBAS,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRGCLCBAS
[L]CURPRO = "PRGCLCBAS"
Return

$_AOTHERS_PRGCLCBAS
[L]CURPRO = "PRGCLCBAS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRGCLCBAS
[L]CURPRO = "PRGCLCBAS"
Return

$PROPAGATE_PRGCLCBAS
this.isReadonly = 0
[L]CURPRO = "PRGCLCBAS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRGCLCBAS
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "PRGCLCBAS"
$_LNKPRO_PRGCLCBAS
Return


####################################################################
# 26 : CLCVACITM Tax level selection ( Field TVI 5)
####################################################################

$SET_CLCVACITM
If [L]_AOLDVAL<>this.CLCVACITM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLCVACITM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLCVACITM
 Gosub PROPAGATE_CLCVACITM
Endif
Return

$INIT_CLCVACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCVACITM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CLCVACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCVACITM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLCVACITM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLCVACITM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLCVACITM
[L]CURPRO = "CLCVACITM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CLCVACITM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLCVACITM
[L]CURPRO = "CLCVACITM"
If vireblc(this.CLCVACITM,2)<>vireblc(format$("K:5c",this.CLCVACITM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CLCVACITM
[L]CURPRO = "CLCVACITM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLCVACITM
[L]CURPRO = "CLCVACITM"
If vireblc(this.CLCVACITM,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTVI.ACTRLREF(this,"CLCVACITM",this.CLCVACITM,this.CLCVACITM,"",2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CLCVACITM<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_CLCVACITM
this.isReadonly = 0
[L]CURPRO = "CLCVACITM"
Gosub _LNKPRO_CLCVACITM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLCVACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "CLCVACITM"
$_LNKPRO_CLCVACITM
If vireblc(this.CLCVACITM,2)<>""
 # Link TABVACITM
 Local File TABVACITM [WTVI]
 Read [F:WTVI]TVI0 = this.CLCVACITM;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACITM" & ZONE="SHOAXX" & IDENT1=[F:WTVI]VACITM & IDENT2=[F:WTVI]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CLCVACITM","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACITM" & ZONE="DESAXX" & IDENT1=[F:WTVI]VACITM & IDENT2=[F:WTVI]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CLCVACITM","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVI]
Endif
Return


####################################################################
# 27 : TSDMIN Minimum threshold ( Field MD1 0)
####################################################################

$SET_TSDMIN
If [L]_AOLDVAL<>this.TSDMIN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TSDMIN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TSDMIN
 Gosub PROPAGATE_TSDMIN
Endif
Return

$INIT_TSDMIN
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMIN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TSDMIN
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMIN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TSDMIN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TSDMIN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TSDMIN
[L]CURPRO = "TSDMIN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TSDMIN=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TSDMIN
[L]CURPRO = "TSDMIN"
Return

$_AOTHERS_TSDMIN
[L]CURPRO = "TSDMIN"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"TSDMIN",this.TSDMIN,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TSDMIN
[L]CURPRO = "TSDMIN"
Return

$PROPAGATE_TSDMIN
this.isReadonly = 0
[L]CURPRO = "TSDMIN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TSDMIN
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMIN"
$_LNKPRO_TSDMIN
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"TSDMIN",this.TSDMIN,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("TSDMIN","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 28 : TSDMAX Maximum threshold ( Field MD1 0)
####################################################################

$SET_TSDMAX
If [L]_AOLDVAL<>this.TSDMAX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TSDMAX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TSDMAX
 Gosub PROPAGATE_TSDMAX
Endif
Return

$INIT_TSDMAX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMAX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TSDMAX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMAX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TSDMAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TSDMAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TSDMAX
[L]CURPRO = "TSDMAX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TSDMAX=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TSDMAX
[L]CURPRO = "TSDMAX"
Return

$_AOTHERS_TSDMAX
[L]CURPRO = "TSDMAX"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"TSDMAX",this.TSDMAX,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TSDMAX
[L]CURPRO = "TSDMAX"
Return

$PROPAGATE_TSDMAX
this.isReadonly = 0
[L]CURPRO = "TSDMAX"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TSDMAX
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "TSDMAX"
$_LNKPRO_TSDMAX
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"TSDMAX",this.TSDMAX,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("TSDMAX","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 29 : VATRUL Tax rule ( Field Local menu number 283)
####################################################################

$SET_VATRUL
If [L]_AOLDVAL<>this.VATRUL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VATRUL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VATRUL
 Gosub PROPAGATE_VATRUL
Endif
Return

$INIT_VATRUL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VATRUL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.VATRUL=0 and fmet this.AGETATTRIBUTE("VATRUL","$isMandatory")="true"
 this.VATRUL = 1
Endif
Return
 
$CONTROL_VATRUL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VATRUL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VATRUL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VATRUL                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VATRUL
[L]CURPRO = "VATRUL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.VATRUL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VATRUL
[L]CURPRO = "VATRUL"
If this.VATRUL<0 or this.VATRUL>len(mess(0,283,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"283 ->"-num$(this.VATRUL)-mess(99,123,1)):  Return : # Local menu "283 -> Invalid option
Endif
Return

$_AOTHERS_VATRUL
[L]CURPRO = "VATRUL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VATRUL
[L]CURPRO = "VATRUL"
Return

$PROPAGATE_VATRUL
this.isReadonly = 0
[L]CURPRO = "VATRUL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VATRUL
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VATRUL"
$_LNKPRO_VATRUL
Return


####################################################################
# 30 : VACITM Element tax level ( Field TVI 5)
####################################################################

$SET_VACITM
If [L]_AOLDVAL<>this.VACITM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VACITM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VACITM
 Gosub PROPAGATE_VACITM
Endif
Return

$INIT_VACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VACITM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VACITM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VACITM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VACITM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VACITM
[L]CURPRO = "VACITM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VACITM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VACITM
[L]CURPRO = "VACITM"
If vireblc(this.VACITM,2)<>vireblc(format$("K:5c",this.VACITM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VACITM
[L]CURPRO = "VACITM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VACITM
[L]CURPRO = "VACITM"
If vireblc(this.VACITM,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTVI.ACTRLREF(this,"VACITM",this.VACITM,this.VACITM,"",2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.VACITM<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_VACITM
this.isReadonly = 0
[L]CURPRO = "VACITM"
Gosub _LNKPRO_VACITM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VACITM
Gosub DECLARE_VAR From WMC0SFOOTINV
[L]CURPRO = "VACITM"
$_LNKPRO_VACITM
If vireblc(this.VACITM,2)<>""
 # Link TABVACITM
 Local File TABVACITM [WTVI]
 Read [F:WTVI]TVI0 = this.VACITM;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACITM" & ZONE="SHOAXX" & IDENT1=[F:WTVI]VACITM & IDENT2=[F:WTVI]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACITM","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACITM" & ZONE="DESAXX" & IDENT1=[F:WTVI]VACITM & IDENT2=[F:WTVI]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACITM","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVI]
Endif
Return




