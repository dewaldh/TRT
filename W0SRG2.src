#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management SRG2 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone VCRTYPCOD
mkstat = 0
zoncou = "VCRTYPCOD"
indice = 0
IMPENT = [M]VCRTYPCOD
If varinit([M]VCRTYPCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRTYPCOD,indice)=0
 [M]VCRTYPCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRTYPCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRTYPCOD(indice)
 Endif
Endif
[M]VCRTYPCOD = IMPENT

## Zone VCRTYPSCR
mkstat = 0
zoncou = "VCRTYPSCR"
indice = 0
IMPENT = [M]VCRTYPSCR
If varinit([M]VCRTYPSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRTYPSCR,indice)=0
 [M]VCRTYPSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRTYPSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRTYPSCR(indice)
 Endif
Endif
[M]VCRTYPSCR = IMPENT

## Zone VCRNUMCOD
mkstat = 0
zoncou = "VCRNUMCOD"
indice = 0
IMPENT = [M]VCRNUMCOD
If varinit([M]VCRNUMCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRNUMCOD,indice)=0
 [M]VCRNUMCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRNUMCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRNUMCOD(indice)
 Endif
Endif
[M]VCRNUMCOD = IMPENT

## Zone VCRNUMSCR
mkstat = 0
zoncou = "VCRNUMSCR"
indice = 0
IMPENT = [M]VCRNUMSCR
If varinit([M]VCRNUMSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRNUMSCR,indice)=0
 [M]VCRNUMSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRNUMSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRNUMSCR(indice)
 Endif
Endif
[M]VCRNUMSCR = IMPENT

## Zone VCRLINCOD
mkstat = 0
zoncou = "VCRLINCOD"
indice = 0
IMPENT = [M]VCRLINCOD
If varinit([M]VCRLINCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRLINCOD,indice)=0
 [M]VCRLINCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRLINCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRLINCOD(indice)
 Endif
Endif
[M]VCRLINCOD = IMPENT

## Zone VCRLINSCR
mkstat = 0
zoncou = "VCRLINSCR"
indice = 0
IMPENT = [M]VCRLINSCR
If varinit([M]VCRLINSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]VCRLINSCR,indice)=0
 [M]VCRLINSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRLINSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]VCRLINSCR(indice)
 Endif
Endif
[M]VCRLINSCR = IMPENT

## Zone IPTDATCOD
mkstat = 0
zoncou = "IPTDATCOD"
indice = 0
IMPENT = [M]IPTDATCOD
If varinit([M]IPTDATCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]IPTDATCOD,indice)=0
 [M]IPTDATCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IPTDATCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IPTDATCOD(indice)
 Endif
Endif
[M]IPTDATCOD = IMPENT

## Zone IPTDATSCR
mkstat = 0
zoncou = "IPTDATSCR"
indice = 0
IMPENT = [M]IPTDATSCR
If varinit([M]IPTDATSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]IPTDATSCR,indice)=0
 [M]IPTDATSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IPTDATSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IPTDATSCR(indice)
 Endif
Endif
[M]IPTDATSCR = IMPENT

## Zone SRGPPSCOD
mkstat = 0
zoncou = "SRGPPSCOD"
indice = 0
IMPENT = [M]SRGPPSCOD
If varinit([M]SRGPPSCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]SRGPPSCOD,indice)=0
 [M]SRGPPSCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SRGPPSCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SRGPPSCOD(indice)
 Endif
Endif
[M]SRGPPSCOD = IMPENT

## Zone SRGPPSSCR
mkstat = 0
zoncou = "SRGPPSSCR"
indice = 0
IMPENT = [M]SRGPPSSCR
If varinit([M]SRGPPSSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]SRGPPSSCR,indice)=0
 [M]SRGPPSSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SRGPPSSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SRGPPSSCR(indice)
 Endif
Endif
[M]SRGPPSSCR = IMPENT

## Zone STUCOD
mkstat = 0
zoncou = "STUCOD"
indice = 0
IMPENT = [M]STUCOD
If varinit([M]STUCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]STUCOD,indice)=0
 [M]STUCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "STUCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]STUCOD(indice)
 Endif
Endif
[M]STUCOD = IMPENT

## Zone STUSCR
mkstat = 0
zoncou = "STUSCR"
indice = 0
IMPENT = [M]STUSCR
If varinit([M]STUSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]STUSCR,indice)=0
 [M]STUSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "STUSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]STUSCR(indice)
 Endif
Endif
[M]STUSCR = IMPENT

## Zone PCUSTUOCOD
mkstat = 0
zoncou = "PCUSTUOCOD"
indice = 0
IMPENT = [M]PCUSTUOCOD
If varinit([M]PCUSTUOCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUSTUOCOD,indice)=0
 [M]PCUSTUOCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUSTUOCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUSTUOCOD(indice)
 Endif
Endif
[M]PCUSTUOCOD = IMPENT

## Zone PCUSTUOSCR
mkstat = 0
zoncou = "PCUSTUOSCR"
indice = 0
IMPENT = [M]PCUSTUOSCR
If varinit([M]PCUSTUOSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUSTUOSCR,indice)=0
 [M]PCUSTUOSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUSTUOSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUSTUOSCR(indice)
 Endif
Endif
[M]PCUSTUOSCR = IMPENT

## Zone QTYSTUOCOD
mkstat = 0
zoncou = "QTYSTUOCOD"
indice = 0
IMPENT = [M]QTYSTUOCOD
If varinit([M]QTYSTUOCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYSTUOCOD,indice)=0
 [M]QTYSTUOCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYSTUOCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYSTUOCOD(indice)
 Endif
Endif
[M]QTYSTUOCOD = IMPENT

## Zone QTYSTUOSCR
mkstat = 0
zoncou = "QTYSTUOSCR"
indice = 0
IMPENT = [M]QTYSTUOSCR
If varinit([M]QTYSTUOSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYSTUOSCR,indice)=0
 [M]QTYSTUOSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYSTUOSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYSTUOSCR(indice)
 Endif
Endif
[M]QTYSTUOSCR = IMPENT

## Zone STAORICOD
mkstat = 0
zoncou = "STAORICOD"
indice = 0
IMPENT = [M]STAORICOD
If varinit([M]STAORICOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]STAORICOD,indice)=0
 [M]STAORICOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "STAORICOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]STAORICOD(indice)
 Endif
Endif
[M]STAORICOD = IMPENT

## Zone STAORISCR
mkstat = 0
zoncou = "STAORISCR"
indice = 0
IMPENT = [M]STAORISCR
If varinit([M]STAORISCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]STAORISCR,indice)=0
 [M]STAORISCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "STAORISCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]STAORISCR(indice)
 Endif
Endif
[M]STAORISCR = IMPENT

## Zone LOCORICOD
mkstat = 0
zoncou = "LOCORICOD"
indice = 0
IMPENT = [M]LOCORICOD
If varinit([M]LOCORICOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOCORICOD,indice)=0
 [M]LOCORICOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOCORICOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOCORICOD(indice)
 Endif
Endif
[M]LOCORICOD = IMPENT

## Zone LOCORISCR
mkstat = 0
zoncou = "LOCORISCR"
indice = 0
IMPENT = [M]LOCORISCR
If varinit([M]LOCORISCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOCORISCR,indice)=0
 [M]LOCORISCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOCORISCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOCORISCR(indice)
 Endif
Endif
[M]LOCORISCR = IMPENT

## Zone WRHORICOD
mkstat = 0
zoncou = "WRHORICOD"
indice = 0
IMPENT = [M]WRHORICOD
If varinit([M]WRHORICOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHORICOD,indice)=0
 [M]WRHORICOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHORICOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHORICOD(indice)
 Endif
Endif
[M]WRHORICOD = IMPENT

## Zone WRHORISCR
mkstat = 0
zoncou = "WRHORISCR"
indice = 0
IMPENT = [M]WRHORISCR
If varinit([M]WRHORISCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHORISCR,indice)=0
 [M]WRHORISCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHORISCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHORISCR(indice)
 Endif
Endif
[M]WRHORISCR = IMPENT

## Zone PCUCOD
mkstat = 0
zoncou = "PCUCOD"
indice = 0
IMPENT = [M]PCUCOD
If varinit([M]PCUCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUCOD,indice)=0
 [M]PCUCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUCOD(indice)
 Endif
Endif
[M]PCUCOD = IMPENT

## Zone PCUSCR
mkstat = 0
zoncou = "PCUSCR"
indice = 0
IMPENT = [M]PCUSCR
If varinit([M]PCUSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUSCR,indice)=0
 [M]PCUSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUSCR(indice)
 Endif
Endif
[M]PCUSCR = IMPENT

## Zone QTYPCUCOD
mkstat = 0
zoncou = "QTYPCUCOD"
indice = 0
IMPENT = [M]QTYPCUCOD
If varinit([M]QTYPCUCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYPCUCOD,indice)=0
 [M]QTYPCUCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYPCUCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYPCUCOD(indice)
 Endif
Endif
[M]QTYPCUCOD = IMPENT

## Zone QTYPCUSCR
mkstat = 0
zoncou = "QTYPCUSCR"
indice = 0
IMPENT = [M]QTYPCUSCR
If varinit([M]QTYPCUSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYPCUSCR,indice)=0
 [M]QTYPCUSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYPCUSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYPCUSCR(indice)
 Endif
Endif
[M]QTYPCUSCR = IMPENT

## Zone PCUSTUCOD
mkstat = 0
zoncou = "PCUSTUCOD"
indice = 0
IMPENT = [M]PCUSTUCOD
If varinit([M]PCUSTUCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUSTUCOD,indice)=0
 [M]PCUSTUCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUSTUCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUSTUCOD(indice)
 Endif
Endif
[M]PCUSTUCOD = IMPENT

## Zone PCUSTUSCR
mkstat = 0
zoncou = "PCUSTUSCR"
indice = 0
IMPENT = [M]PCUSTUSCR
If varinit([M]PCUSTUSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]PCUSTUSCR,indice)=0
 [M]PCUSTUSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUSTUSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PCUSTUSCR(indice)
 Endif
Endif
[M]PCUSTUSCR = IMPENT

## Zone QTYSTUCOD
mkstat = 0
zoncou = "QTYSTUCOD"
indice = 0
IMPENT = [M]QTYSTUCOD
If varinit([M]QTYSTUCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYSTUCOD,indice)=0
 [M]QTYSTUCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYSTUCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYSTUCOD(indice)
 Endif
Endif
[M]QTYSTUCOD = IMPENT

## Zone QTYSTUSCR
mkstat = 0
zoncou = "QTYSTUSCR"
indice = 0
IMPENT = [M]QTYSTUSCR
If varinit([M]QTYSTUSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]QTYSTUSCR,indice)=0
 [M]QTYSTUSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYSTUSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QTYSTUSCR(indice)
 Endif
Endif
[M]QTYSTUSCR = IMPENT

## Zone PJTCOD
mkstat = 0
zoncou = "PJTCOD"
indice = 0
IMPENT = [M]PJTCOD
If varinit([M]PJTCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]PJTCOD,indice)=0
 [M]PJTCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PJTCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PJTCOD(indice)
 Endif
Endif
[M]PJTCOD = IMPENT

## Zone PJTSCR
mkstat = 0
zoncou = "PJTSCR"
indice = 0
IMPENT = [M]PJTSCR
If varinit([M]PJTSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]PJTSCR,indice)=0
 [M]PJTSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "PJTSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]PJTSCR(indice)
 Endif
Endif
[M]PJTSCR = IMPENT

####################################
## Bloc liste 2
####################################
IMPTBL = 0

## Zone CRIT1
mkstat = 0
zoncou = "CRIT1"
indice = 0
IMPENT = [M]CRIT1
If varinit([M]CRIT1,indice)=0
 IMPENT = 1
Endif
If varmode([M]CRIT1,indice)=0
 [M]CRIT1(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "CRIT1" : Gosub ACTION From =IMPTRT
  IMPENT = [M]CRIT1(indice)
 Endif
Endif
[M]CRIT1 = IMPENT

## Zone CRIT2
mkstat = 0
zoncou = "CRIT2"
indice = 0
IMPENT = [M]CRIT2
If varinit([M]CRIT2,indice)=0
 IMPENT = 1
Endif
If varmode([M]CRIT2,indice)=0
 [M]CRIT2(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "CRIT2" : Gosub ACTION From =IMPTRT
  IMPENT = [M]CRIT2(indice)
 Endif
Endif
[M]CRIT2 = IMPENT

## Zone ORIFLG
mkstat = 0
zoncou = "ORIFLG"
indice = 0
IMPENT = [M]ORIFLG
If varinit([M]ORIFLG,indice)=0
 IMPENT = 1
Endif
[M]ORIFLG = IMPENT

## Zone ALLSTKFLG
mkstat = 0
zoncou = "ALLSTKFLG"
indice = 0
IMPENT = [M]ALLSTKFLG
If varinit([M]ALLSTKFLG,indice)=0
 IMPENT = 1
Endif
[M]ALLSTKFLG = IMPENT

####################################
## Bloc liste 3
####################################
IMPTBL = 0

## Zone WRHCOD
mkstat = 0
zoncou = "WRHCOD"
indice = 0
IMPENT = [M]WRHCOD
If varinit([M]WRHCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHCOD,indice)=0
 [M]WRHCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHCOD(indice)
 Endif
Endif
[M]WRHCOD = IMPENT

## Zone WRHOBY
mkstat = 0
zoncou = "WRHOBY"
indice = 0
IMPENT = [M]WRHOBY
WNUM = IMPENT
If varinit([M]WRHOBY,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHOBY,indice)=0
 [M]WRHOBY(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHOBY" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHOBY(indice)
 Endif
 If WNUM<>IMPENT or IMPMOD
  SAVACT = GACTION : GACTION = "STD"
  Call AM_WRHOBY(IMPENT) From SUBSRG
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "WRHOBY" : GZNUM = 40968 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]WRHOBY = IMPENT

mkstat = 0

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "SRG2"
Return

