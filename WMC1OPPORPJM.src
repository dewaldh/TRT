#<AdxTL>@(#)0.0.0.0 $Revision$Class PJM project
# Supervisor
## ACLA-CLASSE ## OPPORPJM
# 2018-12-07 03:26:42 311


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : OPPNUM Project chrono ( Field VCR 30)
####################################################################

$SET_OPPNUM
If [L]_AOLDVAL<>this.OPPNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPNUM
 Gosub PROPAGATE_OPPNUM
Endif
Return

$INIT_OPPNUM
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPNUM
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPNUM
[L]CURPRO = "OPPNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPNUM
[L]CURPRO = "OPPNUM"
If vireblc(this.OPPNUM,2)<>vireblc(format$("K:30X",this.OPPNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPNUM
[L]CURPRO = "OPPNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPNUM
[L]CURPRO = "OPPNUM"
Return

$PROPAGATE_OPPNUM
this.isReadonly = 0
[L]CURPRO = "OPPNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPNUM
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPNUM"
$_LNKPRO_OPPNUM
Return

$_ALOADATTRIBUTE_OPPNUM
[L]ASTATUS = fmet this.ASETATTRIBUTE("OPPNUM","$isMandatory","true")
Return


####################################################################
# 2 : OPPINT Internal ( Field Local menu number 1)
####################################################################

$SET_OPPINT
If [L]_AOLDVAL<>this.OPPINT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPINT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPINT
 Gosub PROPAGATE_OPPINT
Endif
Return

$INIT_OPPINT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPINT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPINT=0 and fmet this.AGETATTRIBUTE("OPPINT","$isMandatory")="true"
 this.OPPINT = 1
Endif
Return
 
$CONTROL_OPPINT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPINT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPINT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPINT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPINT
[L]CURPRO = "OPPINT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPINT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPINT
[L]CURPRO = "OPPINT"
If this.OPPINT<0 or this.OPPINT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPINT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPINT
[L]CURPRO = "OPPINT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPINT
[L]CURPRO = "OPPINT"
Return

$PROPAGATE_OPPINT
this.isReadonly = 0
[L]CURPRO = "OPPINT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPINT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPINT"
$_LNKPRO_OPPINT
Return


####################################################################
# 3 : OPPFRT Projected ( Field Local menu number 1)
####################################################################

$SET_OPPFRT
If [L]_AOLDVAL<>this.OPPFRT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPFRT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPFRT
 Gosub PROPAGATE_OPPFRT
Endif
Return

$INIT_OPPFRT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPFRT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPFRT=0 and fmet this.AGETATTRIBUTE("OPPFRT","$isMandatory")="true"
 this.OPPFRT = 1
Endif
Return
 
$CONTROL_OPPFRT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPFRT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPFRT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPFRT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPFRT
[L]CURPRO = "OPPFRT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPFRT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPFRT
[L]CURPRO = "OPPFRT"
If this.OPPFRT<0 or this.OPPFRT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPFRT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPFRT
[L]CURPRO = "OPPFRT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPFRT
[L]CURPRO = "OPPFRT"
Return

$PROPAGATE_OPPFRT
this.isReadonly = 0
[L]CURPRO = "OPPFRT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPFRT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPFRT"
$_LNKPRO_OPPFRT
Return


####################################################################
# 4 : OPPSTATE Status ( Field Local menu number 2249)
####################################################################

$SET_OPPSTATE
If [L]_AOLDVAL<>this.OPPSTATE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPSTATE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPSTATE
 Gosub PROPAGATE_OPPSTATE
Endif
Return

$INIT_OPPSTATE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPSTATE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPSTATE=0 and fmet this.AGETATTRIBUTE("OPPSTATE","$isMandatory")="true"
 this.OPPSTATE = 1
Endif
Return
 
$CONTROL_OPPSTATE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPSTATE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPSTATE              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPSTATE              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPSTATE
[L]CURPRO = "OPPSTATE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPSTATE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPSTATE
[L]CURPRO = "OPPSTATE"
If this.OPPSTATE<0 or this.OPPSTATE>len(mess(0,2249,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2249 ->"-num$(this.OPPSTATE)-mess(99,123,1)):  Return : # Local menu "2249 -> Invalid option
Endif
Return

$_AOTHERS_OPPSTATE
[L]CURPRO = "OPPSTATE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPSTATE
[L]CURPRO = "OPPSTATE"
Return

$PROPAGATE_OPPSTATE
this.isReadonly = 0
[L]CURPRO = "OPPSTATE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPSTATE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPSTATE"
$_LNKPRO_OPPSTATE
Return


####################################################################
# 5 : OPPDATTH Suspension date ( Field D)
####################################################################

$SET_OPPDATTH
If [L]_AOLDVAL<>this.OPPDATTH
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDATTH
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPDATTH
 Gosub PROPAGATE_OPPDATTH
Endif
Return

$INIT_OPPDATTH
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATTH"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDATTH
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATTH"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDATTH              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDATTH              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDATTH
[L]CURPRO = "OPPDATTH"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPDATTH=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDATTH
[L]CURPRO = "OPPDATTH"
Return

$_AOTHERS_OPPDATTH
[L]CURPRO = "OPPDATTH"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDATTH
[L]CURPRO = "OPPDATTH"
Return

$PROPAGATE_OPPDATTH
this.isReadonly = 0
[L]CURPRO = "OPPDATTH"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDATTH
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATTH"
$_LNKPRO_OPPDATTH
Return


####################################################################
# 6 : OPPDATLV Delivery date ( Field D)
####################################################################

$SET_OPPDATLV
If [L]_AOLDVAL<>this.OPPDATLV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDATLV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPDATLV
 Gosub PROPAGATE_OPPDATLV
Endif
Return

$INIT_OPPDATLV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDATLV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDATLV              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDATLV              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDATLV
[L]CURPRO = "OPPDATLV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPDATLV=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDATLV
[L]CURPRO = "OPPDATLV"
Return

$_AOTHERS_OPPDATLV
[L]CURPRO = "OPPDATLV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDATLV
[L]CURPRO = "OPPDATLV"
Return

$PROPAGATE_OPPDATLV
this.isReadonly = 0
[L]CURPRO = "OPPDATLV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDATLV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLV"
$_LNKPRO_OPPDATLV
Return


####################################################################
# 7 : OPPDATS Date closed ( Field D)
####################################################################

$SET_OPPDATS
If [L]_AOLDVAL<>this.OPPDATS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDATS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPDATS
 Gosub PROPAGATE_OPPDATS
Endif
Return

$INIT_OPPDATS
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDATS
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDATS               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDATS               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDATS
[L]CURPRO = "OPPDATS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPDATS=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDATS
[L]CURPRO = "OPPDATS"
Return

$_AOTHERS_OPPDATS
[L]CURPRO = "OPPDATS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDATS
[L]CURPRO = "OPPDATS"
Return

$PROPAGATE_OPPDATS
this.isReadonly = 0
[L]CURPRO = "OPPDATS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDATS
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATS"
$_LNKPRO_OPPDATS
Return


####################################################################
# 8 : OPPDATLA Launch date ( Field D)
####################################################################

$SET_OPPDATLA
If [L]_AOLDVAL<>this.OPPDATLA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDATLA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPDATLA
 Gosub PROPAGATE_OPPDATLA
Endif
Return

$INIT_OPPDATLA
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDATLA
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDATLA              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDATLA              : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDATLA
[L]CURPRO = "OPPDATLA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPDATLA=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDATLA
[L]CURPRO = "OPPDATLA"
Return

$_AOTHERS_OPPDATLA
[L]CURPRO = "OPPDATLA"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDATLA
[L]CURPRO = "OPPDATLA"
Return

$PROPAGATE_OPPDATLA
this.isReadonly = 0
[L]CURPRO = "OPPDATLA"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDATLA
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDATLA"
$_LNKPRO_OPPDATLA
Return


####################################################################
# 9 : OPPPROACTIV Activation ( Field Local menu number 1)
####################################################################

$SET_OPPPROACTIV
If [L]_AOLDVAL<>this.OPPPROACTIV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPPROACTIV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPPROACTIV
 Gosub PROPAGATE_OPPPROACTIV
Endif
Return

$INIT_OPPPROACTIV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPPROACTIV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPPROACTIV=0 and fmet this.AGETATTRIBUTE("OPPPROACTIV","$isMandatory")="true"
 this.OPPPROACTIV = 1
Endif
Return
 
$CONTROL_OPPPROACTIV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPPROACTIV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPPROACTIV           : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPPROACTIV           : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPPROACTIV
[L]CURPRO = "OPPPROACTIV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPPROACTIV=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPPROACTIV
[L]CURPRO = "OPPPROACTIV"
If this.OPPPROACTIV<0 or this.OPPPROACTIV>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPPROACTIV)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPPROACTIV
[L]CURPRO = "OPPPROACTIV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPPROACTIV
[L]CURPRO = "OPPPROACTIV"
Return

$PROPAGATE_OPPPROACTIV
this.isReadonly = 0
[L]CURPRO = "OPPPROACTIV"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPPROACTIV
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPPROACTIV"
$_LNKPRO_OPPPROACTIV
Return


####################################################################
# 10 : CUROPP Financial currency ( Field CUR 3)
####################################################################

$SET_CUROPP
If [L]_AOLDVAL<>this.CUROPP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUROPP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUROPP
 Gosub PROPAGATE_CUROPP
Endif
Return

$INIT_CUROPP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUROPP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUROPP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUROPP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUROPP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUROPP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUROPP
[L]CURPRO = "CUROPP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUROPP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUROPP
[L]CURPRO = "CUROPP"
If vireblc(this.CUROPP,2)<>vireblc(format$("K:3c",this.CUROPP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUROPP
[L]CURPRO = "CUROPP"
If vireblc(this.CUROPP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUROPP",this.CUROPP,this.CUROPP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUROPP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUROPP
[L]CURPRO = "CUROPP"
Return

$PROPAGATE_CUROPP
this.isReadonly = 0
[L]CURPRO = "CUROPP"
Gosub _LNKPRO_CUROPP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUROPP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUROPP"
$_LNKPRO_CUROPP
If vireblc(this.CUROPP,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUROPP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUROPP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUROPP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUROPP","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUROPP","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUROPP","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return


####################################################################
# 11 : OPPIMPT Budgeting intermediate levels ( Field Local menu number 1)
####################################################################

$SET_OPPIMPT
If [L]_AOLDVAL<>this.OPPIMPT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPIMPT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPIMPT
 Gosub PROPAGATE_OPPIMPT
Endif
Return

$INIT_OPPIMPT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPIMPT=0 and fmet this.AGETATTRIBUTE("OPPIMPT","$isMandatory")="true"
 this.OPPIMPT = 1
Endif
Return
 
$CONTROL_OPPIMPT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPIMPT               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPIMPT               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPIMPT
[L]CURPRO = "OPPIMPT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPIMPT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPIMPT
[L]CURPRO = "OPPIMPT"
If this.OPPIMPT<0 or this.OPPIMPT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPIMPT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPIMPT
[L]CURPRO = "OPPIMPT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPIMPT
[L]CURPRO = "OPPIMPT"
Return

$PROPAGATE_OPPIMPT
this.isReadonly = 0
[L]CURPRO = "OPPIMPT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPIMPT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPT"
$_LNKPRO_OPPIMPT
Return


####################################################################
# 12 : OPPIMPTLOCK Batch lock ( Field Local menu number 1)
####################################################################

$SET_OPPIMPTLOCK
If [L]_AOLDVAL<>this.OPPIMPTLOCK
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPIMPTLOCK
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPIMPTLOCK
 Gosub PROPAGATE_OPPIMPTLOCK
Endif
Return

$INIT_OPPIMPTLOCK
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPTLOCK"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPIMPTLOCK=0 and fmet this.AGETATTRIBUTE("OPPIMPTLOCK","$isMandatory")="true"
 this.OPPIMPTLOCK = 1
Endif
Return
 
$CONTROL_OPPIMPTLOCK
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPTLOCK"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPIMPTLOCK           : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPIMPTLOCK           : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPIMPTLOCK
[L]CURPRO = "OPPIMPTLOCK"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPIMPTLOCK=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPIMPTLOCK
[L]CURPRO = "OPPIMPTLOCK"
If this.OPPIMPTLOCK<0 or this.OPPIMPTLOCK>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPIMPTLOCK)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPIMPTLOCK
[L]CURPRO = "OPPIMPTLOCK"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPIMPTLOCK
[L]CURPRO = "OPPIMPTLOCK"
Return

$PROPAGATE_OPPIMPTLOCK
this.isReadonly = 0
[L]CURPRO = "OPPIMPTLOCK"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPIMPTLOCK
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPIMPTLOCK"
$_LNKPRO_OPPIMPTLOCK
Return


####################################################################
# 13 : OPEDEFFCY Operating site ( Field FCY 5)
####################################################################

$SET_OPEDEFFCY
If [L]_AOLDVAL<>this.OPEDEFFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPEDEFFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPEDEFFCY
 Gosub PROPAGATE_OPEDEFFCY
Endif
Return

$INIT_OPEDEFFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPEDEFFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPEDEFFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPEDEFFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPEDEFFCY             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPEDEFFCY             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPEDEFFCY
[L]CURPRO = "OPEDEFFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPEDEFFCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPEDEFFCY
[L]CURPRO = "OPEDEFFCY"
If vireblc(this.OPEDEFFCY,2)<>vireblc(format$("K:5c",this.OPEDEFFCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPEDEFFCY
[L]CURPRO = "OPEDEFFCY"
If vireblc(this.OPEDEFFCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"OPEDEFFCY",this.OPEDEFFCY,this.OPEDEFFCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPEDEFFCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPEDEFFCY
[L]CURPRO = "OPEDEFFCY"
Return

$PROPAGATE_OPEDEFFCY
this.isReadonly = 0
[L]CURPRO = "OPEDEFFCY"
Gosub _LNKPRO_OPEDEFFCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPEDEFFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPEDEFFCY"
$_LNKPRO_OPEDEFFCY
If vireblc(this.OPEDEFFCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.OPEDEFFCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPEDEFFCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPEDEFFCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return

$_ALOADATTRIBUTE_OPEDEFFCY
[L]ASTATUS = fmet this.ASETATTRIBUTE("OPEDEFFCY","$isMandatory","true")
Return


####################################################################
# 14 : OPPMOD Template ( Field Local menu number 1)
####################################################################

$SET_OPPMOD
If [L]_AOLDVAL<>this.OPPMOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPMOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPMOD
 Gosub PROPAGATE_OPPMOD
Endif
Return

$INIT_OPPMOD
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPMOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OPPMOD=0 and fmet this.AGETATTRIBUTE("OPPMOD","$isMandatory")="true"
 this.OPPMOD = 1
Endif
Return
 
$CONTROL_OPPMOD
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPMOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPMOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPMOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPMOD
[L]CURPRO = "OPPMOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OPPMOD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPMOD
[L]CURPRO = "OPPMOD"
If this.OPPMOD<0 or this.OPPMOD>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OPPMOD)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OPPMOD
[L]CURPRO = "OPPMOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPMOD
[L]CURPRO = "OPPMOD"
Return

$PROPAGATE_OPPMOD
this.isReadonly = 0
[L]CURPRO = "OPPMOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPMOD
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPMOD"
$_LNKPRO_OPPMOD
Return


####################################################################
# 15 : YDEFACC Default Account ( Field A 15)
####################################################################

$SET_YDEFACC
If [L]_AOLDVAL<>this.YDEFACC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_YDEFACC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.YDEFACC
 Gosub PROPAGATE_YDEFACC
Endif
Return

$INIT_YDEFACC
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "YDEFACC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_YDEFACC
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "YDEFACC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_YDEFACC               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_YDEFACC               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_YDEFACC
[L]CURPRO = "YDEFACC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.YDEFACC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_YDEFACC
[L]CURPRO = "YDEFACC"
Return

$_AOTHERS_YDEFACC
[L]CURPRO = "YDEFACC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_YDEFACC
[L]CURPRO = "YDEFACC"
Return

$PROPAGATE_YDEFACC
this.isReadonly = 0
[L]CURPRO = "YDEFACC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_YDEFACC
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "YDEFACC"
$_LNKPRO_YDEFACC
Return


####################################################################
# 16 : OPPDESTEX Description ( Field ACPLAIN 1)
####################################################################

$GET_OPPDESTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDESTEX"
Local Char _CNT(100)
Local Tinyint _EXI : [L]_EXI=1
[L]ASTATUS = fmet this.AREAD_CLB("OPPDESTEX",
& "OPPORPJM"
& +[V]CST_AURLSEPLOB+"OPPDESTEX"
& +[V]CST_AURLSEPLOB+this.OPPNUM
& +[V]CST_AURLSEPLOB+AVOID.ACHAR
& +[V]CST_AURLSEPLOB+AVOID.ACHAR
& ,[L]_CNT,this.OPPDESTEX)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isLoaded")<>"true"
 [L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
Endif
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_OPPDESTEX
If fmet this.AGETATTRIBUTE("OPPDESTEX","$isLoaded")<>"true" or [L]_AOLDVAL<>this.OPPDESTEX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPDESTEX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE("OPPDESTEX","$isLoaded")<>"true" or [L]_AOLDVAL<>this.OPPDESTEX
 Gosub PROPAGATE_OPPDESTEX
Endif
Return

$INIT_OPPDESTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDESTEX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPDESTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDESTEX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPDESTEX             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPDESTEX             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPDESTEX
[L]CURPRO = "OPPDESTEX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & len(this.OPPDESTEX)=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPDESTEX
[L]CURPRO = "OPPDESTEX"
Return

$_AOTHERS_OPPDESTEX
[L]CURPRO = "OPPDESTEX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPDESTEX
[L]CURPRO = "OPPDESTEX"
Return

$PROPAGATE_OPPDESTEX
this.isReadonly = 0
[L]CURPRO = "OPPDESTEX"
[L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPDESTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPDESTEX"
$_LNKPRO_OPPDESTEX
Local Tinyint _EXI : [L]_EXI=1
Gosub READ_EXI_OPPDESTEX From WMC0OPPORPJM
[L]ASTATUS = fmet this.ASETATTRIBUTE("OPPDESTEX","$isLobFound",func ASYRSUB.BOOLEAN_TO_SYR([L]_EXI+1))
Return


####################################################################
# 17 : OPPCOMTEX Comment ( Field ACPLAIN 1)
####################################################################

$GET_OPPCOMTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCOMTEX"
Local Char _CNT(100)
Local Tinyint _EXI : [L]_EXI=1
[L]ASTATUS = fmet this.AREAD_CLB("OPPCOMTEX",
& "OPPORPJM"
& +[V]CST_AURLSEPLOB+"OPPCOMTEX"
& +[V]CST_AURLSEPLOB+this.OPPNUM
& +[V]CST_AURLSEPLOB+AVOID.ACHAR
& +[V]CST_AURLSEPLOB+AVOID.ACHAR
& ,[L]_CNT,this.OPPCOMTEX)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isLoaded")<>"true"
 [L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
Endif
[L]ARULE = "GET" : [L]ACTION = "GET" : Gosub ACTION From ASYRSUB
Return

$SET_OPPCOMTEX
If fmet this.AGETATTRIBUTE("OPPCOMTEX","$isLoaded")<>"true" or [L]_AOLDVAL<>this.OPPCOMTEX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPCOMTEX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If fmet this.AGETATTRIBUTE("OPPCOMTEX","$isLoaded")<>"true" or [L]_AOLDVAL<>this.OPPCOMTEX
 Gosub PROPAGATE_OPPCOMTEX
Endif
Return

$INIT_OPPCOMTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCOMTEX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPCOMTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCOMTEX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPCOMTEX             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPCOMTEX             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPCOMTEX
[L]CURPRO = "OPPCOMTEX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & len(this.OPPCOMTEX)=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPCOMTEX
[L]CURPRO = "OPPCOMTEX"
Return

$_AOTHERS_OPPCOMTEX
[L]CURPRO = "OPPCOMTEX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPCOMTEX
[L]CURPRO = "OPPCOMTEX"
Return

$PROPAGATE_OPPCOMTEX
this.isReadonly = 0
[L]CURPRO = "OPPCOMTEX"
[L]ASTATUS = fmet this.ASETATTRIBUTE([L]CURPRO,"$isLoaded","true")
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPCOMTEX
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCOMTEX"
$_LNKPRO_OPPCOMTEX
Local Tinyint _EXI : [L]_EXI=1
Gosub READ_EXI_OPPCOMTEX From WMC0OPPORPJM
[L]ASTATUS = fmet this.ASETATTRIBUTE("OPPCOMTEX","$isLobFound",func ASYRSUB.BOOLEAN_TO_SYR([L]_EXI+1))
Return


####################################################################
# 20 : TASBUDAUT Task creates budget ( Field Local menu number 1)
####################################################################

$SET_TASBUDAUT
If [L]_AOLDVAL<>this.TASBUDAUT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TASBUDAUT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TASBUDAUT
 Gosub PROPAGATE_TASBUDAUT
Endif
Return

$INIT_TASBUDAUT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TASBUDAUT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TASBUDAUT=0 and fmet this.AGETATTRIBUTE("TASBUDAUT","$isMandatory")="true"
 this.TASBUDAUT = 1
Endif
Return
 
$CONTROL_TASBUDAUT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TASBUDAUT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TASBUDAUT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TASBUDAUT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TASBUDAUT
[L]CURPRO = "TASBUDAUT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TASBUDAUT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TASBUDAUT
[L]CURPRO = "TASBUDAUT"
If this.TASBUDAUT<0 or this.TASBUDAUT>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.TASBUDAUT)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_TASBUDAUT
[L]CURPRO = "TASBUDAUT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TASBUDAUT
[L]CURPRO = "TASBUDAUT"
Return

$PROPAGATE_TASBUDAUT
this.isReadonly = 0
[L]CURPRO = "TASBUDAUT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TASBUDAUT
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TASBUDAUT"
$_LNKPRO_TASBUDAUT
Return

$_ALOADATTRIBUTE_TASBUDAUT
[L]ASTATUS = fmet this.ASETATTRIBUTE("TASBUDAUT","$isMandatory","true")
Return


####################################################################
# 24 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return

$_ALOADATTRIBUTE_CUR
[L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$isMandatory","true")
Return


####################################################################
# 25 : SALFCY Sales site ( Field FCY 5)
####################################################################

$SET_SALFCY
If [L]_AOLDVAL<>this.SALFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SALFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SALFCY
 Gosub PROPAGATE_SALFCY
Endif
Return

$INIT_SALFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "SALFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SALFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "SALFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SALFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SALFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SALFCY
[L]CURPRO = "SALFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SALFCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SALFCY
[L]CURPRO = "SALFCY"
If vireblc(this.SALFCY,2)<>vireblc(format$("K:5c",this.SALFCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SALFCY
[L]CURPRO = "SALFCY"
If vireblc(this.SALFCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"SALFCY",this.SALFCY,this.SALFCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.SALFCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SALFCY
[L]CURPRO = "SALFCY"
Return

$PROPAGATE_SALFCY
this.isReadonly = 0
[L]CURPRO = "SALFCY"
Gosub _LNKPRO_SALFCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SALFCY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "SALFCY"
$_LNKPRO_SALFCY
If vireblc(this.SALFCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.SALFCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return

$_ALOADATTRIBUTE_SALFCY
[L]ASTATUS = fmet this.ASETATTRIBUTE("SALFCY","$isMandatory","true")
Return


####################################################################
# 26 : CPY Company ( Field CPY 5)
####################################################################

$SET_CPY
If [L]_AOLDVAL<>this.CPY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CPY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CPY
 Gosub PROPAGATE_CPY
Endif
Return

$INIT_CPY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CPY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CPY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CPY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CPY
[L]CURPRO = "CPY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CPY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>vireblc(format$("K:5c",this.CPY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCPY.ACTRLREF(this,"CPY",this.CPY,this.CPY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CPY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CPY
[L]CURPRO = "CPY"
Return

$PROPAGATE_CPY
this.isReadonly = 0
[L]CURPRO = "CPY"
Gosub _LNKPRO_CPY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CPY
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "CPY"
$_LNKPRO_CPY
If vireblc(this.CPY,2)<>""
 # Link COMPANY
 Local File COMPANY [WCPY]
 Read [F:WCPY]CPY0 = this.CPY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$title",[F:WCPY]CPYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$description",[F:WCPY]CPYNAM)
 Endif
 LogicClose File [WCPY]
Endif
Return


####################################################################
# 27 : TCHREPDIECCE Response: 1=no, 2-yes ( Field Local menu number 1)
####################################################################

$SET_TCHREPDIECCE
If [L]_AOLDVAL<>this.TCHREPDIECCE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHREPDIECCE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHREPDIECCE
 Gosub PROPAGATE_TCHREPDIECCE
Endif
Return

$INIT_TCHREPDIECCE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHREPDIECCE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TCHREPDIECCE=0 and fmet this.AGETATTRIBUTE("TCHREPDIECCE","$isMandatory")="true"
 this.TCHREPDIECCE = 1
Endif
Return
 
$CONTROL_TCHREPDIECCE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHREPDIECCE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHREPDIECCE          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHREPDIECCE          : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHREPDIECCE
[L]CURPRO = "TCHREPDIECCE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TCHREPDIECCE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHREPDIECCE
[L]CURPRO = "TCHREPDIECCE"
If this.TCHREPDIECCE<0 or this.TCHREPDIECCE>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.TCHREPDIECCE)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_TCHREPDIECCE
[L]CURPRO = "TCHREPDIECCE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHREPDIECCE
[L]CURPRO = "TCHREPDIECCE"
Return

$PROPAGATE_TCHREPDIECCE
this.isReadonly = 0
[L]CURPRO = "TCHREPDIECCE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHREPDIECCE
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHREPDIECCE"
$_LNKPRO_TCHREPDIECCE
Return


####################################################################
# 28 : TCHACTION Action ( Field A 20)
####################################################################

$SET_TCHACTION
If [L]_AOLDVAL<>this.TCHACTION
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHACTION
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHACTION
 Gosub PROPAGATE_TCHACTION
Endif
Return

$INIT_TCHACTION
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHACTION"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TCHACTION
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHACTION"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHACTION             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHACTION             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHACTION
[L]CURPRO = "TCHACTION"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TCHACTION,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHACTION
[L]CURPRO = "TCHACTION"
Return

$_AOTHERS_TCHACTION
[L]CURPRO = "TCHACTION"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHACTION
[L]CURPRO = "TCHACTION"
Return

$PROPAGATE_TCHACTION
this.isReadonly = 0
[L]CURPRO = "TCHACTION"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHACTION
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHACTION"
$_LNKPRO_TCHACTION
Return


####################################################################
# 29 : TCHCHGTYP Rate type ( Field Local menu number 202)
####################################################################

$SET_TCHCHGTYP
If [L]_AOLDVAL<>this.TCHCHGTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TCHCHGTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TCHCHGTYP
 Gosub PROPAGATE_TCHCHGTYP
Endif
Return

$INIT_TCHCHGTYP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHCHGTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TCHCHGTYP=0 and fmet this.AGETATTRIBUTE("TCHCHGTYP","$isMandatory")="true"
 this.TCHCHGTYP = 1
Endif
Return
 
$CONTROL_TCHCHGTYP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHCHGTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TCHCHGTYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TCHCHGTYP             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TCHCHGTYP
[L]CURPRO = "TCHCHGTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TCHCHGTYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TCHCHGTYP
[L]CURPRO = "TCHCHGTYP"
If this.TCHCHGTYP<0 or this.TCHCHGTYP>len(mess(0,202,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"202 ->"-num$(this.TCHCHGTYP)-mess(99,123,1)):  Return : # Local menu "202 -> Invalid option
Endif
Return

$_AOTHERS_TCHCHGTYP
[L]CURPRO = "TCHCHGTYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TCHCHGTYP
[L]CURPRO = "TCHCHGTYP"
Return

$PROPAGATE_TCHCHGTYP
this.isReadonly = 0
[L]CURPRO = "TCHCHGTYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TCHCHGTYP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "TCHCHGTYP"
$_LNKPRO_TCHCHGTYP
Return


####################################################################
# 30 : OPPCMP BP ( Field BPC 15)
####################################################################

$SET_OPPCMP
If [L]_AOLDVAL<>this.OPPCMP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OPPCMP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OPPCMP
 Gosub PROPAGATE_OPPCMP
Endif
Return

$INIT_OPPCMP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCMP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OPPCMP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCMP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OPPCMP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OPPCMP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OPPCMP
[L]CURPRO = "OPPCMP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OPPCMP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OPPCMP
[L]CURPRO = "OPPCMP"
If vireblc(this.OPPCMP,2)<>vireblc(format$("K:15c",this.OPPCMP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OPPCMP
[L]CURPRO = "OPPCMP"
If vireblc(this.OPPCMP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPC.ACTRLREF(this,"OPPCMP",this.OPPCMP,this.OPPCMP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.OPPCMP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OPPCMP
[L]CURPRO = "OPPCMP"
Return

$PROPAGATE_OPPCMP
this.isReadonly = 0
[L]CURPRO = "OPPCMP"
Gosub _LNKPRO_OPPCMP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OPPCMP
Gosub DECLARE_VAR From WMC0OPPORPJM
[L]CURPRO = "OPPCMP"
$_LNKPRO_OPPCMP
If vireblc(this.OPPCMP,2)<>""
 # Link BPCUSTOMER
 Local File BPCUSTOMER [WBPC]
 Read [F:WBPC]BPC0 = this.OPPCMP
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPCMP","$title",[F:WBPC]BPCSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("OPPCMP","$description",[F:WBPC]BPCNAM)
 Endif
 LogicClose File [WBPC]
Endif
Return




