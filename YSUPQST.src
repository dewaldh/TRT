#<AdxTL>@(#)0.0.0.0 $Revision$
#-----------------------------------------------------------------------
# FILE NAME   : YSUPQST
# DESCRIPTION : Supplier questionnaire validations and executions
#-----------------------------------------------------------------------
# DATE        : 10-08-2018
# AUTHOR      : Dewald Henning
# COMPANY     : Leverage Technologies
#-----------------------------------------------------------------------
# Epics Code  : DFCX1-36
#-----------------------------------------------------------------------

#Gosub SUPP_QST_WS
Gosub SUPP_QST_TMPLT


$SUPP_QST_TMPLT
Local Char NAME(50),LINE1(255),LINE2(255),LINE3(255),LINE4(255),LINE5(255),LINE6(255),LINE7(255),LINE8(255),LINE9(255),LINE10(255)
Local Char LINE11(255),LINE12(255),LINE13(255),LINE14(255),LINE15(255),LINE16(255),LINE17(255),LINE18(255),LINE19(255),LINE20(255)
Local Char REP(50)

If clalev([F:YBPR])=0 : Local File BPARTNER  [YBPR] : Endif
If clalev([F:YADO])=0 : Local File ADOVALAUS [YADO] : Endif

adxifs = ':' : adxirs = chr$(10)

Raz LINE1



Read [F:YADO]ADU0 = GUSER;"AUSCRMF"
If fstat = 0
REP = [F:YADO]VALEUR
#Infbox num$(REP)
Endif

NAME = "TSK" + format$("D:YYMMDDhhmmss",date$)

Openo filpath('tmp',NAME,'txt'),0 Using [FIC1]

LINE1  = "TSK"
LINE2  = "001"        #TSKNUM
LINE3  = "002-1"      #FCY
LINE4  = "70004"      #BPS
LINE5  = ""
LINE6  = ""
LINE7  = ""
LINE8  = ""
LINE9  = gdat$(day(date$)+1,month(date$),year(date$))   #END
LINE10 = date$   #START
LINE11 = "B1"         #PRIORITY
LINE12 = REP           #REP
LINE13 = "2"         #
LINE14 = "1"         #
LINE15 = ""         #
LINE16 = "0"         #
LINE17 = "0"         #
LINE18 = "HD6"         #
LINE19 = "~&c~4"         #
LINE20 = "123"         #


Wrseq LINE1 Using   [FIC1]
Wrseq LINE2 Using   [FIC1]
Wrseq LINE3 Using   [FIC1]
Wrseq LINE4 Using   [FIC1]
Wrseq LINE5 Using   [FIC1]
Wrseq LINE6 Using   [FIC1]
Wrseq LINE7 Using   [FIC1]
Wrseq LINE8 Using   [FIC1]
Wrseq LINE9 Using   [FIC1]
Wrseq LINE10 Using   [FIC1]
Wrseq LINE11 Using   [FIC1]
Wrseq LINE12 Using   [FIC1]
Wrseq LINE13 Using   [FIC1]
Wrseq LINE14 Using   [FIC1]
Wrseq LINE15 Using   [FIC1]
Wrseq LINE16 Using   [FIC1]
Wrseq LINE17 Using   [FIC1]
Wrseq LINE18 Using   [FIC1]
Wrseq LINE19 Using   [FIC1]
Wrseq LINE20 Using   [FIC1]



Openo  Using [FIC1]

Call IMPORTSIL("TSK", filpath('tmp',NAME,'txt')) From GIMPOBJ
Gosub QUESTIONNAIRE
End

$QUESTIONNAIRE
#EXPORT CRYSTAL REPORT

#Variable for report parameters
Local Char    TBPAR_BP(15)(1..50),TBVAL_BP(30)(1..50)

#bpsdeb

TBPAR_BP(1) = "bpsdeb" : TBVAL_BP(1) = "70004"

#Call at the standard X3 Subprog to execute the report
#The Subprog ETAT needs these parameters:
#1 - "YSUPPLIERQE" Name of the report (is not the name of the rpt Crystal file)
#2 - "tmp" Name of the destination
#3 - "FRA" Language, leave this blanc to use the default language
#4 - 0 or 1 it shows or not the info message 'print executed'
#5 - TBPAR_BP
#6 - TBVAL_BP

# Run the report with the info message 'print executed'
#Call ETAT("BONLIV","VTPRTCED01","",1,"",TBPAR_BP,TBVAL_BP) From AIMP3

# Run the report without the info message
Call ETAT("YSUPPLIERQE","tmp","",0,"",TBPAR_BP,TBVAL_BP) From AIMP3


End

#$SUPP_QST_WS
#Local Integer I : I = 0
##Read Tables and do validations
#If clalev([F:BPR])=0 : Local File BPARTNER [BPR] : Endif
#If clalev([F:BPR])=0 : Local File BSUPPLIER [BPR] : Endif
##Call OUVRE From SUBTSK # From Task script
#If clalev ([M:TSK0]) = 0 : Local Mask TSK0 [TSK0] : Endif
#
##Infbox "1"
##Tick must be active and Site must not be empty
##For [BPR] Where YSNDQST = 2 and FCY <> ""
##I += 1
#
#Gosub DEFVAR From WJYTSK_V001
#
#WW_ACTION = "CREATE"
#
#SALFCY_A  = "002-1"       #SITE
#TSKCMP_A = "70003"      #BPS
#TSKNUM_A  = "001"       #TASK NUMBER
#TSKSTR_B  = "20180814"      #START DATE
#TSKDAT_B  = "20180815"      #END DATE
#TSKPIOLEV_B = "B1"    #PRIORITY LEVEL
#TSKREP_B    = "AA"
#
#Gosub WEBSERV From WJYTSK_V001
#
##TSKNUM_A <> ""
#Infbox num$(WW_OK)
##WW_OK = 1
##WW_GRAVE 1 INFO, 2 WARNING, 3 ERROR
##
##WW_MESS(1) = "Madatory fields FCY"
##WW_MESS(2) = "Madatory fields BPC"
##Next
#
#End

