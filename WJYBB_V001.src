#<AdxTL>@(#)0.0.0.0 $Revision:   1.1  $
 
#########################################################################
## Publication d'un web-service associé à un sous-programme
## Nom de Programme         : YBBIMP
## Nom de Sous-programme    : YBBIMP
## Nom de Publication       : YBB_V001
## Timestamp de génération  : 20181113202908
## Version de génération    : 6.30
#########################################################################
 
 
Local Integer WW_OK
Local Char    WW_ZONE(30)
Local Integer WW_STAT
Local Integer WW_GRAVE(1..50)
Local Char    WW_MESS(250)(1..50)
Local Char WW_ACTION
Local Char    WW_IDENT(250)
Local Integer WW_NB
Local Char    WW_HORDAT(14)
Local Char    WW_TAB(20)
Local Char    WW_PAR(80)(1..10)
Local Clbfile WW_TRACE(1)
WW_HORDAT="20181113202908"
Local Char YBATFCY(250)
Local Char YBATNBR(250)
Local Char YBATDES(250)
Local Date YBATDAT
Local Char YBATREF(250)
Local Integer YBATSTA
Local Integer YBATCAT
Local Integer YFINSTA
Local Char YBATNBRTEMP(250)
Local Integer YDETLIG(1..2000)
Local Char YENTTYP(250)(1..2000)
Local Char YJOU(250)(1..2000)
Local Integer YTRANSNBR(1..2000)
Local Char YDETDES(250)(1..2000)
Local Char YFCY(250)(1..2000)
Local Char YCPY(250)(1..2000)
Local Char YACM(250)(1..2000)
Local Char YLED1(250)(1..2000)
Local Char YELA(250)(1..2000)
Local Char YBAN(250)(1..2000)
Local Char YCOA(250)(1..2000)
Local Char YACC(250)(1..2000)
Local Char YLIGDES(250)(1..2000)
Local Char YCTRL(250)(1..2000)
Local Char YBP(250)(1..2000)
Local Decimal YDEB(1..2000)
Local Decimal YCDT(1..2000)
Local Char YTAX(250)(1..2000)
Local Decimal YGSTAMT(1..2000)
Local Decimal YAMTTAX(1..2000)
Local Char YREF(250)(1..2000)
Local Char YPJT(250)(1..2000)
Local Char YDIE0(250)(1..2000)
Local Char YCCE0(250)(1..2000)
Local Char YDIE1(250)(1..2000)
Local Char YCCE1(250)(1..2000)
Local Char YDIE2(250)(1..2000)
Local Char YCCE2(250)(1..2000)
Local Char YDIE3(250)(1..2000)
Local Char YCCE3(250)(1..2000)
Local Char YDIE4(250)(1..2000)
Local Char YCCE4(250)(1..2000)
Local Integer YBATTYP(1..2000)
Local Integer YGSTINC(1..2000)
Local Integer YSTATUS
Local Char YMESS(250)
 
 
Call OUVRE_TRACE("") From LECFIC
 
Onerrgo ERREURWS
Gosub INITWS From YBBIMP
Onerrgo
 
Call YBBIMP(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION,WW_IDENT,WW_NB,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
&            ,YBATFCY,YBATNBR,YBATDES,YBATDAT,YBATREF
&            ,YBATSTA,YBATCAT,YFINSTA,YBATNBRTEMP,YDETLIG
&            ,YENTTYP,YJOU,YTRANSNBR,YDETDES,YFCY
&            ,YCPY,YACM,YLED1,YELA,YBAN
&            ,YCOA,YACC,YLIGDES,YCTRL,YBP
&            ,YDEB,YCDT,YTAX,YGSTAMT,YAMTTAX
&            ,YREF,YPJT,YDIE0,YCCE0,YDIE1
&            ,YCCE1,YDIE2,YCCE2,YDIE3,YCCE3
&            ,YDIE4,YCCE4,YBATTYP,YGSTINC,YSTATUS
&            ,YMESS)
 
Call ECR_TRACE(mess(218,123,1)+" : "+num$(WW_OK)-"("+mess(WW_OK+3,2940,1)+")",0) From GESECRAN
Call ECR_TRACE(mess(219,123,1)+" : "+num$(WW_STAT),0) From GESECRAN
Call ECR_TRACE("  ",0) From GESECRAN
Call ECR_TRACE(mess(222,123,1),0) From GESECRAN
Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
For indice=1 To WW_STAT
  If WW_GRAVE(indice)=3
    Call ECR_TRACE(num$(indice)-num$(WW_GRAVE(indice))+" ("+mess(WW_GRAVE(indice),2940,1)+") :"-WW_MESS(indice),1) From GESECRAN
  Else
    Call ECR_TRACE(num$(indice)-num$(WW_GRAVE(indice))+" ("+mess(WW_GRAVE(indice),2940,1)+") :"-WW_MESS(indice),0) From GESECRAN
  Endif
Next indice
If WW_STAT=0 : Call ECR_TRACE("",0) From GESECRAN : Endif
Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
Onerrgo ERREURWS
Gosub RESULTWS From YBBIMP
Onerrgo
 
Call FERME_TRACE From LECFIC
Call LEC_TRACE From LECFIC
End
 
 
$ERREURWS
Resume
 
 
# --------------------------------------------------------------- 
 
Subprog YBBIMP(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION,WW_IDENT,WW_NB,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
&            ,YBATFCY,YBATNBR,YBATDES,YBATDAT,YBATREF
&            ,YBATSTA,YBATCAT,YFINSTA,YBATNBRTEMP,YDETLIG
&            ,YENTTYP,YJOU,YTRANSNBR,YDETDES,YFCY
&            ,YCPY,YACM,YLED1,YELA,YBAN
&            ,YCOA,YACC,YLIGDES,YCTRL,YBP
&            ,YDEB,YCDT,YTAX,YGSTAMT,YAMTTAX
&            ,YREF,YPJT,YDIE0,YCCE0,YDIE1
&            ,YCCE1,YDIE2,YCCE2,YDIE3,YCCE3
&            ,YDIE4,YCCE4,YBATTYP,YGSTINC,YSTATUS
&            ,YMESS)
 
Variable Integer WW_OK
Variable Char    WW_ZONE()
Variable Integer WW_STAT
Variable Integer WW_GRAVE(1..)
Variable Char    WW_MESS()(1..)
Value Char       WW_ACTION
Value Char       WW_IDENT()
Variable Integer WW_NB
Variable Char    WW_HORDAT()
Variable Char    WW_TAB()
Variable Char    WW_PAR()(1..)
Variable Clbfile WW_TRACE()
Value Char YBATFCY()
Value Char YBATNBR()
Value Char YBATDES()
Value Date YBATDAT
Value Char YBATREF()
Value Integer YBATSTA
Value Integer YBATCAT
Value Integer YFINSTA
Value Char YBATNBRTEMP()
Value Integer YDETLIG(1..)
Value Char YENTTYP()(1..)
Value Char YJOU()(1..)
Value Integer YTRANSNBR(1..)
Value Char YDETDES()(1..)
Value Char YFCY()(1..)
Value Char YCPY()(1..)
Value Char YACM()(1..)
Value Char YLED1()(1..)
Value Char YELA()(1..)
Value Char YBAN()(1..)
Value Char YCOA()(1..)
Value Char YACC()(1..)
Value Char YLIGDES()(1..)
Value Char YCTRL()(1..)
Value Char YBP()(1..)
Value Decimal YDEB(1..)
Value Decimal YCDT(1..)
Value Char YTAX()(1..)
Value Decimal YGSTAMT(1..)
Value Decimal YAMTTAX(1..)
Value Char YREF()(1..)
Value Char YPJT()(1..)
Value Char YDIE0()(1..)
Value Char YCCE0()(1..)
Value Char YDIE1()(1..)
Value Char YCCE1()(1..)
Value Char YDIE2()(1..)
Value Char YCCE2()(1..)
Value Char YDIE3()(1..)
Value Char YCCE3()(1..)
Value Char YDIE4()(1..)
Value Char YCCE4()(1..)
Value Integer YBATTYP(1..)
Value Integer YGSTINC(1..)
Variable Integer YSTATUS
Variable Char YMESS()
 
 
WW_OK=0
Gosub ISDBGON from AWEB
If WW_OK<>0 : End : Endif
Local Char HORDAT1(14)
Local Integer WW_I
Local Char HORDATG(14),VERGEN
HORDATG="20181113202908"
VERGEN="6.30"
Call RECUPHDAT("YBB_V001",HORDAT1,WW_I) from AWEB
Gosub ANLHORSPG From AWEB
If WW_OK<>0 : Gosub SETTRACE : End : Endif
GWEBSERV=1
indice=0
Raz GMESSAGE,GW_STAT,GW_MESS,GW_GRAVE
 
 
Local Char ALIAS : ALIAS="YBB_V001"
Local Char ACTION
ACTION="AV_WS"
GPE=0
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo
If GPE<>1
Call YBBIMP(YBATFCY,YBATNBR,YBATDES,YBATDAT,YBATREF,
&            YBATSTA,YBATCAT,YFINSTA,YBATNBRTEMP,YDETLIG,
&            YENTTYP,YJOU,YTRANSNBR,YDETDES,YFCY,
&            YCPY,YACM,YLED1,YELA,YBAN,
&            YCOA,YACC,YLIGDES,YCTRL,YBP,
&            YDEB,YCDT,YTAX,YGSTAMT,YAMTTAX,
&            YREF,YPJT,YDIE0,YCCE0,YDIE1,
&            YCCE1,YDIE2,YCCE2,YDIE3,YCCE3,
&            YDIE4,YCCE4,YBATTYP,YGSTINC,YSTATUS,
&            YMESS) From YBBIMP
 
 
Gosub ANLSPGRES From AWEB
Endif

ACTION="AP_WS"
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo
GWEBSERV=0
Gosub SETTRACE
End



$XT_SPG
Local Integer WIND : WIND =46
Local Char    PRG      :    PRG="YBBIMP"
Local Char    SUBPRG   :    SUBPRG="YBBIMP"
Local Integer RUBNBR   :    RUBNBR=WIND
Local Char    RUBCOD        (GLONAVA+2)(0..WIND-1 )
Local Char    RUBGRP        (GLONAPU)(0..WIND-1 )
Local Integer RUBINTIT      (0..WIND-1 )
Local Char    RUBTYP        (10)(0..WIND-1 )    :    # Internal type (example Char, Integer)
Local Integer RUBADR        (0..WIND-1 )
Local Integer RUBLON        (0..WIND-1 )
Local Integer RUBMNL        (0..WIND-1 )
Local Integer RUBDIM        (0..WIND-1 )
 
RUBCOD(0)="YBATFCY" : RUBGRP(0)="GRP1" : RUBINTIT(0)=0 : RUBTYP(0)="1" : RUBADR(0)=2 : RUBLON(0)=0 : RUBDIM(0)=1 : RUBMNL(0)=0
RUBCOD(1)="YBATNBR" : RUBGRP(1)="GRP1" : RUBINTIT(1)=0 : RUBTYP(1)="1" : RUBADR(1)=2 : RUBLON(1)=0 : RUBDIM(1)=1 : RUBMNL(1)=0
RUBCOD(2)="YBATDES" : RUBGRP(2)="GRP1" : RUBINTIT(2)=0 : RUBTYP(2)="1" : RUBADR(2)=2 : RUBLON(2)=0 : RUBDIM(2)=1 : RUBMNL(2)=0
RUBCOD(3)="YBATDAT" : RUBGRP(3)="GRP1" : RUBINTIT(3)=0 : RUBTYP(3)="4" : RUBADR(3)=2 : RUBLON(3)=0 : RUBDIM(3)=1 : RUBMNL(3)=0
RUBCOD(4)="YBATREF" : RUBGRP(4)="GRP1" : RUBINTIT(4)=0 : RUBTYP(4)="1" : RUBADR(4)=2 : RUBLON(4)=0 : RUBDIM(4)=1 : RUBMNL(4)=0
RUBCOD(5)="YBATSTA" : RUBGRP(5)="GRP1" : RUBINTIT(5)=0 : RUBTYP(5)="2" : RUBADR(5)=2 : RUBLON(5)=0 : RUBDIM(5)=1 : RUBMNL(5)=0
RUBCOD(6)="YBATCAT" : RUBGRP(6)="GRP1" : RUBINTIT(6)=0 : RUBTYP(6)="2" : RUBADR(6)=2 : RUBLON(6)=0 : RUBDIM(6)=1 : RUBMNL(6)=0
RUBCOD(7)="YFINSTA" : RUBGRP(7)="GRP1" : RUBINTIT(7)=0 : RUBTYP(7)="2" : RUBADR(7)=2 : RUBLON(7)=0 : RUBDIM(7)=1 : RUBMNL(7)=0
RUBCOD(8)="YBATNBRTEMP" : RUBGRP(8)="GRP1" : RUBINTIT(8)=0 : RUBTYP(8)="1" : RUBADR(8)=2 : RUBLON(8)=0 : RUBDIM(8)=1 : RUBMNL(8)=0
RUBCOD(9)="YDETLIG" : RUBGRP(9)="GRP2" : RUBINTIT(9)=0 : RUBTYP(9)="2" : RUBADR(9)=2 : RUBLON(9)=0 : RUBDIM(9)=2000 : RUBMNL(9)=0
RUBCOD(10)="YENTTYP" : RUBGRP(10)="GRP2" : RUBINTIT(10)=0 : RUBTYP(10)="1" : RUBADR(10)=2 : RUBLON(10)=0 : RUBDIM(10)=2000 : RUBMNL(10)=0
RUBCOD(11)="YJOU" : RUBGRP(11)="GRP2" : RUBINTIT(11)=0 : RUBTYP(11)="1" : RUBADR(11)=2 : RUBLON(11)=0 : RUBDIM(11)=2000 : RUBMNL(11)=0
RUBCOD(12)="YTRANSNBR" : RUBGRP(12)="GRP2" : RUBINTIT(12)=0 : RUBTYP(12)="2" : RUBADR(12)=2 : RUBLON(12)=0 : RUBDIM(12)=2000 : RUBMNL(12)=0
RUBCOD(13)="YDETDES" : RUBGRP(13)="GRP2" : RUBINTIT(13)=0 : RUBTYP(13)="1" : RUBADR(13)=2 : RUBLON(13)=0 : RUBDIM(13)=2000 : RUBMNL(13)=0
RUBCOD(14)="YFCY" : RUBGRP(14)="GRP2" : RUBINTIT(14)=0 : RUBTYP(14)="1" : RUBADR(14)=2 : RUBLON(14)=0 : RUBDIM(14)=2000 : RUBMNL(14)=0
RUBCOD(15)="YCPY" : RUBGRP(15)="GRP2" : RUBINTIT(15)=0 : RUBTYP(15)="1" : RUBADR(15)=2 : RUBLON(15)=0 : RUBDIM(15)=2000 : RUBMNL(15)=0
RUBCOD(16)="YACM" : RUBGRP(16)="GRP2" : RUBINTIT(16)=0 : RUBTYP(16)="1" : RUBADR(16)=2 : RUBLON(16)=0 : RUBDIM(16)=2000 : RUBMNL(16)=0
RUBCOD(17)="YLED1" : RUBGRP(17)="GRP2" : RUBINTIT(17)=0 : RUBTYP(17)="1" : RUBADR(17)=2 : RUBLON(17)=0 : RUBDIM(17)=2000 : RUBMNL(17)=0
RUBCOD(18)="YELA" : RUBGRP(18)="GRP2" : RUBINTIT(18)=0 : RUBTYP(18)="1" : RUBADR(18)=2 : RUBLON(18)=0 : RUBDIM(18)=2000 : RUBMNL(18)=0
RUBCOD(19)="YBAN" : RUBGRP(19)="GRP2" : RUBINTIT(19)=0 : RUBTYP(19)="1" : RUBADR(19)=2 : RUBLON(19)=0 : RUBDIM(19)=2000 : RUBMNL(19)=0
RUBCOD(20)="YCOA" : RUBGRP(20)="GRP2" : RUBINTIT(20)=0 : RUBTYP(20)="1" : RUBADR(20)=2 : RUBLON(20)=0 : RUBDIM(20)=2000 : RUBMNL(20)=0
RUBCOD(21)="YACC" : RUBGRP(21)="GRP2" : RUBINTIT(21)=0 : RUBTYP(21)="1" : RUBADR(21)=2 : RUBLON(21)=0 : RUBDIM(21)=2000 : RUBMNL(21)=0
RUBCOD(22)="YLIGDES" : RUBGRP(22)="GRP2" : RUBINTIT(22)=0 : RUBTYP(22)="1" : RUBADR(22)=2 : RUBLON(22)=0 : RUBDIM(22)=2000 : RUBMNL(22)=0
RUBCOD(23)="YCTRL" : RUBGRP(23)="GRP2" : RUBINTIT(23)=0 : RUBTYP(23)="1" : RUBADR(23)=2 : RUBLON(23)=0 : RUBDIM(23)=2000 : RUBMNL(23)=0
RUBCOD(24)="YBP" : RUBGRP(24)="GRP2" : RUBINTIT(24)=0 : RUBTYP(24)="1" : RUBADR(24)=2 : RUBLON(24)=0 : RUBDIM(24)=2000 : RUBMNL(24)=0
RUBCOD(25)="YDEB" : RUBGRP(25)="GRP2" : RUBINTIT(25)=0 : RUBTYP(25)="3" : RUBADR(25)=2 : RUBLON(25)=0 : RUBDIM(25)=2000 : RUBMNL(25)=0
RUBCOD(26)="YCDT" : RUBGRP(26)="GRP2" : RUBINTIT(26)=0 : RUBTYP(26)="3" : RUBADR(26)=2 : RUBLON(26)=0 : RUBDIM(26)=2000 : RUBMNL(26)=0
RUBCOD(27)="YTAX" : RUBGRP(27)="GRP2" : RUBINTIT(27)=0 : RUBTYP(27)="1" : RUBADR(27)=2 : RUBLON(27)=0 : RUBDIM(27)=2000 : RUBMNL(27)=0
RUBCOD(28)="YGSTAMT" : RUBGRP(28)="GRP2" : RUBINTIT(28)=0 : RUBTYP(28)="3" : RUBADR(28)=2 : RUBLON(28)=0 : RUBDIM(28)=2000 : RUBMNL(28)=0
RUBCOD(29)="YAMTTAX" : RUBGRP(29)="GRP2" : RUBINTIT(29)=0 : RUBTYP(29)="3" : RUBADR(29)=2 : RUBLON(29)=0 : RUBDIM(29)=2000 : RUBMNL(29)=0
RUBCOD(30)="YREF" : RUBGRP(30)="GRP2" : RUBINTIT(30)=0 : RUBTYP(30)="1" : RUBADR(30)=2 : RUBLON(30)=0 : RUBDIM(30)=2000 : RUBMNL(30)=0
RUBCOD(31)="YPJT" : RUBGRP(31)="GRP2" : RUBINTIT(31)=0 : RUBTYP(31)="1" : RUBADR(31)=2 : RUBLON(31)=0 : RUBDIM(31)=2000 : RUBMNL(31)=0
RUBCOD(32)="YDIE0" : RUBGRP(32)="GRP2" : RUBINTIT(32)=0 : RUBTYP(32)="1" : RUBADR(32)=2 : RUBLON(32)=0 : RUBDIM(32)=2000 : RUBMNL(32)=0
RUBCOD(33)="YCCE0" : RUBGRP(33)="GRP2" : RUBINTIT(33)=0 : RUBTYP(33)="1" : RUBADR(33)=2 : RUBLON(33)=0 : RUBDIM(33)=2000 : RUBMNL(33)=0
RUBCOD(34)="YDIE1" : RUBGRP(34)="GRP2" : RUBINTIT(34)=0 : RUBTYP(34)="1" : RUBADR(34)=2 : RUBLON(34)=0 : RUBDIM(34)=2000 : RUBMNL(34)=0
RUBCOD(35)="YCCE1" : RUBGRP(35)="GRP2" : RUBINTIT(35)=0 : RUBTYP(35)="1" : RUBADR(35)=2 : RUBLON(35)=0 : RUBDIM(35)=2000 : RUBMNL(35)=0
RUBCOD(36)="YDIE2" : RUBGRP(36)="GRP2" : RUBINTIT(36)=0 : RUBTYP(36)="1" : RUBADR(36)=2 : RUBLON(36)=0 : RUBDIM(36)=2000 : RUBMNL(36)=0
RUBCOD(37)="YCCE2" : RUBGRP(37)="GRP2" : RUBINTIT(37)=0 : RUBTYP(37)="1" : RUBADR(37)=2 : RUBLON(37)=0 : RUBDIM(37)=2000 : RUBMNL(37)=0
RUBCOD(38)="YDIE3" : RUBGRP(38)="GRP2" : RUBINTIT(38)=0 : RUBTYP(38)="1" : RUBADR(38)=2 : RUBLON(38)=0 : RUBDIM(38)=2000 : RUBMNL(38)=0
RUBCOD(39)="YCCE3" : RUBGRP(39)="GRP2" : RUBINTIT(39)=0 : RUBTYP(39)="1" : RUBADR(39)=2 : RUBLON(39)=0 : RUBDIM(39)=2000 : RUBMNL(39)=0
RUBCOD(40)="YDIE4" : RUBGRP(40)="GRP2" : RUBINTIT(40)=0 : RUBTYP(40)="1" : RUBADR(40)=2 : RUBLON(40)=0 : RUBDIM(40)=2000 : RUBMNL(40)=0
RUBCOD(41)="YCCE4" : RUBGRP(41)="GRP2" : RUBINTIT(41)=0 : RUBTYP(41)="1" : RUBADR(41)=2 : RUBLON(41)=0 : RUBDIM(41)=2000 : RUBMNL(41)=0
RUBCOD(42)="YBATTYP" : RUBGRP(42)="GRP2" : RUBINTIT(42)=0 : RUBTYP(42)="2" : RUBADR(42)=2 : RUBLON(42)=0 : RUBDIM(42)=2000 : RUBMNL(42)=0
RUBCOD(43)="YGSTINC" : RUBGRP(43)="GRP2" : RUBINTIT(43)=0 : RUBTYP(43)="2" : RUBADR(43)=2 : RUBLON(43)=0 : RUBDIM(43)=2000 : RUBMNL(43)=0
RUBCOD(44)="YSTATUS" : RUBGRP(44)="GRP3" : RUBINTIT(44)=0 : RUBTYP(44)="2" : RUBADR(44)=1 : RUBLON(44)=0 : RUBDIM(44)=1 : RUBMNL(44)=0
RUBCOD(45)="YMESS" : RUBGRP(45)="GRP3" : RUBINTIT(45)=0 : RUBTYP(45)="1" : RUBADR(45)=1 : RUBLON(45)=0 : RUBDIM(45)=1 : RUBMNL(45)=0
Return
 
 
$SETTRACE
Local Char WPTRACE(200)(1..500)
Local Integer IT
Setlob WPTRACE(1..IT) With WW_TRACE
If instr(1,WPTRACE(1),"adonix.trace.on=on")=0 : Return : Endif
WPTRACE(1)="Engine version    : "+num$(ver$(0))+chr$(10)
WPTRACE(2)="Wrapper timestamp : "+num$(HORDATG)+chr$(10)
WPTRACE(3)="Wrapper version   : "+num$(VERGEN)+chr$(10)
WPTRACE(4)="Duration time     : "+num$(time-val(TSTART))+chr$(10)
WPTRACE(5)="WW_OK     : "+num$(WW_OK)+chr$(10)
WPTRACE(6)="WW_ZONE   : "+num$(WW_ZONE)+chr$(10)
WPTRACE(7)="WW_STAT   : "+num$(WW_STAT)+chr$(10)
IT=8
For indice=1 To WW_STAT
  WPTRACE(IT)="WW_GRAVE("+num$(indice)+")  : "+num$(WW_GRAVE(indice))+chr$(10)
  IT+=1 : WPTRACE(IT)="WW_MESS("+num$(indice)+")   : "+num$(WW_MESS(indice))+chr$(10)
  IT+=1
Next indice
IT+=1 : WPTRACE(IT)="WW_ACTION : "+num$(WW_ACTION)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_IDENT  : "+num$(WW_IDENT)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_NB     : "+num$(WW_NB)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_HORDAT : "+num$(WW_HORDAT)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_TAB    : "+num$(WW_TAB)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_PAR    : "+num$(WW_PAR)+chr$(10)
Setlob WW_TRACE With WPTRACE(1..IT)
Return   
