#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
## BI-REGLE ## Synchronization rule MFGOPE

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".MFGOPE" : If clalev([F:MFO])=0 : Local File =OUVTAB [MFO] : Endif
OUVTAB = GDOSSIER+".MFGHEAD" : If clalev([F:MFG])=0 : Local File =OUVTAB [MFG] : Endif
OUVTAB = GDOSSIER+".MFGITM" : If clalev([F:MFI])=0 : Local File =OUVTAB [MFI] : Endif
OUVTAB = "Link [MFO]"
Link [MFO] With
& [MFG]MFG0 = [F:MFO]MFGNUM,
& [MFI]MFI0 = [F:MFO]MFGNUM;1000
& As [LNK_]
& Where [F:MFG]MFGSTA=4
FILTRE = ""
Return

$FERME
If clalev([F:MFO]) : Close local File [MFO] : Endif
If clalev([F:MFG]) : Close local File [MFG] : Endif
If clalev([F:MFI]) : Close local File [MFI] : Endif
Return

$LIEN
Return

$MAJFLD
### MFGFCY
[L]FLD="MFGFCY"
[L]FORMULE='[F:MFG]MFGFCY'
If dim([F:AAA_]MFGFCY)>0
 [F:AAA_]MFGFCY = [F:MFG]MFGFCY
Endif

### MFGSTA
[L]FLD="MFGSTA"
[L]FORMULE='[F:MFG]MFGSTA'
If dim([F:AAA_]MFGSTA)>0
 [F:AAA_]MFGSTA = [F:MFG]MFGSTA
Endif

### MFGNUM
[L]FLD="MFGNUM"
[L]FORMULE='[F:MFG]MFGNUM'
If dim([F:AAA_]MFGNUM)>0
 [F:AAA_]MFGNUM = [F:MFG]MFGNUM
Endif

### LINTYP
[L]FLD="LINTYP"
[L]FORMULE='4'
If dim([F:AAA_]LINTYP)>0
 [F:AAA_]LINTYP = 4
Endif

### STRDAT
[L]FLD="STRDAT"
[L]FORMULE='[F:MFG]STRDAT'
If dim([F:AAA_]STRDAT)>0
 [F:AAA_]STRDAT = [F:MFG]STRDAT
Endif

### ENDDAT
[L]FLD="ENDDAT"
[L]FORMULE='[F:MFG]ENDDAT'
If dim([F:AAA_]ENDDAT)>0
 [F:AAA_]ENDDAT = [F:MFG]ENDDAT
Endif

### DOSSIER
[L]FLD="DOSSIER"
[L]FORMULE='GDOSSIER'
If dim([F:AAA_]DOSSIER)>0
 [F:AAA_]DOSSIER = GDOSSIER
Endif

### ROUNUM
[L]FLD="ROUNUM"
[L]FORMULE='[F:MFG]ROUNUM'
If dim([F:AAA_]ROUNUM)>0
 [F:AAA_]ROUNUM = [F:MFG]ROUNUM
Endif

### ROUALT
[L]FLD="ROUALT"
[L]FORMULE='[F:MFG]ROUALT'
If dim([F:AAA_]ROUALT)>0
 [F:AAA_]ROUALT = [F:MFG]ROUALT
Endif

### MFGPIO
[L]FLD="MFGPIO"
[L]FORMULE='[F:MFO]MFGPIO'
If dim([F:AAA_]MFGPIO)>0
 K   = max(1,val(num$([F:MFO]MFGPIO)))
 [F:AAA_]MFGPIO = mess(K,365,1)
Endif

### ITMLINNBR
[L]FLD="ITMLINNBR"
[L]FORMULE='0'
If dim([F:AAA_]ITMLINNBR)>0
 [F:AAA_]ITMLINNBR = 0
Endif

### MATLINNBR
[L]FLD="MATLINNBR"
[L]FORMULE='0'
If dim([F:AAA_]MATLINNBR)>0
 [F:AAA_]MATLINNBR = 0
Endif

### OPELINNBR
[L]FLD="OPELINNBR"
[L]FORMULE='0'
If dim([F:AAA_]OPELINNBR)>0
 [F:AAA_]OPELINNBR = 0
Endif

### TRKFIRST
[L]FLD="TRKFIRST"
[L]FORMULE='[F:MFO]TRKFIRST'
If dim([F:AAA_]TRKFIRST)>0
 [F:AAA_]TRKFIRST = [F:MFO]TRKFIRST
Endif

### TRKLAST
[L]FLD="TRKLAST"
[L]FORMULE='[F:MFO]TRKLAST'
If dim([F:AAA_]TRKLAST)>0
 [F:AAA_]TRKLAST = [F:MFO]TRKLAST
Endif

### CLODAT
[L]FLD="CLODAT"
[L]FORMULE='[F:MFG]CLODAT'
If dim([F:AAA_]CLODAT)>0
 [F:AAA_]CLODAT = [F:MFG]CLODAT
Endif

### OBJDAT
[L]FLD="OBJDAT"
[L]FORMULE='[F:MFG]OBJDAT'
If dim([F:AAA_]OBJDAT)>0
 [F:AAA_]OBJDAT = [F:MFG]OBJDAT
Endif

### CPY
[L]FLD="CPY"
[L]FORMULE='func TRTX3BI.GETCPY([F:MFO]MFGFCY)'
If dim([F:AAA_]CPY)>0
 [F:AAA_]CPY = func TRTX3BI.GETCPY([F:MFO]MFGFCY)
Endif

### FIYNUM
[L]FLD="FIYNUM"
[L]FORMULE='func TRTX3BI.GETEXE([F:MFO]MFGFCY,[F:MFO]OPEEND)'
If dim([F:AAA_]FIYNUM)>0
 [F:AAA_]FIYNUM = func TRTX3BI.GETEXE([F:MFO]MFGFCY,[F:MFO]OPEEND)
Endif

### PERNUM
[L]FLD="PERNUM"
[L]FORMULE='func TRTX3BI.GETPER([F:MFO]MFGFCY,[F:MFO]OPEEND)'
If dim([F:AAA_]PERNUM)>0
 [F:AAA_]PERNUM = func TRTX3BI.GETPER([F:MFO]MFGFCY,[F:MFO]OPEEND)
Endif

### PJT
[L]FLD="PJT"
[L]FORMULE='vireblc([F:MFI]PJT,2)'
If dim([F:AAA_]PJT)>0
 [F:AAA_]PJT = vireblc([F:MFI]PJT,2)
Endif

### MFGLIN
[L]FLD="MFGLIN"
[L]FORMULE='0'
If dim([F:AAA_]MFGLIN)>0
 [F:AAA_]MFGLIN = 0
Endif

### ITMTYP
[L]FLD="ITMTYP"
[L]FORMULE='0'
If dim([F:AAA_]ITMTYP)>0
 [F:AAA_]ITMTYP = 0
Endif

### ITMREF
[L]FLD="ITMREF"
[L]FORMULE='[F:MFI]ITMREF'
If dim([F:AAA_]ITMREF)>0
 [F:AAA_]ITMREF = [F:MFI]ITMREF
Endif

### MFGDES
[L]FLD="MFGDES"
[L]FORMULE='[F:MFO]ROODES'
If dim([F:AAA_]MFGDES)>0
 [F:AAA_]MFGDES = [F:MFO]ROODES
Endif

### UOM
[L]FLD="UOM"
[L]FORMULE='[F:MFO]OPEUOM'
If dim([F:AAA_]UOM)>0
 [F:AAA_]UOM = [F:MFO]OPEUOM
Endif

### UOMSTUCOE
[L]FLD="UOMSTUCOE"
[L]FORMULE='[F:MFO]OPESTUCOE'
If dim([F:AAA_]UOMSTUCOE)>0
 [F:AAA_]UOMSTUCOE = [F:MFO]OPESTUCOE
Endif

### TRKFLG
[L]FLD="TRKFLG"
[L]FORMULE='[F:MFO]MFOTRKFLG'
If dim([F:AAA_]TRKFLG)>0
 [F:AAA_]TRKFLG = [F:MFO]MFOTRKFLG
Endif

### CPNITMREF
[L]FLD="CPNITMREF"
[L]FORMULE='""'
If dim([F:AAA_]CPNITMREF)>0
FORMULE = ''
 [F:AAA_]CPNITMREF = ''
Endif

### EXTQTY
[L]FLD="EXTQTY"
[L]FORMULE='[F:MFO]EXTQTY'
If dim([F:AAA_]EXTQTY)>0
 [F:AAA_]EXTQTY = [F:MFO]EXTQTY
Endif

### CPLQTY
[L]FLD="CPLQTY"
[L]FORMULE='[F:MFO]CPLQTY'
If dim([F:AAA_]CPLQTY)>0
 [F:AAA_]CPLQTY = [F:MFO]CPLQTY
Endif

### REJQTY
[L]FLD="REJQTY"
[L]FORMULE='0'
If dim([F:AAA_]REJQTY)>0
 [F:AAA_]REJQTY = 0
Endif

### QUAQTY
[L]FLD="QUAQTY"
[L]FORMULE='0'
If dim([F:AAA_]QUAQTY)>0
 [F:AAA_]QUAQTY = 0
Endif

### TRKQTY
[L]FLD="TRKQTY"
[L]FORMULE='[F:MFO]EXTQTY*[F:MFG]CPLQTY/[F:MFG]EXTQTY'
If dim([F:AAA_]TRKQTY)>0
 [F:AAA_]TRKQTY = [F:MFO]EXTQTY*[F:MFG]CPLQTY/[F:MFG]EXTQTY
Endif

### CPNTYP
[L]FLD="CPNTYP"
[L]FORMULE='0'
If dim([F:AAA_]CPNTYP)>0
 K   = max(1,val(num$(0)))
 [F:AAA_]CPNTYP = mess(K,438,1)
Endif

### OPENUM
[L]FLD="OPENUM"
[L]FORMULE='[F:MFO]OPENUM'
If dim([F:AAA_]OPENUM)>0
 [F:AAA_]OPENUM = [F:MFO]OPENUM
Endif

### EXTWST
[L]FLD="EXTWST"
[L]FORMULE='[F:MFO]EXTWST'
If dim([F:AAA_]EXTWST)>0
 [F:AAA_]EXTWST = [F:MFO]EXTWST
Endif

### CPLWST
[L]FLD="CPLWST"
[L]FORMULE='[F:MFO]CPLWST'
If dim([F:AAA_]CPLWST)>0
 [F:AAA_]CPLWST = [F:MFO]CPLWST
Endif

### EXTSETTIM
[L]FLD="EXTSETTIM"
[L]FORMULE='[F:MFO]EXTSETTIM'
If dim([F:AAA_]EXTSETTIM)>0
 [F:AAA_]EXTSETTIM = [F:MFO]EXTSETTIM
Endif

### CPLSETTIM
[L]FLD="CPLSETTIM"
[L]FORMULE='[F:MFO]CPLSETTIM'
If dim([F:AAA_]CPLSETTIM)>0
 [F:AAA_]CPLSETTIM = [F:MFO]CPLSETTIM
Endif

### EXTOPETIM
[L]FLD="EXTOPETIM"
[L]FORMULE='[F:MFO]EXTOPETIM'
If dim([F:AAA_]EXTOPETIM)>0
 [F:AAA_]EXTOPETIM = [F:MFO]EXTOPETIM
Endif

### CPLOPETIM
[L]FLD="CPLOPETIM"
[L]FORMULE='[F:MFO]CPLOPETIM'
If dim([F:AAA_]CPLOPETIM)>0
 [F:AAA_]CPLOPETIM = [F:MFO]CPLOPETIM
Endif

### TRKOPETIM
[L]FLD="TRKOPETIM"
[L]FORMULE='[F:MFO]EXTOPETIM*[F:MFG]CPLQTY/[F:MFG]EXTQTY'
If dim([F:AAA_]TRKOPETIM)>0
 [F:AAA_]TRKOPETIM = [F:MFO]EXTOPETIM*[F:MFG]CPLQTY/[F:MFG]EXTQTY
Endif

K = instr(1,GDOSSIER,'@')
If K
 [F:AAA_]ADOS = right$(GDOSSIER,K+1)
Else
 [F:AAA_]ADOS = GDOSSIER
Endif
[F:AAA_]AREG = 'MFGOPE'
[F:AAA_]AIND = indice
[L]FLD="ACLE"
[L]FORMULE="ACLE"
[F:AAA_]ACLE = num$([F:MFO]MFGNUM)+'~'+num$([F:MFO]OPENUM)+'~'+num$([F:MFO]OPESPLNUM)
Return

