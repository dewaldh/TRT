#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
## BI-REGLE ## Synchronization rule MFGOPETRK3

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".MFGOPETRK" : If clalev([F:MKO])=0 : Local File =OUVTAB [MKO] : Endif
OUVTAB = GDOSSIER+".MFGHEAD" : If clalev([F:MFG])=0 : Local File =OUVTAB [MFG] : Endif
OUVTAB = GDOSSIER+".MFGOPE" : If clalev([F:MFO])=0 : Local File =OUVTAB [MFO] : Endif
OUVTAB = "Link [MKO]"
Link [MKO] With
& [MFG]MFG0 = [F:MKO]MFGNUM,
& [MFO]MFO0 = [F:MKO]MFGNUM;[F:MKO]OPENUM;[F:MKO]OPESPLNUM
& As [LNK_]
& Where [F:MFG]MFGSTA=4 & [F:MKO]CPLLAB> " "
FILTRE = ""
Return

$FERME
If clalev([F:MKO]) : Close local File [MKO] : Endif
If clalev([F:MFG]) : Close local File [MFG] : Endif
If clalev([F:MFO]) : Close local File [MFO] : Endif
Return

$LIEN
Return

$MAJFLD
### MFGFCY
[L]FLD="MFGFCY"
[L]FORMULE='[F:MKO]MFGFCY'
If dim([F:AAA_]MFGFCY)>0
 [F:AAA_]MFGFCY = [F:MKO]MFGFCY
Endif

### CPY
[L]FLD="CPY"
[L]FORMULE='func TRTX3BI.GETCPY([F:MKO]MFGFCY)'
If dim([F:AAA_]CPY)>0
 [F:AAA_]CPY = func TRTX3BI.GETCPY([F:MKO]MFGFCY)
Endif

### FIYNUM
[L]FLD="FIYNUM"
[L]FORMULE='func TRTX3BI.GETEXE([F:MKO]MFGFCY,[F:MKO]DACDAT)'
If dim([F:AAA_]FIYNUM)>0
 [F:AAA_]FIYNUM = func TRTX3BI.GETEXE([F:MKO]MFGFCY,[F:MKO]DACDAT)
Endif

### PERNUM
[L]FLD="PERNUM"
[L]FORMULE='func TRTX3BI.GETPER([F:MKO]MFGFCY,[F:MKO]DACDAT)'
If dim([F:AAA_]PERNUM)>0
 [F:AAA_]PERNUM = func TRTX3BI.GETPER([F:MKO]MFGFCY,[F:MKO]DACDAT)
Endif

### MFGNUM
[L]FLD="MFGNUM"
[L]FORMULE='[F:MKO]MFGNUM'
If dim([F:AAA_]MFGNUM)>0
 [F:AAA_]MFGNUM = [F:MKO]MFGNUM
Endif

### DOSSIER
[L]FLD="DOSSIER"
[L]FORMULE='GDOSSIER'
If dim([F:AAA_]DOSSIER)>0
 [F:AAA_]DOSSIER = GDOSSIER
Endif

### ROUNUM
[L]FLD="ROUNUM"
[L]FORMULE='[F:MFG]ROUNUM'
If dim([F:AAA_]ROUNUM)>0
 [F:AAA_]ROUNUM = [F:MFG]ROUNUM
Endif

### ROUALT
[L]FLD="ROUALT"
[L]FORMULE='[F:MKO]ROUALT'
If dim([F:AAA_]ROUALT)>0
 [F:AAA_]ROUALT = [F:MKO]ROUALT
Endif

### OPENUM
[L]FLD="OPENUM"
[L]FORMULE='[F:MKO]OPENUM'
If dim([F:AAA_]OPENUM)>0
 [F:AAA_]OPENUM = [F:MKO]OPENUM
Endif

### IPTDAT
[L]FLD="IPTDAT"
[L]FORMULE='[F:MKO]DACDAT'
If dim([F:AAA_]IPTDAT)>0
 [F:AAA_]IPTDAT = [F:MKO]DACDAT
Endif

### EXTWST
[L]FLD="EXTWST"
[L]FORMULE='[F:MFO]EXTLAB'
If dim([F:AAA_]EXTWST)>0
 [F:AAA_]EXTWST = [F:MFO]EXTLAB
Endif

### CPLWST
[L]FLD="CPLWST"
[L]FORMULE='[F:MKO]CPLLAB'
If dim([F:AAA_]CPLWST)>0
 [F:AAA_]CPLWST = [F:MKO]CPLLAB
Endif

### TRKOPETIM
[L]FLD="TRKOPETIM"
[L]FORMULE='[F:MFO]EXTOPETIM*[F:MFG]CPLQTY/[F:MFG]EXTQTY'
If dim([F:AAA_]TRKOPETIM)>0
 [F:AAA_]TRKOPETIM = [F:MFO]EXTOPETIM*[F:MFG]CPLQTY/[F:MFG]EXTQTY
Endif

### CPLOPETIM
[L]FLD="CPLOPETIM"
[L]FORMULE='[F:MKO]OPELABCOE*[F:MKO]CPLOPETIM'
If dim([F:AAA_]CPLOPETIM)>0
 [F:AAA_]CPLOPETIM = [F:MKO]OPELABCOE*[F:MKO]CPLOPETIM
Endif

### CPLSETTIM
[L]FLD="CPLSETTIM"
[L]FORMULE='[F:MKO]SETLABCOE*[F:MKO]CPLSETTIM'
If dim([F:AAA_]CPLSETTIM)>0
 [F:AAA_]CPLSETTIM = [F:MKO]SETLABCOE*[F:MKO]CPLSETTIM
Endif

### OPEUOM
[L]FLD="OPEUOM"
[L]FORMULE='[F:MKO]OPEUOM'
If dim([F:AAA_]OPEUOM)>0
 [F:AAA_]OPEUOM = [F:MKO]OPEUOM
Endif

### OPEWORCOE
[L]FLD="OPEWORCOE"
[L]FORMULE='[F:MKO]OPEWORCOE'
If dim([F:AAA_]OPEWORCOE)>0
 [F:AAA_]OPEWORCOE = [F:MKO]OPEWORCOE
Endif

### TRKQTY
[L]FLD="TRKQTY"
[L]FORMULE='[F:MFO]EXTQTY*[F:MFG]CPLQTY/[F:MFG]EXTQTY'
If dim([F:AAA_]TRKQTY)>0
 [F:AAA_]TRKQTY = [F:MFO]EXTQTY*[F:MFG]CPLQTY/[F:MFG]EXTQTY
Endif

### CPLQTY
[L]FLD="CPLQTY"
[L]FORMULE='[F:MKO]CPLQTY'
If dim([F:AAA_]CPLQTY)>0
 [F:AAA_]CPLQTY = [F:MKO]CPLQTY
Endif

### REJCPLQTY
[L]FLD="REJCPLQTY"
[L]FORMULE='[F:MKO]REJCPLQTY'
If dim([F:AAA_]REJCPLQTY)>0
 [F:AAA_]REJCPLQTY = [F:MKO]REJCPLQTY
Endif

### QUACPLQTY
[L]FLD="QUACPLQTY"
[L]FORMULE='[F:MKO]QUACPLQTY'
If dim([F:AAA_]QUACPLQTY)>0
 [F:AAA_]QUACPLQTY = [F:MKO]QUACPLQTY
Endif

### MFGTRKNUM
[L]FLD="MFGTRKNUM"
[L]FORMULE='[F:MKO]MFGTRKNUM'
If dim([F:AAA_]MFGTRKNUM)>0
 [F:AAA_]MFGTRKNUM = [F:MKO]MFGTRKNUM
Endif

K = instr(1,GDOSSIER,'@')
If K
 [F:AAA_]ADOS = right$(GDOSSIER,K+1)
Else
 [F:AAA_]ADOS = GDOSSIER
Endif
[F:AAA_]AREG = 'MFGOPETRK3'
[F:AAA_]AIND = indice
[L]FLD="ACLE"
[L]FORMULE="ACLE"
[F:AAA_]ACLE = num$([F:MKO]MFGTRKNUM)+'~'+num$([F:MKO]OPETRKLIN)
Return

