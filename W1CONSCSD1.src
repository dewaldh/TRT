#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management CONSCSD1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [27/08/2018]
A_HEURE = "23:56:14"
A_USER  = "ADMIN"
A_STAMP = "20180827235614"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CONSCSD1 [CSD1]
Gosub HORODAT
Local Inpbox "CONSCSD1" From GFONCTION At A_STAMP With A_WINDPREV Mask [CSD1] As [SIM_]
Grizo [CSD1]5
Grizo [CSD1]10
Grizo [CSD1]15
Grizo [CSD1]20
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [CSD1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=83 : Y1(0)=1 : Y2(0)=6
X1(1)=84 : X2(1)=113 : Y1(1)=1 : Y2(1)=6
X1(2)=114 : X2(2)=154 : Y1(2)=1 : Y2(2)=6
X1(3)=155 : X2(3)=167 : Y1(3)=1 : Y2(3)=6
Return

$ON_CPY
Onevent CONTROL Call C_CPY(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_CPY From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_CPY(zc) From W1CONSCSD1
Return

Subprog AS_CPY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3529,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_CPY(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_CPY(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_CPY(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_CPY(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_CPY(VALEUR)
Variable Char    VALEUR()
## Action ACONTCPY
Call CONTSOC(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CPY","!A",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
 If !mkstat
  ## Action STD
  Call C_CPY(VALEUR) From CNSCSDSTD
  If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_CPY
Call AM_CPY(zc)
If !mkstat & GOBJET
 zoncou = "CPY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPY(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZCPY)")>indice
 [M]CPY(indice) = VALEUR
 Affzo ZCPY(indice)
Endif
Gosub _AFF
End

Subprog S_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CPY"
PARMSK(2) = "!A"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CPY(VALEUR)
Variable Char    VALEUR()
Call OBJET("CPY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CPY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CPY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCPY
Onevent BEFORE_AREA Gosub AV_ZCPY From W1CONSCSD1
Return

$AV_ZCPY
If clalev([F:CPY])=0 : Local File COMPANY [CPY] : Endif
Call LECTURE("CPY",num$([M]CPY(indice)),"") From CONTOBJ
zc = [F:CPY]CPYSHO
Gosub _AFF
Return

$ON_STOFCY
Onevent CONTROL Call C_STOFCY(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_STOFCY From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_STOFCY(zc) From W1CONSCSD1
Return

Subprog AS_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STOFCY(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_STOFCY(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_STOFCY(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_STOFCY(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_STOFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 8560 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 8560 : Endif
 If !mkstat
  ## Action STD
  Call C_STOFCY(VALEUR) From CNSCSDSTD
  If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 8560 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_STOFCY
Call AM_STOFCY(zc)
If !mkstat & GOBJET
 zoncou = "STOFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STOFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_STOFCY(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 8560 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZSTOFCY)")>indice
 [M]STOFCY(indice) = VALEUR
 Affzo ZSTOFCY(indice)
Endif
Gosub _AFF
End

Subprog S_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STOFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSTOFCY
Onevent BEFORE_AREA Gosub AV_ZSTOFCY From W1CONSCSD1
Return

$AV_ZSTOFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]STOFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYSHO
Gosub _AFF
Return

$ON_BPCORD
Onevent CONTROL Call C_BPCORD(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_BPCORD(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_BPCORD From W1CONSCSD1
Return

Subprog AS_BPCORD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43545,GBOUT11) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 139 Titled GBOUT11 Call B11_BPCORD(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_BPCORD(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_BPCORD(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_BPCORD(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_BPCORD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPCCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPCCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPCCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPCORD" : GZNUM = 3662 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPCORD" : GZNUM = 3662 : Endif
Endif
Gosub _AFF
End

$AMM_BPCORD
Call AM_BPCORD(zc)
If !mkstat & GOBJET
 zoncou = "BPCORD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCORD(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZBPCORD)")>indice
 [M]BPCORD(indice) = VALEUR
 Affzo ZBPCORD(indice)
Endif
Gosub _AFF
End

Subprog S_BPCORD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B11_BPCORD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CUSSEAQ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CUSSEAQ"
 PARMSK(1) = ""
 Call TRAITE_CHAR(VALEUR,PARMSK,"CUSSEAQ","CUSSEAQ","",1,"XYCUSSEAQ") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BPCORD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPCORD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPCORD
Onevent BEFORE_AREA Gosub AV_ZBPCORD From W1CONSCSD1
Return

$AV_ZBPCORD
If clalev([F:BPC])=0 : Local File BPCUSTOMER [BPC] : Endif
Call LECTURE("BPC",num$([M]BPCORD(indice)),"") From CONTOBJ
zc = [F:BPC]BPCNAM
Gosub _AFF
Return

$ON_PJTDEB
Onevent BEFORE_INPUT Call AS_PJTDEB(zc) From W1CONSCSD1
Onevent CONTROL Call C_PJTDEB(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_PJTDEB From W1CONSCSD1
Return

Subprog IB_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]PJTDEB(INDIC) = VALEUR
 Affzo PJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTDEB(zc) From W1CONSCSD1
Onkey 130 Titled GBOUT2 Call B2_PJTDEB(zc) From W1CONSCSD1
Onkey 131 Titled GBOUT3 Call B3_PJTDEB(zc) From W1CONSCSD1
Onkey 132 Titled GBOUT4 Call B4_PJTDEB(zc) From W1CONSCSD1
Onkey 172 Titled GBOUT15 Call B15_PJTDEB(zc) From W1CONSCSD1
Onkey 173 Titled GBOUT16 Call B16_PJTDEB(zc) From W1CONSCSD1
Onkey 174 Titled GBOUT17 Call B17_PJTDEB(zc) From W1CONSCSD1
Onkey 175 Titled GBOUT18 Call B18_PJTDEB(zc) From W1CONSCSD1
Onkey 176 Titled GBOUT19 Call B19_PJTDEB(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_PJTDEB(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_PJTDEB(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_PJTDEB(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

$AMM_PJTDEB
Call AM_PJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "PJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTDEB(VALEUR) From CNSCSDSTD
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 54671 : Endif
 If !mkstat & evalue("dim("+clanam([M])+"ZPJTDEB)")>indice
  [M]PJTDEB(indice) = VALEUR
  Affzo ZPJTDEB(indice)
 Endif
Endif
Gosub _AFF
End

Subprog S_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTDEB(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CSD1","PJTDEB",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTDEB
Onevent BEFORE_AREA Gosub AV_ZPJTDEB From W1CONSCSD1
Return

$AV_ZPJTDEB
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PJTFIN
Onevent BEFORE_INPUT Call AS_PJTFIN(zc) From W1CONSCSD1
Onevent CONTROL Call C_PJTFIN(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_PJTFIN From W1CONSCSD1
Return

Subprog IB_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]PJTFIN(INDIC) = VALEUR
 Affzo PJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTFIN(zc) From W1CONSCSD1
Onkey 130 Titled GBOUT2 Call B2_PJTFIN(zc) From W1CONSCSD1
Onkey 131 Titled GBOUT3 Call B3_PJTFIN(zc) From W1CONSCSD1
Onkey 132 Titled GBOUT4 Call B4_PJTFIN(zc) From W1CONSCSD1
Onkey 172 Titled GBOUT15 Call B15_PJTFIN(zc) From W1CONSCSD1
Onkey 173 Titled GBOUT16 Call B16_PJTFIN(zc) From W1CONSCSD1
Onkey 174 Titled GBOUT17 Call B17_PJTFIN(zc) From W1CONSCSD1
Onkey 175 Titled GBOUT18 Call B18_PJTFIN(zc) From W1CONSCSD1
Onkey 176 Titled GBOUT19 Call B19_PJTFIN(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_PJTFIN(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_PJTFIN(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_PJTFIN(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
 If !mkstat
  ## Action CTLALPVALW
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CTLALPVALW"
  PARMSK(1) = [M]PJTDEB
  Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTFIN
Call AM_PJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 54672 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZPJTFIN)")>indice
 [M]PJTFIN(indice) = VALEUR
 Affzo ZPJTFIN(indice)
Endif
Gosub _AFF
End

Subprog S_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTFIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CSD1","PJTFIN",0,5,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,"",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CSD1"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPJTFIN
Onevent BEFORE_AREA Gosub AV_ZPJTFIN From W1CONSCSD1
Return

$AV_ZPJTFIN
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]PJTFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_DLVDATDEB
Onevent BEFORE_AREA Gosub AV_DLVDATDEB From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVDATDEB From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVDATDEB(zc) From W1CONSCSD1
Onevent CONTROL Call C_DLVDATDEB(zc) From W1CONSCSD1
Return

$AV_DLVDATDEB
## Action ADATRELI
Call INIDAT(zc,[M:CCSD]DLVDATDEBF) From ADATREL
Chgfmt [M]DLVDATDEB(indice) With "D:"+GFMDAT
Gosub _AFF
Return

Subprog AS_DLVDATDEB(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_DLVDATDEB(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVDATDEB(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "DLVDATDEB" : GZNUM = 1805 : Endif
Gosub _AFF
End

$AMM_DLVDATDEB
Call AM_DLVDATDEB(zc)
If !mkstat & GOBJET
 zoncou = "DLVDATDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVDATDEB(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M:CCSD]DLVDATDEBF) From ADATREL
If mkstat : GERR = 1 : GZONE = "DLVDATDEB" : GZNUM = 1805 : Endif
Gosub _AFF
End

Subprog B1_DLVDATDEB(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M:CCSD]DLVDATDEBF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M:CCSD]DLVDATDEBF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DLVDATFIN
Onevent BEFORE_AREA Gosub AV_DLVDATFIN From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVDATFIN From W1CONSCSD1
Onevent CONTROL Call C_DLVDATFIN(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVDATFIN(zc) From W1CONSCSD1
Return

$AV_DLVDATFIN
## Action ADATRELI
Call INIDAT(zc,[M:CCSD]DLVDATFINF) From ADATREL
Chgfmt [M]DLVDATFIN(indice) With "D:"+GFMDAT
Gosub _AFF
Return

Subprog AS_DLVDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_DLVDATFIN(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVDATFIN(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "DLVDATFIN" : GZNUM = 1806 : Endif
If !mkstat
 ## Action DATDEBFIN
 Call DATDEBFIN(VALEUR,[M]DLVDATDEB) From EXEFNC
 If mkstat : GERR = 1 : GZONE = "DLVDATFIN" : GZNUM = 1806 : Endif
Endif
Gosub _AFF
End

$AMM_DLVDATFIN
Call AM_DLVDATFIN(zc)
If !mkstat & GOBJET
 zoncou = "DLVDATFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVDATFIN(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M:CCSD]DLVDATFINF) From ADATREL
If mkstat : GERR = 1 : GZONE = "DLVDATFIN" : GZNUM = 1806 : Endif
Gosub _AFF
End

Subprog B1_DLVDATFIN(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M:CCSD]DLVDATFINF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M:CCSD]DLVDATFINF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CURS
Return

$ON_ZCURS
Onevent BEFORE_AREA Gosub AV_ZCURS From W1CONSCSD1
Return

$AV_ZCURS
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CURS(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_CURD
Return

$ON_ZCURD
Onevent BEFORE_AREA Gosub AV_ZCURD From W1CONSCSD1
Return

$AV_ZCURD
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CURD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_LNDN
Onevent AFTER_CHANGE Gosub AMM_LNDN From W1CONSCSD1
Onevent INIT_AREA Call D_LNDN(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_LNDN(zc) From W1CONSCSD1
Return

Subprog D_LNDN(VALEUR)
Variable Integer VALEUR
If varinit([M]LNDN,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LNDN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_LNDN
Call AM_LNDN(zc)
If !mkstat & GOBJET
 zoncou = "LNDN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LNDN(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_LNDN(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "LNDN" : GZNUM = 14309 : Endif
Gosub _AFF
End

$ON_DLVTYPNOR
Onevent CONTROL Call C_DLVTYPNOR(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVTYPNOR(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVTYPNOR From W1CONSCSD1
Return

Subprog IB_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(48598,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_DLVTYPNOR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DLVTYPNOR(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_DLVTYPNOR(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_DLVTYPNOR(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_DLVTYPNOR(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
## Action CONTTSD
Call CONTTSD(VALEUR,"","CSD1","DLVTYPNOR",[M:CSD1]STOFCY,"",1,[M:CSD1]CPY) From SUBTSD
If mkstat : GERR = 1 : GZONE = "DLVTYPNOR" : GZNUM = 2946 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DLVTYPNOR" : GZNUM = 2946 : Endif
Endif
Gosub _AFF
End

$AMM_DLVTYPNOR
Call AM_DLVTYPNOR(zc)
If !mkstat & GOBJET
 zoncou = "DLVTYPNOR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZDLVTYPNOR)")>indice
 [M]DLVTYPNOR(indice) = VALEUR
 Affzo ZDLVTYPNOR(indice)
Endif
Gosub _AFF
End

Subprog S_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTSDLEG2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTSDLEG2"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSD1]STOFCY
 PARMSK(3) = ""
 PARMSK(4) = "1"
 PARMSK(5) = [M:CSD1]CPY
 PARMSK(6) = "CSD1"
 PARMSK(7) = "DLVTYPNOR"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTSD","SUBTSD","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTSD
 Call TUNTSD(VALEUR,"") From SUBTSD
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TSD"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DLVTYPNOR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TSD",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZDLVTYPNOR
Onevent BEFORE_AREA Gosub AV_ZDLVTYPNOR From W1CONSCSD1
Return

$AV_ZDLVTYPNOR
Call LECTEXTRA(zc,"TABSDHTYP","SHOAXX",num$([M]DLVTYPNOR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_LNDO
Onevent AFTER_CHANGE Gosub AMM_LNDO From W1CONSCSD1
Onevent INIT_AREA Call D_LNDO(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_LNDO(zc) From W1CONSCSD1
Return

Subprog D_LNDO(VALEUR)
Variable Integer VALEUR
If varinit([M]LNDO,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LNDO(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_LNDO
Call AM_LNDO(zc)
If !mkstat & GOBJET
 zoncou = "LNDO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LNDO(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_LNDO(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "LNDO" : GZNUM = 1695 : Endif
Gosub _AFF
End

$ON_DLVTYPLND
Onevent CONTROL Call C_DLVTYPLND(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVTYPLND(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVTYPLND From W1CONSCSD1
Return

Subprog IB_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(48598,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_DLVTYPLND(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DLVTYPLND(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_DLVTYPLND(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_DLVTYPLND(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_DLVTYPLND(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
## Action CONTTSD
Call CONTTSD(VALEUR,"","CSD1","DLVTYPLND",[M:CSD1]STOFCY,"",2,[M:CSD1]CPY) From SUBTSD
If mkstat : GERR = 1 : GZONE = "DLVTYPLND" : GZNUM = 2946 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DLVTYPLND" : GZNUM = 2946 : Endif
Endif
Gosub _AFF
End

$AMM_DLVTYPLND
Call AM_DLVTYPLND(zc)
If !mkstat & GOBJET
 zoncou = "DLVTYPLND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZDLVTYPLND)")>indice
 [M]DLVTYPLND(indice) = VALEUR
 Affzo ZDLVTYPLND(indice)
Endif
Gosub _AFF
End

Subprog S_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTSDLEG2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTSDLEG2"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSD1]STOFCY
 PARMSK(3) = ""
 PARMSK(4) = "2"
 PARMSK(5) = [M:CSD1]CPY
 PARMSK(6) = "CSD1"
 PARMSK(7) = "DLVTYPLND"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTSD","SUBTSD","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTSD
 Call TUNTSD(VALEUR,"") From SUBTSD
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TSD"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DLVTYPLND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TSD",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZDLVTYPLND
Onevent BEFORE_AREA Gosub AV_ZDLVTYPLND From W1CONSCSD1
Return

$AV_ZDLVTYPLND
Call LECTEXTRA(zc,"TABSDHTYP","SHOAXX",num$([M]DLVTYPLND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_SCOFLG
Onevent AFTER_CHANGE Gosub AMM_SCOFLG From W1CONSCSD1
Onevent INIT_AREA Call D_SCOFLG(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_SCOFLG(zc) From W1CONSCSD1
Return

Subprog D_SCOFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]SCOFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SCOFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_SCOFLG
Call AM_SCOFLG(zc)
If !mkstat & GOBJET
 zoncou = "SCOFLG" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SCOFLG(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_SCOFLG(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "SCOFLG" : GZNUM = 5727 : Endif
Gosub _AFF
End

$ON_DLVTYPSCO
Onevent CONTROL Call C_DLVTYPSCO(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVTYPSCO(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVTYPSCO From W1CONSCSD1
Return

Subprog IB_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(48598,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_DLVTYPSCO(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DLVTYPSCO(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_DLVTYPSCO(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_DLVTYPSCO(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_DLVTYPSCO(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
## Action CONTTSD
Call CONTTSD(VALEUR,"","CSD1","DLVTYPSCO",[M:CSD1]STOFCY,"",3,[M:CSD1]CPY) From SUBTSD
If mkstat : GERR = 1 : GZONE = "DLVTYPSCO" : GZNUM = 2946 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DLVTYPSCO" : GZNUM = 2946 : Endif
Endif
Gosub _AFF
End

$AMM_DLVTYPSCO
Call AM_DLVTYPSCO(zc)
If !mkstat & GOBJET
 zoncou = "DLVTYPSCO" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZDLVTYPSCO)")>indice
 [M]DLVTYPSCO(indice) = VALEUR
 Affzo ZDLVTYPSCO(indice)
Endif
Gosub _AFF
End

Subprog S_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTSDLEG2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTSDLEG2"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSD1]STOFCY
 PARMSK(3) = ""
 PARMSK(4) = "3"
 PARMSK(5) = [M:CSD1]CPY
 PARMSK(6) = "CSD1"
 PARMSK(7) = "DLVTYPSCO"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTSD","SUBTSD","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTSD
 Call TUNTSD(VALEUR,"") From SUBTSD
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TSD"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DLVTYPSCO(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TSD",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZDLVTYPSCO
Onevent BEFORE_AREA Gosub AV_ZDLVTYPSCO From W1CONSCSD1
Return

$AV_ZDLVTYPSCO
Call LECTEXTRA(zc,"TABSDHTYP","SHOAXX",num$([M]DLVTYPSCO(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_NONINV
Onevent AFTER_CHANGE Gosub AMM_NONINV From W1CONSCSD1
Onevent INIT_AREA Call D_NONINV(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_NONINV(zc) From W1CONSCSD1
Return

Subprog D_NONINV(VALEUR)
Variable Integer VALEUR
If varinit([M]NONINV,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_NONINV(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_NONINV
Call AM_NONINV(zc)
If !mkstat & GOBJET
 zoncou = "NONINV" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NONINV(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_NONINV(VALEUR) From CNSCSDSTD
If mkstat : GERR = 1 : GZONE = "NONINV" : GZNUM = 30732 : Endif
Gosub _AFF
End

$ON_DLVTYPNIN
Onevent CONTROL Call C_DLVTYPNIN(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_DLVTYPNIN(zc) From W1CONSCSD1
Onevent AFTER_CHANGE Gosub AMM_DLVTYPNIN From W1CONSCSD1
Return

Subprog IB_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(48598,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_DLVTYPNIN(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_DLVTYPNIN(zc) From W1CONSCSD1
Onkey   2 Titled GBOUTS Call S_DLVTYPNIN(zc) From W1CONSCSD1
Onkey 144 Titled GBOUTP Call P_DLVTYPNIN(zc) From W1CONSCSD1
Onkey 146 Titled GBOUTA Call SA_DLVTYPNIN(zc) From W1CONSCSD1
Gosub _AFF
End

Subprog C_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
## Action CONTTSD
Call CONTTSD(VALEUR,"","CSD1","DLVTYPNIN",[M:CSD1]STOFCY,"",5,[M:CSD1]CPY) From SUBTSD
If mkstat : GERR = 1 : GZONE = "DLVTYPNIN" : GZNUM = 2946 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DLVTYPNIN" : GZNUM = 2946 : Endif
Endif
Gosub _AFF
End

$AMM_DLVTYPNIN
Call AM_DLVTYPNIN(zc)
If !mkstat & GOBJET
 zoncou = "DLVTYPNIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZDLVTYPNIN)")>indice
 [M]DLVTYPNIN(indice) = VALEUR
 Affzo ZDLVTYPNIN(indice)
Endif
Gosub _AFF
End

Subprog S_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTSDLEG2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTSDLEG2"
 PARMSK(1) = ""
 PARMSK(2) = [M:CSD1]STOFCY
 PARMSK(3) = ""
 PARMSK(4) = "5"
 PARMSK(5) = [M:CSD1]CPY
 PARMSK(6) = "CSD1"
 PARMSK(7) = "DLVTYPNIN"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTSD","SUBTSD","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTSD
 Call TUNTSD(VALEUR,"") From SUBTSD
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TSD"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DLVTYPNIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TSD",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZDLVTYPNIN
Onevent BEFORE_AREA Gosub AV_ZDLVTYPNIN From W1CONSCSD1
Return

$AV_ZDLVTYPNIN
Call LECTEXTRA(zc,"TABSDHTYP","SHOAXX",num$([M]DLVTYPNIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_CFMFLGO
Onevent INIT_AREA Call D_CFMFLGO(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_CFMFLGO(zc) From W1CONSCSD1
Return

Subprog D_CFMFLGO(VALEUR)
Variable Integer VALEUR
If varinit([M]CFMFLGO,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CFMFLGO(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CFMFLGN
Onevent INIT_AREA Call D_CFMFLGN(zc) From W1CONSCSD1
Onevent BEFORE_INPUT Call AS_CFMFLGN(zc) From W1CONSCSD1
Return

Subprog D_CFMFLGN(VALEUR)
Variable Integer VALEUR
If varinit([M]CFMFLGN,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CFMFLGN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Return


