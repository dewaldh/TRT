#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
## BI-DIMENSION ## Synchronization rule FASVEH

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".FXDASSETS" : If clalev([F:FAS])=0 : Local File =OUVTAB [FAS] : Endif
OUVTAB = GDOSSIER+".FXDASSETS" : If clalev([F:A_])=0 : Local File =OUVTAB [A_] : Endif
OUVTAB = "Link [FAS]"
Link [FAS] With
& [A_]FAS0=[FAS]AASREF
& As [LNK_]
& Where [F:FAS]NPL <> ""
& Order By Key CLE = [FAS]AASREF
FILTRE = ""
Return

$FERME
If clalev([F:FAS]) : Close local File [FAS] : Endif
If clalev([F:A_]) : Close local File [A_] : Endif
Return

$DCLE
Local Char    DCLE(GLONAVA)(1..1)
Local Integer DTYP(1..1)
Local Integer NBDCLE
NBDCLE = 1
DCLE(1) = "AASREFVEH"
DTYP(1) =  7
Return

$CHARGE_CLE
If dim([F:AAA_]AASREFVEH)>0
 [F:AAA_]AASREFVEH = [F:FAS]AASREF
Endif
Return

########################################################################
# Return the filter necessary for incremental delete in synchroonization
Subprog GET_FLTDELINC(PFLT)
Variable Clbfile PFLT
PFLT = "1=1"
Append PFLT, " & [F:AAA_]AASREFVEH=[F:FAS]AASREF"

End

$MAJFLD
### AASREFVEH
[L]FLD="AASREFVEH"
[L]FORMULE='[F:FAS]AASREF'
If dim([F:AAA_]AASREFVEH)>0
 [F:AAA_]AASREFVEH = [F:FAS]AASREF
Endif

### NPL
[L]FLD="NPL"
[L]FORMULE='[F:FAS]NPL'
If dim([F:AAA_]NPL)>0
 [F:AAA_]NPL = [F:FAS]NPL
Endif

### VEHCO2
[L]FLD="VEHCO2"
[L]FORMULE='[F:FAS]VEHCO2'
If dim([F:AAA_]VEHCO2)>0
 [F:AAA_]VEHCO2 = [F:FAS]VEHCO2
Endif

### RGNDAT
[L]FLD="RGNDAT"
[L]FORMULE='[F:FAS]RGNDAT'
If dim([F:AAA_]RGNDAT)>0
 [F:AAA_]RGNDAT = [F:FAS]RGNDAT
Endif

### FIRICIDAT
[L]FLD="FIRICIDAT"
[L]FORMULE='[F:FAS]FIRICIDAT'
If dim([F:AAA_]FIRICIDAT)>0
 [F:AAA_]FIRICIDAT = [F:FAS]FIRICIDAT
Endif

### VEHUSER
[L]FLD="VEHUSER"
[L]FORMULE='[F:FAS]VEHUSER'
If dim([F:AAA_]VEHUSER)>0
 [F:AAA_]VEHUSER = [F:FAS]VEHUSER
Endif

### VEHBRA
[L]FLD="VEHBRA"
[L]FORMULE='[F:FAS]VEHBRA'
If dim([F:AAA_]VEHBRA)>0
 [F:AAA_]VEHBRA = [F:FAS]VEHBRA
Endif

### VEHTYP
[L]FLD="VEHTYP"
[L]FORMULE='[F:FAS]VEHTYP'
If dim([F:AAA_]VEHTYP)>0
 [F:AAA_]VEHTYP = [F:FAS]VEHTYP
Endif

### CWKTYP
[L]FLD="CWKTYP"
[L]FORMULE='[F:FAS]CWKTYP'
If dim([F:AAA_]CWKTYP)>0
 [F:AAA_]CWKTYP = [F:FAS]CWKTYP
Endif

### VEHPWR
[L]FLD="VEHPWR"
[L]FORMULE='[F:FAS]VEHPWR'
If dim([F:AAA_]VEHPWR)>0
 [F:AAA_]VEHPWR = [F:FAS]VEHPWR
Endif

### TAXPLI
[L]FLD="TAXPLI"
[L]FORMULE='num$([F:FAS]TAXPLI)-"-"-mess([F:FAS]TAXPLI,3164,1)'
If dim([F:AAA_]TAXPLI)>0
 [F:AAA_]TAXPLI = num$([F:FAS]TAXPLI)-"-"-mess([F:FAS]TAXPLI,3164,1)
Endif

### RNTSTRDAT
[L]FLD="RNTSTRDAT"
[L]FORMULE='[F:FAS]RNTSTRDAT'
If dim([F:AAA_]RNTSTRDAT)>0
 [F:AAA_]RNTSTRDAT = [F:FAS]RNTSTRDAT
Endif

### RNTENDDAT
[L]FLD="RNTENDDAT"
[L]FORMULE='[F:FAS]RNTENDDAT'
If dim([F:AAA_]RNTENDDAT)>0
 [F:AAA_]RNTENDDAT = [F:FAS]RNTENDDAT
Endif

### RNTMONDUR
[L]FLD="RNTMONDUR"
[L]FORMULE='[F:FAS]RNTMONDUR'
If dim([F:AAA_]RNTMONDUR)>0
 [F:AAA_]RNTMONDUR = [F:FAS]RNTMONDUR
Endif

### RNTDAYDUR
[L]FLD="RNTDAYDUR"
[L]FORMULE='[F:FAS]RNTDAYDUR'
If dim([F:AAA_]RNTDAYDUR)>0
 [F:AAA_]RNTDAYDUR = [F:FAS]RNTDAYDUR
Endif

### VEHTAXRUL
[L]FLD="VEHTAXRUL"
[L]FORMULE='num$([F:FAS]VEHTAXRUL)-"-"-mess([F:FAS]VEHTAXRUL,3165,1)'
If dim([F:AAA_]VEHTAXRUL)>0
 [F:AAA_]VEHTAXRUL = num$([F:FAS]VEHTAXRUL)-"-"-mess([F:FAS]VEHTAXRUL,3165,1)
Endif

### VEHWEI1
[L]FLD="VEHWEI1"
[L]FORMULE='[F:FAS]VEHWEI1'
If dim([F:AAA_]VEHWEI1)>0
 [F:AAA_]VEHWEI1 = [F:FAS]VEHWEI1
Endif

### VEHWEI2
[L]FLD="VEHWEI2"
[L]FORMULE='[F:FAS]VEHWEI2'
If dim([F:AAA_]VEHWEI2)>0
 [F:AAA_]VEHWEI2 = [F:FAS]VEHWEI2
Endif

### VEHPLCNBR
[L]FLD="VEHPLCNBR"
[L]FORMULE='[F:FAS]VEHPLCNBR'
If dim([F:AAA_]VEHPLCNBR)>0
 [F:AAA_]VEHPLCNBR = [F:FAS]VEHPLCNBR
Endif


Return

