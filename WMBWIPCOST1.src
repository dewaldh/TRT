#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
## BI-REGLE ## Synchronization rule WIPCOST1

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".WIPCOST" : If clalev([F:MWI])=0 : Local File =OUVTAB [MWI] : Endif
OUVTAB = GDOSSIER+".MFGHEAD" : If clalev([F:MFG])=0 : Local File =OUVTAB [MFG] : Endif
OUVTAB = GDOSSIER+".MFGITM" : If clalev([F:MFI])=0 : Local File =OUVTAB [MFI] : Endif
OUVTAB = "Link [MWI]"
Link [MWI] With
& [MFG]MFG0 = [F:MWI]VCRNUM,
& [MFI]MFI0 = [F:MWI]VCRNUM;[F:MWI]VCRLIN
& As [LNK_]
& Where [F:MFG]MFGTRKFLG>4 & [F:MFG]MFGSTA=4
FILTRE = ""
Return

$FERME
If clalev([F:MWI]) : Close local File [MWI] : Endif
If clalev([F:MFG]) : Close local File [MFG] : Endif
If clalev([F:MFI]) : Close local File [MFI] : Endif
Return

$LIEN
Return

$MAJFLD
### MFGFCY
[L]FLD="MFGFCY"
[L]FORMULE='[F:MWI]MFGFCY'
If dim([F:AAA_]MFGFCY)>0
 [F:AAA_]MFGFCY = [F:MWI]MFGFCY
Endif

### MFGSTA
[L]FLD="MFGSTA"
[L]FORMULE='[F:MFG]MFGSTA'
If dim([F:AAA_]MFGSTA)>0
 [F:AAA_]MFGSTA = [F:MFG]MFGSTA
Endif

### VCRNUM
[L]FLD="VCRNUM"
[L]FORMULE='[F:MWI]VCRNUM'
If dim([F:AAA_]VCRNUM)>0
 [F:AAA_]VCRNUM = [F:MWI]VCRNUM
Endif

### VCRTYP
[L]FLD="VCRTYP"
[L]FORMULE='[F:MWI]VCRTYP'
If dim([F:AAA_]VCRTYP)>0
 [F:AAA_]VCRTYP = [F:MWI]VCRTYP
Endif

### VCRLIN
[L]FLD="VCRLIN"
[L]FORMULE='[F:MWI]VCRLIN'
If dim([F:AAA_]VCRLIN)>0
 [F:AAA_]VCRLIN = [F:MWI]VCRLIN
Endif

### DOSSIER
[L]FLD="DOSSIER"
[L]FORMULE='GDOSSIER'
If dim([F:AAA_]DOSSIER)>0
 [F:AAA_]DOSSIER = GDOSSIER
Endif

### CURLOC
[L]FLD="CURLOC"
[L]FORMULE='func TRTX3BI.GETCUR([F:AAA_]MFGFCY)'
If dim([F:AAA_]CURLOC)>0
 [F:AAA_]CURLOC = func TRTX3BI.GETCUR([F:AAA_]MFGFCY)
Endif

### CURRPT
[L]FLD="CURRPT"
[L]FORMULE='func TRTX3BI.GETSYSCUR()'
If dim([F:AAA_]CURRPT)>0
 [F:AAA_]CURRPT = func TRTX3BI.GETSYSCUR()
Endif

### ROUNUM
[L]FLD="ROUNUM"
[L]FORMULE='[F:MFG]ROUNUM'
If dim([F:AAA_]ROUNUM)>0
 [F:AAA_]ROUNUM = [F:MFG]ROUNUM
Endif

### ROUALT
[L]FLD="ROUALT"
[L]FORMULE='[F:MFG]ROUALT'
If dim([F:AAA_]ROUALT)>0
 [F:AAA_]ROUALT = [F:MFG]ROUALT
Endif

### CPY
[L]FLD="CPY"
[L]FORMULE='func TRTX3BI.GETCPY([F:MFG]MFGFCY)'
If dim([F:AAA_]CPY)>0
 [F:AAA_]CPY = func TRTX3BI.GETCPY([F:MFG]MFGFCY)
Endif

### PJT
[L]FLD="PJT"
[L]FORMULE='vireblc([F:MFI]PJT,2)'
If dim([F:AAA_]PJT)>0
 [F:AAA_]PJT = vireblc([F:MFI]PJT,2)
Endif

### TXNTYP
[L]FLD="TXNTYP"
[L]FORMULE='[F:MWI]TXNTYP'
If dim([F:AAA_]TXNTYP)>0
 [F:AAA_]TXNTYP = [F:MWI]TXNTYP
Endif

### MFGTRKNUM
[L]FLD="MFGTRKNUM"
[L]FORMULE='[F:MWI]MFGTRKNUM'
If dim([F:AAA_]MFGTRKNUM)>0
 [F:AAA_]MFGTRKNUM = [F:MWI]MFGTRKNUM
Endif

### FIYNUM
[L]FLD="FIYNUM"
[L]FORMULE='func TRTX3BI.GETEXE([F:MFG]MFGFCY,[F:MFG]ENDDAT)'
If dim([F:AAA_]FIYNUM)>0
 [F:AAA_]FIYNUM = func TRTX3BI.GETEXE([F:MFG]MFGFCY,[F:MFG]ENDDAT)
Endif

### PERNUM
[L]FLD="PERNUM"
[L]FORMULE='func TRTX3BI.GETPER([F:MFG]MFGFCY,[F:MFG]ENDDAT)'
If dim([F:AAA_]PERNUM)>0
 [F:AAA_]PERNUM = func TRTX3BI.GETPER([F:MFG]MFGFCY,[F:MFG]ENDDAT)
Endif

### TXNDAT
[L]FLD="TXNDAT"
[L]FORMULE='[F:MWI]TXNDAT'
If dim([F:AAA_]TXNDAT)>0
 [F:AAA_]TXNDAT = [F:MWI]TXNDAT
Endif

### ITMREF
[L]FLD="ITMREF"
[L]FORMULE='[F:MWI]ITMREF'
If dim([F:AAA_]ITMREF)>0
 [F:AAA_]ITMREF = [F:MWI]ITMREF
Endif

### QTY
[L]FLD="QTY"
[L]FORMULE='[F:MWI]QTY'
If dim([F:AAA_]QTY)>0
 [F:AAA_]QTY = [F:MWI]QTY
Endif

### REJQTY
[L]FLD="REJQTY"
[L]FORMULE='[F:MWI]REJQTY'
If dim([F:AAA_]REJQTY)>0
 [F:AAA_]REJQTY = [F:MWI]REJQTY
Endif

### CPLSETTIM
[L]FLD="CPLSETTIM"
[L]FORMULE='[F:MWI]CPLSETTIM'
If dim([F:AAA_]CPLSETTIM)>0
 [F:AAA_]CPLSETTIM = [F:MWI]CPLSETTIM
Endif

### CPLOPETIM
[L]FLD="CPLOPETIM"
[L]FORMULE='[F:MWI]CPLOPETIM'
If dim([F:AAA_]CPLOPETIM)>0
 [F:AAA_]CPLOPETIM = [F:MWI]CPLOPETIM
Endif

### WST
[L]FLD="WST"
[L]FORMULE='[F:MWI]WST'
If dim([F:AAA_]WST)>0
 [F:AAA_]WST = [F:MWI]WST
Endif

### AMOUNT
[L]FLD="AMOUNT"
[L]FORMULE='[F:MWI]AMOUNT'
If dim([F:AAA_]AMOUNT)>0
 [F:AAA_]AMOUNT = [F:MWI]AMOUNT
Endif

### AMOUNTR
[L]FLD="AMOUNTR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]AMOUNT)'
If dim([F:AAA_]AMOUNTR)>0
 [F:AAA_]AMOUNTR = func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]AMOUNT)
Endif

### CSTELM
[L]FLD="CSTELM"
[L]FORMULE='[F:MWI]CSTELM'
If dim([F:AAA_]CSTELM)>0
 [F:AAA_]CSTELM = [F:MWI]CSTELM
Endif

### CSTELMR
[L]FLD="CSTELMR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]CSTELM)'
If dim([F:AAA_]CSTELMR)>0
 [F:AAA_]CSTELMR = func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]CSTELM)
Endif

### OVENAT
[L]FLD="OVENAT"
[L]FORMULE='[F:MWI]OVENAT'
If dim([F:AAA_]OVENAT)>0
 [F:AAA_]OVENAT = [F:MWI]OVENAT
Endif

### OVENATAMT
[L]FLD="OVENATAMT"
[L]FORMULE='[F:MWI]OVENATAMT'
If dim([F:AAA_]OVENATAMT)>0
 [F:AAA_]OVENATAMT = [F:MWI]OVENATAMT
Endif

### OVENATAMTR
[L]FLD="OVENATAMTR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]OVENATAMT)'
If dim([F:AAA_]OVENATAMTR)>0
 [F:AAA_]OVENATAMTR = func TRTX3BI.CNVCPYRPT([F:MWI]MFGFCY,[F:MWI]TXNDAT,[F:MWI]OVENATAMT)
Endif

### MATGRP
[L]FLD="MATGRP"
[L]FORMULE='[F:MWI]MATGRP'
If dim([F:AAA_]MATGRP)>0
 [F:AAA_]MATGRP = [F:MWI]MATGRP
Endif

### OPEGRP
[L]FLD="OPEGRP"
[L]FORMULE='[F:MWI]OPEGRP'
If dim([F:AAA_]OPEGRP)>0
 [F:AAA_]OPEGRP = [F:MWI]OPEGRP
Endif

### GLPSTA
[L]FLD="GLPSTA"
[L]FORMULE='[F:MWI]GLPSTA'
If dim([F:AAA_]GLPSTA)>0
 [F:AAA_]GLPSTA = [F:MWI]GLPSTA
Endif

### GLPDAT
[L]FLD="GLPDAT"
[L]FORMULE='[F:MWI]GLPDAT'
If dim([F:AAA_]GLPDAT)>0
 [F:AAA_]GLPDAT = [F:MWI]GLPDAT
Endif

### PRINAT
[L]FLD="PRINAT"
[L]FORMULE='[F:MWI]PRINAT'
If dim([F:AAA_]PRINAT)>0
 [F:AAA_]PRINAT = [F:MWI]PRINAT
Endif

K = instr(1,GDOSSIER,'@')
If K
 [F:AAA_]ADOS = right$(GDOSSIER,K+1)
Else
 [F:AAA_]ADOS = GDOSSIER
Endif
[F:AAA_]AREG = 'WIPCOST1'
[F:AAA_]AIND = indice
[L]FLD="ACLE"
[L]FORMULE="ACLE"
[F:AAA_]ACLE = num$([F:MWI]VCRTYP)+'~'+num$([F:MWI]VCRNUM)+'~'+num$([F:MWI]TXNTYP)+'~'+num$([F:MWI]WIPSEQ)
Return

