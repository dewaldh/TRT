#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WMAC2STDCO 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [23/01/2019]
A_HEURE = "16:09:20"
A_USER  = "JR"
A_STAMP = "20190123160920"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If [M:HAEF]FMTSAC(0)<>""
    Chgfmt SAC1 With [M:HAEF]FMTSAC(0)
   Else
    Chgfmt SAC1 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(0)<>""
    Chgfmt ACC1 With [M:HAEF]FMTCOA(0)
   Else
    Chgfmt ACC1 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(1)<>""
    Chgfmt SAC2 With [M:HAEF]FMTSAC(1)
   Else
    Chgfmt SAC2 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(1)<>""
    Chgfmt ACC2 With [M:HAEF]FMTCOA(1)
   Else
    Chgfmt ACC2 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(2)<>""
    Chgfmt SAC3 With [M:HAEF]FMTSAC(2)
   Else
    Chgfmt SAC3 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(2)<>""
    Chgfmt ACC3 With [M:HAEF]FMTCOA(2)
   Else
    Chgfmt ACC3 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(3)<>""
    Chgfmt SAC4 With [M:HAEF]FMTSAC(3)
   Else
    Chgfmt SAC4 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(3)<>""
    Chgfmt ACC4 With [M:HAEF]FMTCOA(3)
   Else
    Chgfmt ACC4 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(4)<>""
    Chgfmt SAC5 With [M:HAEF]FMTSAC(4)
   Else
    Chgfmt SAC5 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(4)<>""
    Chgfmt ACC5 With [M:HAEF]FMTCOA(4)
   Else
    Chgfmt ACC5 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(5)<>""
    Chgfmt SAC6 With [M:HAEF]FMTSAC(5)
   Else
    Chgfmt SAC6 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(5)<>""
    Chgfmt ACC6 With [M:HAEF]FMTCOA(5)
   Else
    Chgfmt ACC6 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(6)<>""
    Chgfmt SAC7 With [M:HAEF]FMTSAC(6)
   Else
    Chgfmt SAC7 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(6)<>""
    Chgfmt ACC7 With [M:HAEF]FMTCOA(6)
   Else
    Chgfmt ACC7 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(7)<>""
    Chgfmt SAC8 With [M:HAEF]FMTSAC(7)
   Else
    Chgfmt SAC8 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(7)<>""
    Chgfmt ACC8 With [M:HAEF]FMTCOA(7)
   Else
    Chgfmt ACC8 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(8)<>""
    Chgfmt SAC9 With [M:HAEF]FMTSAC(8)
   Else
    Chgfmt SAC9 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(8)<>""
    Chgfmt ACC9 With [M:HAEF]FMTCOA(8)
   Else
    Chgfmt ACC9 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(9)<>""
    Chgfmt SAC10 With [M:HAEF]FMTSAC(9)
   Else
    Chgfmt SAC10 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(9)<>""
    Chgfmt ACC10 With [M:HAEF]FMTCOA(9)
   Else
    Chgfmt ACC10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDOE<>""
    Chgfmt DOEPTR With [M:HAEF]FMTDOE
   Else
    Chgfmt DOEPTR With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(0)<>""
    Chgfmt CPA1 With [M:HAEF]FMTCPA(0)
   Else
    Chgfmt CPA1 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(1)<>""
    Chgfmt CPA2 With [M:HAEF]FMTCPA(1)
   Else
    Chgfmt CPA2 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(2)<>""
    Chgfmt CPA3 With [M:HAEF]FMTCPA(2)
   Else
    Chgfmt CPA3 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(3)<>""
    Chgfmt CPA4 With [M:HAEF]FMTCPA(3)
   Else
    Chgfmt CPA4 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(4)<>""
    Chgfmt CPA5 With [M:HAEF]FMTCPA(4)
   Else
    Chgfmt CPA5 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(5)<>""
    Chgfmt CPA6 With [M:HAEF]FMTCPA(5)
   Else
    Chgfmt CPA6 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(6)<>""
    Chgfmt CPA7 With [M:HAEF]FMTCPA(6)
   Else
    Chgfmt CPA7 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(7)<>""
    Chgfmt CPA8 With [M:HAEF]FMTCPA(7)
   Else
    Chgfmt CPA8 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(8)<>""
    Chgfmt CPA9 With [M:HAEF]FMTCPA(8)
   Else
    Chgfmt CPA9 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(9)<>""
    Chgfmt CPA10 With [M:HAEF]FMTCPA(9)
   Else
    Chgfmt CPA10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(0)<>""
    Chgfmt CCE1 With [M:HAEF]FMTDIE(0)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(1)<>""
    Chgfmt CCE2 With [M:HAEF]FMTDIE(1)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(2)<>""
    Chgfmt CCE3 With [M:HAEF]FMTDIE(2)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(3)<>""
    Chgfmt CCE4 With [M:HAEF]FMTDIE(3)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(4)<>""
    Chgfmt CCE5 With [M:HAEF]FMTDIE(4)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(5)<>""
    Chgfmt CCE6 With [M:HAEF]FMTDIE(5)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(6)<>""
    Chgfmt CCE7 With [M:HAEF]FMTDIE(6)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(7)<>""
    Chgfmt CCE8 With [M:HAEF]FMTDIE(7)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(8)<>""
    Chgfmt CCE9 With [M:HAEF]FMTDIE(8)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(9)<>""
    Chgfmt CCE10 With [M:HAEF]FMTDIE(9)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(10)<>""
    Chgfmt CCE11 With [M:HAEF]FMTDIE(10)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(11)<>""
    Chgfmt CCE12 With [M:HAEF]FMTDIE(11)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(12)<>""
    Chgfmt CCE13 With [M:HAEF]FMTDIE(12)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(13)<>""
    Chgfmt CCE14 With [M:HAEF]FMTDIE(13)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(14)<>""
    Chgfmt CCE15 With [M:HAEF]FMTDIE(14)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(15)<>""
    Chgfmt CCE16 With [M:HAEF]FMTDIE(15)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(16)<>""
    Chgfmt CCE17 With [M:HAEF]FMTDIE(16)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(17)<>""
    Chgfmt CCE18 With [M:HAEF]FMTDIE(17)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(18)<>""
    Chgfmt CCE19 With [M:HAEF]FMTDIE(18)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(19)<>""
    Chgfmt CCE20 With [M:HAEF]FMTDIE(19)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WMAC2STDCO [HAE2]
Gosub HORODAT
Local Inpbox "WMAC2STDCO" From GFONCTION At A_STAMP With A_WINDPREV Mask [HAE2] As [SIM_]
Grizo [HAE2]20
Grizo [HAE2]25
Grizo [HAE2]30
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [HAE2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=19
X1(1)=1 : X2(1)=37 : Y1(1)=20 : Y2(1)=22
X1(2)=38 : X2(2)=74 : Y1(2)=20 : Y2(2)=22
Return

$ON_NBLIG
Onevent BEFORE_AREA Call AV_NBLIG From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_NBLIG From W1WMAC2STDCO
Onevent CONTROL Call C_NBLIG From W1WMAC2STDCO
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WMAC2STDCO
Onevent AFTER_LINE Call APRES_NBLIG From W1WMAC2STDCO
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBGA0
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
GDEV1(1) = "EUR"
GDEV1(1) = [M]CURAFF
Gosub SETDEV From TRTDIV
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W5WMAC2STDCO
Endif
## Action STD
Call AV_NBLIG From SUBGA0
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6086,GBOUT1) From OBJDIV
Call TEXTE(6086,GBOUT2) From OBJDIV
Call TEXTE(5528,GBOUT3) From OBJDIV
Call TEXTE(4975,GBOUT4) From OBJDIV
Call TEXTE(7780,GBOUT5) From OBJDIV
Call TEXTE(5187,GBOUT6) From OBJDIV
Call TEXTE(43525,GBOUT7) From OBJDIV
Call TEXTE(43525,GBOUT8) From OBJDIV
Call TEXTE(43525,GBOUT9) From OBJDIV
Call TEXTE(454,GBOUT10) From OBJDIV
Call IB_NBLIG
## Action STD
Call AS_NBLIG From SUBGA0
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WMAC2STDCO
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WMAC2STDCO
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WMAC2STDCO
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WMAC2STDCO
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WMAC2STDCO
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WMAC2STDCO
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WMAC2STDCO
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WMAC2STDCO
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WMAC2STDCO
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WMAC2STDCO
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBGA0
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSGAS1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSGAS1"
 Call S_AFF_NUM(BASPAG,PARMSK,"GAC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([F:FIY]LEDTYP)
 PARMSK(4) = [F:GAC]ACC
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [F:GAC]ACCSHO
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = ""
 PARMSK(10) = ""
 Call CONSULT_NUM(BASPAG,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSGAS2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSGAS2"
 Call S_AFF_NUM(BASPAG,PARMSK,"CNA","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action CONSNAT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSNAT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([F:FIY]LEDTYP)
 PARMSK(4) = [F:GAC]ACC
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [F:GAC]ACCSHO
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 Call CONSULT_NUM(BASPAG,"NAT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAISTT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAISTT"
 Call SAISIE_NUM(BASPAG,PARMSK,"FSAISTT","SAISTT","XWFSAISTT") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASSCHEMA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASSCHEMA"
 Call S_TAB_NUM(BASPAG,PARMSK,"GASSCHEMA","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBGA0
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action STD
Call APRES_NBLIG From SUBGA0
If mkstat : End : Endif
## Action SPE
Call APRES_NBLIG From SPEGA0
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action DUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DUD"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 PARMSK(2) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(3) = num$([M]VERROU=1 & GCONSULT=0)
 Call SAISIE_NUM(BASPAG,PARMSK,"DDUD","GACCDUD","XWDDUD") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIVENTIL3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIVENTIL3"
 PARMSK(1) = "Â£"+[M]DSP(nolign-1)
 PARMSK(2) = "[M]PTV"
 PARMSK(3) = "[M]PTF"
 PARMSK(4) = num$([M]NBLIG)
 PARMSK(5) = num$(nolign-1)
 PARMSK(6) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(7) = num$([M]QTY(nolign-1))
 PARMSK(8) = [M]UOM(nolign-1)
 PARMSK(9) = [M]CUR
 PARMSK(10) = [M]LEDDSP
 PARMSK(11) = [M]ACCDSP
 PARMSK(12) = [M]BPR(nolign-1)
 PARMSK(13) = [M]FCYLIN(nolign-1)
 PARMSK(14) = [M]ACCDAT
 PARMSK(15) = ""
 Call SAISIE_NUM(BASPAG,PARMSK,"FVENTILE","SAIVENTILE","XWFVENTILE") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 Call SAISIE_NUM(BASPAG,PARMSK,"DGASACCNUM","GASACCNUM","XWGASACCNUM") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM2"
 Call S_LIS_NUM(BASPAG,PARMSK,"GASACCNUM2","GASACCNUM","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action GCNSZOOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GCNSZOOM"
 PARMSK(1) = GBIDC2
 PARMSK(2) = GBIDC1
 PARMSK(3) = GBIDC3
 Call S_AFF_NUM(BASPAG,PARMSK,"ZOOM","CONSSUB","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM3"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 Call S_AFF_NUM(BASPAG,PARMSK,"GASACCNUM3","GASACCNUM","") From GACTION
 [M]ACCNUM(nolign-1) = val(PARMSK(1))
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASVATLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASVATLIN"
 Call S_AFF_NUM(BASPAG,PARMSK,"GASVATLIN","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NUMLIG
Onevent BEFORE_AREA Gosub AV_NUMLIG From W1WMAC2STDCO
Return

$AV_NUMLIG
zc = nolign
Gosub _AFF
Return

$ON_FCYLIN
Onevent CONTROL Call C_FCYLIN(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_FCYLIN(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_FCYLIN(zc) From W1WMAC2STDCO
Return

Subprog D_FCYLIN(VALEUR)
Variable Char    VALEUR()
If varinit([M]FCYLIN,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"FCYL") From TRTGAS
 ## Action STD
 Call D_FCYLIN(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"FCYL") From TRTGAS
If mkstat=2
 [M]FCYLIN(INDIC) = VALEUR
 Affzo FCYLIN(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_FCYLIN(VALEUR) From SUBGA0
 If mkstat=2
  [M]FCYLIN(INDIC) = VALEUR
  Affzo FCYLIN(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_FCYLIN(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_FCYLIN(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_FCYLIN(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_FCYLIN(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_FCYLIN(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","C",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
  If !mkstat
   ## Action FLDCTLCAR
   Call FLDCTLCAR(VALEUR,"FCYL") From TRTGAS
   If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
   If !mkstat
    ## Action CONTFCY
    Call CONTFCY(VALEUR) From EXEFNC
    If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
    If !mkstat
     ## Action STD
     Call C_FCYLIN(VALEUR) From SUBGA0
     If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
    Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "C"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FCYLIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LEDTYP
Onevent INIT_AREA Call D_LEDTYP(zc) From W1WMAC2STDCO
Return

Subprog D_LEDTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]LEDTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_IDTLIN
Onevent INIT_AREA Call D_IDTLIN(zc) From W1WMAC2STDCO
Return

Subprog D_IDTLIN(VALEUR)
Variable Char    VALEUR()
If varinit([M]IDTLIN,indice)=0
 ## Action STD
 Call D_IDTLIN(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

$ON_COA1
Return

$ON_SAC1
Onevent CONTROL Call C_SAC1(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC1(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC1 From W1WMAC2STDCO
Return

$AV_SAC1
If [M:HAEF]FMTSAC(0)<>""
 Chgfmt [M]SAC1(indice) With [M:HAEF]FMTSAC(0)
Else
 Chgfmt [M]SAC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC1(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC1") From TRTGAS
If mkstat=2
 [M]SAC1(INDIC) = VALEUR
 Affzo SAC1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC1(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC1(INDIC) = VALEUR
  Affzo SAC1(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA1(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC1") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC1(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA1(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC1
Onevent BEFORE_AREA Gosub AV_ACC1 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC1(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC1(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC1(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC1 From W1WMAC2STDCO
Return

Subprog IB_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC1 From SUBGA0
Gosub _AFF
End

$AV_ACC1
## Action INIACCFMT
Call INIACCFMT(num$([M]COA1(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(0)<>""
 Chgfmt [M]ACC1(indice) With [M:HAEF]FMTCOA(0)
Else
 Chgfmt [M]ACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC1(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC1(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC1") From TRTGAS
If mkstat=2
 [M]ACC1(INDIC) = VALEUR
 Affzo ACC1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC1(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC1(INDIC) = VALEUR
  Affzo ACC1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC1(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC1(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC1(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC1(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC1(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC1(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA1(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA1(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC1") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC1(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC1
Call AM_ACC1(zc)
If !mkstat & GOBJET
 zoncou = "ACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA1(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA1(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA1(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC1(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA1(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA1(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA2
Return

$ON_SAC2
Onevent CONTROL Call C_SAC2(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC2(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC2 From W1WMAC2STDCO
Return

$AV_SAC2
If [M:HAEF]FMTSAC(1)<>""
 Chgfmt [M]SAC2(indice) With [M:HAEF]FMTSAC(1)
Else
 Chgfmt [M]SAC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC2(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC2") From TRTGAS
If mkstat=2
 [M]SAC2(INDIC) = VALEUR
 Affzo SAC2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC2(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC2(INDIC) = VALEUR
  Affzo SAC2(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA2(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC2") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC2(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA2(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC2
Onevent BEFORE_AREA Gosub AV_ACC2 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC2(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC2(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC2(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC2 From W1WMAC2STDCO
Return

Subprog IB_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC2 From SUBGA0
Gosub _AFF
End

$AV_ACC2
## Action INIACCFMT
Call INIACCFMT(num$([M]COA2(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(1)<>""
 Chgfmt [M]ACC2(indice) With [M:HAEF]FMTCOA(1)
Else
 Chgfmt [M]ACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC2(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC2(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC2") From TRTGAS
If mkstat=2
 [M]ACC2(INDIC) = VALEUR
 Affzo ACC2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC2(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC2(INDIC) = VALEUR
  Affzo ACC2(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC2(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC2(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC2(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC2(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC2(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC2(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA2(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA2(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC2") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC2(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC2
Call AM_ACC2(zc)
If !mkstat & GOBJET
 zoncou = "ACC2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA2(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC2(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA2(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA2(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC2(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA2(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA2(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA3
Return

$ON_SAC3
Onevent CONTROL Call C_SAC3(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC3(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC3 From W1WMAC2STDCO
Return

$AV_SAC3
If [M:HAEF]FMTSAC(2)<>""
 Chgfmt [M]SAC3(indice) With [M:HAEF]FMTSAC(2)
Else
 Chgfmt [M]SAC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC3(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC3") From TRTGAS
If mkstat=2
 [M]SAC3(INDIC) = VALEUR
 Affzo SAC3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC3(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC3(INDIC) = VALEUR
  Affzo SAC3(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA3(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC3") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC3(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA3(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC3
Onevent BEFORE_AREA Gosub AV_ACC3 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC3(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC3(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC3(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC3 From W1WMAC2STDCO
Return

Subprog IB_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC3 From SUBGA0
Gosub _AFF
End

$AV_ACC3
## Action INIACCFMT
Call INIACCFMT(num$([M]COA3(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(2)<>""
 Chgfmt [M]ACC3(indice) With [M:HAEF]FMTCOA(2)
Else
 Chgfmt [M]ACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC3(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC3(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC3") From TRTGAS
If mkstat=2
 [M]ACC3(INDIC) = VALEUR
 Affzo ACC3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC3(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC3(INDIC) = VALEUR
  Affzo ACC3(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC3(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC3(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC3(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC3(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC3(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC3(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA3(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA3(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC3") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC3(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC3
Call AM_ACC3(zc)
If !mkstat & GOBJET
 zoncou = "ACC3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA3(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC3(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA3(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA3(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC3(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA3(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA3(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA4
Return

$ON_SAC4
Onevent CONTROL Call C_SAC4(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC4(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC4 From W1WMAC2STDCO
Return

$AV_SAC4
If [M:HAEF]FMTSAC(3)<>""
 Chgfmt [M]SAC4(indice) With [M:HAEF]FMTSAC(3)
Else
 Chgfmt [M]SAC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC4(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC4") From TRTGAS
If mkstat=2
 [M]SAC4(INDIC) = VALEUR
 Affzo SAC4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC4(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC4(INDIC) = VALEUR
  Affzo SAC4(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA4(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC4") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC4(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA4(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC4
Onevent BEFORE_AREA Gosub AV_ACC4 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC4(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC4(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC4(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC4 From W1WMAC2STDCO
Return

Subprog IB_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC4 From SUBGA0
Gosub _AFF
End

$AV_ACC4
## Action INIACCFMT
Call INIACCFMT(num$([M]COA4(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(3)<>""
 Chgfmt [M]ACC4(indice) With [M:HAEF]FMTCOA(3)
Else
 Chgfmt [M]ACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC4(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC4(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC4") From TRTGAS
If mkstat=2
 [M]ACC4(INDIC) = VALEUR
 Affzo ACC4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC4(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC4(INDIC) = VALEUR
  Affzo ACC4(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC4(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC4(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC4(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC4(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC4(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC4(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA4(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA4(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC4") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC4(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC4
Call AM_ACC4(zc)
If !mkstat & GOBJET
 zoncou = "ACC4" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA4(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC4(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA4(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA4(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC4(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA4(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA4(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA5
Return

$ON_SAC5
Return

$ON_ACC5
Onevent BEFORE_AREA Gosub AV_ACC5 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC5(zc) From W1WMAC2STDCO
Return

$AV_ACC5
## Action INIACCFMT
Call INIACCFMT(num$([M]COA5(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC5(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA6
Return

$ON_SAC6
Return

$ON_ACC6
Onevent BEFORE_AREA Gosub AV_ACC6 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC6(zc) From W1WMAC2STDCO
Return

$AV_ACC6
## Action INIACCFMT
Call INIACCFMT(num$([M]COA6(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC6(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA7
Return

$ON_SAC7
Return

$ON_ACC7
Onevent BEFORE_AREA Gosub AV_ACC7 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC7(zc) From W1WMAC2STDCO
Return

$AV_ACC7
## Action INIACCFMT
Call INIACCFMT(num$([M]COA7(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC7(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC7(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA8
Return

$ON_SAC8
Return

$ON_ACC8
Onevent BEFORE_AREA Gosub AV_ACC8 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC8(zc) From W1WMAC2STDCO
Return

$AV_ACC8
## Action INIACCFMT
Call INIACCFMT(num$([M]COA8(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC8(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC8(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA9
Return

$ON_SAC9
Return

$ON_ACC9
Onevent BEFORE_AREA Gosub AV_ACC9 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC9(zc) From W1WMAC2STDCO
Return

$AV_ACC9
## Action INIACCFMT
Call INIACCFMT(num$([M]COA9(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC9(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC9(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W5WMAC2STDCO
Return

$TIT_COL
Gosub TIT_COL From W5WMAC2STDCO
Return


