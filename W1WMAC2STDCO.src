#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WMAC2STDCO 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [14/03/2019]
A_HEURE = "16:26:36"
A_USER  = "DH"
A_STAMP = "20190314162636"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If [M:HAEF]FMTSAC(0)<>""
    Chgfmt SAC1 With [M:HAEF]FMTSAC(0)
   Else
    Chgfmt SAC1 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(0)<>""
    Chgfmt ACC1 With [M:HAEF]FMTCOA(0)
   Else
    Chgfmt ACC1 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(1)<>""
    Chgfmt SAC2 With [M:HAEF]FMTSAC(1)
   Else
    Chgfmt SAC2 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(1)<>""
    Chgfmt ACC2 With [M:HAEF]FMTCOA(1)
   Else
    Chgfmt ACC2 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(2)<>""
    Chgfmt SAC3 With [M:HAEF]FMTSAC(2)
   Else
    Chgfmt SAC3 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(2)<>""
    Chgfmt ACC3 With [M:HAEF]FMTCOA(2)
   Else
    Chgfmt ACC3 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(3)<>""
    Chgfmt SAC4 With [M:HAEF]FMTSAC(3)
   Else
    Chgfmt SAC4 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(3)<>""
    Chgfmt ACC4 With [M:HAEF]FMTCOA(3)
   Else
    Chgfmt ACC4 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(4)<>""
    Chgfmt SAC5 With [M:HAEF]FMTSAC(4)
   Else
    Chgfmt SAC5 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(4)<>""
    Chgfmt ACC5 With [M:HAEF]FMTCOA(4)
   Else
    Chgfmt ACC5 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(5)<>""
    Chgfmt SAC6 With [M:HAEF]FMTSAC(5)
   Else
    Chgfmt SAC6 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(5)<>""
    Chgfmt ACC6 With [M:HAEF]FMTCOA(5)
   Else
    Chgfmt ACC6 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(6)<>""
    Chgfmt SAC7 With [M:HAEF]FMTSAC(6)
   Else
    Chgfmt SAC7 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(6)<>""
    Chgfmt ACC7 With [M:HAEF]FMTCOA(6)
   Else
    Chgfmt ACC7 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(7)<>""
    Chgfmt SAC8 With [M:HAEF]FMTSAC(7)
   Else
    Chgfmt SAC8 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(7)<>""
    Chgfmt ACC8 With [M:HAEF]FMTCOA(7)
   Else
    Chgfmt ACC8 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(8)<>""
    Chgfmt SAC9 With [M:HAEF]FMTSAC(8)
   Else
    Chgfmt SAC9 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(8)<>""
    Chgfmt ACC9 With [M:HAEF]FMTCOA(8)
   Else
    Chgfmt ACC9 With "-K:1X"
   Endif
   If [M:HAEF]FMTSAC(9)<>""
    Chgfmt SAC10 With [M:HAEF]FMTSAC(9)
   Else
    Chgfmt SAC10 With "-K:1X"
   Endif
   If [M:HAEF]FMTCOA(9)<>""
    Chgfmt ACC10 With [M:HAEF]FMTCOA(9)
   Else
    Chgfmt ACC10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDOE<>""
    Chgfmt DOEPTR With [M:HAEF]FMTDOE
   Else
    Chgfmt DOEPTR With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(0)<>""
    Chgfmt CPA1 With [M:HAEF]FMTCPA(0)
   Else
    Chgfmt CPA1 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(1)<>""
    Chgfmt CPA2 With [M:HAEF]FMTCPA(1)
   Else
    Chgfmt CPA2 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(2)<>""
    Chgfmt CPA3 With [M:HAEF]FMTCPA(2)
   Else
    Chgfmt CPA3 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(3)<>""
    Chgfmt CPA4 With [M:HAEF]FMTCPA(3)
   Else
    Chgfmt CPA4 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(4)<>""
    Chgfmt CPA5 With [M:HAEF]FMTCPA(4)
   Else
    Chgfmt CPA5 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(5)<>""
    Chgfmt CPA6 With [M:HAEF]FMTCPA(5)
   Else
    Chgfmt CPA6 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(6)<>""
    Chgfmt CPA7 With [M:HAEF]FMTCPA(6)
   Else
    Chgfmt CPA7 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(7)<>""
    Chgfmt CPA8 With [M:HAEF]FMTCPA(7)
   Else
    Chgfmt CPA8 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(8)<>""
    Chgfmt CPA9 With [M:HAEF]FMTCPA(8)
   Else
    Chgfmt CPA9 With "-K:1X"
   Endif
   If [M:HAEF]FMTCPA(9)<>""
    Chgfmt CPA10 With [M:HAEF]FMTCPA(9)
   Else
    Chgfmt CPA10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(0)<>""
    Chgfmt CCE1 With [M:HAEF]FMTDIE(0)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(1)<>""
    Chgfmt CCE2 With [M:HAEF]FMTDIE(1)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(2)<>""
    Chgfmt CCE3 With [M:HAEF]FMTDIE(2)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(3)<>""
    Chgfmt CCE4 With [M:HAEF]FMTDIE(3)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(4)<>""
    Chgfmt CCE5 With [M:HAEF]FMTDIE(4)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(5)<>""
    Chgfmt CCE6 With [M:HAEF]FMTDIE(5)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(6)<>""
    Chgfmt CCE7 With [M:HAEF]FMTDIE(6)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(7)<>""
    Chgfmt CCE8 With [M:HAEF]FMTDIE(7)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(8)<>""
    Chgfmt CCE9 With [M:HAEF]FMTDIE(8)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(9)<>""
    Chgfmt CCE10 With [M:HAEF]FMTDIE(9)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(10)<>""
    Chgfmt CCE11 With [M:HAEF]FMTDIE(10)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(11)<>""
    Chgfmt CCE12 With [M:HAEF]FMTDIE(11)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(12)<>""
    Chgfmt CCE13 With [M:HAEF]FMTDIE(12)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(13)<>""
    Chgfmt CCE14 With [M:HAEF]FMTDIE(13)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(14)<>""
    Chgfmt CCE15 With [M:HAEF]FMTDIE(14)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(15)<>""
    Chgfmt CCE16 With [M:HAEF]FMTDIE(15)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(16)<>""
    Chgfmt CCE17 With [M:HAEF]FMTDIE(16)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(17)<>""
    Chgfmt CCE18 With [M:HAEF]FMTDIE(17)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(18)<>""
    Chgfmt CCE19 With [M:HAEF]FMTDIE(18)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If [M:HAEF]FMTDIE(19)<>""
    Chgfmt CCE20 With [M:HAEF]FMTDIE(19)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WMAC2STDCO [HAE2]
Gosub HORODAT
Local Inpbox "WMAC2STDCO" From GFONCTION At A_STAMP With A_WINDPREV Mask [HAE2] As [SIM_]
Grizo [HAE2]20
Grizo [HAE2]25
Grizo [HAE2]30
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [HAE2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=19
X1(1)=1 : X2(1)=37 : Y1(1)=20 : Y2(1)=22
X1(2)=38 : X2(2)=74 : Y1(2)=20 : Y2(2)=22
Return

$ON_NBLIG
Onevent BEFORE_AREA Call AV_NBLIG From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_NBLIG From W1WMAC2STDCO
Onevent CONTROL Call C_NBLIG From W1WMAC2STDCO
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WMAC2STDCO
Onevent AFTER_LINE Call APRES_NBLIG From W1WMAC2STDCO
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBGA0
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
GDEV1(1) = "EUR"
GDEV1(1) = [M]CURAFF
Gosub SETDEV From TRTDIV
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W3WMAC2STDCO
Endif
## Action STD
Call AV_NBLIG From SUBGA0
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6086,GBOUT1) From OBJDIV
Call TEXTE(6086,GBOUT2) From OBJDIV
Call TEXTE(5528,GBOUT3) From OBJDIV
Call TEXTE(4975,GBOUT4) From OBJDIV
Call TEXTE(7780,GBOUT5) From OBJDIV
Call TEXTE(5187,GBOUT6) From OBJDIV
Call TEXTE(43525,GBOUT7) From OBJDIV
Call TEXTE(43525,GBOUT8) From OBJDIV
Call TEXTE(43525,GBOUT9) From OBJDIV
Call TEXTE(454,GBOUT10) From OBJDIV
Call IB_NBLIG
## Action STD
Call AS_NBLIG From SUBGA0
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WMAC2STDCO
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WMAC2STDCO
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WMAC2STDCO
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WMAC2STDCO
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WMAC2STDCO
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WMAC2STDCO
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WMAC2STDCO
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WMAC2STDCO
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WMAC2STDCO
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WMAC2STDCO
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBGA0
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSGAS1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSGAS1"
 Call S_AFF_NUM(BASPAG,PARMSK,"GAC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([F:FIY]LEDTYP)
 PARMSK(4) = [F:GAC]ACC
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [F:GAC]ACCSHO
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = ""
 PARMSK(10) = ""
 Call CONSULT_NUM(BASPAG,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSGAS2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSGAS2"
 Call S_AFF_NUM(BASPAG,PARMSK,"CNA","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action CONSNAT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSNAT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([F:FIY]LEDTYP)
 PARMSK(4) = [F:GAC]ACC
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [F:GAC]ACCSHO
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 Call CONSULT_NUM(BASPAG,"NAT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAISTT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAISTT"
 Call SAISIE_NUM(BASPAG,PARMSK,"FSAISTT","SAISTT","XWFSAISTT") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASSCHEMA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASSCHEMA"
 Call S_TAB_NUM(BASPAG,PARMSK,"GASSCHEMA","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBGA0
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action STD
Call APRES_NBLIG From SUBGA0
If mkstat : End : Endif
## Action SPE
Call APRES_NBLIG From SPEGA0
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action DUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DUD"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 PARMSK(2) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(3) = num$([M]VERROU=1 & GCONSULT=0)
 Call SAISIE_NUM(BASPAG,PARMSK,"DDUD","GACCDUD","XWDDUD") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIVENTIL3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIVENTIL3"
 PARMSK(1) = "£"+[M]DSP(nolign-1)
 PARMSK(2) = "[M]PTV"
 PARMSK(3) = "[M]PTF"
 PARMSK(4) = num$([M]NBLIG)
 PARMSK(5) = num$(nolign-1)
 PARMSK(6) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(7) = num$([M]QTY(nolign-1))
 PARMSK(8) = [M]UOM(nolign-1)
 PARMSK(9) = [M]CUR
 PARMSK(10) = [M]LEDDSP
 PARMSK(11) = [M]ACCDSP
 PARMSK(12) = [M]BPR(nolign-1)
 PARMSK(13) = [M]FCYLIN(nolign-1)
 PARMSK(14) = [M]ACCDAT
 PARMSK(15) = ""
 Call SAISIE_NUM(BASPAG,PARMSK,"FVENTILE","SAIVENTILE","XWFVENTILE") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 Call SAISIE_NUM(BASPAG,PARMSK,"DGASACCNUM","GASACCNUM","XWGASACCNUM") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM2"
 Call S_LIS_NUM(BASPAG,PARMSK,"GASACCNUM2","GASACCNUM","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action GCNSZOOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GCNSZOOM"
 PARMSK(1) = GBIDC2
 PARMSK(2) = GBIDC1
 PARMSK(3) = GBIDC3
 Call S_AFF_NUM(BASPAG,PARMSK,"ZOOM","CONSSUB","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASACCNUM3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACCNUM3"
 PARMSK(1) = num$([M]ACCNUM(nolign-1))
 Call S_AFF_NUM(BASPAG,PARMSK,"GASACCNUM3","GASACCNUM","") From GACTION
 [M]ACCNUM(nolign-1) = val(PARMSK(1))
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GASVATLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASVATLIN"
 Call S_AFF_NUM(BASPAG,PARMSK,"GASVATLIN","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NUMLIG
Onevent BEFORE_AREA Gosub AV_NUMLIG From W1WMAC2STDCO
Return

$AV_NUMLIG
zc = nolign
Gosub _AFF
Return

$ON_FCYLIN
Onevent CONTROL Call C_FCYLIN(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_FCYLIN(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_FCYLIN(zc) From W1WMAC2STDCO
Return

Subprog D_FCYLIN(VALEUR)
Variable Char    VALEUR()
If varinit([M]FCYLIN,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"FCYL") From TRTGAS
 ## Action STD
 Call D_FCYLIN(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"FCYL") From TRTGAS
If mkstat=2
 [M]FCYLIN(INDIC) = VALEUR
 Affzo FCYLIN(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_FCYLIN(VALEUR) From SUBGA0
 If mkstat=2
  [M]FCYLIN(INDIC) = VALEUR
  Affzo FCYLIN(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_FCYLIN(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_FCYLIN(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_FCYLIN(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_FCYLIN(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_FCYLIN(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","C",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
  If !mkstat
   ## Action FLDCTLCAR
   Call FLDCTLCAR(VALEUR,"FCYL") From TRTGAS
   If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
   If !mkstat
    ## Action CONTFCY
    Call CONTFCY(VALEUR) From EXEFNC
    If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
    If !mkstat
     ## Action STD
     Call C_FCYLIN(VALEUR) From SUBGA0
     If mkstat : GERR = 1 : GZONE = "FCYLIN" : GZNUM = 1344 : Endif
    Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "C"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FCYLIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FCYLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LEDTYP
Onevent INIT_AREA Call D_LEDTYP(zc) From W1WMAC2STDCO
Return

Subprog D_LEDTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]LEDTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_IDTLIN
Onevent INIT_AREA Call D_IDTLIN(zc) From W1WMAC2STDCO
Return

Subprog D_IDTLIN(VALEUR)
Variable Char    VALEUR()
If varinit([M]IDTLIN,indice)=0
 ## Action STD
 Call D_IDTLIN(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

$ON_COA1
Return

$ON_SAC1
Onevent CONTROL Call C_SAC1(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC1(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC1 From W1WMAC2STDCO
Return

$AV_SAC1
If [M:HAEF]FMTSAC(0)<>""
 Chgfmt [M]SAC1(indice) With [M:HAEF]FMTSAC(0)
Else
 Chgfmt [M]SAC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC1(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC1") From TRTGAS
If mkstat=2
 [M]SAC1(INDIC) = VALEUR
 Affzo SAC1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC1(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC1(INDIC) = VALEUR
  Affzo SAC1(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA1(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC1") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC1(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC1" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA1(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC1
Onevent BEFORE_AREA Gosub AV_ACC1 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC1(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC1(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC1(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC1 From W1WMAC2STDCO
Return

Subprog IB_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC1 From SUBGA0
Gosub _AFF
End

$AV_ACC1
## Action INIACCFMT
Call INIACCFMT(num$([M]COA1(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(0)<>""
 Chgfmt [M]ACC1(indice) With [M:HAEF]FMTCOA(0)
Else
 Chgfmt [M]ACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC1(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC1(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC1") From TRTGAS
If mkstat=2
 [M]ACC1(INDIC) = VALEUR
 Affzo ACC1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC1(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC1(INDIC) = VALEUR
  Affzo ACC1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC1(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC1(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC1(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC1(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC1(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC1(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA1(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA1(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC1") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC1(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC1
Call AM_ACC1(zc)
If !mkstat & GOBJET
 zoncou = "ACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA1(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA1(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA1(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC1(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA1(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA1(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA2
Return

$ON_SAC2
Onevent CONTROL Call C_SAC2(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC2(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC2 From W1WMAC2STDCO
Return

$AV_SAC2
If [M:HAEF]FMTSAC(1)<>""
 Chgfmt [M]SAC2(indice) With [M:HAEF]FMTSAC(1)
Else
 Chgfmt [M]SAC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC2(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC2") From TRTGAS
If mkstat=2
 [M]SAC2(INDIC) = VALEUR
 Affzo SAC2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC2(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC2(INDIC) = VALEUR
  Affzo SAC2(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA2(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC2") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC2(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC2" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA2(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC2
Onevent BEFORE_AREA Gosub AV_ACC2 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC2(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC2(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC2(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC2 From W1WMAC2STDCO
Return

Subprog IB_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC2 From SUBGA0
Gosub _AFF
End

$AV_ACC2
## Action INIACCFMT
Call INIACCFMT(num$([M]COA2(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(1)<>""
 Chgfmt [M]ACC2(indice) With [M:HAEF]FMTCOA(1)
Else
 Chgfmt [M]ACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC2(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC2(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC2") From TRTGAS
If mkstat=2
 [M]ACC2(INDIC) = VALEUR
 Affzo ACC2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC2(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC2(INDIC) = VALEUR
  Affzo ACC2(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC2(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC2(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC2(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC2(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC2(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC2(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA2(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA2(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC2") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC2(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC2
Call AM_ACC2(zc)
If !mkstat & GOBJET
 zoncou = "ACC2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA2(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC2(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA2(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA2(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC2(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA2(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA2(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA3
Return

$ON_SAC3
Onevent CONTROL Call C_SAC3(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC3(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC3 From W1WMAC2STDCO
Return

$AV_SAC3
If [M:HAEF]FMTSAC(2)<>""
 Chgfmt [M]SAC3(indice) With [M:HAEF]FMTSAC(2)
Else
 Chgfmt [M]SAC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC3(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC3") From TRTGAS
If mkstat=2
 [M]SAC3(INDIC) = VALEUR
 Affzo SAC3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC3(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC3(INDIC) = VALEUR
  Affzo SAC3(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA3(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC3") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC3(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC3" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA3(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC3
Onevent BEFORE_AREA Gosub AV_ACC3 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC3(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC3(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC3(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC3 From W1WMAC2STDCO
Return

Subprog IB_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC3 From SUBGA0
Gosub _AFF
End

$AV_ACC3
## Action INIACCFMT
Call INIACCFMT(num$([M]COA3(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(2)<>""
 Chgfmt [M]ACC3(indice) With [M:HAEF]FMTCOA(2)
Else
 Chgfmt [M]ACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC3(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC3(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC3") From TRTGAS
If mkstat=2
 [M]ACC3(INDIC) = VALEUR
 Affzo ACC3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC3(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC3(INDIC) = VALEUR
  Affzo ACC3(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC3(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC3(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC3(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC3(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC3(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC3(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA3(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA3(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC3") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC3(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC3
Call AM_ACC3(zc)
If !mkstat & GOBJET
 zoncou = "ACC3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA3(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC3(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA3(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA3(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC3(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA3(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA3(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA4
Return

$ON_SAC4
Onevent CONTROL Call C_SAC4(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_SAC4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_SAC4(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_SAC4 From W1WMAC2STDCO
Return

$AV_SAC4
If [M:HAEF]FMTSAC(3)<>""
 Chgfmt [M]SAC4(indice) With [M:HAEF]FMTSAC(3)
Else
 Chgfmt [M]SAC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_SAC4(VALEUR)
Variable Char    VALEUR()
If varinit([M]SAC4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"SAC4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_SAC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"SAC4") From TRTGAS
If mkstat=2
 [M]SAC4(INDIC) = VALEUR
 Affzo SAC4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_SAC4(VALEUR) From SUBGA0
 If mkstat=2
  [M]SAC4(INDIC) = VALEUR
  Affzo SAC4(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_SAC4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_SAC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,[M]COA4(nolign-1)) From CPTCNT
 If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"SAC4") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
 If !mkstat
  ## Action STD
  Call C_SAC4(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "SAC4" : GZNUM = 5251 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_SAC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = [M]COA4(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ACC4
Onevent BEFORE_AREA Gosub AV_ACC4 From W1WMAC2STDCO
Onevent CONTROL Call C_ACC4(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_ACC4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_ACC4(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC4(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_ACC4 From W1WMAC2STDCO
Return

Subprog IB_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call IB_ACC4 From SUBGA0
Gosub _AFF
End

$AV_ACC4
## Action INIACCFMT
Call INIACCFMT(num$([M]COA4(nolign-1))) From SETGLBCOA
If [M:HAEF]FMTCOA(3)<>""
 Chgfmt [M]ACC4(indice) With [M:HAEF]FMTCOA(3)
Else
 Chgfmt [M]ACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ACC4(VALEUR)
Variable Char    VALEUR()
If varinit([M]ACC4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"ACC4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_ACC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(4012,GBOUT2) From OBJDIV
Call TEXTE(4320,GBOUT3) From OBJDIV
Call TEXTE(6086,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ACC4(VALEUR)
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"ACC4") From TRTGAS
If mkstat=2
 [M]ACC4(INDIC) = VALEUR
 Affzo ACC4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ACC4(VALEUR) From SUBGA0
 If mkstat=2
  [M]ACC4(INDIC) = VALEUR
  Affzo ACC4(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ACC4(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_ACC4(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_ACC4(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_ACC4(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_ACC4(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_ACC4(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_ACC4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$([M]COA4(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$([M]COA4(nolign-1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"ACC4") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ACC4(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ACC4
Call AM_ACC4(zc)
If !mkstat & GOBJET
 zoncou = "ACC4" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ACC4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = [M]COA4(nolign-1)
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]COA#"
 PARMSK(6) = "[M]ACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ACC4(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$([M]COA4(nolign-1))) From GOBJET
Gosub _AFF
End

Subprog B2_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHO"
 PARMSK(1) = [M]COA4(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHO","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GASACC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GASACC"
 Call S_LIS_CHAR(VALEUR,PARMSK,"GASACC","SUBGA0","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_ACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSCPT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSCPT"
 PARMSK(1) = [M]CPY
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = num$([M]LEDTYP(nolign-1))
 PARMSK(4) = VALEUR
 PARMSK(5) = [M]BPR(nolign-1)
 PARMSK(6) = [M]SAC4(nolign-1)
 PARMSK(7) = [F:FIY]FIYSTR
 PARMSK(8) = [F:FIY]FIYEND
 PARMSK(9) = [F:CPY]ACCCUR
 PARMSK(10) = ""
 Call CONSULT_CHAR(VALEUR,"CPT",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ACC4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$([M]COA4(nolign-1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ACC4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]COA4(nolign-1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_COA5
Return

$ON_SAC5
Return

$ON_ACC5
Onevent BEFORE_AREA Gosub AV_ACC5 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC5(zc) From W1WMAC2STDCO
Return

$AV_ACC5
## Action INIACCFMT
Call INIACCFMT(num$([M]COA5(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC5(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA6
Return

$ON_SAC6
Return

$ON_ACC6
Onevent BEFORE_AREA Gosub AV_ACC6 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC6(zc) From W1WMAC2STDCO
Return

$AV_ACC6
## Action INIACCFMT
Call INIACCFMT(num$([M]COA6(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC6(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA7
Return

$ON_SAC7
Return

$ON_ACC7
Onevent BEFORE_AREA Gosub AV_ACC7 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC7(zc) From W1WMAC2STDCO
Return

$AV_ACC7
## Action INIACCFMT
Call INIACCFMT(num$([M]COA7(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC7(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC7(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA8
Return

$ON_SAC8
Return

$ON_ACC8
Onevent BEFORE_AREA Gosub AV_ACC8 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC8(zc) From W1WMAC2STDCO
Return

$AV_ACC8
## Action INIACCFMT
Call INIACCFMT(num$([M]COA8(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC8(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC8(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA9
Return

$ON_SAC9
Return

$ON_ACC9
Onevent BEFORE_AREA Gosub AV_ACC9 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC9(zc) From W1WMAC2STDCO
Return

$AV_ACC9
## Action INIACCFMT
Call INIACCFMT(num$([M]COA9(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC9(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC9(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_COA10
Return

$ON_SAC10
Return

$ON_ACC10
Onevent BEFORE_AREA Gosub AV_ACC10 From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_ACC10(zc) From W1WMAC2STDCO
Return

$AV_ACC10
## Action INIACCFMT
Call INIACCFMT(num$([M]COA10(nolign-1))) From SETGLBCOA
Gosub _AFF
Return

Subprog AP_ACC10(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_ACC10(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_BPR
Onevent CONTROL Call C_BPR(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_BPR(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_BPR(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_BPR(zc) From W1WMAC2STDCO
Return

Subprog D_BPR(VALEUR)
Variable Char    VALEUR()
If varinit([M]BPR,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"BPR") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_BPR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15561,GBOUT2) From OBJDIV
Call TEXTE(19868,GBOUT3) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"BPR") From TRTGAS
If mkstat=2
 [M]BPR(INDIC) = VALEUR
 Affzo BPR(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_BPR(VALEUR) From SUBGA0
 If mkstat=2
  [M]BPR(INDIC) = VALEUR
  Affzo BPR(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_BPR(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_BPR(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_BPR(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_BPR(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_BPR(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_BPR(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_BPR(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
If !GWEBSERV
 If !mkstat
  ## Action BPRCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "BPRCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"BPR") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
  If !mkstat
   ## Action CONTBPRCPY
   Call CONTBPRCPY(VALEUR,[M]FCYLIN(nolign-1),[M]COA1(nolign-1),[M]ACC1(nolign-1),"") From CPTSUB
   If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
   If !mkstat
    ## Action STD
    Call C_BPR(VALEUR) From SUBGA0
    If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_BPR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_BPR(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "BPR" : GZNUM = 19569 : Endif
Gosub _AFF
End

Subprog S_BPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPR"
 PARMSK(1) = [M]FCYLIN(nolign-1)
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPR","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_BPR(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_BPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPRC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPRC"
 PARMSK(1) = [M]FCYLIN(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPRC","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_BPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPRF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPRF"
 PARMSK(1) = [M]FCYLIN(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPRF","CPTSUB2","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_DEB
Onevent INIT_AREA Call D_DEB(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_DEB(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_DEB(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_DEB From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_DEB From W1WMAC2STDCO
Return

Subprog IB_DEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_DEB From SUBGA0
Endif
Gosub _AFF
End

$AV_DEB
Chgfmt [M]DEB(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

Subprog D_DEB(VALEUR)
Variable Decimal VALEUR
If varinit([M]DEB,indice)=0
 ## Action FLDDEFDCB
 Call FLDDEFDCB(VALEUR,"DEB") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_DEB(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4120,GBOUT2) From OBJDIV
Call TEXTE(8983,GBOUT3) From OBJDIV
Call TEXTE(7391,GBOUT4) From OBJDIV
Call IB_DEB(VALEUR)
## Action FLDAVTDCB
Call FLDAVTDCB(VALEUR,"DEB") From TRTGAS
If mkstat=2
 [M]DEB(INDIC) = VALEUR
 Affzo DEB(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_DEB(VALEUR) From SUBGA0
 If mkstat=2
  [M]DEB(INDIC) = VALEUR
  Affzo DEB(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_DEB(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_DEB(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_DEB(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_DEB(VALEUR)
Variable Decimal VALEUR
## Action FLDCTLDCB
Call FLDCTLDCB(VALEUR,"DEB") From TRTGAS
If mkstat : GERR = 1 : GZONE = "DEB" : GZNUM = 5252 : Endif
Gosub _AFF
End

$AMM_DEB
Call AM_DEB(zc)
If !mkstat & GOBJET
 zoncou = "DEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_DEB(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "DEB" : GZNUM = 5252 : Endif
Gosub _AFF
End

Subprog B2_DEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B2_DEB(VALEUR) From SUBGA0
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_DEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B3_DEB(VALEUR) From SUBGA0
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_DEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIMONT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIMONT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_DEB" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "DEB"
 PARMSK(2) = [M]CPY
 PARMSK(3) = [M]CUR
 PARMSK(4) = [M]ACCDAT
 PARMSK(5) = "AMTFLG"
 PARMSK(6) = "AMTFRC"
 PARMSK(7) = num$([M]TYPRAT)
 PARMSK(8) = num$([M]LEDTYP(nolign-1))
 PARMSK(9) = [M]LED([M]LEDTYP(nolign-1))
 Call SAISIE_NUM(VALEUR,PARMSK,"FSAIMONT","SAIMONT","XWFSAIMONT") From GSAISIE
 ACTION = "BB4_DEB" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CDT
Onevent INIT_AREA Call D_CDT(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CDT(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CDT(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_CDT From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_CDT From W1WMAC2STDCO
Return

Subprog IB_CDT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_CDT From SUBGA0
Endif
Gosub _AFF
End

$AV_CDT
Chgfmt [M]CDT(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

Subprog D_CDT(VALEUR)
Variable Decimal VALEUR
If varinit([M]CDT,indice)=0
 ## Action FLDDEFDCB
 Call FLDDEFDCB(VALEUR,"CDT") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CDT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4120,GBOUT2) From OBJDIV
Call TEXTE(8983,GBOUT3) From OBJDIV
Call TEXTE(7391,GBOUT4) From OBJDIV
Call IB_CDT(VALEUR)
## Action FLDAVTDCB
Call FLDAVTDCB(VALEUR,"CDT") From TRTGAS
If mkstat=2
 [M]CDT(INDIC) = VALEUR
 Affzo CDT(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CDT(VALEUR) From SUBGA0
 If mkstat=2
  [M]CDT(INDIC) = VALEUR
  Affzo CDT(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_CDT(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_CDT(zc) From W1WMAC2STDCO
 Onkey 132 Titled GBOUT4 Call B4_CDT(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CDT(VALEUR)
Variable Decimal VALEUR
## Action FLDCTLDCB
Call FLDCTLDCB(VALEUR,"CDT") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CDT" : GZNUM = 5253 : Endif
Gosub _AFF
End

$AMM_CDT
Call AM_CDT(zc)
If !mkstat & GOBJET
 zoncou = "CDT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CDT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_CDT(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CDT" : GZNUM = 5253 : Endif
Gosub _AFF
End

Subprog B2_CDT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B2_CDT(VALEUR) From SUBGA0
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_CDT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B3_CDT(VALEUR) From SUBGA0
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_CDT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIMONT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIMONT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_CDT" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "CDT"
 PARMSK(2) = [M]CPY
 PARMSK(3) = [M]CUR
 PARMSK(4) = [M]ACCDAT
 PARMSK(5) = "AMTFLG"
 PARMSK(6) = "AMTFRC"
 PARMSK(7) = num$([M]TYPRAT)
 PARMSK(8) = num$([M]LEDTYP(nolign-1))
 PARMSK(9) = [M]LED([M]LEDTYP(nolign-1))
 Call SAISIE_NUM(VALEUR,PARMSK,"FSAIMONT","SAIMONT","XWFSAIMONT") From GSAISIE
 ACTION = "BB4_CDT" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_DOEPTR
Onevent INIT_AREA Call D_DOEPTR(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_DOEPTR(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_DOEPTR(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_DOEPTR From W1WMAC2STDCO
Return

$AV_DOEPTR
If [M:HAEF]FMTDOE<>""
 Chgfmt [M]DOEPTR(indice) With [M:HAEF]FMTDOE
Else
 Chgfmt [M]DOEPTR(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_DOEPTR(VALEUR)
Variable Decimal VALEUR
If varinit([M]DOEPTR,indice)=0
 ## Action FLDDEFDCB
 Call FLDDEFDCB(VALEUR,"DOE") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_DOEPTR(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTDCB
Call FLDAVTDCB(VALEUR,"DOE") From TRTGAS
If mkstat=2
 [M]DOEPTR(INDIC) = VALEUR
 Affzo DOEPTR(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_DOEPTR(VALEUR)
Variable Decimal VALEUR
## Action FLDCTLDCB
Call FLDCTLDCB(VALEUR,"DOE") From TRTGAS
If mkstat : GERR = 1 : GZONE = "DOEPTR" : GZNUM = 30019 : Endif
Gosub _AFF
End

$ON_DES
Onevent INIT_AREA Call D_DES(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_DES(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_DES(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_DES From W1WMAC2STDCO
Return

Subprog D_DES(VALEUR)
Variable Char    VALEUR()
If varinit([M]DES,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DES") From TRTGAS
 ## Action STD
 Call D_DES(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_DES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action PCEDEF
If [M]STA>1 & (GREP="M" | GREP="")  & func AFNC.PARAM("FRADGI",[M]CPY)="2": mkstat = 2  : Endif : # Définitif
If mkstat=2
 [M]DES(INDIC) = VALEUR
 Affzo DES(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action FLDAVTCAR
 Call FLDAVTCAR(VALEUR,"DES") From TRTGAS
 If mkstat=2
  [M]DES(INDIC) = VALEUR
  Affzo DES(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_DES(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DES") From TRTGAS
If mkstat : GERR = 1 : GZONE = "DES" : GZNUM = 1470 : Endif
Gosub _AFF
End

$AMM_DES
Call AM_DES(zc)
If !mkstat & GOBJET
 zoncou = "DES" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DES(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_DES(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "DES" : GZNUM = 1470 : Endif
Gosub _AFF
End

$ON_FREREF
Onevent INIT_AREA Call D_FREREF(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_FREREF(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_FREREF(zc) From W1WMAC2STDCO
Return

Subprog D_FREREF(VALEUR)
Variable Char    VALEUR()
If varinit([M]FREREF,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"FRER") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_FREREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"FRER") From TRTGAS
If mkstat=2
 [M]FREREF(INDIC) = VALEUR
 Affzo FREREF(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_FREREF(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"FRER") From TRTGAS
If mkstat : GERR = 1 : GZONE = "FREREF" : GZNUM = 25555 : Endif
Gosub _AFF
End

$ON_TAX
Onevent CONTROL Call C_TAX(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_TAX(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_TAX(zc) From W1WMAC2STDCO
Return

Subprog IB_TAX(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog D_TAX(VALEUR)
Variable Char    VALEUR()
If varinit([M]TAX,indice)=0
 ## Action STD
 Call D_TAX(VALEUR) From SUBGA0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"TAX") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_TAX(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_TAX(VALEUR)
## Action STD
Call AS_TAX(VALEUR) From SUBGA0
If mkstat=2
 [M]TAX(INDIC) = VALEUR
 Affzo TAX(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action FLDAVTCAR
 Call FLDAVTCAR(VALEUR,"TAX") From TRTGAS
 If mkstat=2
  [M]TAX(INDIC) = VALEUR
  Affzo TAX(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_TAX(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_TAX(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_TAX(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_TAX(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_TAX(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,GCURLEG,"GACCENTR3","TAX",[M]FCYLIN(nolign-1),"","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
If !mkstat
 ## Action FLDCTLCAR
 Call FLDCTLCAR(VALEUR,"TAX") From TRTGAS
 If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
 If !mkstat
  ## Action STD
  Call C_TAX(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "TAX" : GZNUM = 2554 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_TAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M]FCYLIN(nolign-1)
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = "GACCENTR3"
 PARMSK(7) = "TAX"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_TAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVT
 Call TUNTVT(VALEUR,GCURLEG) From SUBTVT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_TAX(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_TAX(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CPA1
Onevent INIT_AREA Call D_CPA1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CPA1(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CPA1(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_CPA1 From W1WMAC2STDCO
Return

$AV_CPA1
If [M:HAEF]FMTCPA(0)<>""
 Chgfmt [M]CPA1(indice) With [M:HAEF]FMTCPA(0)
Else
 Chgfmt [M]CPA1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CPA1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA1") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(1500,GBOUT2) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA1") From TRTGAS
If mkstat=2
 [M]CPA1(INDIC) = VALEUR
 Affzo CPA1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA1(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA1(INDIC) = VALEUR
  Affzo CPA1(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CPA1(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_CPA1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CPA1(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA1") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA1" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CPA1(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA1" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_CPA1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ1"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_CPA1" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "GAC"
 PARMSK(2) = ""
 PARMSK(3) = [M]COA1(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 ACTION = "BB1_CPA1" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_CPA1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ2"
 PARMSK(1) = "BPR"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPA2
Onevent INIT_AREA Call D_CPA2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CPA2(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CPA2(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_CPA2 From W1WMAC2STDCO
Return

$AV_CPA2
If [M:HAEF]FMTCPA(1)<>""
 Chgfmt [M]CPA2(indice) With [M:HAEF]FMTCPA(1)
Else
 Chgfmt [M]CPA2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CPA2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA2") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(1500,GBOUT2) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA2") From TRTGAS
If mkstat=2
 [M]CPA2(INDIC) = VALEUR
 Affzo CPA2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA2(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA2(INDIC) = VALEUR
  Affzo CPA2(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CPA2(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_CPA2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CPA2(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA2") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA2" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CPA2(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA2" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_CPA2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ1"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_CPA2" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "GAC"
 PARMSK(2) = ""
 PARMSK(3) = [M]COA2(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 ACTION = "BB1_CPA2" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_CPA2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ2"
 PARMSK(1) = "BPR"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPA3
Onevent INIT_AREA Call D_CPA3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CPA3(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CPA3(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_CPA3 From W1WMAC2STDCO
Return

$AV_CPA3
If [M:HAEF]FMTCPA(2)<>""
 Chgfmt [M]CPA3(indice) With [M:HAEF]FMTCPA(2)
Else
 Chgfmt [M]CPA3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CPA3(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA3") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(1500,GBOUT2) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA3") From TRTGAS
If mkstat=2
 [M]CPA3(INDIC) = VALEUR
 Affzo CPA3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA3(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA3(INDIC) = VALEUR
  Affzo CPA3(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CPA3(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_CPA3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CPA3(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA3") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA3" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CPA3(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA3" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_CPA3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ1"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_CPA3" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "GAC"
 PARMSK(2) = ""
 PARMSK(3) = [M]COA3(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 ACTION = "BB1_CPA3" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_CPA3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ2"
 PARMSK(1) = "BPR"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPA4
Onevent INIT_AREA Call D_CPA4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CPA4(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CPA4(zc) From W1WMAC2STDCO
Onevent BEFORE_AREA Gosub AV_CPA4 From W1WMAC2STDCO
Return

$AV_CPA4
If [M:HAEF]FMTCPA(3)<>""
 Chgfmt [M]CPA4(indice) With [M:HAEF]FMTCPA(3)
Else
 Chgfmt [M]CPA4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CPA4(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPA4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CPA4") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_CPA4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(1500,GBOUT2) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CPA4") From TRTGAS
If mkstat=2
 [M]CPA4(INDIC) = VALEUR
 Affzo CPA4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPA4(VALEUR) From SUBGA0
 If mkstat=2
  [M]CPA4(INDIC) = VALEUR
  Affzo CPA4(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_CPA4(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_CPA4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CPA4(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"CPA4") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CPA4" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CPA4(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CPA4" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_CPA4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ1"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_CPA4" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "GAC"
 PARMSK(2) = ""
 PARMSK(3) = [M]COA4(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 ACTION = "BB1_CPA4" : PROGSUB = "SUBGA0" : PROGSPE = "SPEGA0" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_CPA4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJ2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJ2"
 PARMSK(1) = "BPR"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPA5
Return

$ON_CPA6
Return

$ON_CPA7
Return

$ON_CPA8
Return

$ON_CPA9
Return

$ON_CPA10
Return

$ON_CSLBPR
Onevent CONTROL Call C_CSLBPR(zc) From W1WMAC2STDCO
Onevent INIT_AREA Call D_CSLBPR(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CSLBPR(zc) From W1WMAC2STDCO
Return

Subprog D_CSLBPR(VALEUR)
Variable Char    VALEUR()
If varinit([M]CSLBPR,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CSLBPR") From TRTGAS
 ## Action STD
 Call D_CSLBPR(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CSLBPR") From TRTGAS
If mkstat=2
 [M]CSLBPR(INDIC) = VALEUR
 Affzo CSLBPR(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CSLBPR(VALEUR) From SUBGA0
 If mkstat=2
  [M]CSLBPR(INDIC) = VALEUR
  Affzo CSLBPR(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CSLBPR(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_CSLBPR(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_CSLBPR(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CSLBPR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!M",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CSLBPR") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
  If !mkstat
   ## Action STD
   Call C_CSLBPR(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CSLBPR" : GZNUM = 12138 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!M"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CSLBPR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CSLCOD
Return

$ON_CSLFLO
Onevent INIT_AREA Call D_CSLFLO(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CSLFLO(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CSLFLO(zc) From W1WMAC2STDCO
Return

Subprog D_CSLFLO(VALEUR)
Variable Char    VALEUR()
If varinit([M]CSLFLO,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"324","") From SUBADI
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"CSLFLO") From TRTGAS
 ## Action STD
 Call D_CSLFLO(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"CSLFLO") From TRTGAS
If mkstat=2
 [M]CSLFLO(INDIC) = VALEUR
 Affzo CSLFLO(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CSLFLO(VALEUR) From SUBGA0
 If mkstat=2
  [M]CSLFLO(INDIC) = VALEUR
  Affzo CSLFLO(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CSLFLO(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_CSLFLO(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_CSLFLO(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CSLFLO(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"324","") From SUBADI
If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"324",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"CSLFLO") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
  If !mkstat
   ## Action STD
   Call C_CSLFLO(VALEUR) From SUBGA0
   If mkstat : GERR = 1 : GZONE = "CSLFLO" : GZNUM = 24916 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CSLFLO(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "324"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "324"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CSLFLO(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "324"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_QTY
Onevent BEFORE_AREA Gosub AV_QTY From W1WMAC2STDCO
Onevent INIT_AREA Call D_QTY(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_QTY(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_QTY(zc) From W1WMAC2STDCO
Return

$AV_QTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTY(indice) With "Nz:"+GUNTFMT
Gosub _AFF
Return

Subprog D_QTY(VALEUR)
Variable Decimal VALEUR
If varinit([M]QTY,indice)=0
 ## Action STD
 Call D_QTY(VALEUR) From SUBGA0
 ## Action FLDDEFDCB
 Call FLDDEFDCB(VALEUR,"QTY") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_QTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action FLDAVTDCB
Call FLDAVTDCB(VALEUR,"QTY") From TRTGAS
If mkstat=2
 [M]QTY(INDIC) = VALEUR
 Affzo QTY(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_QTY(VALEUR) From SUBGA0
 If mkstat=2
  [M]QTY(INDIC) = VALEUR
  Affzo QTY(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_QTY(VALEUR)
Variable Decimal VALEUR
## Action FLDCTLDCB
Call FLDCTLDCB(VALEUR,"QTY") From TRTGAS
If mkstat : GERR = 1 : GZONE = "QTY" : GZNUM = 271 : Endif
Gosub _AFF
End

$ON_UOM
Onevent INIT_AREA Call D_UOM(zc) From W1WMAC2STDCO
Return

Subprog D_UOM(VALEUR)
Variable Char    VALEUR()
If varinit([M]UOM,indice)=0
 ## Action STD
 Call D_UOM(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

$ON_PJTLIN
Onevent BEFORE_INPUT Call AS_PJTLIN(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_PJTLIN(zc) From W1WMAC2STDCO
Onevent AFTER_CHANGE Gosub AMM_PJTLIN From W1WMAC2STDCO
Onevent INIT_AREA Call D_PJTLIN(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_PJTLIN(zc) From W1WMAC2STDCO
Return

Subprog IB_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
&,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
Gosub _AFF
End

Subprog D_PJTLIN(VALEUR)
Variable Char    VALEUR()
If varinit([M]PJTLIN,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"PJTLIN") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTLIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
&,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
If mkstat=2
 [M]PJTLIN(INDIC) = VALEUR
 Affzo PJTLIN(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action FLDAVTCAR
 Call FLDAVTCAR(VALEUR,"PJTLIN") From TRTGAS
 If mkstat=2
  [M]PJTLIN(INDIC) = VALEUR
  Affzo PJTLIN(INDIC) : mkstat = 2
 Endif
 If !mkstat
  ## Action STD
  Call AS_PJTLIN(VALEUR) From SUBGA0
  If mkstat=2
   [M]PJTLIN(INDIC) = VALEUR
   Affzo PJTLIN(INDIC) : mkstat = 2
  Endif
  Onkey 129 Titled GBOUT1 Call B1_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 130 Titled GBOUT2 Call B2_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 131 Titled GBOUT3 Call B3_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 132 Titled GBOUT4 Call B4_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 172 Titled GBOUT15 Call B15_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 173 Titled GBOUT16 Call B16_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 174 Titled GBOUT17 Call B17_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 175 Titled GBOUT18 Call B18_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 176 Titled GBOUT19 Call B19_PJTLIN(zc) From W1WMAC2STDCO
  Onkey   2 Titled GBOUTS Call S_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 144 Titled GBOUTP Call P_PJTLIN(zc) From W1WMAC2STDCO
  Onkey 146 Titled GBOUTA Call SA_PJTLIN(zc) From W1WMAC2STDCO
 Endif
Endif
Gosub _AFF
End

Subprog C_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
&,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"PJTLIN") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action SPE
Call AP_PJTLIN(VALEUR) From SPEGA0
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
Gosub _AFF
End

$AMM_PJTLIN
Call AM_PJTLIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
&,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTLIN" : GZNUM = 1886 : Endif
Gosub _AFF
End

Subprog S_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
& ,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
& ,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
& ,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"HAE2","PJTLIN",nolign-1,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:HAE2]FCYLIN(nolign-1),""
& ,"","[M:HAE1]PJT","",func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "HAE2"
 PARMSK(2) = "PJTLIN"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:HAE2]FCYLIN(nolign-1)
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:HAE1]PJT"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:HAE2]FCYLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_DSP
Onevent INIT_AREA Call D_DSP(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_DSP(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_DSP(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_DSP(zc) From W1WMAC2STDCO
Return

Subprog D_DSP(VALEUR)
Variable Char    VALEUR()
If varinit([M]DSP,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DSP") From TRTGAS
 ## Action STD
 Call D_DSP(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_DSP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4805,GBOUT1) From OBJDIV
Call TEXTE(3568,GBOUT2) From OBJDIV
Call TEXTE(3603,GBOUT3) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DSP") From TRTGAS
If mkstat=2
 [M]DSP(INDIC) = VALEUR
 Affzo DSP(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_DSP(VALEUR) From SUBGA0
 If mkstat=2
  [M]DSP(INDIC) = VALEUR
  Affzo DSP(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_DSP(zc) From W1WMAC2STDCO
 Onkey 130 Titled GBOUT2 Call B2_DSP(zc) From W1WMAC2STDCO
 Onkey 131 Titled GBOUT3 Call B3_DSP(zc) From W1WMAC2STDCO
 Onkey   2 Titled GBOUTS Call S_DSP(zc) From W1WMAC2STDCO
 Onkey 144 Titled GBOUTP Call P_DSP(zc) From W1WMAC2STDCO
 Onkey 146 Titled GBOUTA Call SA_DSP(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_DSP(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DSP") From TRTGAS
If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
 If !mkstat
  ## Action STD
  Call C_DSP(VALEUR) From SUBGA0
  If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_DSP(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_DSP(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
Gosub _AFF
End

Subprog S_DSP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "DSP"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_DSP(VALEUR)
Variable Char    VALEUR()
Call OBJET("DSP",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_DSP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SAIVENTIL1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIVENTIL1"
 PARMSK(1) = "%"
 PARMSK(2) = "[M:HAE2]PTV"
 PARMSK(3) = "[M:HAE2]PTF"
 PARMSK(4) = num$([M]NBLIG)
 PARMSK(5) = num$(nolign-1)
 PARMSK(6) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(7) = num$([M]QTY(nolign-1))
 PARMSK(8) = [M]UOM(nolign-1)
 PARMSK(9) = [M]CUR
 PARMSK(10) = [M]LEDDSP
 PARMSK(11) = [M]ACCDSP
 PARMSK(12) = [M]BPR(nolign-1)
 PARMSK(13) = [M]FCYLIN(nolign-1)
 PARMSK(14) = [M]ACCDAT
 PARMSK(15) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"FVENTILE","SAIVENTILE","XWFVENTILE") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_DSP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SAIVENTIL2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIVENTIL2"
 PARMSK(1) = "$"
 PARMSK(2) = "[M:HAE2]PTV"
 PARMSK(3) = "[M:HAE2]PTF"
 PARMSK(4) = num$([M]NBLIG)
 PARMSK(5) = num$(nolign-1)
 PARMSK(6) = num$([M]DEB(nolign-1)+[M]CDT(nolign-1))
 PARMSK(7) = num$([M]QTY(nolign-1))
 PARMSK(8) = [M]UOM(nolign-1)
 PARMSK(9) = [M]CUR
 PARMSK(10) = [M]LEDDSP
 PARMSK(11) = [M]ACCDSP
 PARMSK(12) = [M]BPR(nolign-1)
 PARMSK(13) = [M]FCYLIN(nolign-1)
 PARMSK(14) = [M]ACCDAT
 PARMSK(15) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"FVENTILE","SAIVENTILE","XWFVENTILE") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_DSP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "DSP"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_DSP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("DSP",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE1
Onevent BEFORE_AREA Gosub AV_CCE1 From W1WMAC2STDCO
Onevent INIT_AREA Call D_CCE1(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CCE1(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CCE1(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_CCE1(zc) From W1WMAC2STDCO
Return

$AV_CCE1
## Action STD
Call AV_CCE1(zc) From SUBGA0
If [M:HAEF]FMTDIE(0)<>""
 Chgfmt [M]CCE1(indice) With [M:HAEF]FMTDIE(0)
Else
 Chgfmt [M]CCE1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE1,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DIE_0") From TRTGAS
 ## Action STD
 Call D_CCE1(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DIE_0") From TRTGAS
If mkstat=2
 [M]CCE1(INDIC) = VALEUR
 Affzo CCE1(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE1(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE1(INDIC) = VALEUR
  Affzo CCE1(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CCE1(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CCE1(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DIE_0") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CCE1(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action SPE
  Call C_CCE1(VALEUR) From SPEGA0
  If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE1(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = "GESGAS"
 PARMSK(2) = [M:HAEF]DIE(0)
 PARMSK(3) = [M]FCYLIN(nolign-1)
 PARMSK(4) = [M:HAE2]ACC1(nolign-1)
 PARMSK(5) = "DIE_0"
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CCE2
Onevent BEFORE_AREA Gosub AV_CCE2 From W1WMAC2STDCO
Onevent INIT_AREA Call D_CCE2(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CCE2(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CCE2(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_CCE2(zc) From W1WMAC2STDCO
Return

$AV_CCE2
## Action STD
Call AV_CCE2(zc) From SUBGA0
If [M:HAEF]FMTDIE(1)<>""
 Chgfmt [M]CCE2(indice) With [M:HAEF]FMTDIE(1)
Else
 Chgfmt [M]CCE2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE2,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DIE_1") From TRTGAS
 ## Action STD
 Call D_CCE2(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DIE_1") From TRTGAS
If mkstat=2
 [M]CCE2(INDIC) = VALEUR
 Affzo CCE2(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE2(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE2(INDIC) = VALEUR
  Affzo CCE2(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CCE2(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CCE2(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DIE_1") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CCE2(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action SPE
  Call C_CCE2(VALEUR) From SPEGA0
  If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE2(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = "GESGAS"
 PARMSK(2) = [M:HAEF]DIE(1)
 PARMSK(3) = [M]FCYLIN(nolign-1)
 PARMSK(4) = [M:HAE2]ACC1(nolign-1)
 PARMSK(5) = "DIE_1"
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CCE3
Onevent BEFORE_AREA Gosub AV_CCE3 From W1WMAC2STDCO
Onevent INIT_AREA Call D_CCE3(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CCE3(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CCE3(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_CCE3(zc) From W1WMAC2STDCO
Return

$AV_CCE3
## Action STD
Call AV_CCE3(zc) From SUBGA0
If [M:HAEF]FMTDIE(2)<>""
 Chgfmt [M]CCE3(indice) With [M:HAEF]FMTDIE(2)
Else
 Chgfmt [M]CCE3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE3(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE3,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DIE_2") From TRTGAS
 ## Action STD
 Call D_CCE3(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DIE_2") From TRTGAS
If mkstat=2
 [M]CCE3(INDIC) = VALEUR
 Affzo CCE3(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE3(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE3(INDIC) = VALEUR
  Affzo CCE3(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CCE3(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CCE3(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DIE_2") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CCE3(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action SPE
  Call C_CCE3(VALEUR) From SPEGA0
  If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE3(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CCE3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = "GESGAS"
 PARMSK(2) = [M:HAEF]DIE(2)
 PARMSK(3) = [M]FCYLIN(nolign-1)
 PARMSK(4) = [M:HAE2]ACC1(nolign-1)
 PARMSK(5) = "DIE_2"
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CCE4
Onevent BEFORE_AREA Gosub AV_CCE4 From W1WMAC2STDCO
Onevent INIT_AREA Call D_CCE4(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CCE4(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CCE4(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_CCE4(zc) From W1WMAC2STDCO
Return

$AV_CCE4
## Action STD
Call AV_CCE4(zc) From SUBGA0
If [M:HAEF]FMTDIE(3)<>""
 Chgfmt [M]CCE4(indice) With [M:HAEF]FMTDIE(3)
Else
 Chgfmt [M]CCE4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE4(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE4,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DIE_3") From TRTGAS
 ## Action STD
 Call D_CCE4(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DIE_3") From TRTGAS
If mkstat=2
 [M]CCE4(INDIC) = VALEUR
 Affzo CCE4(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE4(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE4(INDIC) = VALEUR
  Affzo CCE4(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CCE4(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CCE4(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DIE_3") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CCE4(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action SPE
  Call C_CCE4(VALEUR) From SPEGA0
  If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE4(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CCE4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = "GESGAS"
 PARMSK(2) = [M:HAEF]DIE(3)
 PARMSK(3) = [M]FCYLIN(nolign-1)
 PARMSK(4) = [M:HAE2]ACC1(nolign-1)
 PARMSK(5) = "DIE_3"
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CCE5
Onevent BEFORE_AREA Gosub AV_CCE5 From W1WMAC2STDCO
Onevent INIT_AREA Call D_CCE5(zc) From W1WMAC2STDCO
Onevent BEFORE_INPUT Call AS_CCE5(zc) From W1WMAC2STDCO
Onevent CONTROL Call C_CCE5(zc) From W1WMAC2STDCO
Onevent AFTER_AREA Call AP_CCE5(zc) From W1WMAC2STDCO
Return

$AV_CCE5
## Action STD
Call AV_CCE5(zc) From SUBGA0
If [M:HAEF]FMTDIE(4)<>""
 Chgfmt [M]CCE5(indice) With [M:HAEF]FMTDIE(4)
Else
 Chgfmt [M]CCE5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE5(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE5,indice)=0
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"DIE_4") From TRTGAS
 ## Action STD
 Call D_CCE5(VALEUR) From SUBGA0
Endif
Gosub _AFF
End

Subprog AS_CCE5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"DIE_4") From TRTGAS
If mkstat=2
 [M]CCE5(INDIC) = VALEUR
 Affzo CCE5(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CCE5(VALEUR) From SUBGA0
 If mkstat=2
  [M]CCE5(INDIC) = VALEUR
  Affzo CCE5(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_CCE5(zc) From W1WMAC2STDCO
Endif
Gosub _AFF
End

Subprog C_CCE5(VALEUR)
Variable Char    VALEUR()
## Action FLDCTLCAR
Call FLDCTLCAR(VALEUR,"DIE_4") From TRTGAS
If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_CCE5(VALEUR) From SUBGA0
 If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
 If !mkstat
  ## Action SPE
  Call C_CCE5(VALEUR) From SPEGA0
  If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_CCE5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_CCE5(VALEUR) From SUBGA0
If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CCE5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YDIESEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YDIESEL"
 PARMSK(1) = "GESGAS"
 PARMSK(2) = [M:HAEF]DIE(4)
 PARMSK(3) = [M]FCYLIN(nolign-1)
 PARMSK(4) = [M:HAE2]ACC1(nolign-1)
 PARMSK(5) = "DIE_4"
 Call S_LIS_CHAR(VALEUR,PARMSK,"YDIE","","YDIESEL") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W3WMAC2STDCO
Return

$TIT_COL
Gosub TIT_COL From W3WMAC2STDCO
Return


