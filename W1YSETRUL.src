#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management YSETRUL 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [16/11/2018]
A_HEURE = "15:09:26"
A_USER  = "MAJID"
A_STAMP = "20181116150926"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask YSETRUL [YSTR]
Gosub HORODAT
Local Inpbox "YSETRUL" From GFONCTION At A_STAMP With A_WINDPREV Mask [YSTR] As [SIM_]
Grizo [YSTR]5
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [YSTR]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=114 : Y1(0)=1 : Y2(0)=31
Return

$ON_YACTFLG
Onevent INIT_AREA Call D_YACTFLG(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YACTFLG(zc) From W1YSETRUL
Return

Subprog D_YACTFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]YACTFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_YACTFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YFFCY
Onevent CONTROL Call C_YFFCY(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFFCY(zc) From W1YSETRUL
Return

Subprog AS_YFFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFFCY(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFFCY(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFFCY(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFFCY(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "YFFCY" : GZNUM = 101136 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFFCY" : GZNUM = 101136 : Endif
Endif
Gosub _AFF
End

Subprog S_YFFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTFCY
Onevent CONTROL Call C_YTFCY(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YTFCY(zc) From W1YSETRUL
Return

Subprog AS_YTFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YTFCY(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YTFCY(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YTFCY(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YTFCY(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YTFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "YTFCY" : GZNUM = 101134 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YTFCY" : GZNUM = 101134 : Endif
Endif
Gosub _AFF
End

Subprog S_YTFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YTFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCALTYP
Onevent INIT_AREA Call D_YCALTYP(zc) From W1YSETRUL
Return

Subprog D_YCALTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]YCALTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YSET
Onevent CONTROL Call C_YSET(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YSET(zc) From W1YSETRUL
Return

Subprog AS_YSET(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(100372,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YSET(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YSET(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YSET(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YSET(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("YEST","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YSET" : GZNUM = 100372 : Endif
Gosub _AFF
End

Subprog S_YSET(VALEUR)
Variable Decimal VALEUR
Local Char PARMSK(250)(1..16)
PARMSK(1) = "YEST"
PARMSK(2) = "!"
Call S_TAB_NUM(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YSET(VALEUR)
Variable Decimal VALEUR
Local Char VALCHAR(20)
VALCHAR = num$(VALEUR)
Call OBJET("YEST",VALCHAR,"") From GOBJET
VALEUR = val(VALCHAR)
Gosub _AFF
End

Subprog P_YSET(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YEST",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFBANK
Onevent CONTROL Call C_YFBANK(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFBANK(zc) From W1YSETRUL
Return

Subprog AS_YFBANK(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7396,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFBANK(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFBANK(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFBANK(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFBANK(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFBANK(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("BAN","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YFBANK" : GZNUM = 38162 : Endif
Gosub _AFF
End

Subprog S_YFBANK(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BAN"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFBANK(VALEUR)
Variable Char    VALEUR()
Call OBJET("BAN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFBANK(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BAN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFBANK(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BAN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YENTTYP
Return

$ON_YFACC
Onevent BEFORE_AREA Gosub AV_YFACC From W1YSETRUL
Onevent CONTROL Call C_YFACC(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFACC(zc) From W1YSETRUL
Return

$AV_YFACC
## Action INIACCFMT
Call INIACCFMT("") From SETGLBCOA
If GFMTACC<>""
 Chgfmt [M]YFACC(indice) With "K:"+GFMTACC
Else
 Chgfmt [M]YFACC(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YFACC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFACC(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFACC(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFACC(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFACC(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YFACC" : GZNUM = 3956 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,"") From CPTSUB
  If mkstat : GERR = 1 : GZONE = "YFACC" : GZNUM = 3956 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFACC" : GZNUM = 3956 : Endif
Endif
Gosub _AFF
End

Subprog S_YFACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GAC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFACC(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFACC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTACC
Onevent BEFORE_AREA Gosub AV_YTACC From W1YSETRUL
Onevent CONTROL Call C_YTACC(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YTACC(zc) From W1YSETRUL
Return

$AV_YTACC
## Action INIACCFMT
Call INIACCFMT("") From SETGLBCOA
If GFMTACC<>""
 Chgfmt [M]YTACC(indice) With "K:"+GFMTACC
Else
 Chgfmt [M]YTACC(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YTACC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YTACC(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YTACC(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YTACC(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YTACC(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YTACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YTACC" : GZNUM = 3956 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,"") From CPTSUB
  If mkstat : GERR = 1 : GZONE = "YTACC" : GZNUM = 3956 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YTACC" : GZNUM = 3956 : Endif
Endif
Gosub _AFF
End

Subprog S_YTACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GAC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YTACC(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTACC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YJOU
Return

$ON_YPRECINCT
Onevent CONTROL Call C_YPRECINCT(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YPRECINCT(zc) From W1YSETRUL
Return

Subprog AS_YPRECINCT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(100394,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YPRECINCT(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YPRECINCT(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YPRECINCT(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YPRECINCT(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YPRECINCT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("YPRE","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YPRECINCT" : GZNUM = 100373 : Endif
Gosub _AFF
End

Subprog S_YPRECINCT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "YPRE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YPRECINCT(VALEUR)
Variable Char    VALEUR()
Call OBJET("YPRE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YPRECINCT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YPRE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YPRECINCT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YPRE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFDRCR
Onevent INIT_AREA Call D_YFDRCR(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFDRCR(zc) From W1YSETRUL
Return

Subprog D_YFDRCR(VALEUR)
Variable Integer VALEUR
If varinit([M]YFDRCR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_YFDRCR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YALWADJ
Onevent INIT_AREA Call D_YALWADJ(zc) From W1YSETRUL
Return

Subprog D_YALWADJ(VALEUR)
Variable Integer VALEUR
If varinit([M]YALWADJ,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YSTAG
Onevent CONTROL Call C_YSTAG(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YSTAG(zc) From W1YSETRUL
Return

Subprog AS_YSTAG(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32952,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YSTAG(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YSTAG(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YSTAG(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YSTAG(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YSTAG(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("YSTA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YSTAG" : GZNUM = 32952 : Endif
Gosub _AFF
End

Subprog S_YSTAG(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "YSTA"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YSTAG(VALEUR)
Variable Char    VALEUR()
Call OBJET("YSTA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YSTAG(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YSTA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YSTAG(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YSTA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YLOT
Onevent CONTROL Call C_YLOT(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YLOT(zc) From W1YSETRUL
Return

Subprog AS_YLOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2721,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YLOT(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YLOT(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YLOT(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YLOT(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YLOT(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "YLOT" : GZNUM = 2721 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("YLOT","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YLOT" : GZNUM = 2721 : Endif
Endif
Gosub _AFF
End

Subprog S_YLOT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "YLOT"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YLOT(VALEUR)
Variable Char    VALEUR()
Call OBJET("YLOT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YLOT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YLOT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YLOT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YLOT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YSETPRC
Onevent INIT_AREA Call D_YSETPRC(zc) From W1YSETRUL
Return

Subprog D_YSETPRC(VALEUR)
Variable Integer VALEUR
If varinit([M]YSETPRC,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YFGST
Onevent CONTROL Call C_YFGST(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFGST(zc) From W1YSETRUL
Return

Subprog IB_YFGST(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_YFGST(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YFGST(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_YFGST(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFGST(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFGST(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFGST(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFGST(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,"","","","","","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "YFGST" : GZNUM = 6818 : Endif
Gosub _AFF
End

Subprog S_YFGST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YFGST(VALEUR)
Variable Char    VALEUR()
Call OBJET("TVT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFGST(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFGST(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTGST
Onevent CONTROL Call C_YTGST(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YTGST(zc) From W1YSETRUL
Return

Subprog IB_YTGST(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_YTGST(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YTGST(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_YTGST(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YTGST(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YTGST(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YTGST(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YTGST(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,"","","","","","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "YTGST" : GZNUM = 6818 : Endif
Gosub _AFF
End

Subprog S_YTGST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YTGST(VALEUR)
Variable Char    VALEUR()
Call OBJET("TVT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTGST(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTGST(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFAMTAMD
Onevent INIT_AREA Call D_YFAMTAMD(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFAMTAMD(zc) From W1YSETRUL
Return

Subprog D_YFAMTAMD(VALEUR)
Variable Integer VALEUR
If varinit([M]YFAMTAMD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_YFAMTAMD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YTAMTAMD
Onevent INIT_AREA Call D_YTAMTAMD(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YTAMTAMD(zc) From W1YSETRUL
Return

Subprog D_YTAMTAMD(VALEUR)
Variable Integer VALEUR
If varinit([M]YTAMTAMD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_YTAMTAMD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_YVLDFRM
Onevent BEFORE_AREA Gosub AV_YVLDFRM From W1YSETRUL
Return

$AV_YVLDFRM
Chgfmt [M]YVLDFRM(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$ON_YVLDTO
Onevent BEFORE_AREA Gosub AV_YVLDTO From W1YSETRUL
Return

$AV_YVLDTO
Chgfmt [M]YVLDTO(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$ON_YFLONAGR
Onevent BEFORE_INPUT Call AS_YFLONAGR(zc) From W1YSETRUL
Onevent CONTROL Call C_YFLONAGR(zc) From W1YSETRUL
Return

Subprog AS_YFLONAGR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(100685,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFLONAGR(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFLONAGR(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFLONAGR(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFLONAGR(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFLONAGR(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("YELA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YFLONAGR" : GZNUM = 100118 : Endif
Gosub _AFF
End

Subprog S_YFLONAGR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YELASEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YELASEL"
 PARMSK(1) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YELASEL","","YSELELA") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YFLONAGR(VALEUR)
Variable Char    VALEUR()
Call OBJET("YELA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFLONAGR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YELA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFLONAGR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YELA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFPJTLIN
Onevent BEFORE_INPUT Call AS_YFPJTLIN(zc) From W1YSETRUL
Onevent CONTROL Call C_YFPJTLIN(zc) From W1YSETRUL
Onevent AFTER_CHANGE Gosub AMM_YFPJTLIN From W1YSETRUL
Return

Subprog IB_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YFPJTLIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]YFPJTLIN(INDIC) = VALEUR
 Affzo YFPJTLIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_YFPJTLIN(zc) From W1YSETRUL
Onkey 130 Titled GBOUT2 Call B2_YFPJTLIN(zc) From W1YSETRUL
Onkey 131 Titled GBOUT3 Call B3_YFPJTLIN(zc) From W1YSETRUL
Onkey 132 Titled GBOUT4 Call B4_YFPJTLIN(zc) From W1YSETRUL
Onkey 172 Titled GBOUT15 Call B15_YFPJTLIN(zc) From W1YSETRUL
Onkey 173 Titled GBOUT16 Call B16_YFPJTLIN(zc) From W1YSETRUL
Onkey 174 Titled GBOUT17 Call B17_YFPJTLIN(zc) From W1YSETRUL
Onkey 175 Titled GBOUT18 Call B18_YFPJTLIN(zc) From W1YSETRUL
Onkey 176 Titled GBOUT19 Call B19_YFPJTLIN(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFPJTLIN(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFPJTLIN(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFPJTLIN(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
Endif
Gosub _AFF
End

$AMM_YFPJTLIN
Call AM_YFPJTLIN(zc)
If !mkstat & GOBJET
 zoncou = "YFPJTLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YFPJTLIN" : GZNUM = 54491 : Endif
Gosub _AFF
End

Subprog S_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFCCE
Onevent BEFORE_AREA Gosub AV_YFCCE From W1YSETRUL
Onevent CONTROL Call C_YFCCE(zc) From W1YSETRUL
Onevent BEFORE_INPUT Call AS_YFCCE(zc) From W1YSETRUL
Return

$AV_YFCCE
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YFCCE(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YFCCE(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YFCCE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFCCE(zc) From W1YSETRUL
Onkey   2 Titled GBOUTS Call S_YFCCE(zc) From W1YSETRUL
Onkey 144 Titled GBOUTP Call P_YFCCE(zc) From W1YSETRUL
Onkey 146 Titled GBOUTA Call SA_YFCCE(zc) From W1YSETRUL
Gosub _AFF
End

Subprog C_YFCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YFCCE" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFCCE" : GZNUM = 3997 : Endif
Endif
Gosub _AFF
End

Subprog S_YFCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFCCE(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFCCE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2YSETRUL
Return

$TIT_COL
Gosub TIT_COL From W2YSETRUL
Return


