#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management CRITMKM 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:45:54"
A_USER  = "ADMIN"
A_STAMP = "20180326124554"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CRITMKM [CMKM]
Gosub HORODAT
Local Inpbox "CRITMKM" From GFONCTION At A_STAMP With A_WINDPREV Mask [CMKM] As [SIM_]
Grizo [CMKM]5
Grizo [CMKM]10
Grizo [CMKM]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [CMKM]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=8 : X2(0)=104 : Y1(0)=6 : Y2(0)=7
X1(1)=8 : X2(1)=104 : Y1(1)=8 : Y2(1)=19
X1(2)=8 : X2(2)=104 : Y1(2)=20 : Y2(2)=22
Return

$ON_MEMO
Return

$ON_ITMREFDEB
Onevent CONTROL Call C_ITMREFDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_ITMREFDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_ITMREFDEB(zc) From W1CRITMKM
Return

Subprog IB_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFDEB(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ITMREFDEB(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_ITMREFDEB(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_ITMREFDEB(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_ITMREFDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFDEB" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFDEB" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFDEB" : GZNUM = 3651 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFDEB
Call AM_ITMREFDEB(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "ITMREFDEB" : GZNUM = 3651 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFDEB)")>indice
 [M]ITMREFDEB(indice) = VALEUR
 Affzo ZITMREFDEB(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFDEB
Onevent BEFORE_AREA Gosub AV_ZITMREFDEB From W1CRITMKM
Return

$AV_ZITMREFDEB
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ITMREFFIN
Onevent CONTROL Call C_ITMREFFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_ITMREFFIN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_ITMREFFIN From W1CRITMKM
Return

Subprog IB_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFFIN(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ITMREFFIN(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_ITMREFFIN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_ITMREFFIN(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_ITMREFFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFFIN" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREFFIN(VALEUR) From CNSMKMSTD
   If mkstat : GERR = 1 : GZONE = "ITMREFFIN" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFFIN
Call AM_ITMREFFIN(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFFIN)")>indice
 [M]ITMREFFIN(indice) = VALEUR
 Affzo ZITMREFFIN(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFFIN
Onevent BEFORE_AREA Gosub AV_ZITMREFFIN From W1CRITMKM
Return

$AV_ZITMREFFIN
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_MFGDATDEB
Onevent BEFORE_AREA Gosub AV_MFGDATDEB From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_MFGDATDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGDATDEB(zc) From W1CRITMKM
Return

$AV_MFGDATDEB
## Action ADATRELI
Call INIDAT(zc,[M]MFGDATDEBF) From ADATREL
Chgfmt [M]MFGDATDEB(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MFGDATDEB(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGDATDEB(zc) From W1CRITMKM
Gosub _AFF
End

$AMM_MFGDATDEB
Call AM_MFGDATDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGDATDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGDATDEB(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]MFGDATDEBF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MFGDATDEB" : GZNUM = 10781 : Endif
If !mkstat
 ## Action STD
 Call AM_MFGDATDEB(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "MFGDATDEB" : GZNUM = 10781 : Endif
Endif
Gosub _AFF
End

Subprog B1_MFGDATDEB(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]MFGDATDEBF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]MFGDATDEBF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MFGDATFIN
Onevent BEFORE_AREA Gosub AV_MFGDATFIN From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_MFGDATFIN From W1CRITMKM
Onevent CONTROL Call C_MFGDATFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGDATFIN(zc) From W1CRITMKM
Return

$AV_MFGDATFIN
## Action ADATRELI
Call INIDAT(zc,[M]MFGDATFINF) From ADATREL
Chgfmt [M]MFGDATFIN(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MFGDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGDATFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_MFGDATFIN(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_MFGDATFIN(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "MFGDATFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_MFGDATFIN
Call AM_MFGDATFIN(zc)
If !mkstat & GOBJET
 zoncou = "MFGDATFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGDATFIN(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]MFGDATFINF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MFGDATFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_MFGDATFIN(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]MFGDATFINF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]MFGDATFINF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MFGTNUMDEB
Onevent CONTROL Call C_MFGTNUMDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_MFGTNUMDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGTNUMDEB(zc) From W1CRITMKM
Return

Subprog AS_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGTNUMDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGTNUMDEB" : GZNUM = 10780 : Endif
Endif
Gosub _AFF
End

$AMM_MFGTNUMDEB
Call AM_MFGTNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGTNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGTNUMDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "MFGTNUMDEB" : GZNUM = 10780 : Endif
Gosub _AFF
End

Subprog S_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGTNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGTNUM"
 PARMSK(1) = [M:MKM1]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGTNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGTNUMFIN
Onevent CONTROL Call C_MFGTNUMFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGTNUMFIN(zc) From W1CRITMKM
Return

Subprog AS_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGTNUMFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGTNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_MFGTNUMFIN(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "MFGTNUMFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGTNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGTNUM"
 PARMSK(1) = [M:MKM1]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGTNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGNUMDEB
Onevent CONTROL Call C_MFGNUMDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_MFGNUMDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGNUMDEB(zc) From W1CRITMKM
Return

Subprog AS_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGNUMDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMDEB" : GZNUM = 9595 : Endif
Endif
Gosub _AFF
End

$AMM_MFGNUMDEB
Call AM_MFGNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGNUMDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "MFGNUMDEB" : GZNUM = 9595 : Endif
Gosub _AFF
End

Subprog S_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M:MKM1]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGNUMFIN
Onevent CONTROL Call C_MFGNUMFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_MFGNUMFIN(zc) From W1CRITMKM
Return

Subprog AS_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGNUMFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_MFGNUMFIN(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "MFGNUMFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M:MKM1]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_RELITMDEB
Onevent CONTROL Call C_RELITMDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_RELITMDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_RELITMDEB(zc) From W1CRITMKM
Return

Subprog IB_RELITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_RELITMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_RELITMDEB(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_RELITMDEB(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_RELITMDEB(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_RELITMDEB(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_RELITMDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_RELITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "RELITMDEB" : GZNUM = 11093 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "RELITMDEB" : GZNUM = 11093 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "RELITMDEB" : GZNUM = 11093 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_RELITMDEB
Call AM_RELITMDEB(zc)
If !mkstat & GOBJET
 zoncou = "RELITMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RELITMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_RELITMDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "RELITMDEB" : GZNUM = 11093 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZRELITMDEB)")>indice
 [M]RELITMDEB(indice) = VALEUR
 Affzo ZRELITMDEB(indice)
Endif
Gosub _AFF
End

Subprog S_RELITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_RELITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_RELITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_RELITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZRELITMDEB
Onevent BEFORE_AREA Gosub AV_ZRELITMDEB From W1CRITMKM
Return

$AV_ZRELITMDEB
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]RELITMDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RELITMFIN
Onevent CONTROL Call C_RELITMFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_RELITMFIN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_RELITMFIN From W1CRITMKM
Return

Subprog IB_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_RELITMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_RELITMFIN(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_RELITMFIN(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_RELITMFIN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_RELITMFIN(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_RELITMFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "RELITMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "RELITMFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "RELITMFIN" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_RELITMFIN(VALEUR) From CNSMKMSTD
   If mkstat : GERR = 1 : GZONE = "RELITMFIN" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_RELITMFIN
Call AM_RELITMFIN(zc)
If !mkstat & GOBJET
 zoncou = "RELITMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZRELITMFIN)")>indice
 [M]RELITMFIN(indice) = VALEUR
 Affzo ZRELITMFIN(indice)
Endif
Gosub _AFF
End

Subprog S_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_RELITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_RELITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZRELITMFIN
Onevent BEFORE_AREA Gosub AV_ZRELITMFIN From W1CRITMKM
Return

$AV_ZRELITMFIN
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]RELITMFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_BOMNUMDEB
Onevent CONTROL Call C_BOMNUMDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_BOMNUMDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_BOMNUMDEB(zc) From W1CRITMKM
Return

Subprog IB_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_BOMNUMDEB(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_BOMNUMDEB(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_BOMNUMDEB(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_BOMNUMDEB(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_BOMNUMDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BOMNUMDEB" : GZNUM = 3966 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "BOMNUMDEB" : GZNUM = 3966 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!A",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "BOMNUMDEB" : GZNUM = 3966 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_BOMNUMDEB
Call AM_BOMNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "BOMNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BOMNUMDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "BOMNUMDEB" : GZNUM = 3966 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZBOMNUMDEB)")>indice
 [M]BOMNUMDEB(indice) = VALEUR
 Affzo ZBOMNUMDEB(indice)
Endif
Gosub _AFF
End

Subprog S_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOM"
 PARMSK(1) = "0"
 PARMSK(2) = "B"
 PARMSK(3) = [M]BOMNUMDEB
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBOM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BOMNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMNUMDEB
Onevent BEFORE_AREA Gosub AV_ZBOMNUMDEB From W1CRITMKM
Return

$AV_ZBOMNUMDEB
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]BOMNUMDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_BOMNUMFIN
Onevent CONTROL Call C_BOMNUMFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_BOMNUMFIN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_BOMNUMFIN From W1CRITMKM
Return

Subprog IB_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_BOMNUMFIN(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_BOMNUMFIN(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_BOMNUMFIN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_BOMNUMFIN(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_BOMNUMFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BOMNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "BOMNUMFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "BOMNUMFIN" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_BOMNUMFIN(VALEUR) From CNSMKMSTD
   If mkstat : GERR = 1 : GZONE = "BOMNUMFIN" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_BOMNUMFIN
Call AM_BOMNUMFIN(zc)
If !mkstat & GOBJET
 zoncou = "BOMNUMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZBOMNUMFIN)")>indice
 [M]BOMNUMFIN(indice) = VALEUR
 Affzo ZBOMNUMFIN(indice)
Endif
Gosub _AFF
End

Subprog S_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOM"
 PARMSK(1) = "0"
 PARMSK(2) = "B"
 PARMSK(3) = [M]BOMNUMFIN
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBOM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BOMNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMNUMFIN
Onevent BEFORE_AREA Gosub AV_ZBOMNUMFIN From W1CRITMKM
Return

$AV_ZBOMNUMFIN
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]BOMNUMFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_BOMALTDEB
Onevent AFTER_CHANGE Gosub AMM_BOMALTDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_BOMALTDEB(zc) From W1CRITMKM
Onevent CONTROL Call C_BOMALTDEB(zc) From W1CRITMKM
Return

Subprog AS_BOMALTDEB(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey   2 Titled GBOUTS Call S_BOMALTDEB(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_BOMALTDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_BOMALTDEB(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "BOMALTDEB" : GZNUM = 9555 : Endif
Gosub _AFF
End

$AMM_BOMALTDEB
Call AM_BOMALTDEB(zc)
If !mkstat & GOBJET
 zoncou = "BOMALTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMALTDEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_BOMALTDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "BOMALTDEB" : GZNUM = 9555 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZBOMALTDEB)")>indice
 [M]BOMALTDEB(indice) = VALEUR
 Affzo ZBOMALTDEB(indice)
Endif
Gosub _AFF
End

Subprog S_BOMALTDEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_BOMALTDEB(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMALTDEB
Onevent BEFORE_AREA Gosub AV_ZBOMALTDEB From W1CRITMKM
Return

$AV_ZBOMALTDEB
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX","2",num$([M]BOMALTDEB(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_BOMALTFIN
Onevent CONTROL Call C_BOMALTFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_BOMALTFIN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_BOMALTFIN From W1CRITMKM
Return

Subprog AS_BOMALTFIN(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey   2 Titled GBOUTS Call S_BOMALTFIN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_BOMALTFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_BOMALTFIN(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "BOMALTFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_BOMALTFIN(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "BOMALTFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_BOMALTFIN
Call AM_BOMALTFIN(zc)
If !mkstat & GOBJET
 zoncou = "BOMALTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMALTFIN(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZBOMALTFIN)")>indice
 [M]BOMALTFIN(indice) = VALEUR
 Affzo ZBOMALTFIN(indice)
Endif
Gosub _AFF
End

Subprog S_BOMALTFIN(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_BOMALTFIN(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMALTFIN
Onevent BEFORE_AREA Gosub AV_ZBOMALTFIN From W1CRITMKM
Return

$AV_ZBOMALTFIN
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX","2",num$([M]BOMALTFIN(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_OPENUMDEB
Onevent AFTER_CHANGE Gosub AMM_OPENUMDEB From W1CRITMKM
Onevent CONTROL Call C_OPENUMDEB(zc) From W1CRITMKM
Return

Subprog C_OPENUMDEB(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_OPENUMDEB
Call AM_OPENUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "OPENUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_OPENUMDEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_OPENUMDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "OPENUMDEB" : GZNUM = 2296 : Endif
Gosub _AFF
End

$ON_OPENUMFIN
Onevent CONTROL Call C_OPENUMFIN(zc) From W1CRITMKM
Return

Subprog C_OPENUMFIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_OPENUMFIN(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "OPENUMFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_PJTDEB
Onevent BEFORE_INPUT Call AS_PJTDEB(zc) From W1CRITMKM
Onevent CONTROL Call C_PJTDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_PJTDEB From W1CRITMKM
Return

Subprog IB_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTDEB(INDIC) = VALEUR
 Affzo PJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTDEB(zc) From W1CRITMKM
Onkey 130 Titled GBOUT2 Call B2_PJTDEB(zc) From W1CRITMKM
Onkey 131 Titled GBOUT3 Call B3_PJTDEB(zc) From W1CRITMKM
Onkey 132 Titled GBOUT4 Call B4_PJTDEB(zc) From W1CRITMKM
Onkey 172 Titled GBOUT15 Call B15_PJTDEB(zc) From W1CRITMKM
Onkey 173 Titled GBOUT16 Call B16_PJTDEB(zc) From W1CRITMKM
Onkey 174 Titled GBOUT17 Call B17_PJTDEB(zc) From W1CRITMKM
Onkey 175 Titled GBOUT18 Call B18_PJTDEB(zc) From W1CRITMKM
Onkey 176 Titled GBOUT19 Call B19_PJTDEB(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_PJTDEB(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_PJTDEB(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_PJTDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJTDEB
Call AM_PJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "PJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTDEB(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CMKM","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PJTFIN
Onevent BEFORE_INPUT Call AS_PJTFIN(zc) From W1CRITMKM
Onevent CONTROL Call C_PJTFIN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_PJTFIN From W1CRITMKM
Return

Subprog IB_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTFIN(INDIC) = VALEUR
 Affzo PJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTFIN(zc) From W1CRITMKM
Onkey 130 Titled GBOUT2 Call B2_PJTFIN(zc) From W1CRITMKM
Onkey 131 Titled GBOUT3 Call B3_PJTFIN(zc) From W1CRITMKM
Onkey 132 Titled GBOUT4 Call B4_PJTFIN(zc) From W1CRITMKM
Onkey 172 Titled GBOUT15 Call B15_PJTFIN(zc) From W1CRITMKM
Onkey 173 Titled GBOUT16 Call B16_PJTFIN(zc) From W1CRITMKM
Onkey 174 Titled GBOUT17 Call B17_PJTFIN(zc) From W1CRITMKM
Onkey 175 Titled GBOUT18 Call B18_PJTFIN(zc) From W1CRITMKM
Onkey 176 Titled GBOUT19 Call B19_PJTFIN(zc) From W1CRITMKM
Onkey   2 Titled GBOUTS Call S_PJTFIN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_PJTFIN(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_PJTFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_PJTFIN(VALEUR) From CNSMKMSTD
  If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTFIN
Call AM_PJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CMKM","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKM1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CMKM"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKM1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKM1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VCRORIDEB
Onevent CONTROL Call C_VCRORIDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_VCRORIDEB From W1CRITMKM
Onevent BEFORE_INPUT Call AS_VCRORIDEB(zc) From W1CRITMKM
Return

Subprog AS_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_VCRORIDEB(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIDEB" : GZNUM = 3312 : Endif
Endif
Gosub _AFF
End

$AMM_VCRORIDEB
Call AM_VCRORIDEB(zc)
If !mkstat & GOBJET
 zoncou = "VCRORIDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRORIDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "VCRORIDEB" : GZNUM = 3312 : Endif
Gosub _AFF
End

Subprog S_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORIFIN
Onevent CONTROL Call C_VCRORIFIN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_VCRORIFIN(zc) From W1CRITMKM
Return

Subprog AS_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_VCRORIFIN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_VCRORIFIN(VALEUR) From CNSMKMSTD
 If mkstat : GERR = 1 : GZONE = "VCRORIFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MATTYPDEB
Onevent BEFORE_INPUT Call AS_MATTYPDEB(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_MATTYPDEB From W1CRITMKM
Onevent INIT_AREA Call D_MATTYPDEB(zc) From W1CRITMKM
Onevent CONTROL Call C_MATTYPDEB(zc) From W1CRITMKM
Return

Subprog D_MATTYPDEB(VALEUR)
Variable Integer VALEUR
If varinit([M]MATTYPDEB,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MATTYPDEB(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2306) From COMBOS
## Action STD
Call AS_MATTYPDEB(VALEUR) From CNSMKMSTD
If mkstat=2
 [M]MATTYPDEB(INDIC) = VALEUR
 Affzo MATTYPDEB(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2306,1))))
Endif
If !mkstat
 Discombo 0 From MATTYPDEB(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From MATTYPDEB(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_MATTYPDEB(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$AMM_MATTYPDEB
Call AM_MATTYPDEB(zc)
If !mkstat & GOBJET
 zoncou = "MATTYPDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MATTYPDEB(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_MATTYPDEB(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "MATTYPDEB" : GZNUM = 14698 : Endif
Gosub _AFF
End

$ON_MATTYPFIN
Onevent BEFORE_INPUT Call AS_MATTYPFIN(zc) From W1CRITMKM
Onevent CONTROL Call C_MATTYPFIN(zc) From W1CRITMKM
Onevent INIT_AREA Call D_MATTYPFIN(zc) From W1CRITMKM
Return

Subprog D_MATTYPFIN(VALEUR)
Variable Integer VALEUR
If varinit([M]MATTYPFIN,indice)=0
 VALEUR = 4
Endif
Gosub _AFF
End

Subprog AS_MATTYPFIN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2306) From COMBOS
## Action STD
Call AS_MATTYPFIN(VALEUR) From CNSMKMSTD
If mkstat=2
 [M]MATTYPFIN(INDIC) = VALEUR
 Affzo MATTYPFIN(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2306,1))))
Endif
If !mkstat
 Discombo 0 From MATTYPFIN(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From MATTYPFIN(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_MATTYPFIN(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
## Action STD
Call C_MATTYPFIN(VALEUR) From CNSMKMSTD
If mkstat : GERR = 1 : GZONE = "MATTYPFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_ECRAN
Onevent CONTROL Call C_ECRAN(zc) From W1CRITMKM
Onevent BEFORE_INPUT Call AS_ECRAN(zc) From W1CRITMKM
Onevent AFTER_CHANGE Gosub AMM_ECRAN From W1CRITMKM
Return

Subprog AS_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ECRAN(zc) From W1CRITMKM
Onkey 144 Titled GBOUTP Call P_ECRAN(zc) From W1CRITMKM
Onkey 146 Titled GBOUTA Call SA_ECRAN(zc) From W1CRITMKM
Gosub _AFF
End

Subprog C_ECRAN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("GTC","!",VALEUR,"MKM",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ECRAN" : GZNUM = 46 : Endif
Gosub _AFF
End

$AMM_ECRAN
Call AM_ECRAN(zc)
If !mkstat & GOBJET
 zoncou = "ECRAN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ECRAN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZECRAN)")>indice
 [M]ECRAN(indice) = VALEUR
 Affzo ZECRAN(indice)
Endif
Gosub _AFF
End

Subprog S_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GTC"
PARMSK(2) = "!"
PARMSK(3) = "MKM"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GTC"
PARMSK(2) = "MKM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "MKM"
Call VISU("GTC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2CRITMKM
Return

$TIT_COL
Gosub TIT_COL From W2CRITMKM
Return


