#<AdxTL>@(#)0.0.0.0 $Revision$Class Purchase invoices
# Supervisor
## ACLA-CLASSE ## PINVOICE
# 2018-08-27 12:39:19 242

####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 31 : EECNUMDEB EU Intrastat ( Field C 4)
####################################################################

$SET_EECNUMDEB
If [L]_AOLDVAL<>this.EECNUMDEB
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECNUMDEB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECNUMDEB
 Gosub PROPAGATE_EECNUMDEB
Endif
Return

$INIT_EECNUMDEB
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EECNUMDEB
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "EECNUMDEB"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECNUMDEB             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECNUMDEB             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EECNUMDEB=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
Return

$_AOTHERS_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECNUMDEB
[L]CURPRO = "EECNUMDEB"
Return

$PROPAGATE_EECNUMDEB
this.isReadonly = 0
[L]CURPRO = "EECNUMDEB"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECNUMDEB
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "EECNUMDEB"
$_LNKPRO_EECNUMDEB
Return


####################################################################
# 32 : STA Status ( Field Local menu number 509)
####################################################################

$SET_STA
If [L]_AOLDVAL<>this.STA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_STA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.STA
 Gosub PROPAGATE_STA
Endif
Return

$INIT_STA
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "STA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.STA=0 and fmet this.AGETATTRIBUTE("STA","$isMandatory")="true"
 this.STA = 1
Endif
Return
 
$CONTROL_STA
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "STA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_STA                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_STA                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_STA
[L]CURPRO = "STA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.STA=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_STA
[L]CURPRO = "STA"
If this.STA<0 or this.STA>len(mess(0,509,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"509 ->"-num$(this.STA)-mess(99,123,1)):  Return : # Local menu "509 -> Invalid option
Endif
Return

$_AOTHERS_STA
[L]CURPRO = "STA"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_STA
[L]CURPRO = "STA"
Return

$PROPAGATE_STA
this.isReadonly = 0
[L]CURPRO = "STA"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_STA
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "STA"
$_LNKPRO_STA
Return


####################################################################
# 33 : PAZ Pay approval ( Field Local menu number 510)
####################################################################

$SET_PAZ
If [L]_AOLDVAL<>this.PAZ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PAZ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PAZ
 Gosub PROPAGATE_PAZ
Endif
Return

$INIT_PAZ
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "PAZ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PAZ=0 and fmet this.AGETATTRIBUTE("PAZ","$isMandatory")="true"
 this.PAZ = 1
Endif
Return
 
$CONTROL_PAZ
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "PAZ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PAZ                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PAZ                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PAZ
[L]CURPRO = "PAZ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PAZ=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PAZ
[L]CURPRO = "PAZ"
If this.PAZ<0 or this.PAZ>len(mess(0,510,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"510 ->"-num$(this.PAZ)-mess(99,123,1)):  Return : # Local menu "510 -> Invalid option
Endif
Return

$_AOTHERS_PAZ
[L]CURPRO = "PAZ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PAZ
[L]CURPRO = "PAZ"
Return

$PROPAGATE_PAZ
this.isReadonly = 0
[L]CURPRO = "PAZ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PAZ
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "PAZ"
$_LNKPRO_PAZ
Return


####################################################################
# 35 : INVNUM Invoice number ( Field VCR 20)
####################################################################

$SET_INVNUM
If [L]_AOLDVAL<>this.INVNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_INVNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.INVNUM
 Gosub PROPAGATE_INVNUM
Endif
Return

$INIT_INVNUM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "INVNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_INVNUM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "INVNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_INVNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_INVNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_INVNUM
[L]CURPRO = "INVNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.INVNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_INVNUM
[L]CURPRO = "INVNUM"
If vireblc(this.INVNUM,2)<>vireblc(format$("K:20X",this.INVNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_INVNUM
[L]CURPRO = "INVNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_INVNUM
[L]CURPRO = "INVNUM"
Return

$PROPAGATE_INVNUM
this.isReadonly = 0
[L]CURPRO = "INVNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_INVNUM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "INVNUM"
$_LNKPRO_INVNUM
Return


####################################################################
# 36 : SNS Sign ( Field C 2)
####################################################################

$SET_SNS
If [L]_AOLDVAL<>this.SNS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SNS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SNS
 Gosub PROPAGATE_SNS
Endif
Return

$INIT_SNS
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SNS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SNS
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SNS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SNS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SNS                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SNS
[L]CURPRO = "SNS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SNS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SNS
[L]CURPRO = "SNS"
Return

$_AOTHERS_SNS
[L]CURPRO = "SNS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SNS
[L]CURPRO = "SNS"
Return

$PROPAGATE_SNS
this.isReadonly = 0
[L]CURPRO = "SNS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SNS
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SNS"
$_LNKPRO_SNS
Return


####################################################################
# 37 : AMTATI Amount + tax ( Field MD1 0)
####################################################################

$SET_AMTATI
If [L]_AOLDVAL<>this.AMTATI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTATI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTATI
 Gosub PROPAGATE_AMTATI
Endif
Return

$INIT_AMTATI
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTATI
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTATI
[L]CURPRO = "AMTATI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTATI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTATI
[L]CURPRO = "AMTATI"
Return

$_AOTHERS_AMTATI
[L]CURPRO = "AMTATI"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTATI",this.AMTATI,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTATI
[L]CURPRO = "AMTATI"
Return

$PROPAGATE_AMTATI
this.isReadonly = 0
[L]CURPRO = "AMTATI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTATI
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATI"
$_LNKPRO_AMTATI
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTATI",this.AMTATI,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTATI","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 38 : AMTNOT Amount - tax ( Field MD1 0)
####################################################################

$SET_AMTNOT
If [L]_AOLDVAL<>this.AMTNOT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTNOT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTNOT
 Gosub PROPAGATE_AMTNOT
Endif
Return

$INIT_AMTNOT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTNOT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTNOT
[L]CURPRO = "AMTNOT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTNOT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTNOT
[L]CURPRO = "AMTNOT"
Return

$_AOTHERS_AMTNOT
[L]CURPRO = "AMTNOT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTNOT",this.AMTNOT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTNOT
[L]CURPRO = "AMTNOT"
Return

$PROPAGATE_AMTNOT
this.isReadonly = 0
[L]CURPRO = "AMTNOT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTNOT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOT"
$_LNKPRO_AMTNOT
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTNOT",this.AMTNOT,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTNOT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 39 : AMTATIL Invoice amt. + tax (co) ( Field MD1 0)
####################################################################

$SET_AMTATIL
If [L]_AOLDVAL<>this.AMTATIL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTATIL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTATIL
 Gosub PROPAGATE_AMTATIL
Endif
Return

$INIT_AMTATIL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATIL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTATIL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATIL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTATIL
[L]CURPRO = "AMTATIL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTATIL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTATIL
[L]CURPRO = "AMTATIL"
Return

$_AOTHERS_AMTATIL
[L]CURPRO = "AMTATIL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTATIL",this.AMTATIL,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTATIL
[L]CURPRO = "AMTATIL"
Return

$PROPAGATE_AMTATIL
this.isReadonly = 0
[L]CURPRO = "AMTATIL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTATIL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTATIL"
$_LNKPRO_AMTATIL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTATIL",this.AMTATIL,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTATIL","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 40 : AMTNOTL Amount - tax (co) ( Field MD1 0)
####################################################################

$SET_AMTNOTL
If [L]_AOLDVAL<>this.AMTNOTL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTNOTL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTNOTL
 Gosub PROPAGATE_AMTNOTL
Endif
Return

$INIT_AMTNOTL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOTL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTNOTL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOTL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTNOTL
[L]CURPRO = "AMTNOTL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTNOTL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTNOTL
[L]CURPRO = "AMTNOTL"
Return

$_AOTHERS_AMTNOTL
[L]CURPRO = "AMTNOTL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"AMTNOTL",this.AMTNOTL,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTNOTL
[L]CURPRO = "AMTNOTL"
Return

$PROPAGATE_AMTNOTL
this.isReadonly = 0
[L]CURPRO = "AMTNOTL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTNOTL
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "AMTNOTL"
$_LNKPRO_AMTNOTL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"AMTNOTL",this.AMTNOTL,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTNOTL","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 41 : VATDAT Tax date on credit ( Field D)
####################################################################

$SET_VATDAT
If [L]_AOLDVAL<>this.VATDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VATDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VATDAT
 Gosub PROPAGATE_VATDAT
Endif
Return

$INIT_VATDAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "VATDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VATDAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "VATDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VATDAT
[L]CURPRO = "VATDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.VATDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VATDAT
[L]CURPRO = "VATDAT"
Return

$_AOTHERS_VATDAT
[L]CURPRO = "VATDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VATDAT
[L]CURPRO = "VATDAT"
Return

$PROPAGATE_VATDAT
this.isReadonly = 0
[L]CURPRO = "VATDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VATDAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "VATDAT"
$_LNKPRO_VATDAT
Return


####################################################################
# 42 : NBRTAX Number of taxes ( Field C 2)
####################################################################

$SET_NBRTAX
If [L]_AOLDVAL<>this.NBRTAX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NBRTAX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NBRTAX
 Gosub PROPAGATE_NBRTAX
Endif
Return

$INIT_NBRTAX
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "NBRTAX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_NBRTAX
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "NBRTAX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NBRTAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NBRTAX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NBRTAX
[L]CURPRO = "NBRTAX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.NBRTAX=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NBRTAX
[L]CURPRO = "NBRTAX"
Return

$_AOTHERS_NBRTAX
[L]CURPRO = "NBRTAX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NBRTAX
[L]CURPRO = "NBRTAX"
Return

$PROPAGATE_NBRTAX
this.isReadonly = 0
[L]CURPRO = "NBRTAX"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NBRTAX
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "NBRTAX"
$_LNKPRO_NBRTAX
Return


####################################################################
# 45 : BPAINV Address ( Field ADR 5)
####################################################################

$SET_BPAINV
If [L]_AOLDVAL<>this.BPAINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPAINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPAINV
 Gosub PROPAGATE_BPAINV
Endif
Return

$INIT_BPAINV
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPAINV
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPAINV
[L]CURPRO = "BPAINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPAINV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>vireblc(format$("K:5c",this.BPAINV),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPAINV
[L]CURPRO = "BPAINV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPADR.ACTRLREF(this,"BPAINV",this.BPAINV,1,this.BPR,this.BPAINV,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPAINV<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_BPAINV
this.isReadonly = 0
[L]CURPRO = "BPAINV"
Gosub _LNKPRO_BPAINV
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPAINV
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAINV"
$_LNKPRO_BPAINV
If vireblc(this.BPAINV,2)<>""
 # Link BPADDRESS
 Local File BPADDRESS [WBPA]
 Read [F:WBPA]BPA0 = 1;this.BPR;this.BPAINV
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPAINV","$description",[F:WBPA]BPADES)
 Endif
 LogicClose File [WBPA]
Endif
Return


####################################################################
# 48 : POSCOD Postal code ( Field POS 10)
####################################################################

$SET_POSCOD
If [L]_AOLDVAL<>this.POSCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_POSCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.POSCOD
 Gosub PROPAGATE_POSCOD
Endif
Return

$INIT_POSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "POSCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_POSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "POSCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_POSCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_POSCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_POSCOD
[L]CURPRO = "POSCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.POSCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_POSCOD
[L]CURPRO = "POSCOD"
If vireblc(this.POSCOD,2)<>vireblc(format$("K:10X",this.POSCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_POSCOD
[L]CURPRO = "POSCOD"
[L]ASTATUS =  func ASYRTRTATY.CONTROLPOS(this,"POSCOD",this.POSCOD,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_POSCOD
[L]CURPRO = "POSCOD"
Return

$PROPAGATE_POSCOD
this.isReadonly = 0
[L]ASTATUS =  func ASYRTRTATY.PROPAGATEPOS(this,"POSCOD",this.POSCOD,this.CTY,this.SAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]CURPRO = "POSCOD"
Gosub _LNKPRO_POSCOD
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_POSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "POSCOD"
$_LNKPRO_POSCOD
If vireblc(this.POSCOD,2)<>""
 # Link POSCOD
 Local File POSCOD [WPOS]
 Read [F:WPOS]POS0 = this.CRY;this.POSCOD;this.CTY;""
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("POSCOD","$description",[F:WPOS]POSCTY)
 Endif
 LogicClose File [WPOS]
Endif
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATPOS(this,"POSCOD",this.POSCOD,[L]AFORMAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("POSCOD","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 49 : CTY City ( Field CTY 40)
####################################################################

$SET_CTY
If [L]_AOLDVAL<>this.CTY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CTY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CTY
 Gosub PROPAGATE_CTY
Endif
Return

$INIT_CTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CTY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CTY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CTY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CTY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CTY
[L]CURPRO = "CTY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CTY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CTY
[L]CURPRO = "CTY"
If vireblc(this.CTY,2)<>vireblc(format$("K:40X",this.CTY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CTY
[L]CURPRO = "CTY"
[L]ASTATUS =  func ASYRTRTATY.CONTROLCTY(this,"CTY",this.CTY,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CTY
[L]CURPRO = "CTY"
Return

$PROPAGATE_CTY
this.isReadonly = 0
[L]ASTATUS =  func ASYRTRTATY.PROPAGATECTY(this,"CTY",this.CTY,this.POSCOD,this.SAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]CURPRO = "CTY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CTY"
$_LNKPRO_CTY
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATCTY(this,"CTY",this.CTY,[L]AFORMAT,this.CRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("CTY","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 50 : SAT County ( Field SAT 35)
####################################################################

$SET_SAT
If [L]_AOLDVAL<>this.SAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SAT
 Gosub PROPAGATE_SAT
Endif
Return

$INIT_SAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SAT                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SAT                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SAT
[L]CURPRO = "SAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SAT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SAT
[L]CURPRO = "SAT"
If vireblc(this.SAT,2)<>vireblc(format$("K:35X",this.SAT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SAT
[L]CURPRO = "SAT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLSAT(this,"SAT",this.SAT,this.CRY,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SAT
[L]CURPRO = "SAT"
Return

$PROPAGATE_SAT
this.isReadonly = 0
[L]CURPRO = "SAT"
Gosub _LNKPRO_SAT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "SAT"
$_LNKPRO_SAT
If vireblc(this.SAT,2)<>""
 # Link TABSUBDIV
 Local File TABSUBDIV [WATU]
 Read [F:WATU]ATU0 = this.CRY;AVOID.ALIB;this.SAT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABSUBDIV" & ZONE="INTIT" & IDENT1=[F:WATU]CRYTYP & IDENT2=[F:WATU]COD & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SAT","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABSUBDIV" & ZONE="INTIT" & IDENT1=[F:WATU]CRYTYP & IDENT2=[F:WATU]COD & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("SAT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WATU]
Endif
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATSAT(this,"SAT",this.SAT,[L]AFORMAT,this.CRY,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("SAT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 51 : CRY Country ( Field CRY 3)
####################################################################

$SET_CRY
If [L]_AOLDVAL<>this.CRY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CRY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CRY
 Gosub PROPAGATE_CRY
Endif
Return

$INIT_CRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CRY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CRY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CRY
[L]CURPRO = "CRY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CRY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CRY
[L]CURPRO = "CRY"
If vireblc(this.CRY,2)<>vireblc(format$("K:3c",this.CRY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CRY
[L]CURPRO = "CRY"
If vireblc(this.CRY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCRY.ACTRLREF(this,"CRY",this.CRY,this.CRY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CRY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CRY
[L]CURPRO = "CRY"
Return

$PROPAGATE_CRY
this.isReadonly = 0
[L]CURPRO = "CRY"
Gosub _LNKPRO_CRY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRY"
$_LNKPRO_CRY
If vireblc(this.CRY,2)<>""
 # Link TABCOUNTRY
 Local File TABCOUNTRY [WTCY]
 Read [F:WTCY]TCY0 = this.CRY
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCOUNTRY" & ZONE="CRYDES" & IDENT1=[F:WTCY]CRY & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CRY","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCOUNTRY" & ZONE="CRYDES" & IDENT1=[F:WTCY]CRY & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CRY","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTCY]
Endif
Return


####################################################################
# 52 : CRYNAM Country name ( Field NCY 40)
####################################################################

$SET_CRYNAM
If [L]_AOLDVAL<>this.CRYNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CRYNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CRYNAM
 Gosub PROPAGATE_CRYNAM
Endif
Return

$INIT_CRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRYNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRYNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CRYNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CRYNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CRYNAM
[L]CURPRO = "CRYNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CRYNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CRYNAM
[L]CURPRO = "CRYNAM"
If vireblc(this.CRYNAM,2)<>vireblc(format$("K:40X",this.CRYNAM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CRYNAM
[L]CURPRO = "CRYNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CRYNAM
[L]CURPRO = "CRYNAM"
Return

$PROPAGATE_CRYNAM
this.isReadonly = 0
[L]CURPRO = "CRYNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "CRYNAM"
$_LNKPRO_CRYNAM
Return


####################################################################
# 53 : BPAPAY Address paying BP ( Field ADR 5)
####################################################################

$SET_BPAPAY
If [L]_AOLDVAL<>this.BPAPAY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPAPAY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPAPAY
 Gosub PROPAGATE_BPAPAY
Endif
Return

$INIT_BPAPAY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAPAY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPAPAY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAPAY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPAPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPAPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPAPAY
[L]CURPRO = "BPAPAY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPAPAY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPAPAY
[L]CURPRO = "BPAPAY"
If vireblc(this.BPAPAY,2)<>vireblc(format$("K:5c",this.BPAPAY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPAPAY
[L]CURPRO = "BPAPAY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPAPAY
[L]CURPRO = "BPAPAY"
If vireblc(this.BPAPAY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPADR.ACTRLREF(this,"BPAPAY",this.BPAPAY,1,this.BPRPAY,this.BPAPAY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPAPAY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_BPAPAY
this.isReadonly = 0
[L]CURPRO = "BPAPAY"
Gosub _LNKPRO_BPAPAY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPAPAY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPAPAY"
$_LNKPRO_BPAPAY
If vireblc(this.BPAPAY,2)<>""
 # Link BPADDRESS
 Local File BPADDRESS [WBPA]
 Read [F:WBPA]BPA0 = 1;this.BPRPAY;this.BPAPAY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPAPAY","$description",[F:WBPA]BPADES)
 Endif
 LogicClose File [WBPA]
Endif
Return


####################################################################
# 56 : BPYPOSCOD Postal code ( Field POS 10)
####################################################################

$SET_BPYPOSCOD
If [L]_AOLDVAL<>this.BPYPOSCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPYPOSCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPYPOSCOD
 Gosub PROPAGATE_BPYPOSCOD
Endif
Return

$INIT_BPYPOSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYPOSCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPYPOSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYPOSCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPYPOSCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPYPOSCOD             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPYPOSCOD
[L]CURPRO = "BPYPOSCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPYPOSCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPYPOSCOD
[L]CURPRO = "BPYPOSCOD"
If vireblc(this.BPYPOSCOD,2)<>vireblc(format$("K:10X",this.BPYPOSCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPYPOSCOD
[L]CURPRO = "BPYPOSCOD"
[L]ASTATUS =  func ASYRTRTATY.CONTROLPOS(this,"BPYPOSCOD",this.BPYPOSCOD,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPYPOSCOD
[L]CURPRO = "BPYPOSCOD"
Return

$PROPAGATE_BPYPOSCOD
this.isReadonly = 0
[L]ASTATUS =  func ASYRTRTATY.PROPAGATEPOS(this,"BPYPOSCOD",this.BPYPOSCOD,this.BPYCTY,this.BPYSAT,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]CURPRO = "BPYPOSCOD"
Gosub _LNKPRO_BPYPOSCOD
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPYPOSCOD
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYPOSCOD"
$_LNKPRO_BPYPOSCOD
If vireblc(this.BPYPOSCOD,2)<>""
 # Link POSCOD
 Local File POSCOD [WPOS]
 Read [F:WPOS]POS0 = this.BPYCRY;this.BPYPOSCOD;this.BPYCTY;""
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPYPOSCOD","$description",[F:WPOS]POSCTY)
 Endif
 LogicClose File [WPOS]
Endif
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATPOS(this,"BPYPOSCOD",this.BPYPOSCOD,[L]AFORMAT,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("BPYPOSCOD","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 57 : BPYCTY City ( Field CTY 40)
####################################################################

$SET_BPYCTY
If [L]_AOLDVAL<>this.BPYCTY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPYCTY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPYCTY
 Gosub PROPAGATE_BPYCTY
Endif
Return

$INIT_BPYCTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCTY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPYCTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCTY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPYCTY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPYCTY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPYCTY
[L]CURPRO = "BPYCTY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPYCTY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPYCTY
[L]CURPRO = "BPYCTY"
If vireblc(this.BPYCTY,2)<>vireblc(format$("K:40X",this.BPYCTY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPYCTY
[L]CURPRO = "BPYCTY"
[L]ASTATUS =  func ASYRTRTATY.CONTROLCTY(this,"BPYCTY",this.BPYCTY,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPYCTY
[L]CURPRO = "BPYCTY"
Return

$PROPAGATE_BPYCTY
this.isReadonly = 0
[L]ASTATUS =  func ASYRTRTATY.PROPAGATECTY(this,"BPYCTY",this.BPYCTY,this.BPYPOSCOD,this.BPYSAT,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]CURPRO = "BPYCTY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPYCTY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCTY"
$_LNKPRO_BPYCTY
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATCTY(this,"BPYCTY",this.BPYCTY,[L]AFORMAT,this.BPYCRY)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("BPYCTY","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 58 : BPYSAT County ( Field SAT 35)
####################################################################

$SET_BPYSAT
If [L]_AOLDVAL<>this.BPYSAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPYSAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPYSAT
 Gosub PROPAGATE_BPYSAT
Endif
Return

$INIT_BPYSAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYSAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPYSAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYSAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPYSAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPYSAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPYSAT
[L]CURPRO = "BPYSAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPYSAT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPYSAT
[L]CURPRO = "BPYSAT"
If vireblc(this.BPYSAT,2)<>vireblc(format$("K:35X",this.BPYSAT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPYSAT
[L]CURPRO = "BPYSAT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLSAT(this,"BPYSAT",this.BPYSAT,this.BPYCRY,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPYSAT
[L]CURPRO = "BPYSAT"
Return

$PROPAGATE_BPYSAT
this.isReadonly = 0
[L]CURPRO = "BPYSAT"
Gosub _LNKPRO_BPYSAT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPYSAT
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYSAT"
$_LNKPRO_BPYSAT
If vireblc(this.BPYSAT,2)<>""
 # Link TABSUBDIV
 Local File TABSUBDIV [WATU]
 Read [F:WATU]ATU0 = this.BPYCRY;AVOID.ALIB;this.BPYSAT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABSUBDIV" & ZONE="INTIT" & IDENT1=[F:WATU]CRYTYP & IDENT2=[F:WATU]COD & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BPYSAT","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABSUBDIV" & ZONE="INTIT" & IDENT1=[F:WATU]CRYTYP & IDENT2=[F:WATU]COD & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BPYSAT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WATU]
Endif
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATSAT(this,"BPYSAT",this.BPYSAT,[L]AFORMAT,this.BPYCRY,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("BPYSAT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 59 : BPYCRY Country ( Field CRY 3)
####################################################################

$SET_BPYCRY
If [L]_AOLDVAL<>this.BPYCRY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPYCRY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPYCRY
 Gosub PROPAGATE_BPYCRY
Endif
Return

$INIT_BPYCRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPYCRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPYCRY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPYCRY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPYCRY
[L]CURPRO = "BPYCRY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPYCRY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPYCRY
[L]CURPRO = "BPYCRY"
If vireblc(this.BPYCRY,2)<>vireblc(format$("K:3c",this.BPYCRY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPYCRY
[L]CURPRO = "BPYCRY"
If vireblc(this.BPYCRY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCRY.ACTRLREF(this,"BPYCRY",this.BPYCRY,this.BPYCRY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPYCRY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPYCRY
[L]CURPRO = "BPYCRY"
Return

$PROPAGATE_BPYCRY
this.isReadonly = 0
[L]CURPRO = "BPYCRY"
Gosub _LNKPRO_BPYCRY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPYCRY
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRY"
$_LNKPRO_BPYCRY
If vireblc(this.BPYCRY,2)<>""
 # Link TABCOUNTRY
 Local File TABCOUNTRY [WTCY]
 Read [F:WTCY]TCY0 = this.BPYCRY
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCOUNTRY" & ZONE="CRYDES" & IDENT1=[F:WTCY]CRY & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BPYCRY","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCOUNTRY" & ZONE="CRYDES" & IDENT1=[F:WTCY]CRY & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BPYCRY","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTCY]
Endif
Return


####################################################################
# 60 : BPYCRYNAM Country name ( Field NCY 40)
####################################################################

$SET_BPYCRYNAM
If [L]_AOLDVAL<>this.BPYCRYNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPYCRYNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPYCRYNAM
 Gosub PROPAGATE_BPYCRYNAM
Endif
Return

$INIT_BPYCRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRYNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPYCRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRYNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPYCRYNAM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPYCRYNAM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPYCRYNAM
[L]CURPRO = "BPYCRYNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPYCRYNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPYCRYNAM
[L]CURPRO = "BPYCRYNAM"
If vireblc(this.BPYCRYNAM,2)<>vireblc(format$("K:40X",this.BPYCRYNAM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPYCRYNAM
[L]CURPRO = "BPYCRYNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPYCRYNAM
[L]CURPRO = "BPYCRYNAM"
Return

$PROPAGATE_BPYCRYNAM
this.isReadonly = 0
[L]CURPRO = "BPYCRYNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPYCRYNAM
Gosub DECLARE_VAR From WMC0PINVOICE
[L]CURPRO = "BPYCRYNAM"
$_LNKPRO_BPYCRYNAM
Return




