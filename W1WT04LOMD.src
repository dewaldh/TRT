#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WT04LOMD 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:28:27"
A_USER  = "ADMIN"
A_STAMP = "20180828002827"
Return

$TITRES
Chgtzn [M:SUD1]USRFLD1 With mess(1,726,1)
Chgtzn [M:SUD1]USRFLD2 With mess(2,726,1)
Chgtzn [M:SUD1]USRFLD3 With mess(3,726,1)
Chgtzn [M:SUD1]USRFLD4 With mess(4,726,1)
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WT04LOMD [SUD1]
Gosub HORODAT
Local Inpbox "WT04LOMD" From GFONCTION At A_STAMP With A_WINDPREV Mask [SUD1] As [SIM_]
Grizo [SUD1]5
Grizo [SUD1]15
Grizo [SUD1]20
Grizo [SUD1]25
Grizo [SUD1]30
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [SUD1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=3 : X2(0)=109 : Y1(0)=3 : Y2(0)=4
X1(1)=3 : X2(1)=109 : Y1(1)=5 : Y2(1)=8
X1(2)=3 : X2(2)=109 : Y1(2)=9 : Y2(2)=11
X1(3)=3 : X2(3)=67 : Y1(3)=12 : Y2(3)=26
X1(4)=68 : X2(4)=109 : Y1(4)=12 : Y2(4)=26
Return

$ON_ALLSTOFCY
Onevent AFTER_CHANGE Gosub AMM_ALLSTOFCY From W1WT04LOMD
Onevent INIT_AREA Call D_ALLSTOFCY(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_ALLSTOFCY(zc) From W1WT04LOMD
Return

Subprog D_ALLSTOFCY(VALEUR)
Variable Integer VALEUR
If varinit([M]ALLSTOFCY,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_ALLSTOFCY(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_ALLSTOFCY
Call AM_ALLSTOFCY(zc)
If !mkstat & GOBJET
 zoncou = "ALLSTOFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ALLSTOFCY(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_ALLSTOFCY(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "ALLSTOFCY" : GZNUM = 6053 : Endif
Gosub _AFF
End

$ON_STOFCY
Onevent CONTROL Call C_STOFCY(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_STOFCY(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_STOFCY From W1WT04LOMD
Onevent INIT_AREA Call D_STOFCY(zc) From W1WT04LOMD
Return

Subprog D_STOFCY(VALEUR)
Variable Char    VALEUR()
If varinit([M]STOFCY,indice)=0
 VALEUR = GFCYDEF(7)
Endif
Gosub _AFF
End

Subprog AS_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STOFCY(zc) From W1WT04LOMD
Onkey   2 Titled GBOUTS Call S_STOFCY(zc) From W1WT04LOMD
Onkey 144 Titled GBOUTP Call P_STOFCY(zc) From W1WT04LOMD
Onkey 146 Titled GBOUTA Call SA_STOFCY(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_STOFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
 If !mkstat
  ## Action STD
  Call C_STOFCY(VALEUR) From FUNSMXUPD
  If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_STOFCY
Call AM_STOFCY(zc)
If !mkstat & GOBJET
 zoncou = "STOFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STOFCY(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSTOFCY)")>indice
 [M]STOFCY(indice) = VALEUR
 Affzo ZSTOFCY(indice)
Endif
Gosub _AFF
End

Subprog S_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_STOFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_STOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSTOFCY
Onevent BEFORE_AREA Gosub AV_ZSTOFCY From W1WT04LOMD
Return

$AV_ZSTOFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]STOFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_ITMREFSTR
Onevent CONTROL Call C_ITMREFSTR(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_ITMREFSTR From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_ITMREFSTR(zc) From W1WT04LOMD
Return

Subprog IB_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFSTR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_ITMREFSTR(zc) From W1WT04LOMD
Onkey 170 Titled GBOUT13 Call B13_ITMREFSTR(zc) From W1WT04LOMD
Onkey   2 Titled GBOUTS Call S_ITMREFSTR(zc) From W1WT04LOMD
Onkey 144 Titled GBOUTP Call P_ITMREFSTR(zc) From W1WT04LOMD
Onkey 146 Titled GBOUTA Call SA_ITMREFSTR(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 12930 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 12930 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!I",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 12930 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREFSTR(VALEUR) From FUNSMXUPD
   If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 12930 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFSTR
Call AM_ITMREFSTR(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFSTR(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 12930 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFSTR)")>indice
 [M]ITMREFSTR(indice) = VALEUR
 Affzo ZITMREFSTR(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]STOFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = "234"
 PARMSK(5) = "234"
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFSTR
Onevent BEFORE_AREA Gosub AV_ZITMREFSTR From W1WT04LOMD
Return

$AV_ZITMREFSTR
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFSTR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ITMREFEND
Onevent CONTROL Call C_ITMREFEND(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_ITMREFEND(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_ITMREFEND From W1WT04LOMD
Return

Subprog IB_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFEND(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_ITMREFEND(zc) From W1WT04LOMD
Onkey 170 Titled GBOUT13 Call B13_ITMREFEND(zc) From W1WT04LOMD
Onkey   2 Titled GBOUTS Call S_ITMREFEND(zc) From W1WT04LOMD
Onkey 144 Titled GBOUTP Call P_ITMREFEND(zc) From W1WT04LOMD
Onkey 146 Titled GBOUTA Call SA_ITMREFEND(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 12931 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 12931 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!I",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 12931 : Endif
  If !mkstat
   ## Action CTLALPVALW
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "CTLALPVALW"
   PARMSK(1) = [M]ITMREFSTR
   Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 12931 : Endif
   If !mkstat
    ## Action STD
    Call C_ITMREFEND(VALEUR) From FUNSMXUPD
    If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 12931 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFEND
Call AM_ITMREFEND(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFEND)")>indice
 [M]ITMREFEND(indice) = VALEUR
 Affzo ZITMREFEND(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]STOFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = "234"
 PARMSK(5) = "234"
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B13_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFEND
Onevent BEFORE_AREA Gosub AV_ZITMREFEND From W1WT04LOMD
Return

$AV_ZITMREFEND
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFEND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_LOTSTR
Onevent AFTER_CHANGE Gosub AMM_LOTSTR From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_LOTSTR(zc) From W1WT04LOMD
Return

Subprog AS_LOTSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_LOTSTR(zc) From W1WT04LOMD
Gosub _AFF
End

$AMM_LOTSTR
Call AM_LOTSTR(zc)
If !mkstat & GOBJET
 zoncou = "LOTSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LOTSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LOTSTR(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "LOTSTR" : GZNUM = 1552 : Endif
Gosub _AFF
End

Subprog S_LOTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELLOTM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELLOTM"
 PARMSK(1) = [M]ITMREFSTR
 PARMSK(2) = [M]ITMREFEND
 PARMSK(3) = string$([M]ALLSTOFCY<>2,[M]STOFCY)
 PARMSK(4) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELLOTM","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_LOTEND
Onevent CONTROL Call C_LOTEND(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_LOTEND(zc) From W1WT04LOMD
Return

Subprog AS_LOTEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_LOTEND(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_LOTEND(VALEUR)
Variable Char    VALEUR()
## Action CTLALPVALW
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CTLALPVALW"
PARMSK(1) = [M]LOTSTR
Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "LOTEND" : GZNUM = 1555 : Endif
If !mkstat
 ## Action STD
 Call C_LOTEND(VALEUR) From FUNSMXUPD
 If mkstat : GERR = 1 : GZONE = "LOTEND" : GZNUM = 1555 : Endif
Endif
Gosub _AFF
End

Subprog S_LOTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELLOTM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELLOTM"
 PARMSK(1) = [M]ITMREFSTR
 PARMSK(2) = [M]ITMREFEND
 PARMSK(3) = string$([M]ALLSTOFCY<>2,[M]STOFCY)
 PARMSK(4) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELLOTM","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_SLOSTR
Onevent AFTER_CHANGE Gosub AMM_SLOSTR From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_SLOSTR(zc) From W1WT04LOMD
Return

Subprog AS_SLOSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_SLOSTR(zc) From W1WT04LOMD
Gosub _AFF
End

$AMM_SLOSTR
Call AM_SLOSTR(zc)
If !mkstat & GOBJET
 zoncou = "SLOSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SLOSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SLOSTR(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SLOSTR" : GZNUM = 54762 : Endif
Gosub _AFF
End

Subprog S_SLOSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSLOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSLOM"
 PARMSK(1) = [M]ITMREFSTR
 PARMSK(2) = [M]ITMREFEND
 PARMSK(3) = [M]LOTSTR
 PARMSK(4) = [M]LOTEND
 PARMSK(5) = string$([M]ALLSTOFCY<>2,[M]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSLOM","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_SLOEND
Onevent CONTROL Call C_SLOEND(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_SLOEND(zc) From W1WT04LOMD
Return

Subprog AS_SLOEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_SLOEND(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_SLOEND(VALEUR)
Variable Char    VALEUR()
## Action CTLALPVALW
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CTLALPVALW"
PARMSK(1) = [M]SLOSTR
Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "SLOEND" : GZNUM = 54763 : Endif
Gosub _AFF
End

Subprog S_SLOEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSLOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSLOM"
 PARMSK(1) = [M]ITMREFSTR
 PARMSK(2) = [M]ITMREFEND
 PARMSK(3) = [M]LOTSTR
 PARMSK(4) = [M]LOTEND
 PARMSK(5) = string$([M]ALLSTOFCY<>2,[M]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSLOM","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_IPTDAT
Onevent CONTROL Call C_IPTDAT(zc) From W1WT04LOMD
Onevent INIT_AREA Call D_IPTDAT(zc) From W1WT04LOMD
Onevent BEFORE_AREA Gosub AV_IPTDAT From W1WT04LOMD
Return

$AV_IPTDAT
Chgfmt [M]IPTDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog D_IPTDAT(VALEUR)
Variable Date    VALEUR
If varinit([M]IPTDAT,indice)=0
 VALEUR = date$
Endif
Gosub _AFF
End

Subprog C_IPTDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_IPTDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 3205 : Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1WT04LOMD
Onevent CONTROL Call C_PJT(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_PJT From W1WT04LOMD
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1WT04LOMD
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1WT04LOMD
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1WT04LOMD
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1WT04LOMD
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1WT04LOMD
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1WT04LOMD
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1WT04LOMD
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1WT04LOMD
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1WT04LOMD
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1WT04LOMD
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1WT04LOMD
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"SUD1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SUD1]STOFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "SUD1"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:SUD1]STOFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:SUD1]STOFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_TRSFAM
Onevent INIT_AREA Call D_TRSFAM(zc) From W1WT04LOMD
Onevent CONTROL Call C_TRSFAM(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_TRSFAM(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_TRSFAM From W1WT04LOMD
Return

Subprog D_TRSFAM(VALEUR)
Variable Char    VALEUR()
If varinit([M]TRSFAM,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"9","") From SUBADI
Endif
Gosub _AFF
End

Subprog AS_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TITADI(GBOUT1,"9") From TRTDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_TRSFAM(zc) From W1WT04LOMD
Onkey   2 Titled GBOUTS Call S_TRSFAM(zc) From W1WT04LOMD
Onkey 144 Titled GBOUTP Call P_TRSFAM(zc) From W1WT04LOMD
Onkey 146 Titled GBOUTA Call SA_TRSFAM(zc) From W1WT04LOMD
Gosub _AFF
End

Subprog C_TRSFAM(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"9","") From SUBADI
If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 17501 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"9",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 17501 : Endif
Endif
Gosub _AFF
End

$AMM_TRSFAM
Call AM_TRSFAM(zc)
If !mkstat & GOBJET
 zoncou = "TRSFAM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_TRSFAM(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZTRSFAM)")>indice
 [M]TRSFAM(indice) = VALEUR
 Affzo ZTRSFAM(indice)
Endif
Gosub _AFF
End

Subprog S_TRSFAM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "9"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_TRSFAM(VALEUR)
Variable Char    VALEUR()
Call OBJET("ADI",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog SA_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_TRSFAM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZTRSFAM
Onevent BEFORE_AREA Gosub AV_ZTRSFAM From W1WT04LOMD
Return

$AV_ZTRSFAM
Call LECTEXTRA(zc,"ATABDIV","SHODES","9",num$([M]TRSFAM(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_ECCVALMAJ
Return

$ON_ECCSTA
Onevent INIT_AREA Call D_ECCSTA(zc) From W1WT04LOMD
Return

Subprog D_ECCSTA(VALEUR)
Variable Integer VALEUR
If varinit([M]ECCSTA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_ECCVALMIN
Return

$ON_BPSLOT
Onevent AFTER_CHANGE Gosub AMM_BPSLOT From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_BPSLOT(zc) From W1WT04LOMD
Return

Subprog AS_BPSLOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_BPSLOT(zc) From W1WT04LOMD
Gosub _AFF
End

$AMM_BPSLOT
Call AM_BPSLOT(zc)
If !mkstat & GOBJET
 zoncou = "BPSLOT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPSLOT(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BPSLOT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "BPSLOT" : GZNUM = 5115 : Endif
Gosub _AFF
End

Subprog S_BPSLOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELBPLN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELBPLN"
 PARMSK(1) = [M:SUD1]STOFCY
 PARMSK(2) = [M:SUD1]ITMREFSTR
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELBPLN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_REFPER
Onevent CONTROL Call C_REFPER(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_REFPER From W1WT04LOMD
Onevent BEFORE_AREA Gosub AV_REFPER From W1WT04LOMD
Return

$AV_REFPER
Chgfmt [M]REFPER(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_REFPER(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_REFPER(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "REFPER" : GZNUM = 5282 : Endif
Gosub _AFF
End

$AMM_REFPER
Call AM_REFPER(zc)
If !mkstat & GOBJET
 zoncou = "REFPER" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_REFPER(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_REFPER(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "REFPER" : GZNUM = 5282 : Endif
Gosub _AFF
End

$ON_SHL
Onevent AFTER_CHANGE Gosub AMM_SHL From W1WT04LOMD
Return

$AMM_SHL
Call AM_SHL(zc)
If !mkstat & GOBJET
 zoncou = "SHL" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SHL(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_SHL(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHL" : GZNUM = 2123 : Endif
Gosub _AFF
End

$ON_SHLUOM
Onevent AFTER_CHANGE Gosub AMM_SHLUOM From W1WT04LOMD
Onevent INIT_AREA Call D_SHLUOM(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_SHLUOM(zc) From W1WT04LOMD
Return

Subprog D_SHLUOM(VALEUR)
Variable Integer VALEUR
If varinit([M]SHLUOM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SHLUOM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_SHLUOM
Call AM_SHLUOM(zc)
If !mkstat & GOBJET
 zoncou = "SHLUOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SHLUOM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_SHLUOM(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHLUOM" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_SHLDAT
Onevent CONTROL Call C_SHLDAT(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_SHLDAT From W1WT04LOMD
Onevent BEFORE_AREA Gosub AV_SHLDAT From W1WT04LOMD
Return

$AV_SHLDAT
Chgfmt [M]SHLDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_SHLDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_SHLDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHLDAT" : GZNUM = 4958 : Endif
Gosub _AFF
End

$AMM_SHLDAT
Call AM_SHLDAT(zc)
If !mkstat & GOBJET
 zoncou = "SHLDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SHLDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_SHLDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHLDAT" : GZNUM = 4958 : Endif
Gosub _AFF
End

$ON_DLU
Onevent CONTROL Call C_DLU(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_DLU From W1WT04LOMD
Return

Subprog C_DLU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_DLU(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "DLU" : GZNUM = 33614 : Endif
Gosub _AFF
End

$AMM_DLU
Call AM_DLU(zc)
If !mkstat & GOBJET
 zoncou = "DLU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_DLU(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "DLU" : GZNUM = 33614 : Endif
Gosub _AFF
End

$ON_DLULTIUOM
Onevent INIT_AREA Call D_DLULTIUOM(zc) From W1WT04LOMD
Return

Subprog D_DLULTIUOM(VALEUR)
Variable Integer VALEUR
If varinit([M]DLULTIUOM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_DLUDAT
Onevent CONTROL Call C_DLUDAT(zc) From W1WT04LOMD
Onevent AFTER_CHANGE Gosub AMM_DLUDAT From W1WT04LOMD
Onevent BEFORE_AREA Gosub AV_DLUDAT From W1WT04LOMD
Return

$AV_DLUDAT
Chgfmt [M]DLUDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_DLUDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_DLUDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "DLUDAT" : GZNUM = 33633 : Endif
Gosub _AFF
End

$AMM_DLUDAT
Call AM_DLUDAT(zc)
If !mkstat & GOBJET
 zoncou = "DLUDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DLUDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_DLUDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "DLUDAT" : GZNUM = 33633 : Endif
Gosub _AFF
End

$ON_SHLLTI
Onevent AFTER_CHANGE Gosub AMM_SHLLTI From W1WT04LOMD
Return

$AMM_SHLLTI
Call AM_SHLLTI(zc)
If !mkstat & GOBJET
 zoncou = "SHLLTI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SHLLTI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_SHLLTI(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHLLTI" : GZNUM = 17814 : Endif
Gosub _AFF
End

$ON_SHLLTIUOM
Onevent AFTER_CHANGE Gosub AMM_SHLLTIUOM From W1WT04LOMD
Onevent INIT_AREA Call D_SHLLTIUOM(zc) From W1WT04LOMD
Onevent BEFORE_INPUT Call AS_SHLLTIUOM(zc) From W1WT04LOMD
Return

Subprog D_SHLLTIUOM(VALEUR)
Variable Integer VALEUR
If varinit([M]SHLLTIUOM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SHLLTIUOM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_SHLLTIUOM
Call AM_SHLLTIUOM(zc)
If !mkstat & GOBJET
 zoncou = "SHLLTIUOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SHLLTIUOM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_SHLLTIUOM(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "SHLLTIUOM" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_NEWLTIDAT
Onevent CONTROL Call C_NEWLTIDAT(zc) From W1WT04LOMD
Onevent BEFORE_AREA Gosub AV_NEWLTIDAT From W1WT04LOMD
Return

$AV_NEWLTIDAT
Chgfmt [M]NEWLTIDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_NEWLTIDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_NEWLTIDAT(VALEUR) From FUNSMXUPD
If mkstat : GERR = 1 : GZONE = "NEWLTIDAT" : GZNUM = 33631 : Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2WT04LOMD
Return

$TIT_COL
Gosub TIT_COL From W2WT04LOMD
Return


