#<AdxTL>@(#)0.0.0.0 $Revision$Class Mass mailing
# Supervisor
## ACLA-CLASSE ## MAILING
# 2018-08-27 12:36:13 634


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : OMMNUM Mail code ( Field VCR 20)
####################################################################

$SET_OMMNUM
If [L]_AOLDVAL<>this.OMMNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OMMNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OMMNUM
 Gosub PROPAGATE_OMMNUM
Endif
Return

$INIT_OMMNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OMMNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OMMNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OMMNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OMMNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OMMNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OMMNUM
[L]CURPRO = "OMMNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OMMNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OMMNUM
[L]CURPRO = "OMMNUM"
If vireblc(this.OMMNUM,2)<>vireblc(format$("K:20X",this.OMMNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OMMNUM
[L]CURPRO = "OMMNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OMMNUM
[L]CURPRO = "OMMNUM"
Return

$PROPAGATE_OMMNUM
this.isReadonly = 0
[L]CURPRO = "OMMNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OMMNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OMMNUM"
$_LNKPRO_OMMNUM
Return


####################################################################
# 2 : FCY Site ( Field FCY 5)
####################################################################

$SET_FCY
If [L]_AOLDVAL<>this.FCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_FCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.FCY
 Gosub PROPAGATE_FCY
Endif
Return

$INIT_FCY
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "FCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_FCY
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "FCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_FCY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_FCY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_FCY
[L]CURPRO = "FCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.FCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_FCY
[L]CURPRO = "FCY"
If vireblc(this.FCY,2)<>vireblc(format$("K:5c",this.FCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_FCY
[L]CURPRO = "FCY"
If vireblc(this.FCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"FCY",this.FCY,this.FCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.FCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_FCY
[L]CURPRO = "FCY"
Return

$PROPAGATE_FCY
this.isReadonly = 0
[L]CURPRO = "FCY"
Gosub _LNKPRO_FCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_FCY
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "FCY"
$_LNKPRO_FCY
If vireblc(this.FCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.FCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("FCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("FCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return


####################################################################
# 3 : CMGNUM Campaign code ( Field CMG 20)
####################################################################

$SET_CMGNUM
If [L]_AOLDVAL<>this.CMGNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CMGNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CMGNUM
 Gosub PROPAGATE_CMGNUM
Endif
Return

$INIT_CMGNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CMGNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CMGNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CMGNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CMGNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CMGNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CMGNUM
[L]CURPRO = "CMGNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CMGNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CMGNUM
[L]CURPRO = "CMGNUM"
If vireblc(this.CMGNUM,2)<>vireblc(format$("K:20X",this.CMGNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CMGNUM
[L]CURPRO = "CMGNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CMGNUM
[L]CURPRO = "CMGNUM"
Return

$PROPAGATE_CMGNUM
this.isReadonly = 0
[L]CURPRO = "CMGNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CMGNUM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CMGNUM"
$_LNKPRO_CMGNUM
Return


####################################################################
# 4 : DES Description ( Field DCO 60)
####################################################################

$SET_DES
If [L]_AOLDVAL<>this.DES
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DES
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DES
 Gosub PROPAGATE_DES
Endif
Return

$INIT_DES
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DES"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DES
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DES"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DES                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DES                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DES
[L]CURPRO = "DES"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DES,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DES
[L]CURPRO = "DES"
If vireblc(this.DES,2)<>vireblc(format$("K:60X",this.DES),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DES
[L]CURPRO = "DES"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DES
[L]CURPRO = "DES"
Return

$PROPAGATE_DES
this.isReadonly = 0
[L]CURPRO = "DES"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DES
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DES"
$_LNKPRO_DES
Return


####################################################################
# 5 : OBJ Objective ( Field CLX 250)
####################################################################

$SET_OBJ
If [L]_AOLDVAL<>this.OBJ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OBJ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OBJ
 Gosub PROPAGATE_OBJ
Endif
Return

$INIT_OBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OBJ                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OBJ                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OBJ
[L]CURPRO = "OBJ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.OBJ,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OBJ
[L]CURPRO = "OBJ"
If vireblc(this.OBJ,2)<>vireblc(format$("K:250X",this.OBJ),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_OBJ
[L]CURPRO = "OBJ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OBJ
[L]CURPRO = "OBJ"
Return

$PROPAGATE_OBJ
this.isReadonly = 0
[L]CURPRO = "OBJ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJ"
$_LNKPRO_OBJ
Return


####################################################################
# 6 : TYPFULOBJ Type text file ( Field CLT 10)
####################################################################

$SET_TYPFULOBJ
If [L]_AOLDVAL<>this.TYPFULOBJ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TYPFULOBJ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TYPFULOBJ
 Gosub PROPAGATE_TYPFULOBJ
Endif
Return

$INIT_TYPFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPFULOBJ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TYPFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPFULOBJ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TYPFULOBJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TYPFULOBJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TYPFULOBJ
[L]CURPRO = "TYPFULOBJ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TYPFULOBJ,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TYPFULOBJ
[L]CURPRO = "TYPFULOBJ"
If vireblc(this.TYPFULOBJ,2)<>vireblc(format$("K:10X",this.TYPFULOBJ),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TYPFULOBJ
[L]CURPRO = "TYPFULOBJ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TYPFULOBJ
[L]CURPRO = "TYPFULOBJ"
Return

$PROPAGATE_TYPFULOBJ
this.isReadonly = 0
[L]CURPRO = "TYPFULOBJ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TYPFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPFULOBJ"
$_LNKPRO_TYPFULOBJ
Return


####################################################################
# 7 : NUMFULOBJ Chrono txt file ( Field CLC 30)
####################################################################

$SET_NUMFULOBJ
If [L]_AOLDVAL<>this.NUMFULOBJ
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NUMFULOBJ
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NUMFULOBJ
 Gosub PROPAGATE_NUMFULOBJ
Endif
Return

$INIT_NUMFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NUMFULOBJ"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_NUMFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NUMFULOBJ"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NUMFULOBJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NUMFULOBJ             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NUMFULOBJ
[L]CURPRO = "NUMFULOBJ"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.NUMFULOBJ,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NUMFULOBJ
[L]CURPRO = "NUMFULOBJ"
If vireblc(this.NUMFULOBJ,2)<>vireblc(format$("K:30X",this.NUMFULOBJ),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_NUMFULOBJ
[L]CURPRO = "NUMFULOBJ"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NUMFULOBJ
[L]CURPRO = "NUMFULOBJ"
Return

$PROPAGATE_NUMFULOBJ
this.isReadonly = 0
[L]CURPRO = "NUMFULOBJ"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NUMFULOBJ
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NUMFULOBJ"
$_LNKPRO_NUMFULOBJ
Return


####################################################################
# 8 : OBJFLG Flag text file ( Field C 2)
####################################################################

$SET_OBJFLG
If [L]_AOLDVAL<>this.OBJFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OBJFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OBJFLG
 Gosub PROPAGATE_OBJFLG
Endif
Return

$INIT_OBJFLG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_OBJFLG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OBJFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OBJFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OBJFLG
[L]CURPRO = "OBJFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OBJFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OBJFLG
[L]CURPRO = "OBJFLG"
Return

$_AOTHERS_OBJFLG
[L]CURPRO = "OBJFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OBJFLG
[L]CURPRO = "OBJFLG"
Return

$PROPAGATE_OBJFLG
this.isReadonly = 0
[L]CURPRO = "OBJFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OBJFLG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "OBJFLG"
$_LNKPRO_OBJFLG
Return


####################################################################
# 9 : BUD Established budget ( Field MD1 0)
####################################################################

$SET_BUD
If [L]_AOLDVAL<>this.BUD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BUD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BUD
 Gosub PROPAGATE_BUD
Endif
Return

$INIT_BUD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "BUD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BUD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "BUD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BUD                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BUD                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BUD
[L]CURPRO = "BUD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BUD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BUD
[L]CURPRO = "BUD"
Return

$_AOTHERS_BUD
[L]CURPRO = "BUD"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"BUD",this.BUD,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BUD
[L]CURPRO = "BUD"
Return

$PROPAGATE_BUD
this.isReadonly = 0
[L]CURPRO = "BUD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BUD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "BUD"
$_LNKPRO_BUD
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"BUD",this.BUD,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("BUD","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 10 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return


####################################################################
# 11 : SHIDAT Ship date ( Field D)
####################################################################

$SET_SHIDAT
If [L]_AOLDVAL<>this.SHIDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SHIDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SHIDAT
 Gosub PROPAGATE_SHIDAT
Endif
Return

$INIT_SHIDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SHIDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SHIDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SHIDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SHIDAT
[L]CURPRO = "SHIDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SHIDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SHIDAT
[L]CURPRO = "SHIDAT"
Return

$_AOTHERS_SHIDAT
[L]CURPRO = "SHIDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SHIDAT
[L]CURPRO = "SHIDAT"
Return

$PROPAGATE_SHIDAT
this.isReadonly = 0
[L]CURPRO = "SHIDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SHIDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIDAT"
$_LNKPRO_SHIDAT
Return


####################################################################
# 12 : SHISTA Shipment status ( Field Local menu number 968)
####################################################################

$SET_SHISTA
If [L]_AOLDVAL<>this.SHISTA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SHISTA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SHISTA
 Gosub PROPAGATE_SHISTA
Endif
Return

$INIT_SHISTA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHISTA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.SHISTA=0 and fmet this.AGETATTRIBUTE("SHISTA","$isMandatory")="true"
 this.SHISTA = 1
Endif
Return
 
$CONTROL_SHISTA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHISTA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SHISTA                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SHISTA                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SHISTA
[L]CURPRO = "SHISTA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SHISTA=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SHISTA
[L]CURPRO = "SHISTA"
If this.SHISTA<0 or this.SHISTA>len(mess(0,968,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"968 ->"-num$(this.SHISTA)-mess(99,123,1)):  Return : # Local menu "968 -> Invalid option
Endif
Return

$_AOTHERS_SHISTA
[L]CURPRO = "SHISTA"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SHISTA
[L]CURPRO = "SHISTA"
Return

$PROPAGATE_SHISTA
this.isReadonly = 0
[L]CURPRO = "SHISTA"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SHISTA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHISTA"
$_LNKPRO_SHISTA
Return


####################################################################
# 13 : SHIMOD Shipment method ( Field Local menu number 963)
####################################################################

$SET_SHIMOD
If [L]_AOLDVAL<>this.SHIMOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SHIMOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SHIMOD
 Gosub PROPAGATE_SHIMOD
Endif
Return

$INIT_SHIMOD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIMOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.SHIMOD=0 and fmet this.AGETATTRIBUTE("SHIMOD","$isMandatory")="true"
 this.SHIMOD = 1
Endif
Return
 
$CONTROL_SHIMOD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIMOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SHIMOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SHIMOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SHIMOD
[L]CURPRO = "SHIMOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.SHIMOD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SHIMOD
[L]CURPRO = "SHIMOD"
If this.SHIMOD<0 or this.SHIMOD>len(mess(0,963,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"963 ->"-num$(this.SHIMOD)-mess(99,123,1)):  Return : # Local menu "963 -> Invalid option
Endif
Return

$_AOTHERS_SHIMOD
[L]CURPRO = "SHIMOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SHIMOD
[L]CURPRO = "SHIMOD"
Return

$PROPAGATE_SHIMOD
this.isReadonly = 0
[L]CURPRO = "SHIMOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SHIMOD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "SHIMOD"
$_LNKPRO_SHIMOD
Return


####################################################################
# 14 : NBQSND Number of mailings ( Field L 8)
####################################################################

$SET_NBQSND
If [L]_AOLDVAL<>this.NBQSND
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NBQSND
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NBQSND
 Gosub PROPAGATE_NBQSND
Endif
Return

$INIT_NBQSND
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NBQSND"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_NBQSND
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NBQSND"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NBQSND                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NBQSND                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NBQSND
[L]CURPRO = "NBQSND"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.NBQSND=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NBQSND
[L]CURPRO = "NBQSND"
Return

$_AOTHERS_NBQSND
[L]CURPRO = "NBQSND"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NBQSND
[L]CURPRO = "NBQSND"
Return

$PROPAGATE_NBQSND
this.isReadonly = 0
[L]CURPRO = "NBQSND"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NBQSND
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "NBQSND"
$_LNKPRO_NBQSND
Return


####################################################################
# 15 : EMAOBC E-mail object ( Field A 90)
####################################################################

$SET_EMAOBC
If [L]_AOLDVAL<>this.EMAOBC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EMAOBC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EMAOBC
 Gosub PROPAGATE_EMAOBC
Endif
Return

$INIT_EMAOBC
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMAOBC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EMAOBC
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMAOBC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EMAOBC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EMAOBC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EMAOBC
[L]CURPRO = "EMAOBC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.EMAOBC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EMAOBC
[L]CURPRO = "EMAOBC"
Return

$_AOTHERS_EMAOBC
[L]CURPRO = "EMAOBC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EMAOBC
[L]CURPRO = "EMAOBC"
Return

$PROPAGATE_EMAOBC
this.isReadonly = 0
[L]CURPRO = "EMAOBC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EMAOBC
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMAOBC"
$_LNKPRO_EMAOBC
Return


####################################################################
# 16 : EMATEX E-mail text ( Field CLX 250)
####################################################################

$SET_EMATEX
If [L]_AOLDVAL<>this.EMATEX
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EMATEX
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EMATEX
 Gosub PROPAGATE_EMATEX
Endif
Return

$INIT_EMATEX
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMATEX"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EMATEX
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMATEX"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EMATEX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EMATEX                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EMATEX
[L]CURPRO = "EMATEX"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.EMATEX,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EMATEX
[L]CURPRO = "EMATEX"
If vireblc(this.EMATEX,2)<>vireblc(format$("K:250X",this.EMATEX),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_EMATEX
[L]CURPRO = "EMATEX"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EMATEX
[L]CURPRO = "EMATEX"
Return

$PROPAGATE_EMATEX
this.isReadonly = 0
[L]CURPRO = "EMATEX"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EMATEX
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "EMATEX"
$_LNKPRO_EMATEX
Return


####################################################################
# 17 : TPL Template ( Field A 50)
####################################################################

$SET_TPL
If [L]_AOLDVAL<>this.TPL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TPL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TPL
 Gosub PROPAGATE_TPL
Endif
Return

$INIT_TPL
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TPL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TPL
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TPL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TPL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TPL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TPL
[L]CURPRO = "TPL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TPL,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TPL
[L]CURPRO = "TPL"
Return

$_AOTHERS_TPL
[L]CURPRO = "TPL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TPL
[L]CURPRO = "TPL"
Return

$PROPAGATE_TPL
this.isReadonly = 0
[L]CURPRO = "TPL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TPL
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TPL"
$_LNKPRO_TPL
Return


####################################################################
# 18 : TYPMRG Merging ( Field Local menu number 2967)
####################################################################

$SET_TYPMRG
If [L]_AOLDVAL<>this.TYPMRG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TYPMRG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TYPMRG
 Gosub PROPAGATE_TYPMRG
Endif
Return

$INIT_TYPMRG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPMRG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TYPMRG=0 and fmet this.AGETATTRIBUTE("TYPMRG","$isMandatory")="true"
 this.TYPMRG = 1
Endif
Return
 
$CONTROL_TYPMRG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPMRG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TYPMRG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TYPMRG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TYPMRG
[L]CURPRO = "TYPMRG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TYPMRG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TYPMRG
[L]CURPRO = "TYPMRG"
If this.TYPMRG<0 or this.TYPMRG>len(mess(0,2967,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"2967 ->"-num$(this.TYPMRG)-mess(99,123,1)):  Return : # Local menu "2967 -> Invalid option
Endif
Return

$_AOTHERS_TYPMRG
[L]CURPRO = "TYPMRG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TYPMRG
[L]CURPRO = "TYPMRG"
Return

$PROPAGATE_TYPMRG
this.isReadonly = 0
[L]CURPRO = "TYPMRG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TYPMRG
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPMRG"
$_LNKPRO_TYPMRG
Return


####################################################################
# 19 : CREHIS Create history ( Field Local menu number 1)
####################################################################

$SET_CREHIS
If [L]_AOLDVAL<>this.CREHIS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREHIS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREHIS
 Gosub PROPAGATE_CREHIS
Endif
Return

$INIT_CREHIS
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREHIS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CREHIS=0 and fmet this.AGETATTRIBUTE("CREHIS","$isMandatory")="true"
 this.CREHIS = 1
Endif
Return
 
$CONTROL_CREHIS
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREHIS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREHIS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREHIS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREHIS
[L]CURPRO = "CREHIS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CREHIS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREHIS
[L]CURPRO = "CREHIS"
If this.CREHIS<0 or this.CREHIS>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.CREHIS)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_CREHIS
[L]CURPRO = "CREHIS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREHIS
[L]CURPRO = "CREHIS"
Return

$PROPAGATE_CREHIS
this.isReadonly = 0
[L]CURPRO = "CREHIS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREHIS
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREHIS"
$_LNKPRO_CREHIS
Return


####################################################################
# 20 : DEFADD Address assignment ( Field Local menu number 965)
####################################################################

$SET_DEFADD
If [L]_AOLDVAL<>this.DEFADD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEFADD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEFADD
 Gosub PROPAGATE_DEFADD
Endif
Return

$INIT_DEFADD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DEFADD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.DEFADD=0 and fmet this.AGETATTRIBUTE("DEFADD","$isMandatory")="true"
 this.DEFADD = 1
Endif
Return
 
$CONTROL_DEFADD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DEFADD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEFADD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEFADD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEFADD
[L]CURPRO = "DEFADD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DEFADD=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEFADD
[L]CURPRO = "DEFADD"
If this.DEFADD<0 or this.DEFADD>len(mess(0,965,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"965 ->"-num$(this.DEFADD)-mess(99,123,1)):  Return : # Local menu "965 -> Invalid option
Endif
Return

$_AOTHERS_DEFADD
[L]CURPRO = "DEFADD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEFADD
[L]CURPRO = "DEFADD"
Return

$PROPAGATE_DEFADD
this.isReadonly = 0
[L]CURPRO = "DEFADD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEFADD
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "DEFADD"
$_LNKPRO_DEFADD
Return


####################################################################
# 21 : HIEBPR Bp/contact empty ( Field Local menu number 1)
####################################################################

$SET_HIEBPR
If [L]_AOLDVAL<>this.HIEBPR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_HIEBPR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.HIEBPR
 Gosub PROPAGATE_HIEBPR
Endif
Return

$INIT_HIEBPR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "HIEBPR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.HIEBPR=0 and fmet this.AGETATTRIBUTE("HIEBPR","$isMandatory")="true"
 this.HIEBPR = 1
Endif
Return
 
$CONTROL_HIEBPR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "HIEBPR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_HIEBPR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_HIEBPR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_HIEBPR
[L]CURPRO = "HIEBPR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.HIEBPR=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_HIEBPR
[L]CURPRO = "HIEBPR"
If this.HIEBPR<0 or this.HIEBPR>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.HIEBPR)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_HIEBPR
[L]CURPRO = "HIEBPR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_HIEBPR
[L]CURPRO = "HIEBPR"
Return

$PROPAGATE_HIEBPR
this.isReadonly = 0
[L]CURPRO = "HIEBPR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_HIEBPR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "HIEBPR"
$_LNKPRO_HIEBPR
Return


####################################################################
# 22 : TYPSEA Sample type ( Field AOB 8)
####################################################################

$SET_TYPSEA
If [L]_AOLDVAL<>this.TYPSEA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TYPSEA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TYPSEA
 Gosub PROPAGATE_TYPSEA
Endif
Return

$INIT_TYPSEA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPSEA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TYPSEA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPSEA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TYPSEA                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TYPSEA                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TYPSEA
[L]CURPRO = "TYPSEA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TYPSEA,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TYPSEA
[L]CURPRO = "TYPSEA"
If vireblc(this.TYPSEA,2)<>vireblc(format$("KTD:8B",this.TYPSEA),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TYPSEA
[L]CURPRO = "TYPSEA"
If vireblc(this.TYPSEA,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPAOB.ACTRLREF(this,"TYPSEA",this.TYPSEA,this.TYPSEA,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.TYPSEA<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TYPSEA
[L]CURPRO = "TYPSEA"
Return

$PROPAGATE_TYPSEA
this.isReadonly = 0
[L]CURPRO = "TYPSEA"
Gosub _LNKPRO_TYPSEA
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TYPSEA
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "TYPSEA"
$_LNKPRO_TYPSEA
If vireblc(this.TYPSEA,2)<>""
 # Link AOBJET
 Local File AOBJET [WAOB]
 Read [F:WAOB]ABREV = this.TYPSEA
 If !fstat
  Local File ATEXTE [WATX]
  For [F:WATX] Where NUMERO=[F:WAOB]LIBSHO & LAN=this.ACTX.LAN
   [L]ASTATUS = fmet this.ASETATTRIBUTE("TYPSEA","$title",[WATX]TEXTE)
  Next WATX
  LogicClose File [WATX]
  Local File ATEXTE [WATX]
  For [F:WATX] Where NUMERO=[F:WAOB]LIBEL & LAN=this.ACTX.LAN
   [L]ASTATUS = fmet this.ASETATTRIBUTE("TYPSEA","$description",[WATX]TEXTE)
  Next WATX
  LogicClose File [WATX]
 Endif
 LogicClose File [WAOB]
Endif
Return


####################################################################
# 23 : CNTTTR Generic title ( Field A 75)
####################################################################

$SET_CNTTTR
If [L]_AOLDVAL<>this.CNTTTR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CNTTTR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CNTTTR
 Gosub PROPAGATE_CNTTTR
Endif
Return

$INIT_CNTTTR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CNTTTR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CNTTTR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CNTTTR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CNTTTR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CNTTTR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CNTTTR
[L]CURPRO = "CNTTTR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CNTTTR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CNTTTR
[L]CURPRO = "CNTTTR"
Return

$_AOTHERS_CNTTTR
[L]CURPRO = "CNTTTR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CNTTTR
[L]CURPRO = "CNTTTR"
Return

$PROPAGATE_CNTTTR
this.isReadonly = 0
[L]CURPRO = "CNTTTR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CNTTTR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CNTTTR"
$_LNKPRO_CNTTTR
Return


####################################################################
# 24 : CLO Closed ( Field Local menu number 1)
####################################################################

$SET_CLO
If [L]_AOLDVAL<>this.CLO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLO
 Gosub PROPAGATE_CLO
Endif
Return

$INIT_CLO
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CLO=0 and fmet this.AGETATTRIBUTE("CLO","$isMandatory")="true"
 this.CLO = 1
Endif
Return
 
$CONTROL_CLO
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLO                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLO                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLO
[L]CURPRO = "CLO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLO=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLO
[L]CURPRO = "CLO"
If this.CLO<0 or this.CLO>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.CLO)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_CLO
[L]CURPRO = "CLO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLO
[L]CURPRO = "CLO"
Return

$PROPAGATE_CLO
this.isReadonly = 0
[L]CURPRO = "CLO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLO
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLO"
$_LNKPRO_CLO
Return


####################################################################
# 25 : CLODAT Closing date ( Field D)
####################################################################

$SET_CLODAT
If [L]_AOLDVAL<>this.CLODAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLODAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLODAT
 Gosub PROPAGATE_CLODAT
Endif
Return

$INIT_CLODAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLODAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CLODAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLODAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLODAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLODAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLODAT
[L]CURPRO = "CLODAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CLODAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLODAT
[L]CURPRO = "CLODAT"
Return

$_AOTHERS_CLODAT
[L]CURPRO = "CLODAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLODAT
[L]CURPRO = "CLODAT"
Return

$PROPAGATE_CLODAT
this.isReadonly = 0
[L]CURPRO = "CLODAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLODAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CLODAT"
$_LNKPRO_CLODAT
Return


####################################################################
# 26 : CREUSR Creation user ( Field A 5)
####################################################################

$SET_CREUSR
If [L]_AOLDVAL<>this.CREUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREUSR
 Gosub PROPAGATE_CREUSR
Endif
Return

$INIT_CREUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CREUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREUSR
[L]CURPRO = "CREUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CREUSR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREUSR
[L]CURPRO = "CREUSR"
Return

$_AOTHERS_CREUSR
[L]CURPRO = "CREUSR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREUSR
[L]CURPRO = "CREUSR"
Return

$PROPAGATE_CREUSR
this.isReadonly = 0
[L]CURPRO = "CREUSR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREUSR"
$_LNKPRO_CREUSR
Return


####################################################################
# 27 : CREDAT Date created ( Field D)
####################################################################

$SET_CREDAT
If [L]_AOLDVAL<>this.CREDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREDAT
 Gosub PROPAGATE_CREDAT
Endif
Return

$INIT_CREDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CREDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREDAT
[L]CURPRO = "CREDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CREDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREDAT
[L]CURPRO = "CREDAT"
Return

$_AOTHERS_CREDAT
[L]CURPRO = "CREDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREDAT
[L]CURPRO = "CREDAT"
Return

$PROPAGATE_CREDAT
this.isReadonly = 0
[L]CURPRO = "CREDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDAT"
$_LNKPRO_CREDAT
Return


####################################################################
# 28 : UPDUSR Change user ( Field A 5)
####################################################################

$SET_UPDUSR
If [L]_AOLDVAL<>this.UPDUSR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_UPDUSR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.UPDUSR
 Gosub PROPAGATE_UPDUSR
Endif
Return

$INIT_UPDUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDUSR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_UPDUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDUSR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_UPDUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_UPDUSR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_UPDUSR
[L]CURPRO = "UPDUSR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.UPDUSR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_UPDUSR
[L]CURPRO = "UPDUSR"
Return

$_AOTHERS_UPDUSR
[L]CURPRO = "UPDUSR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_UPDUSR
[L]CURPRO = "UPDUSR"
Return

$PROPAGATE_UPDUSR
this.isReadonly = 0
[L]CURPRO = "UPDUSR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_UPDUSR
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDUSR"
$_LNKPRO_UPDUSR
Return


####################################################################
# 29 : UPDDAT Change date ( Field D)
####################################################################

$SET_UPDDAT
If [L]_AOLDVAL<>this.UPDDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_UPDDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.UPDDAT
 Gosub PROPAGATE_UPDDAT
Endif
Return

$INIT_UPDDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_UPDDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_UPDDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_UPDDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_UPDDAT
[L]CURPRO = "UPDDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.UPDDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_UPDDAT
[L]CURPRO = "UPDDAT"
Return

$_AOTHERS_UPDDAT
[L]CURPRO = "UPDDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_UPDDAT
[L]CURPRO = "UPDDAT"
Return

$PROPAGATE_UPDDAT
this.isReadonly = 0
[L]CURPRO = "UPDDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_UPDDAT
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "UPDDAT"
$_LNKPRO_UPDDAT
Return


####################################################################
# 30 : CREDATTIM Date time ( Field ADATIM 0)
####################################################################

$SET_CREDATTIM
If [L]_AOLDVAL<>this.CREDATTIM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CREDATTIM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CREDATTIM
 Gosub PROPAGATE_CREDATTIM
Endif
Return

$INIT_CREDATTIM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDATTIM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CREDATTIM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDATTIM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CREDATTIM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CREDATTIM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CREDATTIM
[L]CURPRO = "CREDATTIM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CREDATTIM=AVOID.ADATTIM
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CREDATTIM
[L]CURPRO = "CREDATTIM"
Return

$_AOTHERS_CREDATTIM
[L]CURPRO = "CREDATTIM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CREDATTIM
[L]CURPRO = "CREDATTIM"
Return

$PROPAGATE_CREDATTIM
this.isReadonly = 0
[L]CURPRO = "CREDATTIM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CREDATTIM
Gosub DECLARE_VAR From WMC0MAILING
[L]CURPRO = "CREDATTIM"
$_LNKPRO_CREDATTIM
Return




