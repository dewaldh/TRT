#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management BIC1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [08/03/2019]
A_HEURE = "14:43:34"
A_USER  = "JR"
A_STAMP = "20190308144334"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBRCCE"
  If [M]NBRCCE=0
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask BIC1 [BIC1]
Gosub HORODAT
Local Inpbox "BIC1" From GFONCTION At A_STAMP With A_WINDPREV Mask [BIC1] As [SIM_]
Grizo [BIC1]5
Grizo [BIC1]12
Grizo [BIC1]15
Grizo [BIC1]20
Grizo [BIC1]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [BIC1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=59 : Y1(0)=1 : Y2(0)=10
X1(1)=60 : X2(1)=102 : Y1(1)=1 : Y2(1)=5
X1(2)=60 : X2(2)=102 : Y1(2)=6 : Y2(2)=10
X1(3)=60 : X2(3)=102 : Y1(3)=11 : Y2(3)=22
X1(4)=1 : X2(4)=59 : Y1(4)=11 : Y2(4)=22
Return

$ON_BPRDAT
Onevent INIT_AREA Call D_BPRDAT(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_BPRDAT(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_BPRDAT From W1BIC1
Onevent BEFORE_AREA Gosub AV_BPRDAT From W1BIC1
Return

$AV_BPRDAT
Chgfmt [M]BPRDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog D_BPRDAT(VALEUR)
Variable Date    VALEUR
If varinit([M]BPRDAT,indice)=0
 ## Action STD
 Call D_BPRDAT(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_BPRDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_BPRDAT(VALEUR) From SUBBIC2
If mkstat=2
 [M]BPRDAT(INDIC) = VALEUR
 Affzo BPRDAT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$AMM_BPRDAT
Call AM_BPRDAT(zc)
If !mkstat & GOBJET
 zoncou = "BPRDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_BPRDAT(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "BPRDAT" : GZNUM = 6519 : Endif
Gosub _AFF
End

$ON_BPRVCR
Onevent AFTER_AREA Call AP_BPRVCR(zc) From W1BIC1
Return

Subprog AP_BPRVCR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_BPRVCR(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "BPRVCR" : GZNUM = 6516 : Endif
Gosub _AFF
End

$ON_CUR
Onevent BEFORE_AREA Gosub AV_CUR From W1BIC1
Onevent INIT_AREA Call D_CUR(zc) From W1BIC1
Onevent CONTROL Call C_CUR(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_CUR From W1BIC1
Onevent BEFORE_INPUT Call AS_CUR(zc) From W1BIC1
Return

$AV_CUR
## Action STD
Call AV_CUR(zc) From SUBBIC2
Gosub _AFF
Return

Subprog D_CUR(VALEUR)
Variable Char    VALEUR()
If varinit([M]CUR,indice)=0
 ## Action STD
 Call D_CUR(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_CUR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(17412,GBOUT2) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 130 Titled GBOUT2 Call B2_CUR(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_CUR(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_CUR(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_CUR(zc) From W1BIC1
Gosub _AFF
End

Subprog C_CUR(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "CUR" : GZNUM = 323 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TCU","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CUR" : GZNUM = 323 : Endif
 If !mkstat
  ## Action STD
  Call C_CUR(VALEUR) From SUBBIC2
  If mkstat : GERR = 1 : GZONE = "CUR" : GZNUM = 323 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_CUR
Call AM_CUR(zc)
If !mkstat & GOBJET
 zoncou = "CUR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CUR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CUR(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "CUR" : GZNUM = 323 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZCUR)")>indice
 [M]CUR(indice) = VALEUR
 Affzo ZCUR(indice)
Endif
Gosub _AFF
End

Subprog S_CUR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TCU"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B2_CUR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SAIRATCUR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIRATCUR"
 PARMSK(1) = VALEUR
 PARMSK(2) = [M:BIC0]CPY
 PARMSK(3) = num$([M:BIC1]CURTYP)
 PARMSK(4) = [M:BIC1]RATDAT
 PARMSK(5) = "[M:BIC1]RATMLT"
 PARMSK(6) = "[M:BIC1]RATDIV"
 Call SAISIE_CHAR(VALEUR,PARMSK,"DSAICUR","SUBSCL","SPESCL") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_CUR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TCU"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CUR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TCU",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCUR
Onevent BEFORE_AREA Gosub AV_ZCUR From W1BIC1
Return

$AV_ZCUR
Call LECTEXTRA(zc,"TABCUR","INTSHO",num$([M]CUR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_RAT1
Onevent BEFORE_INPUT Call AS_RAT1(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_RAT1 From W1BIC1
Onevent CONTROL Call C_RAT1(zc) From W1BIC1
Return

Subprog AS_RAT1(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(694,GBOUT2) From OBJDIV
Call TEXTE(17412,GBOUT3) From OBJDIV
If !GWEBSERV
 ## Action ARCUINI
 Call RCUINI(VALEUR,[M:BIC1]CURMLT,[M:BIC1]CURDIV) From AINICOURS
 If mkstat=2
  [M]RAT1(INDIC) = VALEUR
  Affzo RAT1(INDIC) : mkstat = 2
 Endif
Endif
If !mkstat
 ## Action STD
 Call AS_RAT1(VALEUR) From SUBBIC2
 If mkstat=2
  [M]RAT1(INDIC) = VALEUR
  Affzo RAT1(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_RAT1(zc) From W1BIC1
 Onkey 131 Titled GBOUT3 Call B3_RAT1(zc) From W1BIC1
Endif
Gosub _AFF
End

Subprog C_RAT1(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_RAT1
Call AM_RAT1(zc)
If !mkstat & GOBJET
 zoncou = "RAT1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RAT1(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_RAT1(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "RAT1" : GZNUM = 995 : Endif
Gosub _AFF
End

Subprog B2_RAT1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action AINICOURS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "AINICOURS"
 PARMSK(1) = [M:BIC1]CURMLT
 PARMSK(2) = [M:BIC1]CURDIV
 PARMSK(3) = [M:BIC0]CPY
 PARMSK(4) = num$([M:BIC1]CURTYP)
 PARMSK(5) = [M:BIC1]RATDAT
 PARMSK(6) = "2"
 PARMSK(7) = "[M:BIC1]RAT2"
 Call S_AFF_NUM(VALEUR,PARMSK,"AINICOURS","AINICOURS","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_RAT1(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIRATCUR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIRATCUR"
 PARMSK(1) = [M:BIC1]CUR
 PARMSK(2) = [M:BIC0]CPY
 PARMSK(3) = num$([M:BIC1]CURTYP)
 PARMSK(4) = [M:BIC1]RATDAT
 PARMSK(5) = "[M:BIC1]RATMLT"
 PARMSK(6) = "[M:BIC1]RATDIV"
 Call SAISIE_NUM(VALEUR,PARMSK,"DSAICUR","SUBSCL","SPESCL") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CURDIV
Return

$ON_RAT2
Onevent BEFORE_INPUT Call AS_RAT2(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_RAT2 From W1BIC1
Onevent CONTROL Call C_RAT2(zc) From W1BIC1
Return

Subprog AS_RAT2(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(694,GBOUT2) From OBJDIV
Call TEXTE(17412,GBOUT3) From OBJDIV
If !GWEBSERV
 ## Action ARCUINI
 Call RCUINI(VALEUR,[M:BIC1]CURMLT,[M:BIC1]CURDIV) From AINICOURS
 If mkstat=2
  [M]RAT2(INDIC) = VALEUR
  Affzo RAT2(INDIC) : mkstat = 2
 Endif
Endif
If !mkstat
 ## Action STD
 Call AS_RAT2(VALEUR) From SUBBIC2
 If mkstat=2
  [M]RAT2(INDIC) = VALEUR
  Affzo RAT2(INDIC) : mkstat = 2
 Endif
 Onkey 130 Titled GBOUT2 Call B2_RAT2(zc) From W1BIC1
 Onkey 131 Titled GBOUT3 Call B3_RAT2(zc) From W1BIC1
Endif
Gosub _AFF
End

Subprog C_RAT2(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_RAT2
Call AM_RAT2(zc)
If !mkstat & GOBJET
 zoncou = "RAT2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RAT2(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_RAT2(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "RAT2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B2_RAT2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action AINICOURS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "AINICOURS"
 PARMSK(1) = [M:BIC1]CURMLT
 PARMSK(2) = [M:BIC1]CURDIV
 PARMSK(3) = [M:BIC0]CPY
 PARMSK(4) = num$([M:BIC1]CURTYP)
 PARMSK(5) = [M:BIC1]RATDAT
 PARMSK(6) = "1"
 PARMSK(7) = "[M:BIC1]RAT1"
 Call S_AFF_NUM(VALEUR,PARMSK,"AINICOURS","AINICOURS","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_RAT2(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIRATCUR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIRATCUR"
 PARMSK(1) = [M:BIC1]CUR
 PARMSK(2) = [M:BIC0]CPY
 PARMSK(3) = num$([M:BIC1]CURTYP)
 PARMSK(4) = [M:BIC1]RATDAT
 PARMSK(5) = "[M:BIC1]RATMLT"
 PARMSK(6) = "[M:BIC1]RATDIV"
 Call SAISIE_NUM(VALEUR,PARMSK,"DSAICUR","SUBSCL","SPESCL") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CURMLT
Return

$ON_AMTNOT
Onevent BEFORE_AREA Gosub AV_AMTNOT From W1BIC1
Onevent BEFORE_INPUT Call AS_AMTNOT(zc) From W1BIC1
Onevent CONTROL Call C_AMTNOT(zc) From W1BIC1
Onevent AFTER_AREA Call AP_AMTNOT(zc) From W1BIC1
Return

$AV_AMTNOT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]AMTNOT(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

Subprog AS_AMTNOT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_AMTNOT(VALEUR) From SUBBIC2
If mkstat=2
 [M]AMTNOT(INDIC) = VALEUR
 Affzo AMTNOT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_AMTNOT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_AMTNOT(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "AMTNOT" : GZNUM = 5808 : Endif
Gosub _AFF
End

Subprog AP_AMTNOT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AP_AMTNOT(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "AMTNOT" : GZNUM = 5808 : Endif
Gosub _AFF
End

$ON_AMTATI
Onevent BEFORE_AREA Gosub AV_AMTATI From W1BIC1
Onevent BEFORE_INPUT Call AS_AMTATI(zc) From W1BIC1
Onevent CONTROL Call C_AMTATI(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_AMTATI From W1BIC1
Return

$AV_AMTATI
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]AMTATI(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

Subprog AS_AMTATI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_AMTATI(VALEUR) From SUBBIC2
If mkstat=2
 [M]AMTATI(INDIC) = VALEUR
 Affzo AMTATI(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_AMTATI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_AMTATI(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "AMTATI" : GZNUM = 5809 : Endif
Gosub _AFF
End

$AMM_AMTATI
Call AM_AMTATI(zc)
If !mkstat & GOBJET
 zoncou = "AMTATI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_AMTATI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_AMTATI(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "AMTATI" : GZNUM = 5809 : Endif
Gosub _AFF
End

$ON_INVNUM
Onevent CONTROL Call C_INVNUM(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_INVNUM(zc) From W1BIC1
Onevent AFTER_AREA Call AP_INVNUM(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_INVNUM From W1BIC1
Return

Subprog AS_INVNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_INVNUM(VALEUR) From SUBBIC2
If mkstat=2
 [M]INVNUM(INDIC) = VALEUR
 Affzo INVNUM(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_INVNUM(zc) From W1BIC1
Gosub _AFF
End

Subprog C_INVNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "INVNUM" : GZNUM = 6731 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_INVNUM(VALEUR) From SUBBIC2
 If mkstat : GERR = 1 : GZONE = "INVNUM" : GZNUM = 6731 : Endif
Endif
Gosub _AFF
End

Subprog AP_INVNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_INVNUM(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "INVNUM" : GZNUM = 6731 : Endif
Gosub _AFF
End

$AMM_INVNUM
Call AM_INVNUM(zc)
If !mkstat & GOBJET
 zoncou = "INVNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_INVNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_INVNUM(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "INVNUM" : GZNUM = 6731 : Endif
Gosub _AFF
End

Subprog S_INVNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GSELECT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GSELECT"
 PARMSK(1) = "INVNUM"
 PARMSK(2) = "SUBBIC"
 Call S_TAB_CHAR(VALEUR,PARMSK,"GSELECT","ASELGEN","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_PJTH
Onevent BEFORE_INPUT Call AS_PJTH(zc) From W1BIC1
Onevent CONTROL Call C_PJTH(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_PJTH From W1BIC1
Return

Subprog IB_PJTH(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
&,"","","[M:BIC3]PJTLIN","") From TRTPJT
Gosub _AFF
End

Subprog AS_PJTH(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTH(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
&,"","","[M:BIC3]PJTLIN","") From TRTPJT
If mkstat=2
 [M]PJTH(INDIC) = VALEUR
 Affzo PJTH(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_PJTH(VALEUR) From SUBBIC2
 If mkstat=2
  [M]PJTH(INDIC) = VALEUR
  Affzo PJTH(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJTH(zc) From W1BIC1
 Onkey 130 Titled GBOUT2 Call B2_PJTH(zc) From W1BIC1
 Onkey 131 Titled GBOUT3 Call B3_PJTH(zc) From W1BIC1
 Onkey 132 Titled GBOUT4 Call B4_PJTH(zc) From W1BIC1
 Onkey 172 Titled GBOUT15 Call B15_PJTH(zc) From W1BIC1
 Onkey 173 Titled GBOUT16 Call B16_PJTH(zc) From W1BIC1
 Onkey 174 Titled GBOUT17 Call B17_PJTH(zc) From W1BIC1
 Onkey 175 Titled GBOUT18 Call B18_PJTH(zc) From W1BIC1
 Onkey 176 Titled GBOUT19 Call B19_PJTH(zc) From W1BIC1
 Onkey   2 Titled GBOUTS Call S_PJTH(zc) From W1BIC1
 Onkey 144 Titled GBOUTP Call P_PJTH(zc) From W1BIC1
 Onkey 146 Titled GBOUTA Call SA_PJTH(zc) From W1BIC1
Endif
Gosub _AFF
End

Subprog C_PJTH(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
&,"","","[M:BIC3]PJTLIN","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTH" : GZNUM = 18260 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTH" : GZNUM = 18260 : Endif
Endif
Gosub _AFF
End

$AMM_PJTH
Call AM_PJTH(zc)
If !mkstat & GOBJET
 zoncou = "PJTH" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTH(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
&,"","","[M:BIC3]PJTLIN","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTH" : GZNUM = 18260 : Endif
Gosub _AFF
End

Subprog S_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YSELPJM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YSELPJM"
 PARMSK(1) = [M:BIC0]FCY
 Call S_LIS_CHAR(VALEUR,PARMSK,"YSELPJM","","SPEYSELPJM") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
& ,"","","[M:BIC3]PJTLIN","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
& ,"","","[M:BIC3]PJTLIN","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
& ,"","","[M:BIC3]PJTLIN","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"BIC1","PJTH",0,3,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:BIC0]FCY,[M:BIC0]BPR
& ,"","","[M:BIC3]PJTLIN","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "BIC1"
 PARMSK(2) = "PJTH"
 PARMSK(3) = "0"
 PARMSK(4) = "3"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:BIC0]FCY
 PARMSK(15) = [M:BIC0]BPR
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = "[M:BIC3]PJTLIN"
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "BIC1"
 PARMSK(2) = "PJTH"
 PARMSK(3) = "0"
 PARMSK(4) = "3"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:BIC0]FCY
 PARMSK(15) = [M:BIC0]BPR
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = "[M:BIC3]PJTLIN"
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "BIC1"
 PARMSK(2) = "PJTH"
 PARMSK(3) = "0"
 PARMSK(4) = "3"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:BIC0]FCY
 PARMSK(15) = [M:BIC0]BPR
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = "[M:BIC3]PJTLIN"
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "BIC1"
 PARMSK(2) = "PJTH"
 PARMSK(3) = "0"
 PARMSK(4) = "3"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:BIC0]FCY
 PARMSK(15) = [M:BIC0]BPR
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = "[M:BIC3]PJTLIN"
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTH(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "BIC1"
 PARMSK(2) = "PJTH"
 PARMSK(3) = "0"
 PARMSK(4) = "3"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:BIC0]FCY
 PARMSK(15) = [M:BIC0]BPR
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = "[M:BIC3]PJTLIN"
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTH(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTH(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CURCPY
Return

$ON_STA
Onevent INIT_AREA Call D_STA(zc) From W1BIC1
Return

Subprog D_STA(VALEUR)
Variable Integer VALEUR
If varinit([M]STA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_STARPT
Onevent INIT_AREA Call D_STARPT(zc) From W1BIC1
Return

Subprog D_STARPT(VALEUR)
Variable Integer VALEUR
If varinit([M]STARPT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_VAC
Onevent CONTROL Call C_VAC(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_VAC(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_VAC From W1BIC1
Return

Subprog IB_VAC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_VAC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(28739,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_VAC(VALEUR)
## Action STD
Call AS_VAC(VALEUR) From SUBBIC2
If mkstat=2
 [M]VAC(INDIC) = VALEUR
 Affzo VAC(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_VAC(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_VAC(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_VAC(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_VAC(zc) From W1BIC1
Gosub _AFF
End

Subprog C_VAC(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "VAC" : GZNUM = 249 : Endif
If !mkstat
 ## Action CONTTVB
 Call CONTTVB(VALEUR,GCURLEG,"BIC1","VAC",[M:BIC0]FCY,"",GSOCIETE) From SUBTVB
 If mkstat : GERR = 1 : GZONE = "VAC" : GZNUM = 249 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "VAC" : GZNUM = 249 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_VAC
Call AM_VAC(zc)
If !mkstat & GOBJET
 zoncou = "VAC" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VAC(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VAC(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "VAC" : GZNUM = 249 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZVAC)")>indice
 [M]VAC(indice) = VALEUR
 Affzo ZVAC(indice)
Endif
Gosub _AFF
End

Subprog S_VAC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVBLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVBLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:BIC0]FCY
 PARMSK(3) = ""
 PARMSK(4) = GSOCIETE
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVB","SUBTVB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VAC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTVB
 Call TUNTVB(VALEUR,GCURLEG) From SUBTVB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_VAC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVB"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_VAC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVB",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZVAC
Onevent BEFORE_AREA Gosub AV_ZVAC From W1BIC1
Return

$AV_ZVAC
Call LECTEXTRA(zc,"TABVACBPR","SHOAXX",num$([M]VAC(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_SALPRITYP
Onevent AFTER_CHANGE Gosub AMM_SALPRITYP From W1BIC1
Onevent INIT_AREA Call D_SALPRITYP(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_SALPRITYP(zc) From W1BIC1
Return

Subprog D_SALPRITYP(VALEUR)
Variable Integer VALEUR
If varinit([M]SALPRITYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_SALPRITYP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_SALPRITYP
Call AM_SALPRITYP(zc)
If !mkstat & GOBJET
 zoncou = "SALPRITYP" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SALPRITYP(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_SALPRITYP(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "SALPRITYP" : GZNUM = 9801 : Endif
Gosub _AFF
End

$ON_SSTENTCOD
Onevent INIT_AREA Call D_SSTENTCOD(zc) From W1BIC1
Onevent CONTROL Call C_SSTENTCOD(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_SSTENTCOD(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_SSTENTCOD From W1BIC1
Return

Subprog D_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]SSTENTCOD,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"202","") From SUBADI
Endif
Gosub _AFF
End

Subprog AS_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TITADI(GBOUT1,"202") From TRTDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_SSTENTCOD(VALEUR) From SUBBIC2
If mkstat=2
 [M]SSTENTCOD(INDIC) = VALEUR
 Affzo SSTENTCOD(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_SSTENTCOD(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_SSTENTCOD(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_SSTENTCOD(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_SSTENTCOD(zc) From W1BIC1
Gosub _AFF
End

Subprog C_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
## Action CONTADI
Call CONTADI(VALEUR,"202","") From SUBADI
If mkstat : GERR = 1 : GZONE = "SSTENTCOD" : GZNUM = 48789 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("ADI","!",VALEUR,"202",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "SSTENTCOD" : GZNUM = 48789 : Endif
Endif
Gosub _AFF
End

$AMM_SSTENTCOD
Call AM_SSTENTCOD(zc)
If !mkstat & GOBJET
 zoncou = "SSTENTCOD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZSSTENTCOD)")>indice
 [M]SSTENTCOD(indice) = VALEUR
 Affzo ZSSTENTCOD(indice)
Endif
Gosub _AFF
End

Subprog S_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELADI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELADI"
 PARMSK(1) = "202"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELADI","SUBADI","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
Call OBJET("ADI",VALEUR,"202") From GOBJET
Gosub _AFF
End

Subprog SA_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ADI"
PARMSK(2) = "202"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SSTENTCOD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "202"
Call VISU("ADI",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSSTENTCOD
Onevent BEFORE_AREA Gosub AV_ZSSTENTCOD From W1BIC1
Return

$AV_ZSSTENTCOD
Call LECTEXTRA(zc,"ATABDIV","SHODES","202",num$([M]SSTENTCOD(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_BPRFCT
Onevent INIT_AREA Call D_BPRFCT(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_BPRFCT(zc) From W1BIC1
Onevent CONTROL Call C_BPRFCT(zc) From W1BIC1
Return

Subprog D_BPRFCT(VALEUR)
Variable Char    VALEUR()
If varinit([M]BPRFCT,indice)=0
 ## Action STD
 Call D_BPRFCT(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_BPRFCT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(13330,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_BPRFCT(VALEUR) From SUBBIC2
If mkstat=2
 [M]BPRFCT(INDIC) = VALEUR
 Affzo BPRFCT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_BPRFCT(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_BPRFCT(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_BPRFCT(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_BPRFCT(zc) From W1BIC1
Gosub _AFF
End

Subprog C_BPRFCT(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("FCT","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "BPRFCT" : GZNUM = 3669 : Endif
If !mkstat
 ## Action STD
 Call C_BPRFCT(VALEUR) From SUBBIC2
 If mkstat : GERR = 1 : GZONE = "BPRFCT" : GZNUM = 3669 : Endif
Endif
Gosub _AFF
End

Subprog S_BPRFCT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCT"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPRFCT(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_BPRFCT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPRFCT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_XSOI
Onevent INIT_AREA Call D_XSOI(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_XSOI(zc) From W1BIC1
Return

Subprog D_XSOI(VALEUR)
Variable Integer VALEUR
If varinit([M]XSOI,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_XSOI(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_XSOI(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_XSOI(VALEUR) From SUBBIC2
If mkstat=2
 [M]XSOI(INDIC) = VALEUR
 Affzo XSOI(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_XFLGFUP
Onevent INIT_AREA Call D_XFLGFUP(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_XFLGFUP(zc) From W1BIC1
Return

Subprog D_XFLGFUP(VALEUR)
Variable Integer VALEUR
If varinit([M]XFLGFUP,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_XFLGFUP(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_XFLGFUP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_XFLGFUP(VALEUR) From SUBBIC2
If mkstat=2
 [M]XFLGFUP(INDIC) = VALEUR
 Affzo XFLGFUP(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_NBRCCE
Onevent INIT_AREA Call D_NBRCCE From W1BIC1
Onevent BEFORE_INPUT Call AS_NBRCCE From W1BIC1
Onevent CONTROL Call C_NBRCCE From W1BIC1
Return

Subprog D_NBRCCE
Local Decimal BASPAG
If varinit([M]NBRCCE)=0
 ## Action STD
 Call D_NBRCCE From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_NBRCCE
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_NBRCCE From SUBBIC2
Gosub _AFF
End

Subprog C_NBRCCE
Local Decimal BASPAG
## Action STD
Call C_NBRCCE From SUBBIC2
If mkstat : GERR = 1 : GZONE = "NBRCCE" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_NUMLIG2
Onevent BEFORE_AREA Gosub AV_NUMLIG2 From W1BIC1
Return

$AV_NUMLIG2
zc = nolign
Gosub _AFF
Return

$ON_DIE
Return

$ON_CCE
Onevent BEFORE_AREA Gosub AV_CCE From W1BIC1
Onevent CONTROL Call C_CCE(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_CCE(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_CCE From W1BIC1
Return

$AV_CCE
## Action INICCEFMT
Call INICCEFMT(num$([M]DIE(indice))) From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]CCE(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]CCE(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_CCE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_CCE(VALEUR) From SUBBIC2
If mkstat=2
 [M]CCE(INDIC) = VALEUR
 Affzo CCE(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_CCE(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_CCE(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_CCE(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_CCE(zc) From W1BIC1
Gosub _AFF
End

Subprog C_CCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$([M]DIE(indice))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$([M]DIE(indice)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE" : GZNUM = 3997 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE(VALEUR) From SUBBIC2
  If mkstat : GERR = 1 : GZONE = "CCE" : GZNUM = 3997 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_CCE
Call AM_CCE(zc)
If !mkstat & GOBJET
 zoncou = "CCE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CCE(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZCCE)")>indice
 [M]CCE(indice) = VALEUR
 Affzo ZCCE(indice)
Endif
Gosub _AFF
End

Subprog S_CCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELCCE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCE"
 PARMSK(1) = [M]DIE(nolign-1)
 PARMSK(2) = [M]FCY
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]DIE(0"
 PARMSK(6) = "[M]CCE(0"
 PARMSK(7) = ""
 PARMSK(8) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action SELCCEGDD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCEGDD"
 PARMSK(1) = [M]DIE(nolign-1)
 PARMSK(2) = [M]FCY
 PARMSK(3) = [M]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M]DIE(0"
 PARMSK(6) = "[M]CCE(0"
 PARMSK(7) = ""
 PARMSK(8) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$([M]DIE(indice))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$([M]DIE(indice))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]DIE(indice))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCCE
Onevent BEFORE_AREA Gosub AV_ZCCE From W1BIC1
Return

$AV_ZCCE
Call LECTEXTRA(zc,"CACCE","SHOTRA",num$([M]DIE(indice)),num$([M]CCE(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_BPRPAY
Onevent CONTROL Call C_BPRPAY(zc) From W1BIC1
Onevent INIT_AREA Call D_BPRPAY(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_BPRPAY(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_BPRPAY From W1BIC1
Return

Subprog D_BPRPAY(VALEUR)
Variable Char    VALEUR()
If varinit([M]BPRPAY,indice)=0
 ## Action STD
 Call D_BPRPAY(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_BPRPAY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_BPRPAY(VALEUR) From SUBBIC2
If mkstat=2
 [M]BPRPAY(INDIC) = VALEUR
 Affzo BPRPAY(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_BPRPAY(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_BPRPAY(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_BPRPAY(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_BPRPAY(zc) From W1BIC1
Gosub _AFF
End

Subprog C_BPRPAY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "BPRPAY" : GZNUM = 6730 : Endif
If !GWEBSERV
 If !mkstat
  ## Action BPRCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "BPRCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "BPRPAY" : GZNUM = 6730 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPRPAY" : GZNUM = 6730 : Endif
 If !mkstat
  ## Action CONTBPRCPY
  Call CONTBPRCPY(VALEUR,[M]FCY,"","","C") From CPTSUB
  If mkstat : GERR = 1 : GZONE = "BPRPAY" : GZNUM = 6730 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_BPRPAY
Call AM_BPRPAY(zc)
If !mkstat & GOBJET
 zoncou = "BPRPAY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPRPAY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BPRPAY(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "BPRPAY" : GZNUM = 6730 : Endif
Gosub _AFF
End

Subprog S_BPRPAY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPRPAY(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_BPRPAY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPRPAY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_BPAPAY
Onevent INIT_AREA Call D_BPAPAY(zc) From W1BIC1
Onevent CONTROL Call C_BPAPAY(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_BPAPAY(zc) From W1BIC1
Return

Subprog D_BPAPAY(VALEUR)
Variable Char    VALEUR()
If varinit([M]BPAPAY,indice)=0
 ## Action STD
 Call D_BPAPAY(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_BPAPAY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_BPAPAY(zc) From W1BIC1
Gosub _AFF
End

Subprog C_BPAPAY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_BPAPAY(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "BPAPAY" : GZNUM = 1509 : Endif
Gosub _AFF
End

Subprog S_BPAPAY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTBPA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBPA"
 PARMSK(1) = "1"
 PARMSK(2) = [M]BPRPAY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTBPA","TRTADR","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_STRDUDDAT
Onevent INIT_AREA Call D_STRDUDDAT(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_STRDUDDAT(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_STRDUDDAT From W1BIC1
Onevent CONTROL Call C_STRDUDDAT(zc) From W1BIC1
Onevent BEFORE_AREA Gosub AV_STRDUDDAT From W1BIC1
Return

$AV_STRDUDDAT
Chgfmt [M]STRDUDDAT(indice) With "DzZ:"+GFMDAT
Gosub _AFF
Return

Subprog D_STRDUDDAT(VALEUR)
Variable Date    VALEUR
If varinit([M]STRDUDDAT,indice)=0
 ## Action STD
 Call D_STRDUDDAT(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_STRDUDDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_STRDUDDAT(VALEUR) From SUBBIC2
If mkstat=2
 [M]STRDUDDAT(INDIC) = VALEUR
 Affzo STRDUDDAT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_STRDUDDAT(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "STRDUDDAT" : GZNUM = 3604 : Endif
Gosub _AFF
End

$AMM_STRDUDDAT
Call AM_STRDUDDAT(zc)
If !mkstat & GOBJET
 zoncou = "STRDUDDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STRDUDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_STRDUDDAT(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "STRDUDDAT" : GZNUM = 3604 : Endif
Gosub _AFF
End

$ON_PTE
Onevent CONTROL Call C_PTE(zc) From W1BIC1
Onevent INIT_AREA Call D_PTE(zc) From W1BIC1
Onevent BEFORE_INPUT Call AS_PTE(zc) From W1BIC1
Onevent AFTER_CHANGE Gosub AMM_PTE From W1BIC1
Return

Subprog IB_PTE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog D_PTE(VALEUR)
Variable Char    VALEUR()
If varinit([M]PTE,indice)=0
 ## Action STD
 Call D_PTE(VALEUR) From SUBBIC2
Endif
Gosub _AFF
End

Subprog AS_PTE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3589,GBOUT1) From OBJDIV
Call TEXTE(3602,GBOUT2) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PTE(VALEUR)
## Action STD
Call AS_PTE(VALEUR) From SUBBIC2
If mkstat=2
 [M]PTE(INDIC) = VALEUR
 Affzo PTE(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PTE(zc) From W1BIC1
Onkey 130 Titled GBOUT2 Call B2_PTE(zc) From W1BIC1
Onkey   2 Titled GBOUTS Call S_PTE(zc) From W1BIC1
Onkey 144 Titled GBOUTP Call P_PTE(zc) From W1BIC1
Onkey 146 Titled GBOUTA Call SA_PTE(zc) From W1BIC1
Gosub _AFF
End

Subprog C_PTE(VALEUR)
Variable Char    VALEUR()
## Action CONTTPT
Call CONTTPT(VALEUR,GCURLEG,"BIC1","PTE",[M:BIC0]FCY,"",[M:BIC0]CPY) From SUBTPT
If mkstat : GERR = 1 : GZONE = "PTE" : GZNUM = 3624 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PTE" : GZNUM = 3624 : Endif
 If !mkstat
  ## Action STD
  Call C_PTE(VALEUR) From SUBBIC2
  If mkstat : GERR = 1 : GZONE = "PTE" : GZNUM = 3624 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PTE
Call AM_PTE(zc)
If !mkstat & GOBJET
 zoncou = "PTE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PTE(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_PTE(VALEUR) From SUBBIC2
If mkstat : GERR = 1 : GZONE = "PTE" : GZNUM = 3624 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZPTE)")>indice
 [M]PTE(indice) = VALEUR
 Affzo ZPTE(indice)
Endif
Gosub _AFF
End

Subprog S_PTE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTPTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTPTLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = [M:BIC0]FCY
 PARMSK(3) = ""
 PARMSK(4) = [M:BIC0]CPY
 PARMSK(5) = "BIC1"
 PARMSK(6) = "PTE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTPT","SUBTPT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PTE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTPT
 Call TUNTPT(VALEUR,GCURLEG) From SUBTPT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PTE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TPTSIM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "TPTSIM"
 PARMSK(1) = [M]CUR
 PARMSK(2) = num$([M]AMTATI)
 PARMSK(3) = [M]STRDUDDAT
 PARMSK(4) = [M]CPY
 Call SAISIE_CHAR(VALEUR,PARMSK,"DTPTSIM","SUBPTSI","SPEPTS") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PTE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TPT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PTE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TPT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2BIC1
Return

$TIT_COL
Gosub TIT_COL From W2BIC1
Return


