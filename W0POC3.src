#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management POC3 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc tableau 1
####################################
IMPTBL = 1

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
indice = 0
status = 1
zoncou = "NBFAC"
If varmode([M]NBFAC,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBFAC" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBFAC
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBFAC = nolign
   status = 75
   Call SAI_NBFAC(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
  SAVACT = GACTION : GACTION = "STD"
  Call C_NBFAC From SUBPOC
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "NBFAC" : GZNUM = 0 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

####################################
## Bloc liste 2
####################################
IMPTBL = 0

## Zone WORDMINAMT
mkstat = 0
zoncou = "WORDMINAMT"
indice = 0
SAVACT = GACTION : GACTION = "INIDEV"
GACTION = SAVACT
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POC1]CUR,GDEVISE(1..GNBDEV)),1))
If mkstat=1 : Raz [M]WORDMINAMT : Endif

## Zone TOTVLT
mkstat = 0
zoncou = "TOTVLT"
indice = 0
SAVACT = GACTION : GACTION = "INIDEV"
GACTION = SAVACT
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POC1]CUR,GDEVISE(1..GNBDEV)),1))
If mkstat=1 : Raz [M]TOTVLT : Endif

## Zone TOTORD
mkstat = 0
zoncou = "TOTORD"
indice = 0
SAVACT = GACTION : GACTION = "INIDEV"
GACTION = SAVACT
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POC1]CUR,GDEVISE(1..GNBDEV)),1))
If mkstat=1 : Raz [M]TOTORD : Endif

## Zone TTVORD
mkstat = 0
zoncou = "TTVORD"
indice = 0
SAVACT = GACTION : GACTION = "INIDEV"
GACTION = SAVACT
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POC3]WCUR,GDEVISE(1..GNBDEV)),1))
If mkstat=1 : Raz [M]TTVORD : Endif

####################################
## Bloc liste 3
####################################
IMPTBL = 0

## Zone OCNDAT
mkstat = 0
zoncou = "OCNDAT"
indice = 0
If varmode([M]OCNDAT,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "OCNDAT" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone OCNNUM
mkstat = 0
zoncou = "OCNNUM"
indice = 0
If varmode([M]OCNNUM,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "OCNNUM" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone OCNREM
mkstat = 0
zoncou = "OCNREM"
indice = 0
If varmode([M]OCNREM,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "OCNREM" : Gosub ACTION From =IMPTRT
 Endif
Endif

####################################
## Bloc tableau 4
####################################
IMPTBL = 1

indice = 0
status = 1
zoncou = "NBPFI"
If !mkstat
 NBLIG = [M]NBPFI
 For nolign=1 To NBLIG
  indice = nolign-1
  [M]NBPFI = nolign
  status = 75
  Call SAI_NBPFI(IMPFIC,ACTION,IMPTRT)
  If mkstat : Break : Endif
 Next nolign
 If mkstat : End : Endif
 indice = 0
Endif

mkstat = 0

End

####################################
## Bloc tableau 1
####################################
Subprog SAI_NBFAC(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
SAVACT = GACTION : GACTION = "STD"
Call C_NBFAC From SUBPOC
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "NBFAC" : GZNUM = 0 : Endif
Gosub AFF From GSAISIE
If mkstat : End : Endif

## Zone INVDTA
mkstat = 0
zoncou = "INVDTA"
WNUM = [M]INVDTA(indice)
If varmode([M]INVDTA,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_INVDTA([M]INVDTA(indice)) From SUBPOC
 GACTION = SAVACT
 If mkstat=1 : Raz [M]INVDTA(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "INVDTA" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If [M]INVDTA(indice)=0
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTNUM("PFI","ABC",[M]INVDTA(indice),"",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_INVDTA([M]INVDTA(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WNUM<>[M]INVDTA(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_INVDTA([M]INVDTA(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "INVDTA" : GZNUM = 42 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone INVDTAAMT
mkstat = 0
zoncou = "INVDTAAMT"
WNUM = [M]INVDTAAMT(indice)
If varmode([M]INVDTAAMT,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_INVDTAAMT([M]INVDTAAMT(indice)) From SUBPOC
 GACTION = SAVACT
 If mkstat=1 : Raz [M]INVDTAAMT(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "INVDTAAMT" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If WNUM<>[M]INVDTAAMT(indice) or IMPMOD
   SAVACT = GACTION : GACTION = "STD"
   Call AM_INVDTAAMT([M]INVDTAAMT(indice)) From SUBPOC
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "INVDTAAMT" : GZNUM = 5476 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone INVORDAMT
mkstat = 0
zoncou = "INVORDAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:POC1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVORDAMT(indice) : Endif

## Zone INVLINAMT
mkstat = 0
zoncou = "INVLINAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:POC1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVLINAMT(indice) : Endif

## Zone INVCPLAMT
mkstat = 0
zoncou = "INVCPLAMT"
SAVACT = GACTION : GACTION = "FMTFM1DEV"
Call FMTFM1DEV([M:POC1]CUR) From TRTDIV
GACTION = SAVACT
If mkstat=1 : Raz [M]INVCPLAMT(indice) : Endif

## Zone INVDTAFLG
mkstat = 0
zoncou = "INVDTAFLG"
IMPENT = [M]INVDTAFLG(indice)
If varinit([M]INVDTAFLG,indice)=0
 IMPENT = 1
Endif
[M]INVDTAFLG(indice) = IMPENT

## Zone INVORDFLG
mkstat = 0
zoncou = "INVORDFLG"
IMPENT = [M]INVORDFLG(indice)
If varinit([M]INVORDFLG,indice)=0
 IMPENT = 1
Endif
[M]INVORDFLG(indice) = IMPENT

## Zone DISVATFLG
mkstat = 0
zoncou = "DISVATFLG"
IMPENT = [M]DISVATFLG(indice)
If varinit([M]DISVATFLG,indice)=0
 IMPENT = 1
Endif
[M]DISVATFLG(indice) = IMPENT

## Zone DEBCDT
mkstat = 0
zoncou = "DEBCDT"
IMPENT = [M]DEBCDT(indice)
If varinit([M]DEBCDT,indice)=0
 IMPENT = 1
Endif
[M]DEBCDT(indice) = IMPENT

## Zone AMTCOD
mkstat = 0
zoncou = "AMTCOD"
IMPENT = [M]AMTCOD(indice)
If varinit([M]AMTCOD,indice)=0
 IMPENT = 1
Endif
[M]AMTCOD(indice) = IMPENT

## Zone CLCBAS
mkstat = 0
zoncou = "CLCBAS"
IMPENT = [M]CLCBAS(indice)
If varinit([M]CLCBAS,indice)=0
 IMPENT = 1
Endif
[M]CLCBAS(indice) = IMPENT

## Zone ACC1
mkstat = 0
zoncou = "ACC1"
WCHAR = [M]ACC1(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC1(indice) : Endif
If !mkstat
 If varinit([M]ACC1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC1([M]ACC1(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC1([M]ACC1(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC1(indice),num$(GCOA(1)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC1([M]ACC1(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC1(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC1([M]ACC1(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC1" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC2
mkstat = 0
zoncou = "ACC2"
WCHAR = [M]ACC2(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC2(indice) : Endif
If !mkstat
 If varinit([M]ACC2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC2([M]ACC2(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC2([M]ACC2(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC2(indice),num$(GCOA(2)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC2([M]ACC2(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC2(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC2([M]ACC2(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC2" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC3
mkstat = 0
zoncou = "ACC3"
WCHAR = [M]ACC3(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC3(indice) : Endif
If !mkstat
 If varinit([M]ACC3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC3([M]ACC3(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC3([M]ACC3(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC3(indice),num$(GCOA(3)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC3([M]ACC3(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC3(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC3([M]ACC3(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC3" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC4
mkstat = 0
zoncou = "ACC4"
WCHAR = [M]ACC4(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC4(indice) : Endif
If !mkstat
 If varinit([M]ACC4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC4([M]ACC4(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC4([M]ACC4(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC4(indice),num$(GCOA(4)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC4([M]ACC4(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC4(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC4([M]ACC4(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC4" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC5
mkstat = 0
zoncou = "ACC5"
WCHAR = [M]ACC5(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC5(indice) : Endif
If !mkstat
 If varinit([M]ACC5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC5([M]ACC5(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC5([M]ACC5(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC5(indice),num$(GCOA(5)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC5([M]ACC5(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC5(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC5([M]ACC5(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC5" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC6
mkstat = 0
zoncou = "ACC6"
WCHAR = [M]ACC6(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(6))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC6(indice) : Endif
If !mkstat
 If varinit([M]ACC6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC6([M]ACC6(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC6([M]ACC6(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC6(indice),num$(GCOA(6)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC6([M]ACC6(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC6(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC6([M]ACC6(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC6" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC7
mkstat = 0
zoncou = "ACC7"
WCHAR = [M]ACC7(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(7))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC7(indice) : Endif
If !mkstat
 If varinit([M]ACC7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC7([M]ACC7(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC7([M]ACC7(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC7(indice),num$(GCOA(7)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC7([M]ACC7(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC7(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC7([M]ACC7(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC7" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC8
mkstat = 0
zoncou = "ACC8"
WCHAR = [M]ACC8(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(8))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC8(indice) : Endif
If !mkstat
 If varinit([M]ACC8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC8([M]ACC8(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC8([M]ACC8(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC8(indice),num$(GCOA(8)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC8([M]ACC8(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC8(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC8([M]ACC8(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC8" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC9
mkstat = 0
zoncou = "ACC9"
WCHAR = [M]ACC9(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(9))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC9(indice) : Endif
If !mkstat
 If varinit([M]ACC9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC9([M]ACC9(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC9([M]ACC9(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC9(indice),num$(GCOA(9)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC9([M]ACC9(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC9(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC9([M]ACC9(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC9" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone ACC10
mkstat = 0
zoncou = "ACC10"
WCHAR = [M]ACC10(indice)
SAVACT = GACTION : GACTION = "INIACCFMT"
Call INIACCFMT(num$(GCOA(10))) From SETGLBCOA
GACTION = SAVACT
If mkstat=1 : Raz [M]ACC10(indice) : Endif
If !mkstat
 If varinit([M]ACC10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_ACC10([M]ACC10(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]ACC10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_ACC10([M]ACC10(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]ACC10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "ACC10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("GAC","!",[M]ACC10(indice),num$(GCOA(10)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_ACC10([M]ACC10(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]ACC10(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_ACC10([M]ACC10(indice)) From SUBPOC
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "ACC10" : GZNUM = 0 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone DSP
mkstat = 0
zoncou = "DSP"
WCHAR = [M]DSP(indice)
If varmode([M]DSP,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_DSP([M]DSP(indice)) From SUBPOC
 GACTION = SAVACT
 If mkstat=1 : Raz [M]DSP(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "DSP" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  Call CONTROLE("DSP","!",[M]DSP(indice),"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CTLDSP"
   Call CTRL_DSP([M]DSP(indice),GFINRSP,[M:POC0]ORDDAT) From TRTX3CPT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]DSP(indice) or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_DSP([M]DSP(indice)) From SUBPOC
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "DSP" : GZNUM = 4043 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE1
mkstat = 0
zoncou = "PFICCE1"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(1))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE1(indice) : Endif
If !mkstat
 If varinit([M]PFICCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE1([M]PFICCE1(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE1([M]PFICCE1(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE1(indice),num$(GDIE(1)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE1([M]PFICCE1(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE2
mkstat = 0
zoncou = "PFICCE2"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(2))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE2(indice) : Endif
If !mkstat
 If varinit([M]PFICCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE2([M]PFICCE2(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE2([M]PFICCE2(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE2(indice),num$(GDIE(2)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE2([M]PFICCE2(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE3
mkstat = 0
zoncou = "PFICCE3"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(3))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE3(indice) : Endif
If !mkstat
 If varinit([M]PFICCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE3([M]PFICCE3(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE3([M]PFICCE3(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE3(indice),num$(GDIE(3)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE3([M]PFICCE3(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE4
mkstat = 0
zoncou = "PFICCE4"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(4))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE4(indice) : Endif
If !mkstat
 If varinit([M]PFICCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE4([M]PFICCE4(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE4([M]PFICCE4(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE4(indice),num$(GDIE(4)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE4([M]PFICCE4(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE5
mkstat = 0
zoncou = "PFICCE5"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(5))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE5(indice) : Endif
If !mkstat
 If varinit([M]PFICCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE5([M]PFICCE5(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE5([M]PFICCE5(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE5(indice),num$(GDIE(5)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE5([M]PFICCE5(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE6
mkstat = 0
zoncou = "PFICCE6"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(6))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE6(indice) : Endif
If !mkstat
 If varinit([M]PFICCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE6([M]PFICCE6(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE6([M]PFICCE6(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE6(indice),num$(GDIE(6)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE6([M]PFICCE6(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE7
mkstat = 0
zoncou = "PFICCE7"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(7))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE7(indice) : Endif
If !mkstat
 If varinit([M]PFICCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE7([M]PFICCE7(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE7([M]PFICCE7(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE7(indice),num$(GDIE(7)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE7([M]PFICCE7(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE8
mkstat = 0
zoncou = "PFICCE8"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(8))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE8(indice) : Endif
If !mkstat
 If varinit([M]PFICCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE8([M]PFICCE8(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE8([M]PFICCE8(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE8(indice),num$(GDIE(8)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE8([M]PFICCE8(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE9
mkstat = 0
zoncou = "PFICCE9"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(9))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE9(indice) : Endif
If !mkstat
 If varinit([M]PFICCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE9([M]PFICCE9(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE9([M]PFICCE9(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE9(indice),num$(GDIE(9)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE9([M]PFICCE9(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE10
mkstat = 0
zoncou = "PFICCE10"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(10))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE10(indice) : Endif
If !mkstat
 If varinit([M]PFICCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE10([M]PFICCE10(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE10([M]PFICCE10(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE10(indice),num$(GDIE(10)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE10([M]PFICCE10(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE11
mkstat = 0
zoncou = "PFICCE11"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(11))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE11(indice) : Endif
If !mkstat
 If varinit([M]PFICCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE11([M]PFICCE11(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE11([M]PFICCE11(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE11(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE11" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE11(indice),num$(GDIE(11)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE11" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE11([M]PFICCE11(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE11" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE12
mkstat = 0
zoncou = "PFICCE12"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(12))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE12(indice) : Endif
If !mkstat
 If varinit([M]PFICCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE12([M]PFICCE12(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE12([M]PFICCE12(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE12(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE12" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE12(indice),num$(GDIE(12)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE12" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE12([M]PFICCE12(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE12" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE13
mkstat = 0
zoncou = "PFICCE13"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(13))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE13(indice) : Endif
If !mkstat
 If varinit([M]PFICCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE13([M]PFICCE13(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE13([M]PFICCE13(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE13(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE13" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE13(indice),num$(GDIE(13)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE13" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE13([M]PFICCE13(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE13" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE14
mkstat = 0
zoncou = "PFICCE14"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(14))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE14(indice) : Endif
If !mkstat
 If varinit([M]PFICCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE14([M]PFICCE14(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE14([M]PFICCE14(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE14(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE14" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE14(indice),num$(GDIE(14)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE14" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE14([M]PFICCE14(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE14" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE15
mkstat = 0
zoncou = "PFICCE15"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(15))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE15(indice) : Endif
If !mkstat
 If varinit([M]PFICCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE15([M]PFICCE15(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE15([M]PFICCE15(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE15(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE15" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE15(indice),num$(GDIE(15)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE15" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE15([M]PFICCE15(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE15" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE16
mkstat = 0
zoncou = "PFICCE16"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(16))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE16(indice) : Endif
If !mkstat
 If varinit([M]PFICCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE16([M]PFICCE16(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE16([M]PFICCE16(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE16(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE16" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE16(indice),num$(GDIE(16)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE16" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE16([M]PFICCE16(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE16" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE17
mkstat = 0
zoncou = "PFICCE17"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(17))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE17(indice) : Endif
If !mkstat
 If varinit([M]PFICCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE17([M]PFICCE17(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE17([M]PFICCE17(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE17(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE17" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE17(indice),num$(GDIE(17)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE17" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE17([M]PFICCE17(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE17" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE18
mkstat = 0
zoncou = "PFICCE18"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(18))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE18(indice) : Endif
If !mkstat
 If varinit([M]PFICCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE18([M]PFICCE18(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE18([M]PFICCE18(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE18(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE18" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE18(indice),num$(GDIE(18)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE18" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE18([M]PFICCE18(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE18" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE19
mkstat = 0
zoncou = "PFICCE19"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(19))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE19(indice) : Endif
If !mkstat
 If varinit([M]PFICCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE19([M]PFICCE19(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE19([M]PFICCE19(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE19(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE19" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE19(indice),num$(GDIE(19)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE19" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE19([M]PFICCE19(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE19" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone PFICCE20
mkstat = 0
zoncou = "PFICCE20"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(20))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]PFICCE20(indice) : Endif
If !mkstat
 If varinit([M]PFICCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_PFICCE20([M]PFICCE20(indice)) From SUBPOC
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]PFICCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_PFICCE20([M]PFICCE20(indice)) From SUBPOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]PFICCE20(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "PFICCE20" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]PFICCE20(indice),num$(GDIE(20)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "PFICCE20" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_PFICCE20([M]PFICCE20(indice)) From SUBPOC
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PFICCE20" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone NBFAC
mkstat = 0
zoncou = "NBFAC"
status = 71
SAVACT = GACTION : GACTION = "STD"
Call APRES_NBFAC From SUBPOC
GACTION = SAVACT

End

####################################
## Bloc tableau 4
####################################
Subprog SAI_NBPFI(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1



End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "POC3"
Return

