#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
## BI-REGLE ## Synchronization rule STOJOU1

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".STOJOU" : If clalev([F:STJ])=0 : Local File =OUVTAB [STJ] : Endif
OUVTAB = GDOSSIER+".STOJOU" : If clalev([F:A_])=0 : Local File =OUVTAB [A_] : Endif
OUVTAB = "Link [STJ]"
Link [STJ] With
& [A_]STJ0=[STJ]STOFCY;[STJ]UPDCOD;[STJ]ITMREF;[STJ]IPTDAT;[STJ]MVTSEQ;[STJ]MVTIND
& As [LNK_]
& Where REGFLG<>2
FILTRE = ""
Return

$FERME
If clalev([F:STJ]) : Close local File [STJ] : Endif
If clalev([F:A_]) : Close local File [A_] : Endif
Return

$LIEN
Return

$MAJFLD
### STOFCY
[L]FLD="STOFCY"
[L]FORMULE='[F:STJ]STOFCY'
If dim([F:AAA_]STOFCY)>0
 [F:AAA_]STOFCY = [F:STJ]STOFCY
Endif

### ITMREF
[L]FLD="ITMREF"
[L]FORMULE='[F:STJ]ITMREF'
If dim([F:AAA_]ITMREF)>0
 [F:AAA_]ITMREF = [F:STJ]ITMREF
Endif

### LOC
[L]FLD="LOC"
[L]FORMULE='[F:STJ]LOC'
If dim([F:AAA_]LOC)>0
 [F:AAA_]LOC = [F:STJ]LOC
Endif

### IPTDAT
[L]FLD="IPTDAT"
[L]FORMULE='[F:STJ]IPTDAT'
If dim([F:AAA_]IPTDAT)>0
 [F:AAA_]IPTDAT = [F:STJ]IPTDAT
Endif

### DOSSIER
[L]FLD="DOSSIER"
[L]FORMULE='GDOSSIER'
If dim([F:AAA_]DOSSIER)>0
 [F:AAA_]DOSSIER = GDOSSIER
Endif

### CPY
[L]FLD="CPY"
[L]FORMULE='func TRTX3BI.GETCPY([F:STJ]STOFCY)'
If dim([F:AAA_]CPY)>0
 [F:AAA_]CPY = func TRTX3BI.GETCPY([F:STJ]STOFCY)
Endif

### FIYNUM
[L]FLD="FIYNUM"
[L]FORMULE='func TRTX3BI.GETEXE([F:STJ]STOFCY,[F:STJ]IPTDAT)'
If dim([F:AAA_]FIYNUM)>0
 [F:AAA_]FIYNUM = func TRTX3BI.GETEXE([F:STJ]STOFCY,[F:STJ]IPTDAT)
Endif

### PERNUM
[L]FLD="PERNUM"
[L]FORMULE='func TRTX3BI.GETPER([F:STJ]STOFCY,[F:STJ]IPTDAT)'
If dim([F:AAA_]PERNUM)>0
 [F:AAA_]PERNUM = func TRTX3BI.GETPER([F:STJ]STOFCY,[F:STJ]IPTDAT)
Endif

### CURLOC
[L]FLD="CURLOC"
[L]FORMULE='func TRTX3BI.GETCUR([F:STJ]STOFCY)'
If dim([F:AAA_]CURLOC)>0
 [F:AAA_]CURLOC = func TRTX3BI.GETCUR([F:STJ]STOFCY)
Endif

### CURRPT
[L]FLD="CURRPT"
[L]FORMULE='func TRTX3BI.GETSYSCUR()'
If dim([F:AAA_]CURRPT)>0
 [F:AAA_]CURRPT = func TRTX3BI.GETSYSCUR()
Endif

### TRSTYP
[L]FLD="TRSTYP"
[L]FORMULE='[F:STJ]TRSTYP'
If dim([F:AAA_]TRSTYP)>0
 [F:AAA_]TRSTYP = [F:STJ]TRSTYP
Endif

### VCRTYP
[L]FLD="VCRTYP"
[L]FORMULE='[F:STJ]VCRTYP'
If dim([F:AAA_]VCRTYP)>0
 [F:AAA_]VCRTYP = [F:STJ]VCRTYP
Endif

### VCRNUM
[L]FLD="VCRNUM"
[L]FORMULE='[F:STJ]VCRNUM'
If dim([F:AAA_]VCRNUM)>0
 [F:AAA_]VCRNUM = [F:STJ]VCRNUM
Endif

### VCRLIN
[L]FLD="VCRLIN"
[L]FORMULE='[F:STJ]VCRLIN'
If dim([F:AAA_]VCRLIN)>0
 [F:AAA_]VCRLIN = [F:STJ]VCRLIN
Endif

### VCRTYPORI
[L]FLD="VCRTYPORI"
[L]FORMULE='[F:STJ]VCRTYPORI'
If dim([F:AAA_]VCRTYPORI)>0
 [F:AAA_]VCRTYPORI = [F:STJ]VCRTYPORI
Endif

### VCRNUMORI
[L]FLD="VCRNUMORI"
[L]FORMULE='[F:STJ]VCRNUMORI'
If dim([F:AAA_]VCRNUMORI)>0
 [F:AAA_]VCRNUMORI = [F:STJ]VCRNUMORI
Endif

### VCRLINORI
[L]FLD="VCRLINORI"
[L]FORMULE='[F:STJ]VCRLINORI'
If dim([F:AAA_]VCRLINORI)>0
 [F:AAA_]VCRLINORI = [F:STJ]VCRLINORI
Endif

### QTYSTU
[L]FLD="QTYSTU"
[L]FORMULE='[F:STJ]QTYSTU'
If dim([F:AAA_]QTYSTU)>0
 [F:AAA_]QTYSTU = [F:STJ]QTYSTU
Endif

### AMTVAL
[L]FLD="AMTVAL"
[L]FORMULE='[F:STJ]AMTVAL'
If dim([F:AAA_]AMTVAL)>0
 [F:AAA_]AMTVAL = [F:STJ]AMTVAL
Endif

### AMTORD
[L]FLD="AMTORD"
[L]FORMULE='[F:STJ]AMTORD'
If dim([F:AAA_]AMTORD)>0
 [F:AAA_]AMTORD = [F:STJ]AMTORD
Endif

### AMTDEV
[L]FLD="AMTDEV"
[L]FORMULE='[F:STJ]AMTDEV'
If dim([F:AAA_]AMTDEV)>0
 [F:AAA_]AMTDEV = [F:STJ]AMTDEV
Endif

### AMTVALR
[L]FLD="AMTVALR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTVAL)'
If dim([F:AAA_]AMTVALR)>0
 [F:AAA_]AMTVALR = func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTVAL)
Endif

### AMTORDR
[L]FLD="AMTORDR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTORD)'
If dim([F:AAA_]AMTORDR)>0
 [F:AAA_]AMTORDR = func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTORD)
Endif

### AMTDEVR
[L]FLD="AMTDEVR"
[L]FORMULE='func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTDEV)'
If dim([F:AAA_]AMTDEVR)>0
 [F:AAA_]AMTDEVR = func TRTX3BI.CNVCPYRPT([F:STJ]STOFCY,[F:STJ]IPTDAT,[F:STJ]AMTDEV)
Endif

### BPRNUM
[L]FLD="BPRNUM"
[L]FORMULE='func TRTSTOBI.GETBPRNUM  ([F:STJ]VCRTYP,[F:STJ]VCRNUM,[F:STJ]VCRLIN,[F:STJ]BPRNUM)'
If dim([F:AAA_]BPRNUM)>0
 [F:AAA_]BPRNUM = func TRTSTOBI.GETBPRNUM  ([F:STJ]VCRTYP,[F:STJ]VCRNUM,[F:STJ]VCRLIN,[F:STJ]BPRNUM)
Endif

### PJT
[L]FLD="PJT"
[L]FORMULE='vireblc([F:STJ]PJT,2)'
If dim([F:AAA_]PJT)>0
 [F:AAA_]PJT = vireblc([F:STJ]PJT,2)
Endif

### STAORI
[L]FLD="STAORI"
[L]FORMULE='func TRTSTOBI.GETSTOQLYD  ([F:STJ]VCRTYP,[F:STJ]VCRNUM,[F:STJ]VCRLIN,[F:STJ]QTYSTU)'
If dim([F:AAA_]STAORI)>0
 [F:AAA_]STAORI = func TRTSTOBI.GETSTOQLYD  ([F:STJ]VCRTYP,[F:STJ]VCRNUM,[F:STJ]VCRLIN,[F:STJ]QTYSTU)
Endif

### STADST
[L]FLD="STADST"
[L]FORMULE='[F:STJ]STA'
If dim([F:AAA_]STADST)>0
 [F:AAA_]STADST = [F:STJ]STA
Endif

### RCPFLG
[L]FLD="RCPFLG"
[L]FORMULE='func TRTSTOBI.GETRCPFLG([F:STJ]TRSTYP,[F:STJ]QTYSTU,[F:STJ]AMTVAL)'
If dim([F:AAA_]RCPFLG)>0
 [F:AAA_]RCPFLG = func TRTSTOBI.GETRCPFLG([F:STJ]TRSTYP,[F:STJ]QTYSTU,[F:STJ]AMTVAL)
Endif

### ISSFLG
[L]FLD="ISSFLG"
[L]FORMULE='func TRTSTOBI.GETISSFLG([F:STJ]TRSTYP,[F:STJ]QTYSTU,[F:STJ]AMTVAL)'
If dim([F:AAA_]ISSFLG)>0
 [F:AAA_]ISSFLG = func TRTSTOBI.GETISSFLG([F:STJ]TRSTYP,[F:STJ]QTYSTU,[F:STJ]AMTVAL)
Endif

K = instr(1,GDOSSIER,'@')
If K
 [F:AAA_]ADOS = right$(GDOSSIER,K+1)
Else
 [F:AAA_]ADOS = GDOSSIER
Endif
[F:AAA_]AREG = 'STOJOU1'
[F:AAA_]AIND = indice
[L]FLD="ACLE"
[L]FORMULE="ACLE"
[F:AAA_]ACLE = num$([F:STJ]STOFCY)+'~'+num$([F:STJ]UPDCOD)+'~'+num$([F:STJ]ITMREF)+'~'+num$([F:STJ]IPTDAT)+'~'+num$([F:STJ]MVTSEQ)+'~'+num$([F:STJ]MVTIND)
Return

