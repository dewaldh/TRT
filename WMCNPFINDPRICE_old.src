#<AdxTL>@(#)0.0.0.0 $Revision$Class Purchase price search
# Sage X3 supervisor
## ACLA-CLASSE ## PFINDPRICE
# 2018-06-20 06:50:06 806

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMC0PFINDPRICE
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
For TBLINE=1 to 10
 [L]ALINE = func ASYRSUBTAB.ADDLINE([L]TBLINE,"C_LED","C_PFINDPRICE_C_LED",this)
 If [L]ALINE=[V]CST_ANOTDEFINED : [L]ASTATUS = [V]CST_AERROR : Break : Endif
Next
If [L]ASTATUS = [V]CST_AERROR :  Gosub TESTALLSTAT : Endif
For TBLINE=1 to 2
 [L]ALINE = func ASYRSUBTAB.ADDLINE([L]TBLINE,"C_REP","C_PFINDPRICE_C_REP",this)
 If [L]ALINE=[V]CST_ANOTDEFINED : [L]ASTATUS = [V]CST_AERROR : Break : Endif
Next
If [L]ASTATUS = [V]CST_AERROR :  Gosub TESTALLSTAT : Endif
Gosub INIT_MODULE From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_TYPRECH From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_BPSNUM From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_BPAADD From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_DOCDAT From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_CONVDAT From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_FCY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_PURSALFCY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_CPY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_VACBPR From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_VACBPR_LEG From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_CUR From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_CHGTYP From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_PRITYP From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_PIO From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_PLITYP From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_MLTDIVCOE From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_VATCLCDAT From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_MOIS From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GTYPGEN From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GDECRCU From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GSYSCUR From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GLOCALDEV From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GUPDPRISAL From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GPNTITMREF From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GDECPRI From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GDISCRG From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GPLINBR From WMC2PFINDPRICE : Gosub TESTALLSTAT
If this.PLI<>null
 [L]ASTATUS = fmet this.PLI.AINIT : Gosub TESTALLSTAT
Endif
Gosub INIT_GSPLXGRP From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_GRCPFCY From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_NBLIG From WMC2PFINDPRICE : Gosub TESTALLSTAT
If this.C_PPKH<>null
 [L]ASTATUS = fmet this.C_PPKH.AINIT : Gosub TESTALLSTAT
Endif
Gosub INIT_CREDATTIM From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_UPDDATTIM From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_AUUID From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_CREUSR From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub INIT_UPDUSR From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub AINIT From WMC0PFINDPRICE : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMC0PFINDPRICE
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMC0PFINDPRICE
Gosub LNKPRO_BPSNUM From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPAADD From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_FCY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_PURSALFCY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_CPY From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_VACBPR From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_VACBPR_LEG From WMC1PFINDPRICE : Gosub TESTALLSTAT
For AINDCLA=1 To 2
 If this.C_REP(AINDCLA)<>null& find(this.C_REP(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_REP(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_CUR From WMC1PFINDPRICE : Gosub TESTALLSTAT
For AINDCLA=1 To 10
 If this.C_LED(AINDCLA)<>null& find(this.C_LED(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_LED(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_GDECRCU From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_GSYSCUR From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_GLOCALDEV From WMC1PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_GPNTITMREF From WMC1PFINDPRICE : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.FMTCOLREM)
 If this.FMTCOLREM(AINDCLA)<>null& find(this.FMTCOLREM(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.FMTCOLREM(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If this.PLI<>null
 [L]ASTATUS = fmet this.PLI._ALNKPRO : Gosub TESTALLSTAT
Endif
Gosub LNKPRO_GRCPFCY From WMC2PFINDPRICE : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.C_LINE)
 If this.C_LINE(AINDCLA)<>null& find(this.C_LINE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_LINE(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If this.C_PPKH<>null
 [L]ASTATUS = fmet this.C_PPKH._ALNKPRO : Gosub TESTALLSTAT
Endif
Gosub LNKPRO_CREUSR From WMC2PFINDPRICE : Gosub TESTALLSTAT
Gosub LNKPRO_UPDUSR From WMC2PFINDPRICE : Gosub TESTALLSTAT
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



