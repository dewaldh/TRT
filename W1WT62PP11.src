#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management WT62PP11 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [16/04/2018]
A_HEURE = "14:36:21"
A_USER  = "ADMIN"
A_STAMP = "20180416143621"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WT62PP11 [MBI]
Gosub HORODAT
Local Inpbox "WT62PP11" From GFONCTION At A_STAMP With A_WINDPREV Mask [MBI] As [SIM_]
Grizo [MBI]5
Grizo [MBI]7
Grizo [MBI]10
Grizo [MBI]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MBI]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=37 : Y1(0)=1 : Y2(0)=5
X1(1)=1 : X2(1)=37 : Y1(1)=6 : Y2(1)=7
X1(2)=38 : X2(2)=128 : Y1(2)=1 : Y2(2)=7
X1(3)=1 : X2(3)=128 : Y1(3)=8 : Y2(3)=28
Return

$ON_FCY
Onevent CONTROL Call C_FCY(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_FCY From W1WT62PP11
Onevent BEFORE_INPUT Call AS_FCY(zc) From W1WT62PP11
Onevent INIT_AREA Call D_FCY(zc) From W1WT62PP11
Return

Subprog D_FCY(VALEUR)
Variable Char    VALEUR()
If varinit([M]FCY,indice)=0
 VALEUR = GFCYDEF(8)
Endif
Gosub _AFF
End

Subprog AS_FCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_FCY(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_FCY(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_FCY(zc) From W1WT62PP11
Onkey 146 Titled GBOUTA Call SA_FCY(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_FCY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "FCY" : GZNUM = 1344 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "FCY" : GZNUM = 1344 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","E",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "FCY" : GZNUM = 1344 : Endif
  If !mkstat
   ## Action CONTFCY
   Call CONTFCY(VALEUR) From EXEFNC
   If mkstat : GERR = 1 : GZONE = "FCY" : GZNUM = 1344 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_FCY
Call AM_FCY(zc)
If !mkstat & GOBJET
 zoncou = "FCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_FCY(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "FCY" : GZNUM = 1344 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZFCY)")>indice
 [M]FCY(indice) = VALEUR
 Affzo ZFCY(indice)
Endif
Gosub _AFF
End

Subprog S_FCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "E"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_FCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZFCY
Onevent BEFORE_AREA Gosub AV_ZFCY From W1WT62PP11
Return

$AV_ZFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]FCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_ENDDATSTR
Onevent BEFORE_AREA Gosub AV_ENDDATSTR From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_ENDDATSTR From W1WT62PP11
Onevent BEFORE_INPUT Call AS_ENDDATSTR(zc) From W1WT62PP11
Return

$AV_ENDDATSTR
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATSTRF) From ADATREL
Chgfmt [M]ENDDATSTR(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_ENDDATSTR(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ENDDATSTR(zc) From W1WT62PP11
Gosub _AFF
End

$AMM_ENDDATSTR
Call AM_ENDDATSTR(zc)
If !mkstat & GOBJET
 zoncou = "ENDDATSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDATSTR(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATSTRF) From ADATREL
If mkstat : GERR = 1 : GZONE = "ENDDATSTR" : GZNUM = 1806 : Endif
If !mkstat
 ## Action STD
 Call AM_ENDDATSTR(VALEUR) From FUNBENCHI
 If mkstat : GERR = 1 : GZONE = "ENDDATSTR" : GZNUM = 1806 : Endif
Endif
Gosub _AFF
End

Subprog B1_ENDDATSTR(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATSTRF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATSTRF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ENDDATEND
Onevent BEFORE_AREA Gosub AV_ENDDATEND From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_ENDDATEND From W1WT62PP11
Onevent CONTROL Call C_ENDDATEND(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_ENDDATEND(zc) From W1WT62PP11
Return

$AV_ENDDATEND
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATENDF) From ADATREL
Chgfmt [M]ENDDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_ENDDATEND(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ENDDATEND(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_ENDDATEND(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_ENDDATEND(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "ENDDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ENDDATEND
Call AM_ENDDATEND(zc)
If !mkstat & GOBJET
 zoncou = "ENDDATEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDATEND(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATENDF) From ADATREL
If mkstat : GERR = 1 : GZONE = "ENDDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_ENDDATEND(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATENDF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATENDF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FILTART
Onevent INIT_AREA Call D_FILTART(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_FILTART(zc) From W1WT62PP11
Return

Subprog D_FILTART(VALEUR)
Variable Integer VALEUR
If varinit([M]FILTART,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FILTART(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_WRHE
Onevent INIT_AREA Call D_WRHE(zc) From W1WT62PP11
Return

Subprog D_WRHE(VALEUR)
Variable Char    VALEUR()
If varinit([M]WRHE,indice)=0
 ## Action WRHINIT2
 Call WRHINIT2(VALEUR,[M]FCY,2) From STKWRH
Endif
Gosub _AFF
End

$ON_WMFGNUMD
Onevent CONTROL Call C_WMFGNUMD(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WMFGNUMD(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WMFGNUMD From W1WT62PP11
Return

Subprog AS_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_WMFGNUMD(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WMFGNUMD(INDIC) = VALEUR
 Affzo WMFGNUMD(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WMFGNUMD(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WMFGNUMD" : GZNUM = 23296 : Endif
Endif
Gosub _AFF
End

$AMM_WMFGNUMD
Call AM_WMFGNUMD(zc)
If !mkstat & GOBJET
 zoncou = "WMFGNUMD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WMFGNUMD(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "WMFGNUMD" : GZNUM = 23296 : Endif
Gosub _AFF
End

Subprog S_WMFGNUMD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMTKMFG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMTKMFG"
 PARMSK(1) = [M:MBI]FCY
 PARMSK(2) = "1"
 PARMSK(3) = "2"
 PARMSK(4) = "4"
 PARMSK(5) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMTKMFG","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WMFGNUMF
Onevent CONTROL Call C_WMFGNUMF(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WMFGNUMF(zc) From W1WT62PP11
Return

Subprog AS_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_WMFGNUMF(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WMFGNUMF(INDIC) = VALEUR
 Affzo WMFGNUMF(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WMFGNUMF(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WMFGNUMF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_WMFGNUMF(VALEUR) From FUNBENCHI
 If mkstat : GERR = 1 : GZONE = "WMFGNUMF" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_WMFGNUMF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMTKMFG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMTKMFG"
 PARMSK(1) = [M:MBI]FCY
 PARMSK(2) = "1"
 PARMSK(3) = "2"
 PARMSK(4) = "4"
 PARMSK(5) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMTKMFG","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WITMREFD
Onevent CONTROL Call C_WITMREFD(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WITMREFD(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WITMREFD From W1WT62PP11
Return

Subprog IB_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMREFD(VALEUR)
## Action STD
Call AS_WITMREFD(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WITMREFD(INDIC) = VALEUR
 Affzo WITMREFD(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_WITMREFD(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_WITMREFD(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WITMREFD(zc) From W1WT62PP11
Onkey 146 Titled GBOUTA Call SA_WITMREFD(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 3651 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMREFD
Call AM_WITMREFD(zc)
If !mkstat & GOBJET
 zoncou = "WITMREFD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMREFD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WITMREFD(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "WITMREFD" : GZNUM = 3651 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWITMREFD)")>indice
 [M]WITMREFD(indice) = VALEUR
 Affzo ZWITMREFD(indice)
Endif
Gosub _AFF
End

Subprog S_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMREFD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMREFD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMREFD
Onevent BEFORE_AREA Gosub AV_ZWITMREFD From W1WT62PP11
Return

$AV_ZWITMREFD
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMREFD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WITMREFF
Onevent CONTROL Call C_WITMREFF(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WITMREFF(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WITMREFF From W1WT62PP11
Return

Subprog IB_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMREFF(VALEUR)
## Action STD
Call AS_WITMREFF(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WITMREFF(INDIC) = VALEUR
 Affzo WITMREFF(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_WITMREFF(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_WITMREFF(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WITMREFF(zc) From W1WT62PP11
Onkey 146 Titled GBOUTA Call SA_WITMREFF(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WITMREFF(VALEUR) From FUNBENCHI
   If mkstat : GERR = 1 : GZONE = "WITMREFF" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMREFF
Call AM_WITMREFF(zc)
If !mkstat & GOBJET
 zoncou = "WITMREFF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWITMREFF)")>indice
 [M]WITMREFF(indice) = VALEUR
 Affzo ZWITMREFF(indice)
Endif
Gosub _AFF
End

Subprog S_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WITMREFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMREFF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMREFF
Onevent BEFORE_AREA Gosub AV_ZWITMREFF From W1WT62PP11
Return

$AV_ZWITMREFF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMREFF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WNOMENCD
Onevent CONTROL Call C_WNOMENCD(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WNOMENCD(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WNOMENCD From W1WT62PP11
Return

Subprog IB_WNOMENCD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WNOMENCD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WNOMENCD(VALEUR)
## Action STD
Call AS_WNOMENCD(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WNOMENCD(INDIC) = VALEUR
 Affzo WNOMENCD(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_WNOMENCD(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_WNOMENCD(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WNOMENCD(zc) From W1WT62PP11
Onkey 146 Titled GBOUTA Call SA_WNOMENCD(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WNOMENCD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WNOMENCD" : GZNUM = 3966 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WNOMENCD" : GZNUM = 3966 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WNOMENCD" : GZNUM = 3966 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WNOMENCD
Call AM_WNOMENCD(zc)
If !mkstat & GOBJET
 zoncou = "WNOMENCD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WNOMENCD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WNOMENCD(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "WNOMENCD" : GZNUM = 3966 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWNOMENCD)")>indice
 [M]WNOMENCD(indice) = VALEUR
 Affzo ZWNOMENCD(indice)
Endif
Gosub _AFF
End

Subprog S_WNOMENCD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WNOMENCD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WNOMENCD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WNOMENCD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWNOMENCD
Onevent BEFORE_AREA Gosub AV_ZWNOMENCD From W1WT62PP11
Return

$AV_ZWNOMENCD
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WNOMENCD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WNOMENCF
Onevent CONTROL Call C_WNOMENCF(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_WNOMENCF(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WNOMENCF From W1WT62PP11
Return

Subprog IB_WNOMENCF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WNOMENCF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WNOMENCF(VALEUR)
## Action STD
Call AS_WNOMENCF(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WNOMENCF(INDIC) = VALEUR
 Affzo WNOMENCF(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_WNOMENCF(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_WNOMENCF(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WNOMENCF(zc) From W1WT62PP11
Onkey 146 Titled GBOUTA Call SA_WNOMENCF(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WNOMENCF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WNOMENCF" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WNOMENCF" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WNOMENCF" : GZNUM = 0 : Endif
  If !mkstat
   ## Action STD
   Call C_WNOMENCF(VALEUR) From FUNBENCHI
   If mkstat : GERR = 1 : GZONE = "WNOMENCF" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WNOMENCF
Call AM_WNOMENCF(zc)
If !mkstat & GOBJET
 zoncou = "WNOMENCF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WNOMENCF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWNOMENCF)")>indice
 [M]WNOMENCF(indice) = VALEUR
 Affzo ZWNOMENCF(indice)
Endif
Gosub _AFF
End

Subprog S_WNOMENCF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ITM"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B13_WNOMENCF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WNOMENCF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WNOMENCF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWNOMENCF
Onevent BEFORE_AREA Gosub AV_ZWNOMENCF From W1WT62PP11
Return

$AV_ZWNOMENCF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WNOMENCF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WBOMALTD
Onevent BEFORE_INPUT Call AS_WBOMALTD(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WBOMALTD From W1WT62PP11
Onevent CONTROL Call C_WBOMALTD(zc) From W1WT62PP11
Return

Subprog AS_WBOMALTD(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_WBOMALTD(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WBOMALTD(INDIC) = VALEUR
 Affzo WBOMALTD(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WBOMALTD(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WBOMALTD(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WBOMALTD(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!B",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WBOMALTD" : GZNUM = 3964 : Endif
Gosub _AFF
End

$AMM_WBOMALTD
Call AM_WBOMALTD(zc)
If !mkstat & GOBJET
 zoncou = "WBOMALTD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMALTD(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_WBOMALTD(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "WBOMALTD" : GZNUM = 3964 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMALTD)")>indice
 [M]WBOMALTD(indice) = VALEUR
 Affzo ZWBOMALTD(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMALTD(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]FCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_WBOMALTD(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMALTD
Onevent BEFORE_AREA Gosub AV_ZWBOMALTD From W1WT62PP11
Return

$AV_ZWBOMALTD
Call LECTEXTRA(zc,"TABBOMALT","TBOSHOAXX","2",num$([M]WBOMALTD(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_WBOMALTF
Onevent BEFORE_INPUT Call AS_WBOMALTF(zc) From W1WT62PP11
Onevent CONTROL Call C_WBOMALTF(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_WBOMALTF From W1WT62PP11
Return

Subprog AS_WBOMALTF(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_WBOMALTF(VALEUR) From FUNBENCHI
If mkstat=2
 [M]WBOMALTF(INDIC) = VALEUR
 Affzo WBOMALTF(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WBOMALTF(zc) From W1WT62PP11
Onkey 144 Titled GBOUTP Call P_WBOMALTF(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_WBOMALTF(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!B",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WBOMALTF" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_WBOMALTF(VALEUR) From FUNBENCHI
 If mkstat : GERR = 1 : GZONE = "WBOMALTF" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_WBOMALTF
Call AM_WBOMALTF(zc)
If !mkstat & GOBJET
 zoncou = "WBOMALTF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBOMALTF(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZWBOMALTF)")>indice
 [M]WBOMALTF(indice) = VALEUR
 Affzo ZWBOMALTF(indice)
Endif
Gosub _AFF
End

Subprog S_WBOMALTF(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]FCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_WBOMALTF(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBOMALTF
Onevent BEFORE_AREA Gosub AV_ZWBOMALTF From W1WT62PP11
Return

$AV_ZWBOMALTF
Call LECTEXTRA(zc,"TABBOMALT","TBOSHOAXX","2",num$([M]WBOMALTF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_WCDED
Return

$ON_WCDEF
Return

$ON_WPJTD
Return

$ON_WPJTF
Return

$ON_FORMULE
Return

$ON_TRSCOD
Onevent INIT_AREA Call D_TRSCOD(zc) From W1WT62PP11
Return

Subprog D_TRSCOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]TRSCOD,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"","") From SUBADI
Endif
Gosub _AFF
End

$ON_SRGLOCDEF
Return

$ON_MEMO
Return

$ON_NBLIG
Onevent CONTROL Call C_NBLIG From W1WT62PP11
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WT62PP11
Onevent AFTER_LINE Call APRES_NBLIG From W1WT62PP11
Onevent BEFORE_INPUT Call AS_NBLIG From W1WT62PP11
Onevent BEFORE_AREA Call AV_NBLIG From W1WT62PP11
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From FUNBENCHI
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W2WT62PP11
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(22452,GBOUT1) From OBJDIV
Call TEXTE(22300,GBOUT2) From OBJDIV
Call TEXTE(10079,GBOUT3) From OBJDIV
Call TEXTE(3966,GBOUT4) From OBJDIV
Call TEXTE(17084,GBOUT5) From OBJDIV
Call TEXTE(12824,GBOUT6) From OBJDIV
Call TEXTE(17096,GBOUT7) From OBJDIV
Call TEXTE(19169,GBOUT8) From OBJDIV
Call TEXTE(19862,GBOUT9) From OBJDIV
Call IB_NBLIG
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WT62PP11
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WT62PP11
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WT62PP11
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WT62PP11
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WT62PP11
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WT62PP11
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WT62PP11
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WT62PP11
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WT62PP11
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVLINCONT
 Call INSERE("NBLIG") From TABLEAUX
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFITRKSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFITRKSTA"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MBI"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFIQTY","MFGWINLIB","XWIMFIQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFIFICHMTK
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFIFICHMTK"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = [M:MBI]MFGNUM(nolign-1)
 PARMSK(3) = num$([M:MBI]MFGLIN(nolign-1))
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFIW","MFGWINLIB","XWIMFIW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB3_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC7A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC7A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE2
 Call OBJET_CHAR(OBJCLE,"BOD",WCLE1) From GOBJET
 ACTION = "BB4_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From FUNBENCHI
If mkstat : End : Endif
## Action LECFICENT
Call LECFICENT([M:MBI]FCY,"","",nolign-1,5,[M:MBI]TRSCOD,3) From STKECR
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action SAISTOENT
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SAISTOENT"
Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
ACTION = "AAPRES_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
PARMSK(1) = "15"
PARMSK(2) = "MBI"
PARMSK(3) = "WQMBI"+GFLAG+mid$("SM",(!!([M:MBI]CREFLG(nolign-1)))+1,1)
PARMSK(4) = num$(nolign-1)
PARMSK(5) = [M:MBI]FCY
PARMSK(6) = ""
PARMSK(7) = "5"
PARMSK(8) = [M:MBI]TRSCOD
Call TRAITE_NUM(BASPAG,PARMSK,"","TRTSTOENT","",1,"XYTRTSTOENT") From GTRAITE
ACTION = "BAPRES_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
Gosub ACTSUB From GOBJSUB
GACTION = SAVACT
If mkstat : End : Endif
## Action SAIENTLOT
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "SAIENTLOT"
PARMSK(1) = "MBI"
PARMSK(2) = "BTS"
PARMSK(3) = num$(nolign-1)
Call TRAITE_NUM(BASPAG,PARMSK,"ISTOENTLO","SUBENTL","",1,"SPEENT") From GTRAITE
GACTION = SAVACT
If mkstat : End : Endif
## Action STD
Call APRES_NBLIG From FUNBENCHI
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ENTRCLI
 GOUVENT = 16384
Endif
If !GWEBSERV
 ## Action SAISTOENT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAISTOENT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "15"
 PARMSK(2) = "MBI"
 PARMSK(3) = "WQMBI"+GFLAG+mid$("SM",(!!([M:MBI]CREFLG(nolign-1)))+1,1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = [M:MBI]FCY
 PARMSK(6) = ""
 PARMSK(7) = "5"
 PARMSK(8) = [M:MBI]TRSCOD
 Call TRAITE_NUM(BASPAG,PARMSK,"","TRTSTOENT","",1,"XYTRTSTOENT") From GTRAITE
 ACTION = "BB5_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSSLO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSLO"
 PARMSK(1) = "0"
 PARMSK(2) = [M:MBI]FCY
 PARMSK(3) = [M:MBI]ITMREF(nolign-1)
 PARMSK(4) = ""
 PARMSK(5) = "0"
 PARMSK(6) = ""
 PARMSK(7) = [M:MBI]LOT(nolign-1)
 Call CONSULT_NUM(BASPAG,"SLO",PARMSK) From GCONSULT
 [M:MBI]LOT(nolign-1) = PARMSK(7)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIBENCHM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIBENCHM"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB7_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MBI]FCY
 PARMSK(2) = string$(GWRHACT-1,num$(sigma(1,min(1,dim([M:MBI]WRH)),[M:MBI]WRH(nolign-1))))
 PARMSK(3) = [M:MBI]MFGNUM(nolign-1)
 PARMSK(4) = ""
 PARMSK(5) = num$([M:MBI]MFGLIN(nolign-1))
 PARMSK(6) = [M:MBI]ITMREF(nolign-1)
 PARMSK(7) = num$([M:MBI]BOMALT(nolign-1))
 PARMSK(8) = "0"
 PARMSK(9) = "MBI"
 PARMSK(10) = ""
 PARMSK(11) = num$(WCONSMAT)
 PARMSK(12) = num$(WCOEFF)
 PARMSK(13) = num$([M:MBI]WMATOK(nolign-1))
 PARMSK(14) = ""
 Call TRAITE_NUM(BASPAG,PARMSK,"IMBM","FUNBENCHM","",5,"XYBENHCM") From GTRAITE
 [M:MBI]WMATOK(nolign-1) = val(PARMSK(13))
 ACTION = "BB7_NBLIG" : PROGSUB = "FUNBENCHI" : PROGSPE = "SPEBENCHI" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B8_NBLIG From FUNBENCHI
Endif
If !GWEBSERV
 ## Action SAIENTLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIENTLOT"
 PARMSK(1) = "MBI"
 PARMSK(2) = "BTS"
 PARMSK(3) = num$(nolign-1)
 Call TRAITE_NUM(BASPAG,PARMSK,"ISTOENTLO","SUBENTL","",1,"SPEENT") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B9_NBLIG From FUNBENCHI
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_IPTDAT
Onevent BEFORE_AREA Gosub AV_IPTDAT From W1WT62PP11
Onevent CONTROL Call C_IPTDAT(zc) From W1WT62PP11
Onevent INIT_AREA Call D_IPTDAT(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_IPTDAT(zc) From W1WT62PP11
Return

$AV_IPTDAT
## Action STD
Call AV_IPTDAT(zc) From FUNBENCHI
Chgfmt [M]IPTDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog D_IPTDAT(VALEUR)
Variable Date    VALEUR
If varinit([M]IPTDAT,indice)=0
 VALEUR = date$
Endif
Gosub _AFF
End

Subprog AS_IPTDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF = 2)
 Affzo IPTDAT : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

Subprog C_IPTDAT(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 212 : Endif
If !mkstat
 ## Action CONTPER
 Call CONTPER(VALEUR,1,[M:MBI]FCY) From CPTSUB
 If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 212 : Endif
 If !mkstat
  ## Action STD
  Call C_IPTDAT(VALEUR) From FUNBENCHI
  If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 212 : Endif
  If !mkstat
   ## Action STKCTRIPT
   Call STKCTRIPT(VALEUR,[M:MBI]FCY,"1") From STKLIB
   If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 212 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$ON_PRODTYP
Onevent BEFORE_INPUT Call AS_PRODTYP(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_PRODTYP From W1WT62PP11
Onevent INIT_AREA Call D_PRODTYP(zc) From W1WT62PP11
Onevent CONTROL Call C_PRODTYP(zc) From W1WT62PP11
Return

Subprog D_PRODTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]PRODTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_PRODTYP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]WINDIC(nolign-1) = 0 & GMODIF = 2)
 Affzo PRODTYP : mkstat = 2
Endif
If !mkstat
 Call INICOMBO(2306) From COMBOS
 ## Action STD
 Call AS_PRODTYP(VALEUR) From FUNBENCHI
 If mkstat=2
  [M]PRODTYP(INDIC) = VALEUR
  Affzo PRODTYP(INDIC) : mkstat = 2
 Endif
 If VALEUR<1 | GMENLOC(VALEUR)=1
  VALEUR = find(0,GMENLOC(1..len(mess(0,2306,1))))
 Endif
 If !mkstat
  Discombo 0 From PRODTYP(INDIC)
  If sum(GMENLOC)<>0
   Gosub COMBOS From COMBOS
   For WI=1 to WN : Discombo WCOMBO(WI) From PRODTYP(INDIC) : Next WI
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog C_PRODTYP(VALEUR)
Variable Integer VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "PRODTYP" : GZNUM = 14698 : Endif
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$AMM_PRODTYP
Call AM_PRODTYP(zc)
If !mkstat & GOBJET
 zoncou = "PRODTYP" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRODTYP(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_PRODTYP(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "PRODTYP" : GZNUM = 14698 : Endif
Gosub _AFF
End

$ON_MFGNUM
Onevent CONTROL Call C_MFGNUM(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_MFGNUM(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_MFGNUM From W1WT62PP11
Return

Subprog AS_MFGNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
If !([M]PRODTYP(nolign-1) = 1 & [M]WINDIC(nolign-1) = 0 &GMODIF = 2)
 Affzo MFGNUM : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_MFGNUM(VALEUR) From FUNBENCHI
 If mkstat=2
  [M]MFGNUM(INDIC) = VALEUR
  Affzo MFGNUM(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_MFGNUM(zc) From W1WT62PP11
Endif
Gosub _AFF
End

Subprog C_MFGNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUM" : GZNUM = 4420 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_MFGNUM(VALEUR) From FUNBENCHI
 If mkstat : GERR = 1 : GZONE = "MFGNUM" : GZNUM = 4420 : Endif
Endif
Gosub _AFF
End

$AMM_MFGNUM
Call AM_MFGNUM(zc)
If !mkstat & GOBJET
 zoncou = "MFGNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGNUM(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "MFGNUM" : GZNUM = 4420 : Endif
Gosub _AFF
End

Subprog S_MFGNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMTKMFG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMTKMFG"
 PARMSK(1) = [M:MBI]FCY
 PARMSK(2) = "1"
 PARMSK(3) = "2"
 PARMSK(4) = "4"
 PARMSK(5) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMTKMFG","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1WT62PP11
Onevent BEFORE_AREA Gosub AV_ITMREF From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1WT62PP11
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1WT62PP11
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

$AV_ITMREF
## Action STD
Call AV_ITMREF(zc) From FUNBENCHI
Gosub _AFF
Return

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
If !([M]WINDIC(nolign-1) = 0 & GMODIF = 2)
 Affzo ITMREF : mkstat = 2
Endif
If !mkstat
 Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1WT62PP11
 Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1WT62PP11
 Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1WT62PP11
 Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1WT62PP11
Endif
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action ITMCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "ITMCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREF(VALEUR) From FUNBENCHI
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREF(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITMMBI2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMMBI2"
 PARMSK(1) = [M:MBI]FCY
 PARMSK(2) = [M:MBI]MFGNUM(nolign-1)
 PARMSK(3) = num$([M:MBI]PRODTYP(nolign-1))
 PARMSK(4) = num$([M:MBI]MFGLIN(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITMMBI2","MFGSELLIB","") From GACTION
 [M:MBI]MFGLIN(nolign-1) = val(PARMSK(4))
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_BOMALT
Onevent CONTROL Call C_BOMALT(zc) From W1WT62PP11
Onevent AFTER_AREA Call AP_BOMALT(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_BOMALT(zc) From W1WT62PP11
Return

Subprog AS_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
If !([M]PRODTYP(nolign-1) = 2 & [M]WINDIC(nolign-1) = 0 & GMODIF = 2)
 Affzo BOMALT : mkstat = 2
Endif
If !mkstat
 Onkey   2 Titled GBOUTS Call S_BOMALT(zc) From W1WT62PP11
 Onkey 144 Titled GBOUTP Call P_BOMALT(zc) From W1WT62PP11
Endif
Gosub _AFF
End

Subprog C_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 3964 : Endif
If !mkstat
 ## Action STD
 Call C_BOMALT(VALEUR) From FUNBENCHI
 If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 3964 : Endif
Endif
Gosub _AFF
End

Subprog AP_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AP_BOMALT(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 3964 : Endif
Gosub _AFF
End

Subprog S_BOMALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELMFGNOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNOM"
 PARMSK(1) = [M]FCY
 PARMSK(2) = [M]ITMREF(nolign-1)
 Call S_TAB_NUM(VALEUR,PARMSK,"SELMFGNOM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_UOM
Onevent AFTER_CHANGE Gosub AMM_UOM From W1WT62PP11
Onevent BEFORE_INPUT Call AS_UOM(zc) From W1WT62PP11
Onevent CONTROL Call C_UOM(zc) From W1WT62PP11
Return

Subprog AS_UOM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3612,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !(GMODIF = 2)
 Affzo UOM : mkstat = 2
Endif
If !mkstat
 Onkey 129 Titled GBOUT1 Call B1_UOM(zc) From W1WT62PP11
 Onkey   2 Titled GBOUTS Call S_UOM(zc) From W1WT62PP11
 Onkey 144 Titled GBOUTP Call P_UOM(zc) From W1WT62PP11
 Onkey 146 Titled GBOUTA Call SA_UOM(zc) From W1WT62PP11
Endif
Gosub _AFF
End

Subprog C_UOM(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TUN","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
Endif
Gosub _AFF
End

$AMM_UOM
Call AM_UOM(zc)
If !mkstat & GOBJET
 zoncou = "UOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_UOM(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
Gosub _AFF
End

Subprog S_UOM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELUOMN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELUOMN"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 Call S_LIS_CHAR(VALEUR,PARMSK,"STKSELUOMN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_UOM(VALEUR)
Variable Char    VALEUR()
Call OBJET("TUN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_UOMCPLQTY
Onevent BEFORE_AREA Gosub AV_UOMCPLQTY From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_UOMCPLQTY From W1WT62PP11
Onevent CONTROL Call C_UOMCPLQTY(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_UOMCPLQTY(zc) From W1WT62PP11
Return

$AV_UOMCPLQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]UOMCPLQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_UOMCPLQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF = 2)
 Affzo UOMCPLQTY : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

Subprog C_UOMCPLQTY(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_UOMCPLQTY
Call AM_UOMCPLQTY(zc)
If !mkstat & GOBJET
 zoncou = "UOMCPLQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOMCPLQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_UOMCPLQTY(VALEUR) From FUNBENCHI
If mkstat : GERR = 1 : GZONE = "UOMCPLQTY" : GZNUM = 33104 : Endif
Gosub _AFF
End

$ON_UOMEXTQTY
Onevent BEFORE_AREA Gosub AV_UOMEXTQTY From W1WT62PP11
Return

$AV_UOMEXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:MBI]UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_CSTFLG
Onevent INIT_AREA Call D_CSTFLG(zc) From W1WT62PP11
Return

Subprog D_CSTFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]CSTFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_LOT
Onevent BEFORE_INPUT Call AS_LOT(zc) From W1WT62PP11
Onevent CONTROL Call C_LOT(zc) From W1WT62PP11
Onevent AFTER_CHANGE Gosub AMM_LOT From W1WT62PP11
Return

Subprog IB_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKIBLOT
 Call STKIBLOT(VALEUR,sigma(1,dim([M:MBI]NBSLO)>0,[M:MBI]NBSLO(nolign-1)),2,3,4) From STKACT
Endif
Gosub _AFF
End

Subprog AS_LOT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(20545,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
Call TEXTE(454,GBOUT4) From OBJDIV
Call TEXTE(12824,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_LOT(VALEUR)
## Action STD
Call AS_LOT(VALEUR) From FUNBENCHI
If mkstat=2
 [M]LOT(INDIC) = VALEUR
 Affzo LOT(INDIC) : mkstat = 2
Endif
Onkey 130 Titled GBOUT2 Call B2_LOT(zc) From W1WT62PP11
Onkey 131 Titled GBOUT3 Call B3_LOT(zc) From W1WT62PP11
Onkey 132 Titled GBOUT4 Call B4_LOT(zc) From W1WT62PP11
Onkey 133 Titled GBOUT5 Call B5_LOT(zc) From W1WT62PP11
Onkey   2 Titled GBOUTS Call S_LOT(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKCTRLOT
Call STKCTRLOT(VALEUR,"MBI",nolign-1,[M:MBI]ITMREF(nolign-1),"",15,"",[M:MBI]WLINUM(nolign-1)
&,[M:MBI]MFGNUM(nolign-1),10,[M:MBI]MFGLIN(nolign-1),0,[M:MBI]FCY,"LOCTYP",[M:MBI]GESLOT(nolign-1)) From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

$AMM_LOT
Call AM_LOT(zc)
If !mkstat & GOBJET
 zoncou = "LOT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LOT(VALEUR)
Variable Char    VALEUR()
## Action STKAMLOT
Call STKAMLOT(VALEUR,"MBI",nolign-1,[M:MBI]ITMREF(nolign-1),"SLO") From STKACT
If mkstat : GERR = 1 : GZONE = "LOT" : GZNUM = 2721 : Endif
Gosub _AFF
End

Subprog S_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELLOT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELLOT"
 PARMSK(1) = [M:MBI]ITMREF(nolign-1)
 PARMSK(2) = [M:MBI]FCY
 PARMSK(3) = "MBI"
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELLOT","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B2_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action LOTNUMCPT
 Call LOTNUMCPT(VALEUR,[M:MBI]FCY,[M:MBI]IPTDAT(nolign-1),[M:MBI]ITMREF(nolign-1)) From STKACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action LOTBLANC
 Call STKLOTBLAN(VALEUR) From STKACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_LOT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKINFLOT
 Call INFOLOT("MBI",nolign-1) From STKENT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_LOT(VALEUR)
Variable Char    VALEUR()
## Action CONSSLO
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONSSLO"
PARMSK(1) = "2"
PARMSK(2) = [M:MBI]FCY
PARMSK(3) = [M:MBI]ITMREF(nolign-1)
PARMSK(4) = VALEUR
PARMSK(5) = "0"
PARMSK(6) = ""
PARMSK(7) = VALEUR
Call CONSULT_CHAR(VALEUR,"SLO",PARMSK) From GCONSULT
VALEUR = PARMSK(7)
GACTION = SAVACT
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NBSLO
Return

$ON_SERNUM
Return

$ON_SLO
Return

$ON_LOC
Return

$ON_LOCTYP
Return

$ON_STA
Onevent CONTROL Call C_STA(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_STA(zc) From W1WT62PP11
Return

Subprog AS_STA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_STA(zc) From W1WT62PP11
Gosub _AFF
End

Subprog C_STA(VALEUR)
Variable Char    VALEUR()
## Action STKCTRSTA
Call STKCTRSTA(VALEUR,[F:SRU]AUZSST,[M:MBI]QUAFLG(nolign-1),0,0,mkstat) From STKACT
If mkstat : GERR = 1 : GZONE = "STA" : GZNUM = 1287 : Endif
Gosub _AFF
End

Subprog S_STA(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELSTA"
 PARMSK(1) = [F:SRU]AUZSST
 PARMSK(2) = num$([M:MBI]QUAFLG(nolign-1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELSTA","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CLEFLG
Onevent INIT_AREA Call D_CLEFLG(zc) From W1WT62PP11
Onevent BEFORE_INPUT Call AS_CLEFLG(zc) From W1WT62PP11
Return

Subprog D_CLEFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]CLEFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CLEFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M]PRODTYP(nolign-1) = 1 &  GMODIF = 2)
 Affzo CLEFLG : mkstat = 2
Endif
If !mkstat
 If VALEUR<1
  VALEUR = 1
 Endif
Endif
Gosub _AFF
End

$ON_STU
Return

$CHG_STY
Gosub CHG_STY From W2WT62PP11
Return

$TIT_COL
Gosub TIT_COL From W2WT62PP11
Return


