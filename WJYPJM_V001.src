#<AdxTL>@(#)0.0.0.0 $Revision:   1.1  $

#########################################################################
## Publication d'un objet sous forme de web service 
## Objet                    : PJM
## Transaction              : 
## Champs Invisibles        : No
## Fenêtre                  : OPJM
## Nom de Publication       : YPJM_V001
## Timestamp de génération  : 20180913013007
## Version de génération    : 6.30
#########################################################################
## Subprog OBJET(OK,ZONE,STAT,GRAVE,MESS,ACTION,IDENT,NB,HORDAT,...)
## Subprog LISTE(OK,ZONE,STAT,GRAVE,MESS,ACTION,IDENT,NB,HORDAT,...)
#########################################################################
## Subprog TEST
## Subprog TEST_LISTE(NBLISTE)
#########################################################################
#Call TEST
Call TEST_LISTE(10)
End

#########################################################################
## Test de lecture
#########################################################################
Subprog TEST
Local Char    TEXTE(20)
Local Integer I , J , K
Call OUVRE_TRACE("") From LECFIC
Gosub DEFVAR
WW_ACTION = "READ"      : # READ, CREATE, MODIFY, DELETE, SUPLIG, INSLIG
WW_IDENT  = ""          : # Clé de l Objet Val1~Val2 

Onerrgo ERREURWS
Gosub INITMAJ From ZZWSPJM
Onerrgo

Gosub WEBSERV
Gosub ANALRESOBJ

Onerrgo ERREURWS
Gosub RESMAJ From ZZWSPJM
Onerrgo

#Gosub DETAILRES      : # Pour afficher le détail des variables lues ou écrites
Call FERME_TRACE From LECFIC
Call LEC_TRACE From LECFIC
End

$ERREURWS
Resume

#########################################################################
## Test liste gauche
#########################################################################
Subprog TEST_LISTE(NBLISTE)
Value Integer NBLISTE
Call OUVRE_TRACE("") From LECFIC
Gosub DEFLISTE
WW_ACTION="LIST"
# Left list Description 
# 1 : OPPNUM Project
# 2 : Description
# 3 : OPPSTATE Status
# 4 : SALFCY Site
# 5 : OPPDATLA Launch date
# 6 : OPPDATLV Delivery date
# 7 : OPPDATS Date closed
# 8 : OPPDATTH Suspension date
# 9 : OPPTYP Category
# 10 : OPPCMP BP
# 11 : YJOBCOD Job code
 # Filter for columns
#WW_IDENT="Col1~Col2~Col3~Col4~Col5~Col6~Col7~Col8~Col9~Col10~Col11~"

Onerrgo ERREURWS
Gosub INITLG From ZZWSPJM
Onerrgo

WW_NB=NBLISTE
Gosub WEBLISTE
Gosub ANALRESOBJ

Onerrgo ERREURWS
Gosub RESLG From ZZWSPJM
Onerrgo

For indice=1 To WW_NB
  If indice=1
    Call ECR_TRACE(mess(223,123,1),0) From GESECRAN
    Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
  Endif
  Call ECR_TRACE(num$(indice)+":"
&  -WW_SEL1(indice)
&  -WW_SEL2(indice)
&  -WW_SEL3(indice)
&  -WW_SEL4(indice)
&  -WW_SEL5(indice)
&  -WW_SEL6(indice)
&  -WW_SEL7(indice)
&  -WW_SEL8(indice)
&  -WW_SEL9(indice)
&  -WW_SEL10(indice)
&  -WW_SEL11(indice),0) From GESECRAN
Next indice
Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
Call FERME_TRACE From LECFIC
Call LEC_TRACE From LECFIC
End


$ANALRESOBJ
Case WW_ACTION
 When "READ"   : TEXTE =mess(220,123,1) :   # "Lecture"
 When "CREATE" : TEXTE =mess(59,123,1)  :   # "Création"
 When "MODIFY" : TEXTE =mess(60,123,1)  :   # "Modif"
 When "DELETE" : TEXTE =mess(53,123,1)  :   # "Suppression"
 When "LIST"   : TEXTE =mess(137,124,1) :   # "Liste"
 When "SUPLIG" : TEXTE =mess(92,9009,1) :   # "Suppression ligne"
 When "INSLIG" : TEXTE =mess(91,9009,1) :   # "Insertion ligne"
Endcase
Call ECR_TRACE(mess(218,123,1)+" : "+num$(WW_OK)-"("+mess(WW_OK+3,2940,1)+")",0) From GESECRAN
Case WW_OK
 When 0
    If WW_ZONE<>""
      Call ECR_TRACE(TEXTE-WW_IDENT-":"-mess(32,126,1)-WW_ZONE,0) From GESECRAN
    Endif
 When 1
   Call ECR_TRACE(TEXTE-WW_IDENT-":"-"OK",0) From GESECRAN
 When 9
   Call ECR_TRACE(mess(221,123,1),1) From GESECRAN
Endcase
Call ECR_TRACE(" ",0) From GESECRAN
Call ECR_TRACE(mess(219,123,1)+" : "+num$(WW_STAT),0) From GESECRAN
Call ECR_TRACE("",0) From GESECRAN
Call ECR_TRACE(mess(222,123,1),0) From GESECRAN
Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
For indice=1 To WW_STAT
  If WW_GRAVE(indice)=3
    Call ECR_TRACE(num$(indice)-num$(WW_GRAVE(indice))+" ("+mess(WW_GRAVE(indice),2940,1)+") :"-WW_MESS(indice),1) From GESECRAN
  Else
    Call ECR_TRACE(num$(indice)-num$(WW_GRAVE(indice))+" ("+mess(WW_GRAVE(indice),2940,1)+") :"-WW_MESS(indice),0) From GESECRAN
  Endif
Next indice
If WW_STAT=0 : Call ECR_TRACE("",0) From GESECRAN : Endif
Call ECR_TRACE("-------------------------------------------",0) From GESECRAN
Return


$DEFVAR
Local Integer WW_OK
Local Char    WW_ZONE(30)
Local Integer WW_STAT
Local Integer WW_GRAVE(1..50)
Local Char    WW_MESS(250)(1..50)
Local Char    WW_ACTION
Local Char    WW_IDENT(250)
Local Integer WW_NB
Local Char    WW_HORDAT(14)
Local Char    WW_TAB(20)
Local Char    WW_PAR(80)(1..10)
Local Clbfile WW_TRACE(1)
WW_HORDAT="20180913013007"
Local Char    SALFCY_A(GLONFCY)
Local Char    ZSALFCY_A(30)
Local Char    OPEDEFFCY_A(GLONFCY)
Local Char    ZOPEDEFFCY_A(30)
Local Char    OPPNUM_A(GLONVCR)
Local Char    PIMDESAXX_A(60)
Local Char    PIMDESAX1_A(GLONAX3)
Local Integer OPPSTATE_A
Local Char    ICO_A(GLONICO)
Local Char    OPPCMP_B(GLONBPC)
Local Char    ZOPPCMP_B(30)
Local Char    CUR_B(GLONCUR)
Local Char    ZCUR_B(30)
Local Char    OPPMCN_B(GLONAIN)
Local Char    ZOPPMCN_B(30)
Local Char    OPPREP_B(GLONREP)
Local Char    ZOPPREP_B(30)
Local Char    OPPTYP_B(GLONADI)
Local Char    ZOPPTYP_B(30)
Local Integer OPPINT_B
Local Integer OPPFRT_B
Local Integer OPPMOD_B
Local Char    CUROPP_B(GLONCUR)
Local Char    ZCUROPP_B(30)
Local Integer CHGTYP_B
Local Integer OPPPROACTIV_B
Local Integer TASBUDAUT_B
Local Integer OPPIMPT_B
Local Char    YDEFBAN_B(GLONBAN)
Local Char    ZYDEFBAN_B(30)
Local Clbfile OPPDESTEX_B(6)
Local Clbfile OPPCOMTEX_B(6)
Local Date    OPPDATLA_B
Local Date    OPPDATS_B
Local Date    OPPDATLV_B
Local Date    OPPDATTH_B
Local Date    CREDAT_B
Local Char    CREUSR_B(5)
Local Date    UPDDAT_B
Local Char    UPDUSR_B(5)
Local Integer NBPJM6_1
Local Char    PAFCLB_1(GLONPAUS)(0..9999)
Local Char    PAFNAM_1(GLONNAM)(0..9999)
Local Char    PAFROL_1(GLONADI)(0..9999)
Local Char    ZPAFROL_1(30)(0..9999)
Local Integer NBLIG_2
Local Char    SBBPJT_2(GLONPIM)(0..998)
Local Char    ZSBBPJT_2(30)(0..998)
Local Integer NBLIG_3
Local Char    CPP_3(GLONADI)(0..998)
Local Char    ZCPP_3(30)(0..998)
Local Decimal CPPAMT_3(0..998)
Local Char    ASE_3(GLONDCO)(0..998)
Local Char    SHC_3(GLONDCO)(0..998)
Local Integer NBRDIE_4
Local Char    DIE_4(GLONDIE)(0..19)
Local Char    ZDIE_4(30)(0..19)
Local Char    CCE_4(GLONCCE)(0..19)
Local Char    ZCCE_4(10)(0..19)
Local Char    WW_MODSTAMP(20)
Local Char    WW_MODUSER(20)
Return

$WEBSERV
Call OBJET(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION,WW_IDENT,WW_NB
&         ,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
& ,SALFCY_A,ZSALFCY_A,OPEDEFFCY_A,ZOPEDEFFCY_A,OPPNUM_A,PIMDESAXX_A,PIMDESAX1_A,OPPSTATE_A,ICO_A
& ,OPPCMP_B,ZOPPCMP_B,CUR_B,ZCUR_B,OPPMCN_B,ZOPPMCN_B,OPPREP_B,ZOPPREP_B,OPPTYP_B,ZOPPTYP_B
& ,OPPINT_B,OPPFRT_B,OPPMOD_B,CUROPP_B,ZCUROPP_B,CHGTYP_B,OPPPROACTIV_B,TASBUDAUT_B,OPPIMPT_B,YDEFBAN_B
& ,ZYDEFBAN_B,OPPDESTEX_B,OPPCOMTEX_B,OPPDATLA_B,OPPDATS_B,OPPDATLV_B,OPPDATTH_B,CREDAT_B,CREUSR_B,UPDDAT_B
& ,UPDUSR_B,NBPJM6_1,PAFCLB_1,PAFNAM_1,PAFROL_1,ZPAFROL_1,NBLIG_2,SBBPJT_2,ZSBBPJT_2,NBLIG_3
& ,CPP_3,ZCPP_3,CPPAMT_3,ASE_3,SHC_3,NBRDIE_4,DIE_4,ZDIE_4,CCE_4,ZCCE_4,WW_MODSTAMP,WW_MODUSER)
& From WJYPJM_V001
Return

$DETAILRES
   Call ECR_TRACE("WW_MODSTAMP"-":"-num$(WW_MODSTAMP),0) From GESECRAN
   Call ECR_TRACE("WW_MODUSER"-":"-num$(WW_MODUSER),0) From GESECRAN
# 
   Call ECR_TRACE("SALFCY_A"-":"-num$(SALFCY_A),0) From GESECRAN
   Call ECR_TRACE("ZSALFCY_A"-":"-num$(ZSALFCY_A),0) From GESECRAN
   Call ECR_TRACE("OPEDEFFCY_A"-":"-num$(OPEDEFFCY_A),0) From GESECRAN
   Call ECR_TRACE("ZOPEDEFFCY_A"-":"-num$(ZOPEDEFFCY_A),0) From GESECRAN
   Call ECR_TRACE("OPPNUM_A"-":"-num$(OPPNUM_A),0) From GESECRAN
   Call ECR_TRACE("PIMDESAXX_A"-":"-num$(PIMDESAXX_A),0) From GESECRAN
   Call ECR_TRACE("PIMDESAX1_A"-":"-num$(PIMDESAX1_A),0) From GESECRAN
   Call ECR_TRACE("OPPSTATE_A"-":"-num$(OPPSTATE_A),0) From GESECRAN
   Call ECR_TRACE("ICO_A"-":"-num$(ICO_A),0) From GESECRAN
   Call ECR_TRACE("OPPCMP_B"-":"-num$(OPPCMP_B),0) From GESECRAN
   Call ECR_TRACE("ZOPPCMP_B"-":"-num$(ZOPPCMP_B),0) From GESECRAN
   Call ECR_TRACE("CUR_B"-":"-num$(CUR_B),0) From GESECRAN
   Call ECR_TRACE("ZCUR_B"-":"-num$(ZCUR_B),0) From GESECRAN
   Call ECR_TRACE("OPPMCN_B"-":"-num$(OPPMCN_B),0) From GESECRAN
   Call ECR_TRACE("ZOPPMCN_B"-":"-num$(ZOPPMCN_B),0) From GESECRAN
   Call ECR_TRACE("OPPREP_B"-":"-num$(OPPREP_B),0) From GESECRAN
   Call ECR_TRACE("ZOPPREP_B"-":"-num$(ZOPPREP_B),0) From GESECRAN
   Call ECR_TRACE("OPPTYP_B"-":"-num$(OPPTYP_B),0) From GESECRAN
   Call ECR_TRACE("ZOPPTYP_B"-":"-num$(ZOPPTYP_B),0) From GESECRAN
   Call ECR_TRACE("OPPINT_B"-":"-num$(OPPINT_B),0) From GESECRAN
   Call ECR_TRACE("OPPFRT_B"-":"-num$(OPPFRT_B),0) From GESECRAN
   Call ECR_TRACE("OPPMOD_B"-":"-num$(OPPMOD_B),0) From GESECRAN
   Call ECR_TRACE("CUROPP_B"-":"-num$(CUROPP_B),0) From GESECRAN
   Call ECR_TRACE("ZCUROPP_B"-":"-num$(ZCUROPP_B),0) From GESECRAN
   Call ECR_TRACE("CHGTYP_B"-":"-num$(CHGTYP_B),0) From GESECRAN
   Call ECR_TRACE("OPPPROACTIV_B"-":"-num$(OPPPROACTIV_B),0) From GESECRAN
   Call ECR_TRACE("TASBUDAUT_B"-":"-num$(TASBUDAUT_B),0) From GESECRAN
   Call ECR_TRACE("OPPIMPT_B"-":"-num$(OPPIMPT_B),0) From GESECRAN
   Call ECR_TRACE("YDEFBAN_B"-":"-num$(YDEFBAN_B),0) From GESECRAN
   Call ECR_TRACE("ZYDEFBAN_B"-":"-num$(ZYDEFBAN_B),0) From GESECRAN
   Call ECR_TRACE("OPPDATLA_B"-":"-num$(OPPDATLA_B),0) From GESECRAN
   Call ECR_TRACE("OPPDATS_B"-":"-num$(OPPDATS_B),0) From GESECRAN
   Call ECR_TRACE("OPPDATLV_B"-":"-num$(OPPDATLV_B),0) From GESECRAN
   Call ECR_TRACE("OPPDATTH_B"-":"-num$(OPPDATTH_B),0) From GESECRAN
   Call ECR_TRACE("CREDAT_B"-":"-num$(CREDAT_B),0) From GESECRAN
   Call ECR_TRACE("CREUSR_B"-":"-num$(CREUSR_B),0) From GESECRAN
   Call ECR_TRACE("UPDDAT_B"-":"-num$(UPDDAT_B),0) From GESECRAN
   Call ECR_TRACE("UPDUSR_B"-":"-num$(UPDUSR_B),0) From GESECRAN
   Call ECR_TRACE("NBPJM6_1"-":"-num$(NBPJM6_1),0) From GESECRAN
   Call ECR_TRACE("PAFCLB_1"-":"-num$(PAFCLB_1),0) From GESECRAN
   Call ECR_TRACE("PAFNAM_1"-":"-num$(PAFNAM_1),0) From GESECRAN
   Call ECR_TRACE("PAFROL_1"-":"-num$(PAFROL_1),0) From GESECRAN
   Call ECR_TRACE("ZPAFROL_1"-":"-num$(ZPAFROL_1),0) From GESECRAN
   Call ECR_TRACE("NBLIG_2"-":"-num$(NBLIG_2),0) From GESECRAN
   Call ECR_TRACE("SBBPJT_2"-":"-num$(SBBPJT_2),0) From GESECRAN
   Call ECR_TRACE("ZSBBPJT_2"-":"-num$(ZSBBPJT_2),0) From GESECRAN
   Call ECR_TRACE("NBLIG_3"-":"-num$(NBLIG_3),0) From GESECRAN
   Call ECR_TRACE("CPP_3"-":"-num$(CPP_3),0) From GESECRAN
   Call ECR_TRACE("ZCPP_3"-":"-num$(ZCPP_3),0) From GESECRAN
   Call ECR_TRACE("CPPAMT_3"-":"-num$(CPPAMT_3),0) From GESECRAN
   Call ECR_TRACE("ASE_3"-":"-num$(ASE_3),0) From GESECRAN
   Call ECR_TRACE("SHC_3"-":"-num$(SHC_3),0) From GESECRAN
   Call ECR_TRACE("NBRDIE_4"-":"-num$(NBRDIE_4),0) From GESECRAN
   Call ECR_TRACE("DIE_4"-":"-num$(DIE_4),0) From GESECRAN
   Call ECR_TRACE("ZDIE_4"-":"-num$(ZDIE_4),0) From GESECRAN
   Call ECR_TRACE("CCE_4"-":"-num$(CCE_4),0) From GESECRAN
   Call ECR_TRACE("ZCCE_4"-":"-num$(ZCCE_4),0) From GESECRAN
Return

$DEFLISTE
Local Integer WW_OK
Local Char    WW_ZONE(30)
Local Integer WW_STAT
Local Integer WW_GRAVE(1..50)
Local Char    WW_MESS(250)(1..50)
Local Char    WW_ACTION
Local Char    WW_IDENT(250)
Local Integer WW_NB
Local Char    WW_HORDAT(14)
Local Char    WW_TAB(20)
Local Char    WW_PAR(80)(1..10)
Local Clbfile WW_TRACE(1)
WW_HORDAT="20180913013007"
Local Char    WW_SEL1(30)(1..NBLISTE)
Local Char    WW_SEL2(30)(1..NBLISTE)
Local Char    WW_SEL3(30)(1..NBLISTE)
Local Char    WW_SEL4(30)(1..NBLISTE)
Local Char    WW_SEL5(30)(1..NBLISTE)
Local Char    WW_SEL6(30)(1..NBLISTE)
Local Char    WW_SEL7(30)(1..NBLISTE)
Local Char    WW_SEL8(30)(1..NBLISTE)
Local Char    WW_SEL9(30)(1..NBLISTE)
Local Char    WW_SEL10(30)(1..NBLISTE)
Local Char    WW_SEL11(30)(1..NBLISTE)
Return

$WEBLISTE
Call LISTE(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION,WW_IDENT,WW_NB
&         ,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
& ,WW_SEL1,WW_SEL2,WW_SEL3,WW_SEL4,WW_SEL5,WW_SEL6,WW_SEL7,WW_SEL8,WW_SEL9,WW_SEL10,WW_SEL11)
& From WJYPJM_V001
Return

#########################################################################
## Gestion de l'objet PJM
#########################################################################
Subprog OBJET(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION,WW_IDENT,WW_NB
&         ,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
& ,SALFCY_A,ZSALFCY_A,OPEDEFFCY_A,ZOPEDEFFCY_A,OPPNUM_A,PIMDESAXX_A,PIMDESAX1_A,OPPSTATE_A
& ,ICO_A,OPPCMP_B,ZOPPCMP_B,CUR_B,ZCUR_B,OPPMCN_B,ZOPPMCN_B,OPPREP_B,ZOPPREP_B,OPPTYP_B
& ,ZOPPTYP_B,OPPINT_B,OPPFRT_B,OPPMOD_B,CUROPP_B,ZCUROPP_B,CHGTYP_B,OPPPROACTIV_B,TASBUDAUT_B,OPPIMPT_B
& ,YDEFBAN_B,ZYDEFBAN_B,OPPDESTEX_B,OPPCOMTEX_B,OPPDATLA_B,OPPDATS_B,OPPDATLV_B,OPPDATTH_B,CREDAT_B,CREUSR_B
& ,UPDDAT_B,UPDUSR_B,NBPJM6_1,PAFCLB_1,PAFNAM_1,PAFROL_1,ZPAFROL_1,NBLIG_2,SBBPJT_2,ZSBBPJT_2
& ,NBLIG_3,CPP_3,ZCPP_3,CPPAMT_3,ASE_3,SHC_3,NBRDIE_4,DIE_4,ZDIE_4,CCE_4
& ,ZCCE_4,WW_MODSTAMP,WW_MODUSER)

Variable Integer WW_OK                            : # Statut de retour 1=OK, 0=Pas OK, 2=XML déphasé)
Variable Char    WW_ZONE()                        : # Zone de sortie
Variable Integer WW_STAT                          : # Nombre d'événements
Variable Integer WW_GRAVE(1..)                    : # Gravité (1=info, 2=warning, 3=erreur)
Variable Char    WW_MESS()(1..)                   : # Texte événements
Value    Char    WW_ACTION               : # (READ, CREATE, MODIFY, DELETE, LIST, INSLIG, SUPLIG, ..)
Value    Char    WW_IDENT()                       : # Identifiant (cle1~cle2~...)
Variable Integer WW_NB                            : # Nb d'éléments retournés (liste)
Variable Char    WW_HORDAT()                      : # Horodatage
Variable Char    WW_TAB()                         : # Identification tableau pour maj lignes
Variable Char    WW_PAR()(1..)                    : # Identification lignes
Variable Clbfile WW_TRACE()                       : # Trace serveur
Variable Char    SALFCY_A() Sized 5               : # Sales site
Variable Char    ZSALFCY_A() Sized 30             : # 
Variable Char    OPEDEFFCY_A() Sized 5            : # Operating site
Variable Char    ZOPEDEFFCY_A() Sized 30          : # 
Variable Char    OPPNUM_A() Sized 20              : # Project
Variable Char    PIMDESAXX_A() Sized 60           : # Description
Variable Char    PIMDESAX1_A() Sized 30           : # Short description
Variable Integer OPPSTATE_A                       : # Status
Variable Char    ICO_A() Sized 3                  : # 
Variable Char    OPPCMP_B() Sized 15              : # Customer
Variable Char    ZOPPCMP_B() Sized 30             : # 
Variable Char    CUR_B() Sized 3                  : # Currency
Variable Char    ZCUR_B() Sized 30                : # 
Variable Char    OPPMCN_B() Sized 15              : # Contact (relationship)
Variable Char    ZOPPMCN_B() Sized 30             : # 
Variable Char    OPPREP_B() Sized 15              : # Sales rep
Variable Char    ZOPPREP_B() Sized 30             : # 
Variable Char    OPPTYP_B() Sized 20              : # Category
Variable Char    ZOPPTYP_B() Sized 30             : # 
Variable Integer OPPINT_B                         : # Internal
Variable Integer OPPFRT_B                         : # Provisional
Variable Integer OPPMOD_B                         : # Template
Variable Char    CUROPP_B() Sized 3               : # Overview currency
Variable Char    ZCUROPP_B() Sized 30             : # 
Variable Integer CHGTYP_B                         : # Rate type
Variable Integer OPPPROACTIV_B                    : # Indirect cost overview
Variable Integer TASBUDAUT_B                      : # Budget auto. creation
Variable Integer OPPIMPT_B                        : # Budgeting intermediate levels
Variable Char    YDEFBAN_B() Sized 5              : # Default bank
Variable Char    ZYDEFBAN_B() Sized 30            : # 
Variable Clbfile OPPDESTEX_B()                    : # 
Variable Clbfile OPPCOMTEX_B()                    : # 
Variable Date    OPPDATLA_B                       : # Launch date
Variable Date    OPPDATS_B                        : # Closing date
Variable Date    OPPDATLV_B                       : # Delivery date
Variable Date    OPPDATTH_B                       : # Suspension date
Variable Date    CREDAT_B                         : # Date created
Variable Char    CREUSR_B() Sized 5               : # Creation
Variable Date    UPDDAT_B                         : # Change date
Variable Char    UPDUSR_B() Sized 5               : # Modification
Variable Integer NBPJM6_1                         : # 
Variable Char    PAFCLB_1()(0..) Sized 5          : # Employee
Variable Char    PAFNAM_1()(0..) Sized 35         : # Name
Variable Char    PAFROL_1()(0..) Sized 20         : # Role
Variable Char    ZPAFROL_1()(0..) Sized 30        : # 
Variable Integer NBLIG_2                          : # 
Variable Char    SBBPJT_2()(0..) Sized 40         : # Code
Variable Char    ZSBBPJT_2()(0..) Sized 30        : # 
Variable Integer NBLIG_3                          : # 
Variable Char    CPP_3()(0..) Sized 20            : # Competitor
Variable Char    ZCPP_3()(0..) Sized 30           : # 
Variable Decimal CPPAMT_3(0..)                    : # Competitor amount
Variable Char    ASE_3()(0..) Sized 60            : # Strengths
Variable Char    SHC_3()(0..) Sized 60            : # Weaknesses
Variable Integer NBRDIE_4                         : # 
Variable Char    DIE_4()(0..) Sized 3             : # Dimension type
Variable Char    ZDIE_4()(0..) Sized 30           : # 
Variable Char    CCE_4()(0..) Sized 15            : # Analytical dimension
Variable Char    ZCCE_4()(0..) Sized 10           : # 
Variable Char    WW_MODSTAMP()                    : # Timestamp modif objet
Variable Char    WW_MODUSER()                     : # User modifieur de l'objet

WW_OK=0
Gosub ISDBGON from AWEB
If WW_OK<>0 : End : Endif
Local Char    WW_OBJET(GLONAOB)
Local Char    WW_PROG(GLONADC)
Local Char    WW_BOITE(GLONADC)
Local Char    WW_VARIANTE(GLONADC)
Local Char    WW_TEXTE(250)
Local Char    WW_BOUT(50)
Local Integer WW_I

WW_OBJET    = "PJM"
WW_PROG     = "WJYPJM_V001"
WW_BOITE    = "OPJM"
WW_VARIANTE = ""

Local Char HORDAT1(14)
Local Char HORDATG(14),VERGEN
HORDATG="20180913013007"
VERGEN="6.30"
Call RECUPHDAT("YPJM_V001",HORDAT1,WW_I) from AWEB
Gosub ANLHOROBJ From AWEB
If WW_OK<>0 : Gosub SETTRACE : End : Endif

# Liste des Boutons fenetres
WW_BOUT=""
Local Integer AOB_GES : AOB_GES=1
Local Char ALIAS : ALIAS="YPJM_V001"
Local Char ACTION
ACTION="AV_WS"
GPE=0
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo
If GPE<>1
 Gosub OBJET From AWEB
Endif

ACTION="AP_WS"
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo
Gosub SETTRACE
End

 
 
$SETTRACE
Local Char WPTRACE(200)(1..500)
Local Integer IT
Setlob WPTRACE(1..IT) With WW_TRACE
If instr(1,WPTRACE(1),"adonix.trace.on=on")=0 : Return : Endif
WPTRACE(1)="Engine version    : "+num$(ver$(0))+chr$(10)
WPTRACE(2)="Wrapper timestamp : "+num$(HORDATG)+chr$(10)
WPTRACE(3)="Wrapper version   : "+num$(VERGEN)+chr$(10)
WPTRACE(4)="Duration time     : "+num$(time-val(TSTART))+chr$(10)
WPTRACE(5)="WW_OK     : "+num$(WW_OK)+chr$(10)
WPTRACE(6)="WW_ZONE   : "+num$(WW_ZONE)+chr$(10)
WPTRACE(7)="WW_STAT   : "+num$(WW_STAT)+chr$(10)
IT=8
For indice=1 To WW_STAT
  WPTRACE(IT)="WW_GRAVE("+num$(indice)+")  : "+num$(WW_GRAVE(indice))+chr$(10)
  IT+=1 : WPTRACE(IT)="WW_MESS("+num$(indice)+")   : "+num$(WW_MESS(indice))+chr$(10)
  IT+=1
Next indice
IT+=1 : WPTRACE(IT)="WW_ACTION : "+num$(WW_ACTION)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_IDENT  : "+num$(WW_IDENT)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_NB     : "+num$(WW_NB)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_HORDAT : "+num$(WW_HORDAT)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_TAB    : "+num$(WW_TAB)+chr$(10)
IT+=1 : WPTRACE(IT)="WW_PAR    : "+num$(WW_PAR)+chr$(10)
Setlob WW_TRACE With WPTRACE(1..IT)
Return   

$OUVRE_MASK
Local Mask PJMA0        [A_W0]
Local Integer A_W0_1
Local Mask PJMA1        [A_W1]
Local Integer A_W1_1
Local Integer A_W1_2
Local Integer A_W1_3
Local Integer A_W1_4
Local Integer A_W1_5
Local Integer A_W1_6
Local Integer A_W1_7
Local Mask PJMA6        [A_W2]
Local Integer A_W2_1
Local Mask PJMA3        [A_W3]
Local Integer A_W3_1
Local Mask PJMA2        [A_W4]
Local Integer A_W4_1
Local Mask PJMA4        [A_W5]
Local Integer A_W5_1
Default Mask [PJM0      ]
Return

$SAISIE_MASK
# [M:PJM0]5
If [L]A_W0_1>0
 Saizo [M:PJM0]5 With [M:A_W0]
 If mkstat and status=7
  WW_ZONE = "[M:PJM0]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]5
If [L]A_W1_1>0
 Saizo [M:PJM1]5 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]10
If [L]A_W1_2>0
 Saizo [M:PJM1]10 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]15
If [L]A_W1_3>0
 Saizo [M:PJM1]15 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]20
If [L]A_W1_4>0
 Saizo [M:PJM1]20 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]25
If [L]A_W1_5>0
 Saizo [M:PJM1]25 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]30
If [L]A_W1_6>0
 Saizo [M:PJM1]30 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM1]35
If [L]A_W1_7>0
 Saizo [M:PJM1]35 With [M:A_W1]
 If mkstat and status=7
  WW_ZONE = "[M:PJM1]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM6]5
If [L]A_W2_1>0
 Saizo [M:PJM6]5 With [M:A_W2]
 If mkstat and status=7
  WW_ZONE = "[M:PJM6]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM3]5
If [L]A_W3_1>0
 Saizo [M:PJM3]5 With [M:A_W3]
 If mkstat and status=7
  WW_ZONE = "[M:PJM3]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM2]5
If [L]A_W4_1>0
 Saizo [M:PJM2]5 With [M:A_W4]
 If mkstat and status=7
  WW_ZONE = "[M:PJM2]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
# [M:PJM4]5
If [L]A_W5_1>0
 Saizo [M:PJM4]5 With [M:A_W5]
 If mkstat and status=7
  WW_ZONE = "[M:PJM4]"+zonsor
  If indice>=1 : WW_ZONE+="("+num$(indice+1)+")" : Endif
  Call ERREUR(mess(32,126,1)-WW_ZONE) From GESECRAN
 Endif
Endif
mkstat=0
Return

$CHARGE
Raz [M:A_W0]
Raz [M:A_W1]
Raz [M:A_W2]
Raz [M:A_W3]
Raz [M:A_W4]
Raz [M:A_W5]
If [L]SALFCY_A<>"" : [M:A_W0]SALFCY = [L]SALFCY_A : [L]A_W0_1+=1 : Endif
If [L]ZSALFCY_A<>"" : [M:A_W0]ZSALFCY = [L]ZSALFCY_A : [L]A_W0_1+=1 : Endif
If [L]OPEDEFFCY_A<>"" : [M:A_W0]OPEDEFFCY = [L]OPEDEFFCY_A : [L]A_W0_1+=1 : Endif
If [L]ZOPEDEFFCY_A<>"" : [M:A_W0]ZOPEDEFFCY = [L]ZOPEDEFFCY_A : [L]A_W0_1+=1 : Endif
If [L]OPPNUM_A<>"" : [M:A_W0]OPPNUM = [L]OPPNUM_A : [L]A_W0_1+=1 : Endif
If [L]PIMDESAXX_A<>"" : [M:A_W0]PIMDESAXX = [L]PIMDESAXX_A : [L]A_W0_1+=1 : Endif
If [L]PIMDESAX1_A<>"" : [M:A_W0]PIMDESAX1 = [L]PIMDESAX1_A : [L]A_W0_1+=1 : Endif
If [L]OPPSTATE_A<>0 : [M:A_W0]OPPSTATE = [L]OPPSTATE_A : [L]A_W0_1+=1 : Endif
If [L]ICO_A<>"" : [M:A_W0]ICO = [L]ICO_A : [L]A_W0_1+=1 : Endif
If [L]OPPCMP_B<>"" : [M:A_W1]OPPCMP = [L]OPPCMP_B : [L]A_W1_1+=1 : Endif
If [L]ZOPPCMP_B<>"" : [M:A_W1]ZOPPCMP = [L]ZOPPCMP_B : [L]A_W1_1+=1 : Endif
If [L]CUR_B<>"" : [M:A_W1]CUR = [L]CUR_B : [L]A_W1_1+=1 : Endif
If [L]ZCUR_B<>"" : [M:A_W1]ZCUR = [L]ZCUR_B : [L]A_W1_1+=1 : Endif
If [L]OPPMCN_B<>"" : [M:A_W1]OPPMCN = [L]OPPMCN_B : [L]A_W1_1+=1 : Endif
If [L]ZOPPMCN_B<>"" : [M:A_W1]ZOPPMCN = [L]ZOPPMCN_B : [L]A_W1_1+=1 : Endif
If [L]OPPREP_B<>"" : [M:A_W1]OPPREP = [L]OPPREP_B : [L]A_W1_1+=1 : Endif
If [L]ZOPPREP_B<>"" : [M:A_W1]ZOPPREP = [L]ZOPPREP_B : [L]A_W1_1+=1 : Endif
If [L]OPPTYP_B<>"" : [M:A_W1]OPPTYP = [L]OPPTYP_B : [L]A_W1_2+=1 : Endif
If [L]ZOPPTYP_B<>"" : [M:A_W1]ZOPPTYP = [L]ZOPPTYP_B : [L]A_W1_2+=1 : Endif
If [L]OPPINT_B<>0 : [M:A_W1]OPPINT = [L]OPPINT_B : [L]A_W1_2+=1 : Endif
If [L]OPPFRT_B<>0 : [M:A_W1]OPPFRT = [L]OPPFRT_B : [L]A_W1_2+=1 : Endif
If [L]OPPMOD_B<>0 : [M:A_W1]OPPMOD = [L]OPPMOD_B : [L]A_W1_2+=1 : Endif
If [L]CUROPP_B<>"" : [M:A_W1]CUROPP = [L]CUROPP_B : [L]A_W1_3+=1 : Endif
If [L]ZCUROPP_B<>"" : [M:A_W1]ZCUROPP = [L]ZCUROPP_B : [L]A_W1_3+=1 : Endif
If [L]CHGTYP_B<>0 : [M:A_W1]CHGTYP = [L]CHGTYP_B : [L]A_W1_3+=1 : Endif
If [L]OPPPROACTIV_B<>0 : [M:A_W1]OPPPROACTIV = [L]OPPPROACTIV_B : [L]A_W1_3+=1 : Endif
If [L]TASBUDAUT_B<>0 : [M:A_W1]TASBUDAUT = [L]TASBUDAUT_B : [L]A_W1_3+=1 : Endif
If [L]OPPIMPT_B<>0 : [M:A_W1]OPPIMPT = [L]OPPIMPT_B : [L]A_W1_3+=1 : Endif
If [L]YDEFBAN_B<>"" : [M:A_W1]YDEFBAN = [L]YDEFBAN_B : [L]A_W1_3+=1 : Endif
If [L]ZYDEFBAN_B<>"" : [M:A_W1]ZYDEFBAN = [L]ZYDEFBAN_B : [L]A_W1_3+=1 : Endif
Setlob WW_TEXTE With [L]OPPDESTEX_B
If WW_TEXTE<>"" : [M:A_W1]OPPDESTEX = [L]OPPDESTEX_B : [L]A_W1_4+=1 : Endif
Setlob WW_TEXTE With [L]OPPCOMTEX_B
If WW_TEXTE<>"" : [M:A_W1]OPPCOMTEX = [L]OPPCOMTEX_B : [L]A_W1_5+=1 : Endif
If [L]OPPDATLA_B<>[0/0/0] : [M:A_W1]OPPDATLA = [L]OPPDATLA_B : [L]A_W1_6+=1 : Endif
If [L]OPPDATS_B<>[0/0/0] : [M:A_W1]OPPDATS = [L]OPPDATS_B : [L]A_W1_6+=1 : Endif
If [L]OPPDATLV_B<>[0/0/0] : [M:A_W1]OPPDATLV = [L]OPPDATLV_B : [L]A_W1_6+=1 : Endif
If [L]OPPDATTH_B<>[0/0/0] : [M:A_W1]OPPDATTH = [L]OPPDATTH_B : [L]A_W1_6+=1 : Endif
If [L]CREDAT_B<>[0/0/0] : [M:A_W1]CREDAT = [L]CREDAT_B : [L]A_W1_7+=1 : Endif
If [L]CREUSR_B<>"" : [M:A_W1]CREUSR = [L]CREUSR_B : [L]A_W1_7+=1 : Endif
If [L]UPDDAT_B<>[0/0/0] : [M:A_W1]UPDDAT = [L]UPDDAT_B : [L]A_W1_7+=1 : Endif
If [L]UPDUSR_B<>"" : [M:A_W1]UPDUSR = [L]UPDUSR_B : [L]A_W1_7+=1 : Endif
If [L]NBPJM6_1<>0 : [M:A_W2]NBPJM6 = [L]NBPJM6_1 : [L]A_W2_1+=1 : Endif
If WW_ACTION="MODIFY" and [M:A_W2]NBPJM6=0
  [M:A_W2]NBPJM6 = max([M:A_W2]NBPJM6,[M:PJM6]NBPJM6)
Endif
For WW_I=0 To [M:A_W2]NBPJM6-1
 If [L]PAFCLB_1(WW_I)<>"" : [M:A_W2]PAFCLB(WW_I) = [L]PAFCLB_1(WW_I) : [L]A_W2_1+=1 : Endif
 If [L]PAFNAM_1(WW_I)<>"" : [M:A_W2]PAFNAM(WW_I) = [L]PAFNAM_1(WW_I) : [L]A_W2_1+=1 : Endif
 If [L]PAFROL_1(WW_I)<>"" : [M:A_W2]PAFROL(WW_I) = [L]PAFROL_1(WW_I) : [L]A_W2_1+=1 : Endif
 If [L]ZPAFROL_1(WW_I)<>"" : [M:A_W2]ZPAFROL(WW_I) = [L]ZPAFROL_1(WW_I) : [L]A_W2_1+=1 : Endif
Next WW_I
If [L]NBLIG_2<>0 : [M:A_W3]NBLIG = [L]NBLIG_2 : [L]A_W3_1+=1 : Endif
If WW_ACTION="MODIFY" and [M:A_W3]NBLIG=0
  [M:A_W3]NBLIG = max([M:A_W3]NBLIG,[M:PJM3]NBLIG)
Endif
For WW_I=0 To [M:A_W3]NBLIG-1
 If [L]SBBPJT_2(WW_I)<>"" : [M:A_W3]SBBPJT(WW_I) = [L]SBBPJT_2(WW_I) : [L]A_W3_1+=1 : Endif
 If [L]ZSBBPJT_2(WW_I)<>"" : [M:A_W3]ZSBBPJT(WW_I) = [L]ZSBBPJT_2(WW_I) : [L]A_W3_1+=1 : Endif
Next WW_I
If [L]NBLIG_3<>0 : [M:A_W4]NBLIG = [L]NBLIG_3 : [L]A_W4_1+=1 : Endif
If WW_ACTION="MODIFY" and [M:A_W4]NBLIG=0
  [M:A_W4]NBLIG = max([M:A_W4]NBLIG,[M:PJM2]NBLIG)
Endif
For WW_I=0 To [M:A_W4]NBLIG-1
 If [L]CPP_3(WW_I)<>"" : [M:A_W4]CPP(WW_I) = [L]CPP_3(WW_I) : [L]A_W4_1+=1 : Endif
 If [L]ZCPP_3(WW_I)<>"" : [M:A_W4]ZCPP(WW_I) = [L]ZCPP_3(WW_I) : [L]A_W4_1+=1 : Endif
 If [L]CPPAMT_3(WW_I)<>0 : [M:A_W4]CPPAMT(WW_I) = [L]CPPAMT_3(WW_I) : [L]A_W4_1+=1 : Endif
 If [L]ASE_3(WW_I)<>"" : [M:A_W4]ASE(WW_I) = [L]ASE_3(WW_I) : [L]A_W4_1+=1 : Endif
 If [L]SHC_3(WW_I)<>"" : [M:A_W4]SHC(WW_I) = [L]SHC_3(WW_I) : [L]A_W4_1+=1 : Endif
Next WW_I
If [L]NBRDIE_4<>0 : [M:A_W5]NBRDIE = [L]NBRDIE_4 : [L]A_W5_1+=1 : Endif
If WW_ACTION="MODIFY" and [M:A_W5]NBRDIE=0
  [M:A_W5]NBRDIE = max([M:A_W5]NBRDIE,[M:PJM4]NBRDIE)
Endif
For WW_I=0 To [M:A_W5]NBRDIE-1
 If [L]DIE_4(WW_I)<>"" : [M:A_W5]DIE(WW_I) = [L]DIE_4(WW_I) : [L]A_W5_1+=1 : Endif
 If [L]ZDIE_4(WW_I)<>"" : [M:A_W5]ZDIE(WW_I) = [L]ZDIE_4(WW_I) : [L]A_W5_1+=1 : Endif
 If [L]CCE_4(WW_I)<>"" : [M:A_W5]CCE(WW_I) = [L]CCE_4(WW_I) : [L]A_W5_1+=1 : Endif
 If [L]ZCCE_4(WW_I)<>"" : [M:A_W5]ZCCE(WW_I) = [L]ZCCE_4(WW_I) : [L]A_W5_1+=1 : Endif
Next WW_I
Return
Return
$CHARGEINV
For WW_I=0 To [M:A_W2]NBPJM6-1
Next WW_I
For WW_I=0 To [M:A_W3]NBLIG-1
Next WW_I
For WW_I=0 To [M:A_W4]NBLIG-1
Next WW_I
For WW_I=0 To [M:A_W5]NBRDIE-1
Next WW_I
Return
 
$DECHARGE
[L]SALFCY_A = [M:PJM0]SALFCY
[L]ZSALFCY_A = [M:PJM0]ZSALFCY
[L]OPEDEFFCY_A = [M:PJM0]OPEDEFFCY
[L]ZOPEDEFFCY_A = [M:PJM0]ZOPEDEFFCY
[L]OPPNUM_A = [M:PJM0]OPPNUM
[L]PIMDESAXX_A = [M:PJM0]PIMDESAXX
[L]PIMDESAX1_A = [M:PJM0]PIMDESAX1
[L]OPPSTATE_A = [M:PJM0]OPPSTATE
[L]ICO_A = [M:PJM0]ICO
[L]OPPCMP_B = [M:PJM1]OPPCMP
[L]ZOPPCMP_B = [M:PJM1]ZOPPCMP
[L]CUR_B = [M:PJM1]CUR
[L]ZCUR_B = [M:PJM1]ZCUR
[L]OPPMCN_B = [M:PJM1]OPPMCN
[L]ZOPPMCN_B = [M:PJM1]ZOPPMCN
[L]OPPREP_B = [M:PJM1]OPPREP
[L]ZOPPREP_B = [M:PJM1]ZOPPREP
[L]OPPTYP_B = [M:PJM1]OPPTYP
[L]ZOPPTYP_B = [M:PJM1]ZOPPTYP
[L]OPPINT_B = [M:PJM1]OPPINT
[L]OPPFRT_B = [M:PJM1]OPPFRT
[L]OPPMOD_B = [M:PJM1]OPPMOD
[L]CUROPP_B = [M:PJM1]CUROPP
[L]ZCUROPP_B = [M:PJM1]ZCUROPP
[L]CHGTYP_B = [M:PJM1]CHGTYP
[L]OPPPROACTIV_B = [M:PJM1]OPPPROACTIV
[L]TASBUDAUT_B = [M:PJM1]TASBUDAUT
[L]OPPIMPT_B = [M:PJM1]OPPIMPT
[L]YDEFBAN_B = [M:PJM1]YDEFBAN
[L]ZYDEFBAN_B = [M:PJM1]ZYDEFBAN
[L]OPPDESTEX_B = [M:PJM1]OPPDESTEX
[L]OPPCOMTEX_B = [M:PJM1]OPPCOMTEX
[L]OPPDATLA_B = [M:PJM1]OPPDATLA
[L]OPPDATS_B = [M:PJM1]OPPDATS
[L]OPPDATLV_B = [M:PJM1]OPPDATLV
[L]OPPDATTH_B = [M:PJM1]OPPDATTH
[L]CREDAT_B = [M:PJM1]CREDAT
[L]CREUSR_B = [M:PJM1]CREUSR
[L]UPDDAT_B = [M:PJM1]UPDDAT
[L]UPDUSR_B = [M:PJM1]UPDUSR
[L]NBPJM6_1 = [M:PJM6]NBPJM6
For WW_I=0 To [M:PJM6]NBPJM6-1
 [L]PAFCLB_1(WW_I) = [M:PJM6]PAFCLB(WW_I)
 [L]PAFNAM_1(WW_I) = [M:PJM6]PAFNAM(WW_I)
 [L]PAFROL_1(WW_I) = [M:PJM6]PAFROL(WW_I)
 [L]ZPAFROL_1(WW_I) = [M:PJM6]ZPAFROL(WW_I)
Next WW_I
[L]NBLIG_2 = [M:PJM3]NBLIG
For WW_I=0 To [M:PJM3]NBLIG-1
 [L]SBBPJT_2(WW_I) = [M:PJM3]SBBPJT(WW_I)
 [L]ZSBBPJT_2(WW_I) = [M:PJM3]ZSBBPJT(WW_I)
Next WW_I
[L]NBLIG_3 = [M:PJM2]NBLIG
For WW_I=0 To [M:PJM2]NBLIG-1
 [L]CPP_3(WW_I) = [M:PJM2]CPP(WW_I)
 [L]ZCPP_3(WW_I) = [M:PJM2]ZCPP(WW_I)
 [L]CPPAMT_3(WW_I) = [M:PJM2]CPPAMT(WW_I)
 [L]ASE_3(WW_I) = [M:PJM2]ASE(WW_I)
 [L]SHC_3(WW_I) = [M:PJM2]SHC(WW_I)
Next WW_I
[L]NBRDIE_4 = [M:PJM4]NBRDIE
For WW_I=0 To [M:PJM4]NBRDIE-1
 [L]DIE_4(WW_I) = [M:PJM4]DIE(WW_I)
 [L]ZDIE_4(WW_I) = [M:PJM4]ZDIE(WW_I)
 [L]CCE_4(WW_I) = [M:PJM4]CCE(WW_I)
 [L]ZCCE_4(WW_I) = [M:PJM4]ZCCE(WW_I)
Next WW_I
Return
 
#########################################################################
## Liste gauche
#########################################################################
Subprog LISTE(WW_OK,WW_ZONE,WW_STAT,WW_GRAVE,WW_MESS,WW_ACTION1,WW_IDENT,WW_NB
&         ,WW_HORDAT,WW_TAB,WW_PAR,WW_TRACE
& ,WW_SEL1,WW_SEL2,WW_SEL3,WW_SEL4,WW_SEL5,WW_SEL6,WW_SEL7,WW_SEL8,WW_SEL9,WW_SEL10,WW_SEL11)
Variable Integer WW_OK                            : # Statut de retour 1=OK, 0=Pas OK, 2=XML déphasé)
Variable Char    WW_ZONE()                        : # Zone de sortie
Variable Integer WW_STAT                          : # Nombre d'événements
Variable Integer WW_GRAVE(1..)                    : # Gravité (1=info, 2=warning, 3=bloquant)
Variable Char    WW_MESS()(1..)                   : # Texte événements
Value    Char    WW_ACTION1                       : # Action 
Value    Char    WW_IDENT()                       : # Identifiant (cle1~cle2~...)
Variable Integer WW_NB                            : # Nb d'éléments retournés (liste)
Variable Char    WW_HORDAT()                      : # Horodatage
Variable Char    WW_TAB()                         : # Identification tableau pour maj lignes
Variable Char    WW_PAR()(1..)                    : # Identification lignes
Variable Clbfile WW_TRACE()                       : # Trace serveur
Variable Char    WW_SEL1()(1..)              : #  OPPNUM
Variable Char    WW_SEL2()(1..)              : # [F:AX3]TEXTE 
Variable Char    WW_SEL3()(1..)              : #  OPPSTATE
Variable Char    WW_SEL4()(1..)              : #  SALFCY
Variable Char    WW_SEL5()(1..)              : #  OPPDATLA
Variable Char    WW_SEL6()(1..)              : #  OPPDATLV
Variable Char    WW_SEL7()(1..)              : #  OPPDATS
Variable Char    WW_SEL8()(1..)              : #  OPPDATTH
Variable Char    WW_SEL9()(1..)              : #  OPPTYP
Variable Char    WW_SEL10()(1..)             : #  OPPCMP
Variable Char    WW_SEL11()(1..)             : #  YJOBCOD

WW_OK=0
Gosub ISDBGON from AWEB
If WW_OK<>0 : End : Endif
Local Char    WW_OBJET(GLONAOB)
Local Char    WW_PROG(GLONADC)
Local Char    WW_BOITE(GLONADC)
Local Char    WW_VARIANTE(GLONADC)
Local Char    WW_ACTION
Local Integer WW_I
WW_OBJET    = "PJM"
WW_PROG     = "WJYPJM_V001"
WW_BOITE    = "OPJM"
WW_VARIANTE = ""
WW_ACTION   = "LIST"

Local Char HORDAT1(14)
Local Char HORDATG(14),VERGEN
HORDATG="20180913013007"
VERGEN="6.30"
Call RECUPHDAT("YPJM_V001",HORDAT1,WW_I) from AWEB
Gosub ANLHORSPG From AWEB
If WW_OK<>0 : Gosub SETTRACE : End : Endif

Local Char ALIAS : ALIAS="YPJM_V001"
Local Char ACTION
ACTION="AV_WS"
GPE=0
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo
If GPE<>1
 Gosub OBJET From AWEB
Endif

ACTION="AP_WS"
Onerrgo ERREURWS
Gosub ACTION From SPEWS
Onerrgo

Gosub SETTRACE
End


# Interface liste gauche pour Xtend
$XT_LISTE
Local Char    PRG      :    PRG="WJYPJM_V001"
Local Char    SUBPRG   :    SUBPRG="LISTE"
Local Integer RUBNBR   :    RUBNBR=11
Local Char    RUBCOD        (GLONAVA+2)(0..10)
Local Char    RUBGRP        (GLONAPU)(0..10)
Local Integer RUBINTIT      (0..10)
Local Char    RUBTYP        (GLONATY)(0..10)
Local Integer RUBADR        (0..10)
Local Integer RUBLON        (0..10)
Local Integer RUBDIM        (0..10)
Local Integer RUBMNL        (0..10)
Local Integer RUBRESMAX   :    RUBRESMAX=10000

RUBCOD(0)="OPPNUM" : RUBGRP(0)="RES" : RUBINTIT(0)=18260 : RUBTYP(0)="VCR" : RUBADR(0)=2 : RUBLON(0)=20 : RUBDIM(0)=RUBRESMAX
RUBCOD(1)="C2" : RUBGRP(1)="RES" : RUBINTIT(1)=282 : RUBTYP(1)="DES" : RUBADR(1)=2 : RUBLON(1)=20 : RUBDIM(1)=RUBRESMAX
RUBCOD(2)="OPPSTATE" : RUBGRP(2)="RES" : RUBINTIT(2)=1287 : RUBTYP(2)="M" : RUBADR(2)=2 : RUBLON(2)=9 : RUBDIM(2)=RUBRESMAX : RUBMNL(2)=2249
RUBCOD(3)="SALFCY" : RUBGRP(3)="RES" : RUBINTIT(3)=1344 : RUBTYP(3)="FCY" : RUBADR(3)=2 : RUBLON(3)=5 : RUBDIM(3)=RUBRESMAX
RUBCOD(4)="OPPDATLA" : RUBGRP(4)="RES" : RUBINTIT(4)=41594 : RUBTYP(4)="D" : RUBADR(4)=2 : RUBLON(4)=10 : RUBDIM(4)=RUBRESMAX
RUBCOD(5)="OPPDATLV" : RUBGRP(5)="RES" : RUBINTIT(5)=280 : RUBTYP(5)="D" : RUBADR(5)=2 : RUBLON(5)=10 : RUBDIM(5)=RUBRESMAX
RUBCOD(6)="OPPDATS" : RUBGRP(6)="RES" : RUBINTIT(6)=19341 : RUBTYP(6)="D" : RUBADR(6)=2 : RUBLON(6)=10 : RUBDIM(6)=RUBRESMAX
RUBCOD(7)="OPPDATTH" : RUBGRP(7)="RES" : RUBINTIT(7)=41910 : RUBTYP(7)="D" : RUBADR(7)=2 : RUBLON(7)=10 : RUBDIM(7)=RUBRESMAX
RUBCOD(8)="OPPTYP" : RUBGRP(8)="RES" : RUBINTIT(8)=707 : RUBTYP(8)="ADI" : RUBADR(8)=2 : RUBLON(8)=20 : RUBDIM(8)=RUBRESMAX
RUBCOD(9)="OPPCMP" : RUBGRP(9)="RES" : RUBINTIT(9)=19569 : RUBTYP(9)="BPR" : RUBADR(9)=2 : RUBLON(9)=15 : RUBDIM(9)=RUBRESMAX
RUBCOD(10)="YJOBCOD" : RUBGRP(10)="RES" : RUBINTIT(10)=21780 : RUBTYP(10)="A" : RUBADR(10)=2 : RUBLON(10)=50 : RUBDIM(10)=RUBRESMAX
Return
 
 
# Interface objet pour Xtend
$XT_OBJET
Local Integer WIND : WIND =58
Local Char    PRG      :    PRG="WJYPJM_V001"
Local Char    SUBPRG   :    SUBPRG="OBJET"
Local Integer RUBNBR   :    RUBNBR=WIND+1
Local Char    RUBCOD        (GLONAVA+2)(0..WIND )
Local Char    RUBGRP        (GLONAPU)(0..WIND )
Local Integer RUBINTIT      (0..WIND )
Local Char    RUBTYP        (GLONATY)(0..WIND )    :    # Type X3 (exemple ATY)
Local Integer RUBADR        (0..WIND )
Local Integer RUBLON        (0..WIND )
Local Integer RUBMNL        (0..WIND )
Local Integer RUBDIM        (0..WIND )
 
RUBCOD(0)="SALFCY" : RUBGRP(0)="PJM0_1" : RUBINTIT(0)=6537 : RUBTYP(0)="FCY" : RUBADR(0)=1 : RUBLON(0)=GLONFCY : RUBDIM(0)=1 : RUBMNL(0)=0
RUBCOD(1)="ZSALFCY" : RUBGRP(1)="PJM0_1" : RUBINTIT(1)=0 : RUBTYP(1)="A" : RUBADR(1)=2 : RUBLON(1)=30 : RUBDIM(1)=1 : RUBMNL(1)=0
RUBCOD(2)="OPEDEFFCY" : RUBGRP(2)="PJM0_1" : RUBINTIT(2)=48539 : RUBTYP(2)="FCY" : RUBADR(2)=1 : RUBLON(2)=GLONFCY : RUBDIM(2)=1 : RUBMNL(2)=0
RUBCOD(3)="ZOPEDEFFCY" : RUBGRP(3)="PJM0_1" : RUBINTIT(3)=0 : RUBTYP(3)="A" : RUBADR(3)=2 : RUBLON(3)=30 : RUBDIM(3)=1 : RUBMNL(3)=0
RUBCOD(4)="OPPNUM" : RUBGRP(4)="PJM0_1" : RUBINTIT(4)=18260 : RUBTYP(4)="VCR" : RUBADR(4)=1 : RUBLON(4)=GLONVCR : RUBDIM(4)=1 : RUBMNL(4)=0
RUBCOD(5)="PIMDESAXX" : RUBGRP(5)="PJM0_1" : RUBINTIT(5)=282 : RUBTYP(5)="AXX" : RUBADR(5)=1 : RUBLON(5)=60 : RUBDIM(5)=1 : RUBMNL(5)=0
RUBCOD(6)="PIMDESAX1" : RUBGRP(6)="PJM0_1" : RUBINTIT(6)=42416 : RUBTYP(6)="AX3" : RUBADR(6)=1 : RUBLON(6)=GLONAX3 : RUBDIM(6)=1 : RUBMNL(6)=0
RUBCOD(7)="OPPSTATE" : RUBGRP(7)="PJM0_1" : RUBINTIT(7)=1287 : RUBTYP(7)="M" : RUBADR(7)=2 : RUBLON(7)=20 : RUBDIM(7)=1 : RUBMNL(7)=2249
RUBCOD(8)="ICO" : RUBGRP(8)="PJM0_1" : RUBINTIT(8)=0 : RUBTYP(8)="ICO" : RUBADR(8)=1 : RUBLON(8)=GLONICO : RUBDIM(8)=1 : RUBMNL(8)=0
RUBCOD(9)="OPPCMP" : RUBGRP(9)="PJM1_1" : RUBINTIT(9)=3662 : RUBTYP(9)="BPC" : RUBADR(9)=1 : RUBLON(9)=GLONBPC : RUBDIM(9)=1 : RUBMNL(9)=0
RUBCOD(10)="ZOPPCMP" : RUBGRP(10)="PJM1_1" : RUBINTIT(10)=0 : RUBTYP(10)="A" : RUBADR(10)=2 : RUBLON(10)=30 : RUBDIM(10)=1 : RUBMNL(10)=0
RUBCOD(11)="CUR" : RUBGRP(11)="PJM1_1" : RUBINTIT(11)=323 : RUBTYP(11)="CUR" : RUBADR(11)=1 : RUBLON(11)=GLONCUR : RUBDIM(11)=1 : RUBMNL(11)=0
RUBCOD(12)="ZCUR" : RUBGRP(12)="PJM1_1" : RUBINTIT(12)=0 : RUBTYP(12)="A" : RUBADR(12)=2 : RUBLON(12)=30 : RUBDIM(12)=1 : RUBMNL(12)=0
RUBCOD(13)="OPPMCN" : RUBGRP(13)="PJM1_1" : RUBINTIT(13)=10981 : RUBTYP(13)="AIN" : RUBADR(13)=1 : RUBLON(13)=GLONAIN : RUBDIM(13)=1 : RUBMNL(13)=0
RUBCOD(14)="ZOPPMCN" : RUBGRP(14)="PJM1_1" : RUBINTIT(14)=0 : RUBTYP(14)="A" : RUBADR(14)=2 : RUBLON(14)=30 : RUBDIM(14)=1 : RUBMNL(14)=0
RUBCOD(15)="OPPREP" : RUBGRP(15)="PJM1_1" : RUBINTIT(15)=2929 : RUBTYP(15)="REP" : RUBADR(15)=1 : RUBLON(15)=GLONREP : RUBDIM(15)=1 : RUBMNL(15)=0
RUBCOD(16)="ZOPPREP" : RUBGRP(16)="PJM1_1" : RUBINTIT(16)=0 : RUBTYP(16)="A" : RUBADR(16)=2 : RUBLON(16)=30 : RUBDIM(16)=1 : RUBMNL(16)=0
RUBCOD(17)="OPPTYP" : RUBGRP(17)="PJM1_2" : RUBINTIT(17)=707 : RUBTYP(17)="ADI" : RUBADR(17)=1 : RUBLON(17)=GLONADI : RUBDIM(17)=1 : RUBMNL(17)=0
RUBCOD(18)="ZOPPTYP" : RUBGRP(18)="PJM1_2" : RUBINTIT(18)=0 : RUBTYP(18)="A" : RUBADR(18)=2 : RUBLON(18)=30 : RUBDIM(18)=1 : RUBMNL(18)=0
RUBCOD(19)="OPPINT" : RUBGRP(19)="PJM1_2" : RUBINTIT(19)=12097 : RUBTYP(19)="M" : RUBADR(19)=1 : RUBLON(19)=10 : RUBDIM(19)=1 : RUBMNL(19)=1
RUBCOD(20)="OPPFRT" : RUBGRP(20)="PJM1_2" : RUBINTIT(20)=53514 : RUBTYP(20)="M" : RUBADR(20)=1 : RUBLON(20)=15 : RUBDIM(20)=1 : RUBMNL(20)=1
RUBCOD(21)="OPPMOD" : RUBGRP(21)="PJM1_2" : RUBINTIT(21)=615 : RUBTYP(21)="M" : RUBADR(21)=1 : RUBLON(21)=7 : RUBDIM(21)=1 : RUBMNL(21)=1
RUBCOD(22)="CUROPP" : RUBGRP(22)="PJM1_3" : RUBINTIT(22)=44340 : RUBTYP(22)="CUR" : RUBADR(22)=1 : RUBLON(22)=GLONCUR : RUBDIM(22)=1 : RUBMNL(22)=0
RUBCOD(23)="ZCUROPP" : RUBGRP(23)="PJM1_3" : RUBINTIT(23)=0 : RUBTYP(23)="A" : RUBADR(23)=2 : RUBLON(23)=30 : RUBDIM(23)=1 : RUBMNL(23)=0
RUBCOD(24)="CHGTYP" : RUBGRP(24)="PJM1_3" : RUBINTIT(24)=426 : RUBTYP(24)="M" : RUBADR(24)=1 : RUBLON(24)=15 : RUBDIM(24)=1 : RUBMNL(24)=202
RUBCOD(25)="OPPPROACTIV" : RUBGRP(25)="PJM1_3" : RUBINTIT(25)=56641 : RUBTYP(25)="M" : RUBADR(25)=1 : RUBLON(25)=20 : RUBDIM(25)=1 : RUBMNL(25)=1
RUBCOD(26)="TASBUDAUT" : RUBGRP(26)="PJM1_3" : RUBINTIT(26)=55663 : RUBTYP(26)="M" : RUBADR(26)=1 : RUBLON(26)=25 : RUBDIM(26)=1 : RUBMNL(26)=1
RUBCOD(27)="OPPIMPT" : RUBGRP(27)="PJM1_3" : RUBINTIT(27)=44468 : RUBTYP(27)="M" : RUBADR(27)=1 : RUBLON(27)=30 : RUBDIM(27)=1 : RUBMNL(27)=1
RUBCOD(28)="YDEFBAN" : RUBGRP(28)="PJM1_3" : RUBINTIT(28)=1465 : RUBTYP(28)="BAN" : RUBADR(28)=1 : RUBLON(28)=GLONBAN : RUBDIM(28)=1 : RUBMNL(28)=0
RUBCOD(29)="ZYDEFBAN" : RUBGRP(29)="PJM1_3" : RUBINTIT(29)=0 : RUBTYP(29)="A" : RUBADR(29)=2 : RUBLON(29)=30 : RUBDIM(29)=1 : RUBMNL(29)=0
RUBCOD(30)="OPPDESTEX" : RUBGRP(30)="PJM1_4" : RUBINTIT(30)=0 : RUBTYP(30)="AC0" : RUBADR(30)=1 : RUBLON(30)=10 : RUBDIM(30)=1 : RUBMNL(30)=0
RUBCOD(31)="OPPCOMTEX" : RUBGRP(31)="PJM1_5" : RUBINTIT(31)=0 : RUBTYP(31)="AC0" : RUBADR(31)=1 : RUBLON(31)=10 : RUBDIM(31)=1 : RUBMNL(31)=0
RUBCOD(32)="OPPDATLA" : RUBGRP(32)="PJM1_6" : RUBINTIT(32)=41542 : RUBTYP(32)="D" : RUBADR(32)=2 : RUBLON(32)=30 : RUBDIM(32)=1 : RUBMNL(32)=0
RUBCOD(33)="OPPDATS" : RUBGRP(33)="PJM1_6" : RUBINTIT(33)=41535 : RUBTYP(33)="D" : RUBADR(33)=2 : RUBLON(33)=30 : RUBDIM(33)=1 : RUBMNL(33)=0
RUBCOD(34)="OPPDATLV" : RUBGRP(34)="PJM1_6" : RUBINTIT(34)=24582 : RUBTYP(34)="D" : RUBADR(34)=2 : RUBLON(34)=30 : RUBDIM(34)=1 : RUBMNL(34)=0
RUBCOD(35)="OPPDATTH" : RUBGRP(35)="PJM1_6" : RUBINTIT(35)=41910 : RUBTYP(35)="D" : RUBADR(35)=2 : RUBLON(35)=30 : RUBDIM(35)=1 : RUBMNL(35)=0
RUBCOD(36)="CREDAT" : RUBGRP(36)="PJM1_7" : RUBINTIT(36)=1322 : RUBTYP(36)="D" : RUBADR(36)=2 : RUBLON(36)=30 : RUBDIM(36)=1 : RUBMNL(36)=0
RUBCOD(37)="CREUSR" : RUBGRP(37)="PJM1_7" : RUBINTIT(37)=873 : RUBTYP(37)="A" : RUBADR(37)=2 : RUBLON(37)=5 : RUBDIM(37)=1 : RUBMNL(37)=0
RUBCOD(38)="UPDDAT" : RUBGRP(38)="PJM1_7" : RUBINTIT(38)=1326 : RUBTYP(38)="D" : RUBADR(38)=2 : RUBLON(38)=30 : RUBDIM(38)=1 : RUBMNL(38)=0
RUBCOD(39)="UPDUSR" : RUBGRP(39)="PJM1_7" : RUBINTIT(39)=196 : RUBTYP(39)="A" : RUBADR(39)=2 : RUBLON(39)=5 : RUBDIM(39)=1 : RUBMNL(39)=0
RUBCOD(40)="NBPJM6" : RUBGRP(40)="PJM6_1" : RUBINTIT(40)=0 : RUBTYP(40)="ABS" : RUBADR(40)=1 : RUBLON(40)=4 : RUBDIM(40)=1 : RUBMNL(40)=0
RUBCOD(41)="PAFCLB" : RUBGRP(41)="PJM6_1" : RUBINTIT(41)=16058 : RUBTYP(41)="PAUS" : RUBADR(41)=1 : RUBLON(41)=GLONPAUS : RUBDIM(41)=10000 : RUBMNL(41)=0
RUBCOD(42)="PAFNAM" : RUBGRP(42)="PJM6_1" : RUBINTIT(42)=18622 : RUBTYP(42)="NAM" : RUBADR(42)=2 : RUBLON(42)=GLONNAM : RUBDIM(42)=10000 : RUBMNL(42)=0
RUBCOD(43)="PAFROL" : RUBGRP(43)="PJM6_1" : RUBINTIT(43)=10073 : RUBTYP(43)="ADI" : RUBADR(43)=1 : RUBLON(43)=GLONADI : RUBDIM(43)=10000 : RUBMNL(43)=0
RUBCOD(44)="ZPAFROL" : RUBGRP(44)="PJM6_1" : RUBINTIT(44)=0 : RUBTYP(44)="A" : RUBADR(44)=2 : RUBLON(44)=30 : RUBDIM(44)=10000 : RUBMNL(44)=0
RUBCOD(45)="NBLIG" : RUBGRP(45)="PJM3_1" : RUBINTIT(45)=0 : RUBTYP(45)="ABS" : RUBADR(45)=1 : RUBLON(45)=4 : RUBDIM(45)=1 : RUBMNL(45)=0
RUBCOD(46)="SBBPJT" : RUBGRP(46)="PJM3_1" : RUBINTIT(46)=5296 : RUBTYP(46)="PIM" : RUBADR(46)=1 : RUBLON(46)=GLONPIM : RUBDIM(46)=999 : RUBMNL(46)=0
RUBCOD(47)="ZSBBPJT" : RUBGRP(47)="PJM3_1" : RUBINTIT(47)=0 : RUBTYP(47)="A" : RUBADR(47)=2 : RUBLON(47)=30 : RUBDIM(47)=999 : RUBMNL(47)=0
RUBCOD(48)="NBLIG" : RUBGRP(48)="PJM2_1" : RUBINTIT(48)=0 : RUBTYP(48)="ABS" : RUBADR(48)=1 : RUBLON(48)=4 : RUBDIM(48)=1 : RUBMNL(48)=0
RUBCOD(49)="CPP" : RUBGRP(49)="PJM2_1" : RUBINTIT(49)=15065 : RUBTYP(49)="ADI" : RUBADR(49)=1 : RUBLON(49)=GLONADI : RUBDIM(49)=999 : RUBMNL(49)=0
RUBCOD(50)="ZCPP" : RUBGRP(50)="PJM2_1" : RUBINTIT(50)=0 : RUBTYP(50)="A" : RUBADR(50)=2 : RUBLON(50)=30 : RUBDIM(50)=999 : RUBMNL(50)=0
RUBCOD(51)="CPPAMT" : RUBGRP(51)="PJM2_1" : RUBINTIT(51)=15066 : RUBTYP(51)="MD1" : RUBADR(51)=1 : RUBLON(51)=13.2 : RUBDIM(51)=999 : RUBMNL(51)=0
RUBCOD(52)="ASE" : RUBGRP(52)="PJM2_1" : RUBINTIT(52)=15068 : RUBTYP(52)="DCO" : RUBADR(52)=1 : RUBLON(52)=GLONDCO : RUBDIM(52)=999 : RUBMNL(52)=0
RUBCOD(53)="SHC" : RUBGRP(53)="PJM2_1" : RUBINTIT(53)=15069 : RUBTYP(53)="DCO" : RUBADR(53)=1 : RUBLON(53)=GLONDCO : RUBDIM(53)=999 : RUBMNL(53)=0
RUBCOD(54)="NBRDIE" : RUBGRP(54)="PJM4_1" : RUBINTIT(54)=0 : RUBTYP(54)="ABS" : RUBADR(54)=1 : RUBLON(54)=4 : RUBDIM(54)=1 : RUBMNL(54)=0
RUBCOD(55)="DIE" : RUBGRP(55)="PJM4_1" : RUBINTIT(55)=3984 : RUBTYP(55)="DIE" : RUBADR(55)=2 : RUBLON(55)=GLONDIE : RUBDIM(55)=20 : RUBMNL(55)=0
RUBCOD(56)="ZDIE" : RUBGRP(56)="PJM4_1" : RUBINTIT(56)=0 : RUBTYP(56)="A" : RUBADR(56)=2 : RUBLON(56)=30 : RUBDIM(56)=20 : RUBMNL(56)=0
RUBCOD(57)="CCE" : RUBGRP(57)="PJM4_1" : RUBINTIT(57)=1688 : RUBTYP(57)="CCE" : RUBADR(57)=1 : RUBLON(57)=GLONCCE : RUBDIM(57)=20 : RUBMNL(57)=0
RUBCOD(58)="ZCCE" : RUBGRP(58)="PJM4_1" : RUBINTIT(58)=0 : RUBTYP(58)="A" : RUBADR(58)=2 : RUBLON(58)=10 : RUBDIM(58)=20 : RUBMNL(58)=0
Local Integer RUBKEYIND     (0..0)
RUBKEYIND(0)=4   : # OPPNUM
Return
