#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management MTK1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:53:51"
A_USER  = "ADMIN"
A_STAMP = "20180326125351"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBOPE"
  If [M]NBOPE=0
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt LABCCE1 With GFMTDIE(1)
   Else
    Chgfmt LABCCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt LABCCE2 With GFMTDIE(2)
   Else
    Chgfmt LABCCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt LABCCE3 With GFMTDIE(3)
   Else
    Chgfmt LABCCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt LABCCE4 With GFMTDIE(4)
   Else
    Chgfmt LABCCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt LABCCE5 With GFMTDIE(5)
   Else
    Chgfmt LABCCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt LABCCE6 With GFMTDIE(6)
   Else
    Chgfmt LABCCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt LABCCE7 With GFMTDIE(7)
   Else
    Chgfmt LABCCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt LABCCE8 With GFMTDIE(8)
   Else
    Chgfmt LABCCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt LABCCE9 With GFMTDIE(9)
   Else
    Chgfmt LABCCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt LABCCE10 With GFMTDIE(10)
   Else
    Chgfmt LABCCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt LABCCE11 With GFMTDIE(11)
   Else
    Chgfmt LABCCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt LABCCE12 With GFMTDIE(12)
   Else
    Chgfmt LABCCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt LABCCE13 With GFMTDIE(13)
   Else
    Chgfmt LABCCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt LABCCE14 With GFMTDIE(14)
   Else
    Chgfmt LABCCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt LABCCE15 With GFMTDIE(15)
   Else
    Chgfmt LABCCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt LABCCE16 With GFMTDIE(16)
   Else
    Chgfmt LABCCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt LABCCE17 With GFMTDIE(17)
   Else
    Chgfmt LABCCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt LABCCE18 With GFMTDIE(18)
   Else
    Chgfmt LABCCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt LABCCE19 With GFMTDIE(19)
   Else
    Chgfmt LABCCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt LABCCE20 With GFMTDIE(20)
   Else
    Chgfmt LABCCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask MTK1 [MTK1]
Gosub HORODAT
Local Inpbox "MTK1" From GFONCTION At A_STAMP With A_WINDPREV Mask [MTK1] As [SIM_]
Grizo [MTK1]5
Grizo [MTK1]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [MTK1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=80 : Y1(0)=1 : Y2(0)=3
X1(1)=1 : X2(1)=80 : Y1(1)=4 : Y2(1)=22
Return

$ON_WOPE1
Onevent AFTER_CHANGE Gosub AMM_WOPE1 From W1MTK1
Onevent CONTROL Call C_WOPE1(zc) From W1MTK1
Return

Subprog C_WOPE1(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_WOPE1
Call AM_WOPE1(zc)
If !mkstat & GOBJET
 zoncou = "WOPE1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WOPE1(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_WOPE1(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "WOPE1" : GZNUM = 10838 : Endif
Gosub _AFF
End

$ON_WOPE2
Onevent AFTER_CHANGE Gosub AMM_WOPE2 From W1MTK1
Onevent INIT_AREA Call D_WOPE2(zc) From W1MTK1
Onevent CONTROL Call C_WOPE2(zc) From W1MTK1
Return

Subprog D_WOPE2(VALEUR)
Variable Decimal VALEUR
If varinit([M]WOPE2,indice)=0
 VALEUR = 9999
Endif
Gosub _AFF
End

Subprog C_WOPE2(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_WOPE2
Call AM_WOPE2(zc)
If !mkstat & GOBJET
 zoncou = "WOPE2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WOPE2(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_WOPE2(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "WOPE2" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_FILTOPE
Onevent BEFORE_AREA Gosub AV_FILTOPE From W1MTK1
Onevent AFTER_AREA Call AP_FILTOPE(zc) From W1MTK1
Onevent INIT_AREA Call D_FILTOPE(zc) From W1MTK1
Onevent BEFORE_INPUT Call AS_FILTOPE(zc) From W1MTK1
Return

$AV_FILTOPE
## Action STD
Call AV_FILTOPE(zc) From SUBMTK
Gosub _AFF
Return

Subprog D_FILTOPE(VALEUR)
Variable Integer VALEUR
If varinit([M]FILTOPE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FILTOPE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AP_FILTOPE(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_FILTOPE(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "FILTOPE" : GZNUM = 10104 : Endif
Gosub _AFF
End

$ON_QTESUIVOPE
Onevent BEFORE_AREA Gosub AV_QTESUIVOPE From W1MTK1
Onevent BEFORE_INPUT Call AS_QTESUIVOPE(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_QTESUIVOPE From W1MTK1
Onevent CONTROL Call C_QTESUIVOPE(zc) From W1MTK1
Return

$AV_QTESUIVOPE
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:MTK1]UOM,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTESUIVOPE(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTESUIVOPE(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M:MTK1]FILTOPE <> 3)
 Affzo QTESUIVOPE : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_QTESUIVOPE(VALEUR) From SUBMTK
 If mkstat=2
  [M]QTESUIVOPE(INDIC) = VALEUR
  Affzo QTESUIVOPE(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_QTESUIVOPE(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_QTESUIVOPE
Call AM_QTESUIVOPE(zc)
If !mkstat & GOBJET
 zoncou = "QTESUIVOPE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTESUIVOPE(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_QTESUIVOPE(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "QTESUIVOPE" : GZNUM = 10835 : Endif
Gosub _AFF
End

$ON_UOM
Onevent BEFORE_AREA Gosub AV_UOM From W1MTK1
Return

$AV_UOM
## Action STD
Call AV_UOM(zc) From SUBMTK
Gosub _AFF
Return

$ON_ZUOM
Onevent BEFORE_AREA Gosub AV_ZUOM From W1MTK1
Return

$AV_ZUOM
Call LECTEXTRA(zc,"TABUNIT","DES",num$([M]UOM(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WCOEFF
Onevent INIT_AREA Call D_WCOEFF(zc) From W1MTK1
Return

Subprog D_WCOEFF(VALEUR)
Variable Decimal VALEUR
If varinit([M]WCOEFF,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_NBOPE
Onevent CONTROL Call C_NBOPE From W1MTK1
Onevent BEFORE_LINE Call AVANT_NBOPE From W1MTK1
Onevent AFTER_LINE Call APRES_NBOPE From W1MTK1
Onevent BEFORE_INPUT Call AS_NBOPE From W1MTK1
Onevent BEFORE_AREA Call AV_NBOPE From W1MTK1
Return

Subprog IB_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBOPE From SUBMTK
Endif
Gosub _AFF
End

Subprog AV_NBOPE
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBOPE" : Gosub TIT_COL From W3MTK1
Endif
Gosub _AFF
End

Subprog AS_NBOPE
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(22452,GBOUT1) From OBJDIV
Call TEXTE(17010,GBOUT2) From OBJDIV
Call TEXTE(87,GBOUT3) From OBJDIV
Call TEXTE(5712,GBOUT4) From OBJDIV
Call TEXTE(5712,GBOUT5) From OBJDIV
Call TEXTE(6986,GBOUT6) From OBJDIV
Call TEXTE(454,GBOUT7) From OBJDIV
Call TEXTE(17033,GBOUT8) From OBJDIV
Call TEXTE(10825,GBOUT10) From OBJDIV
Call TEXTE(735,GBOUT11) From OBJDIV
Call TEXTE(735,GBOUT12) From OBJDIV
Call TEXTE(17009,GBOUT13) From OBJDIV
Call IB_NBOPE
Onkey 129 Titled GBOUT1 Call B1_NBOPE From W1MTK1
Onkey 130 Titled GBOUT2 Call B2_NBOPE From W1MTK1
Onkey 131 Titled GBOUT3 Call B3_NBOPE From W1MTK1
Onkey 132 Titled GBOUT4 Call B4_NBOPE From W1MTK1
Onkey 133 Titled GBOUT5 Call B5_NBOPE From W1MTK1
Onkey 134 Titled GBOUT6 Call B6_NBOPE From W1MTK1
Onkey 135 Titled GBOUT7 Call B7_NBOPE From W1MTK1
Onkey 136 Titled GBOUT8 Call B8_NBOPE From W1MTK1
Onkey 138 Titled GBOUT10 Call B10_NBOPE From W1MTK1
Onkey 139 Titled GBOUT11 Call B11_NBOPE From W1MTK1
Onkey 140 Titled GBOUT12 Call B12_NBOPE From W1MTK1
Onkey 170 Titled GBOUT13 Call B13_NBOPE From W1MTK1
Gosub _AFF
End

Subprog C_NBOPE
Local Decimal BASPAG
## Action STD
Call C_NBOPE From SUBMTK
If mkstat : GERR = 1 : GZONE = "NBOPE" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKSTA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKSTA"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MTK1"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOQTY","MFGWINLIB","XWIMFOQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOFICHMTK
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOFICHMTK"
 PARMSK(1) = [M:MTK1]MFGNUMOP(nolign-1)
 PARMSK(2) = num$([M:MTK1]OPENUM(nolign-1))
 PARMSK(3) = num$([M:MTK1]OPESPLNUM(nolign-1))
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOW","MFGWINLIB","XWIMFOW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC7A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC7A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:MTK1]MFGNUMOP(nolign-1)
 Call OBJET_CHAR(OBJCLE,"MFG","") From GOBJET
 ACTION = "BB3_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAITECCRD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAITECCRD"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MTK1]TECCRD(nolign-1)
 PARMSK(2) = num$([M:MTK1]OPENUM(nolign-1))
 PARMSK(3) = [M:MTK0]MFGTRKDAT
 PARMSK(4) = num$([M:MTK1]OPETRKLIN(nolign-1))
 PARMSK(5) = "1"
 PARMSK(6) = [M:MTK0]MFGTRKNUM
 PARMSK(7) = [M:MTK1]MFGNUMOP(nolign-1)
 PARMSK(8) = num$(WMOD)
 PARMSK(9) = "MTK1"
 PARMSK(10) = num$([M:MTK1]OPESPLNUM(nolign-1))
 PARMSK(11) = num$(nolign-1)
 Call TRAITE_NUM(BASPAG,PARMSK,"IQLYCRD","CRDLIB","",1,"") From GTRAITE
 ACTION = "BB4_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBOPE
Local Decimal BASPAG
## Action STD
Call AVANT_NBOPE From SUBMTK
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBOPE
Local Decimal BASPAG
## Action STD
Call APRES_NBOPE From SUBMTK
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B5_NBOPE From SUBMTK
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKFICH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKFICH"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB6_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = num$(WMOD)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMTO1","MFGWINLIB","XWIMTO1") From GSAISIE
 ACTION = "BB6_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action ACLOB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ACLOB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB7_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:MTK1]MKOTEX(nolign-1)
 PARMSK(2) = "MKO"
 PARMSK(3) = "TRTX3TEX"
 PARMSK(4) = "MTK1"
 PARMSK(5) = num$(nolign)
 PARMSK(6) = "1"
 Call TRAITE_NUM(BASPAG,PARMSK,"","ACLOB","ACLOB",3,"XYACLOB") From GTRAITE
 [M:MTK1]MKOTEX(nolign-1) = PARMSK(1)
 ACTION = "BB7_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKFICH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKFICH"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB8_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = num$(WMOD)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMTO1","MFGWINLIB","XWIMTO1") From GSAISIE
 ACTION = "BB8_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MKOREBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MKOREBUT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB10_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "MTK1"
 PARMSK(2) = num$(nolign-1)
 PARMSK(3) = num$(WTRT)
 Call SAISIE_NUM(BASPAG,PARMSK,"IMTO3","MFGWINLIB","XWIMTO3") From GSAISIE
 ACTION = "BB10_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB11_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE2
 Call OBJET_CHAR(OBJCLE,"ROU",WCLE1) From GOBJET
 ACTION = "BB11_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B12_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC6A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC6A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB12_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:MTK0]MFGFCY
 Call OBJET_CHAR(OBJCLE,"MWS",[M:MTK1]CPLWST(nolign-1)) From GOBJET
 ACTION = "BB12_NBOPE" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_NBOPE
Local Decimal BASPAG
If !GWEBSERV
 ## Action MFOTRKSTAB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MFOTRKSTAB"
 PARMSK(1) = num$(nolign-1)
 PARMSK(2) = "MTK1"
 Call SAISIE_NUM(BASPAG,PARMSK,"IMFOQTYB","MFGWINLIB","XWIMFOQTYB") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_NO
Onevent BEFORE_AREA Gosub AV_NO From W1MTK1
Return

$AV_NO
zc = nolign
Gosub _AFF
Return

$ON_TIMTYP
Onevent INIT_AREA Call D_TIMTYP(zc) From W1MTK1
Return

Subprog D_TIMTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]TIMTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_OPENUM
Onevent CONTROL Call C_OPENUM(zc) From W1MTK1
Onevent BEFORE_INPUT Call AS_OPENUM(zc) From W1MTK1
Return

Subprog AS_OPENUM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M:MTK1]WINDIC(nolign-1) <> 1)
 Affzo OPENUM : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

Subprog C_OPENUM(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "OPENUM" : GZNUM = 2296 : Endif
If !mkstat
 ## Action STD
 Call C_OPENUM(VALEUR) From SUBMTK
 If mkstat : GERR = 1 : GZONE = "OPENUM" : GZNUM = 2296 : Endif
Endif
Gosub _AFF
End

$ON_OPESPLNUM
Onevent BEFORE_INPUT Call AS_OPESPLNUM(zc) From W1MTK1
Return

Subprog AS_OPESPLNUM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !([M:MTK1]WINDIC(nolign-1) <> 1)
 Affzo OPESPLNUM : mkstat = 2
Endif
If !mkstat
Endif
Gosub _AFF
End

$ON_STDOPENUM
Onevent CONTROL Call C_STDOPENUM(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_STDOPENUM From W1MTK1
Onevent BEFORE_INPUT Call AS_STDOPENUM(zc) From W1MTK1
Return

Subprog AS_STDOPENUM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
If !([M:MTK1]WINDIC(nolign-1) <> 1)
 Affzo STDOPENUM : mkstat = 2
Endif
If !mkstat
 Onkey   2 Titled GBOUTS Call S_STDOPENUM(zc) From W1MTK1
Endif
Gosub _AFF
End

Subprog C_STDOPENUM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_STDOPENUM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "STDOPENUM" : GZNUM = 2867 : Endif
Gosub _AFF
End

$AMM_STDOPENUM
Call AM_STDOPENUM(zc)
If !mkstat & GOBJET
 zoncou = "STDOPENUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STDOPENUM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_STDOPENUM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "STDOPENUM" : GZNUM = 2867 : Endif
Gosub _AFF
End

Subprog S_STDOPENUM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELSTDOPE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSTDOPE"
 PARMSK(1) = [M:MTK0]MFGFCY
 Call S_TAB_NUM(VALEUR,PARMSK,"SELSTDOPE","MFGSELLIB","") From GACTION
 [M:MTK0]MFGFCY = PARMSK(1)
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_WSTTYP
Onevent INIT_AREA Call D_WSTTYP(zc) From W1MTK1
Return

Subprog D_WSTTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]WSTTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CPLWST
Onevent CONTROL Call C_CPLWST(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CPLWST From W1MTK1
Onevent BEFORE_INPUT Call AS_CPLWST(zc) From W1MTK1
Return

Subprog IB_CPLWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_CPLWST From SUBMTK
Endif
Gosub _AFF
End

Subprog AS_CPLWST(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5972,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_CPLWST(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_CPLWST(zc) From W1MTK1
Onkey   2 Titled GBOUTS Call S_CPLWST(zc) From W1MTK1
Gosub _AFF
End

Subprog C_CPLWST(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "CPLWST" : GZNUM = 9257 : Endif
If !mkstat
 ## Action STD
 Call C_CPLWST(VALEUR) From SUBMTK
 If mkstat : GERR = 1 : GZONE = "CPLWST" : GZNUM = 9257 : Endif
Endif
Gosub _AFF
End

$AMM_CPLWST
Call AM_CPLWST(zc)
If !mkstat & GOBJET
 zoncou = "CPLWST" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLWST(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPLWST(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLWST" : GZNUM = 9257 : Endif
Gosub _AFF
End

Subprog S_CPLWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:MTK0]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CPLWST(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0"
 Local Char    OBJCLE(30)
 OBJCLE = [M:MTK0]MFGFCY
 Call OBJET_CHAR(OBJCLE,"MWS",VALEUR) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPLLAB
Onevent CONTROL Call C_CPLLAB(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CPLLAB From W1MTK1
Onevent BEFORE_INPUT Call AS_CPLLAB(zc) From W1MTK1
Return

Subprog IB_CPLLAB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_CPLLAB From SUBMTK
Endif
Gosub _AFF
End

Subprog AS_CPLLAB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_CPLLAB(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_CPLLAB(zc) From W1MTK1
Onkey   2 Titled GBOUTS Call S_CPLLAB(zc) From W1MTK1
Gosub _AFF
End

Subprog C_CPLLAB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_CPLLAB(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLLAB" : GZNUM = 9285 : Endif
Gosub _AFF
End

$AMM_CPLLAB
Call AM_CPLLAB(zc)
If !mkstat & GOBJET
 zoncou = "CPLLAB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLLAB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPLLAB(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLLAB" : GZNUM = 9285 : Endif
Gosub _AFF
End

Subprog S_CPLLAB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:MTK0]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = "2"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CPLLAB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0"
 Local Char    OBJCLE(30)
 OBJCLE = [M:MTK0]MFGFCY
 Call OBJET_CHAR(OBJCLE,"MWS",VALEUR) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_OPEUOM
Onevent BEFORE_INPUT Call AS_OPEUOM(zc) From W1MTK1
Onevent CONTROL Call C_OPEUOM(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_OPEUOM From W1MTK1
Return

Subprog AS_OPEUOM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_OPEUOM(VALEUR) From SUBMTK
If mkstat=2
 [M]OPEUOM(INDIC) = VALEUR
 Affzo OPEUOM(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_OPEUOM(zc) From W1MTK1
Onkey 144 Titled GBOUTP Call P_OPEUOM(zc) From W1MTK1
Onkey 146 Titled GBOUTA Call SA_OPEUOM(zc) From W1MTK1
Gosub _AFF
End

Subprog C_OPEUOM(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "OPEUOM" : GZNUM = 16460 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TUN","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "OPEUOM" : GZNUM = 16460 : Endif
 If !mkstat
  ## Action STD
  Call C_OPEUOM(VALEUR) From SUBMTK
  If mkstat : GERR = 1 : GZONE = "OPEUOM" : GZNUM = 16460 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_OPEUOM
Call AM_OPEUOM(zc)
If !mkstat & GOBJET
 zoncou = "OPEUOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_OPEUOM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_OPEUOM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "OPEUOM" : GZNUM = 16460 : Endif
Gosub _AFF
End

Subprog S_OPEUOM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOPEUOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOPEUOM"
 PARMSK(1) = [F:MFG]STU
 PARMSK(2) = [M:MTK1]XOPEUOM(nolign-1)
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELOPEUOM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_OPEUOM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_OPEUOM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_SETLABCOE
Onevent BEFORE_INPUT Call AS_SETLABCOE(zc) From W1MTK1
Return

Subprog AS_SETLABCOE(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_SETLABCOE(VALEUR) From SUBMTK
If mkstat=2
 [M]SETLABCOE(INDIC) = VALEUR
 Affzo SETLABCOE(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_XOPEUOM
Return

$ON_EXTQTY
Onevent BEFORE_AREA Gosub AV_EXTQTY From W1MTK1
Return

$AV_EXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:MTK1]OPEUOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTY(indice) With "NPz:"+GUNTFMT
Gosub _AFF
Return

$ON_OPELABCOE
Onevent BEFORE_INPUT Call AS_OPELABCOE(zc) From W1MTK1
Return

Subprog AS_OPELABCOE(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_OPELABCOE(VALEUR) From SUBMTK
If mkstat=2
 [M]OPELABCOE(INDIC) = VALEUR
 Affzo OPELABCOE(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_CPLQTY
Onevent BEFORE_AREA Gosub AV_CPLQTY From W1MTK1
Onevent BEFORE_INPUT Call AS_CPLQTY(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CPLQTY From W1MTK1
Onevent CONTROL Call C_CPLQTY(zc) From W1MTK1
Return

$AV_CPLQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:MTK1]OPEUOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]CPLQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_CPLQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF = 2)
 Affzo CPLQTY : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CPLQTY(VALEUR) From SUBMTK
 If mkstat=2
  [M]CPLQTY(INDIC) = VALEUR
  Affzo CPLQTY(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

Subprog C_CPLQTY(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_CPLQTY
Call AM_CPLQTY(zc)
If !mkstat & GOBJET
 zoncou = "CPLQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_CPLQTY(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLQTY" : GZNUM = 10004 : Endif
Gosub _AFF
End

$ON_REJCPLQTY
Onevent BEFORE_AREA Gosub AV_REJCPLQTY From W1MTK1
Onevent CONTROL Call C_REJCPLQTY(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_REJCPLQTY From W1MTK1
Onevent BEFORE_INPUT Call AS_REJCPLQTY(zc) From W1MTK1
Return

Subprog IB_REJCPLQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_REJCPLQTY From SUBMTK
Endif
Gosub _AFF
End

$AV_REJCPLQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M:MTK1]OPEUOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]REJCPLQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_REJCPLQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(10825,GBOUT1) From OBJDIV
Call IB_REJCPLQTY(VALEUR)
If !(GMODIF = 2)
 Affzo REJCPLQTY : mkstat = 2
Endif
If !mkstat
 Onkey 129 Titled GBOUT1 Call B1_REJCPLQTY(zc) From W1MTK1
Endif
Gosub _AFF
End

Subprog C_REJCPLQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_REJCPLQTY(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "REJCPLQTY" : GZNUM = 2258 : Endif
Gosub _AFF
End

$AMM_REJCPLQTY
Call AM_REJCPLQTY(zc)
If !mkstat & GOBJET
 zoncou = "REJCPLQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_REJCPLQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_REJCPLQTY(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "REJCPLQTY" : GZNUM = 2258 : Endif
Gosub _AFF
End

Subprog B1_REJCPLQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action MKOREBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MKOREBUT"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_REJCPLQTY" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "MTK1"
 PARMSK(2) = num$(nolign-1)
 PARMSK(3) = "0"
 Call SAISIE_NUM(VALEUR,PARMSK,"IMTO3","MFGWINLIB","XWIMTO3") From GSAISIE
 ACTION = "BB1_REJCPLQTY" : PROGSUB = "SUBMTK" : PROGSPE = "SPEMTK" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_TIMUOMCOD
Onevent INIT_AREA Call D_TIMUOMCOD(zc) From W1MTK1
Return

Subprog D_TIMUOMCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]TIMUOMCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CPLUNTTIM
Onevent BEFORE_INPUT Call AS_CPLUNTTIM(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CPLUNTTIM From W1MTK1
Onevent CONTROL Call C_CPLUNTTIM(zc) From W1MTK1
Return

Subprog AS_CPLUNTTIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_CPLUNTTIM(VALEUR) From SUBMTK
If mkstat=2
 [M]CPLUNTTIM(INDIC) = VALEUR
 Affzo CPLUNTTIM(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_CPLUNTTIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_CPLUNTTIM
Call AM_CPLUNTTIM(zc)
If !mkstat & GOBJET
 zoncou = "CPLUNTTIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLUNTTIM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_CPLUNTTIM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLUNTTIM" : GZNUM = 10717 : Endif
Gosub _AFF
End

$ON_CPLSETTIM
Onevent BEFORE_INPUT Call AS_CPLSETTIM(zc) From W1MTK1
Onevent CONTROL Call C_CPLSETTIM(zc) From W1MTK1
Return

Subprog IB_CPLSETTIM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_CPLSETTIM From SUBMTK
Endif
Gosub _AFF
End

Subprog AS_CPLSETTIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT3) From OBJDIV
Call IB_CPLSETTIM(VALEUR)
## Action STD
Call AS_CPLSETTIM(VALEUR) From SUBMTK
If mkstat=2
 [M]CPLSETTIM(INDIC) = VALEUR
 Affzo CPLSETTIM(INDIC) : mkstat = 2
Endif
Onkey 131 Titled GBOUT3 Call B3_CPLSETTIM(zc) From W1MTK1
Gosub _AFF
End

Subprog C_CPLSETTIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

Subprog B3_CPLSETTIM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action MTKCALTPS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MTKCALTPS"
 PARMSK(1) = "MTK1"
 PARMSK(2) = "CPLSETTIM"
 Call TRAITE_NUM(VALEUR,PARMSK,"","MFGWINLIB","DMTO2",3,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPLOPETIM
Onevent BEFORE_INPUT Call AS_CPLOPETIM(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CPLOPETIM From W1MTK1
Onevent CONTROL Call C_CPLOPETIM(zc) From W1MTK1
Return

Subprog IB_CPLOPETIM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_CPLOPETIM From SUBMTK
Endif
Gosub _AFF
End

Subprog AS_CPLOPETIM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT3) From OBJDIV
Call IB_CPLOPETIM(VALEUR)
## Action STD
Call AS_CPLOPETIM(VALEUR) From SUBMTK
If mkstat=2
 [M]CPLOPETIM(INDIC) = VALEUR
 Affzo CPLOPETIM(INDIC) : mkstat = 2
Endif
Onkey 131 Titled GBOUT3 Call B3_CPLOPETIM(zc) From W1MTK1
Gosub _AFF
End

Subprog C_CPLOPETIM(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_CPLOPETIM
Call AM_CPLOPETIM(zc)
If !mkstat & GOBJET
 zoncou = "CPLOPETIM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLOPETIM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_CPLOPETIM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CPLOPETIM" : GZNUM = 9339 : Endif
Gosub _AFF
End

Subprog B3_CPLOPETIM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action MTKCALTPS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MTKCALTPS"
 PARMSK(1) = "MTK1"
 PARMSK(2) = "CPLOPETIM"
 Call TRAITE_NUM(VALEUR,PARMSK,"","MFGWINLIB","DMTO2",3,"") From GTRAITE
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action STD
 Call B3_CPLOPETIM(VALEUR) From SUBMTK
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CLEFLG
Onevent BEFORE_INPUT Call AS_CLEFLG(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_CLEFLG From W1MTK1
Onevent INIT_AREA Call D_CLEFLG(zc) From W1MTK1
Return

Subprog D_CLEFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]CLEFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CLEFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If !(GMODIF = 2)
 Affzo CLEFLG : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_CLEFLG(VALEUR) From SUBMTK
 If mkstat=2
  [M]CLEFLG(INDIC) = VALEUR
  Affzo CLEFLG(INDIC) : mkstat = 2
 Endif
 If VALEUR<1
  VALEUR = 1
 Endif
Endif
Gosub _AFF
End

$AMM_CLEFLG
Call AM_CLEFLG(zc)
If !mkstat & GOBJET
 zoncou = "CLEFLG" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CLEFLG(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_CLEFLG(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "CLEFLG" : GZNUM = 17875 : Endif
Gosub _AFF
End

$ON_EMPNUM
Onevent BEFORE_INPUT Call AS_EMPNUM(zc) From W1MTK1
Onevent CONTROL Call C_EMPNUM(zc) From W1MTK1
Onevent AFTER_CHANGE Gosub AMM_EMPNUM From W1MTK1
Return

Subprog AS_EMPNUM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_EMPNUM(VALEUR) From SUBMTK
If mkstat=2
 [M]EMPNUM(INDIC) = VALEUR
 Affzo EMPNUM(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_EMPNUM(zc) From W1MTK1
Gosub _AFF
End

Subprog C_EMPNUM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_EMPNUM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "EMPNUM" : GZNUM = 10793 : Endif
Gosub _AFF
End

$AMM_EMPNUM
Call AM_EMPNUM(zc)
If !mkstat & GOBJET
 zoncou = "EMPNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EMPNUM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EMPNUM(VALEUR) From SUBMTK
If mkstat : GERR = 1 : GZONE = "EMPNUM" : GZNUM = 10793 : Endif
Gosub _AFF
End

Subprog S_EMPNUM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELEMPNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELEMPNUM"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELEMPNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MSGNUM
Onevent BEFORE_INPUT Call AS_MSGNUM(zc) From W1MTK1
Return

Subprog IB_MSGNUM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call IB_MSGNUM From SUBMTK
Gosub _AFF
End

Subprog AS_MSGNUM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_MSGNUM(VALEUR)
## Action STD
Call AS_MSGNUM(VALEUR) From SUBMTK
If mkstat=2
 [M]MSGNUM(INDIC) = VALEUR
 Affzo MSGNUM(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_MSGNUM(zc) From W1MTK1
Onkey   2 Titled GBOUTS Call S_MSGNUM(zc) From W1MTK1
Gosub _AFF
End

Subprog S_MSGNUM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELMSGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMSGNUM"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELMSGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_MSGNUM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action GOBJETN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETN"
 Call OBJET_NUM([M:MTK1]MSGNUM(nolign-1),"TMS","MSGNUM") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W3MTK1
Return

$TIT_COL
Gosub TIT_COL From W3MTK1
Return


