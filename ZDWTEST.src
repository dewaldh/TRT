#<AdxTL>@(#)0.0.0.0 $Revision$
Local Char ACCQRY(250)(0..)

ACCQRY(0) = "SELECT G.FCY_0, F.FCY_0"
ACCQRY(1) -= "FROM GACCOUNT G"
ACCQRY(2) -= "LEFT OUTER JOIN FACGROUP F ON G.FCY_0 = F.CPY_0"
ACCQRY(3) -= "WHERE ACC_0 = '1095' AND COA_0 = 'A20'"

For (Char FCYA, Char FCYB) From "5" Sql ACCQRY As [YACQ]
  If [F:YACQ]FCYA = "" or [F:YACQ]FCYB = "002-1"
    #No Restriction
    Infbox "1"
  Endif
Next

#Local Char CCEQRY(250)(0..)
#
#CCEQRY(0) = "select C.FCY_0, F.FCY_0"
#CCEQRY(1) -= "FROM CACCE C"
#CCEQRY(2) -= "LEFT OUTER JOIN FACGROUP F ON C.FCY_0 = F.CPY_0"
#CCEQRY(3) -= "WHERE C.CCE_0 = '121' AND C.DIE_0 = 'CAD'"
#For (Char FCYA, Char FCYB) From "5" Sql CCEQRY As [YCCQ]
#  If [F:YCCQ]FCYA = "" or [F:YCCQ]FCYB = "002-1"
#
#  Endif
#Next


#--------------------
# Distinct SUM
#--------------------
#Local Char PQUERY(250)(0..)
#Local Char SUMQRY(250)(0..)
#
#PQUERY(0) = "SELECT distinct PAY.FRMNUM_0, PAY.BAN_0, BAN.YELA_0, PAY.SNS_0, PAY.FRMFLG_0"
#PQUERY(1) -= "FROM PAYMENTH PAY"
#PQUERY(2) -= "INNER JOIN BANK BAN ON PAY.BAN_0 = BAN.BAN_0"
#PQUERY(3) -= "WHERE PAY.STA_0 = 9 AND (PAY.FRMNUM_0 <> '') and BAN.YBANPRNSTA_0 = 1 and PAY.YPSTSTA_0 not in (2,4)"
#PQUERY(4) -= "GROUP BY FRMNUM_0, PAY.BAN_0, BAN.YELA_0,  PAY.NUM_0, PAY.SNS_0, PAY.BPRSAC_0, PAY.BPR_0, PAY.FRMFLG_0"
#
#For (Char YNUM, Char YBAN, Char YELA, Integer YSNS, Integer YFRMFLG) From "5" Sql PQUERY As [YLNK]
#  #-- Get Sum for each distinct YNUM
#  Local Decimal SUMAMT : SUMAMT = 0
#  SUMQRY(0) = "" : SUMQRY(1) = "" : SUMQRY(2) = ""
#  SUMQRY(0) = "SELECT sum(AMTBAN_0)"
#  SUMQRY(1) -= "From PAYMENTH"
#  SUMQRY(2) -= "Where FRMNUM_0 = '"+[F:YLNK]YNUM+"'"
#  For (Decimal YSUM) From "5" Sql SUMQRY As [YSLNK]
#    SUMAMT = [F:YSLNK]YSUM
#  Next
#  Infbox [F:YLNK]YNUM, num$(SUMAMT)
#Next

