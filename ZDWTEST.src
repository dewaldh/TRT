#<AdxTL>@(#)0.0.0.0 $Revision$
Local Char CURDATE : CURDATE = num$(format$("D:YY",date$))
Infbox CURDATE

# If clalev([F:YBDT])   = 0 : Local File YBBDETAILTEM [YBDT]    : Endif
#
# Local Char FCY1(10), FCY2(10)
# Local Integer YMINTRN, YMAXTRN, YCURTRN
# Local Integer YIEMINTRN
# Local Char IEQRY(250)(0..)
#
#Local Char BATNBR(50) : BATNBR = 'BB181200022'
#
#  # -- IE Calculations --
#  Filter [F:YBDT] Where [F:YBDT]YBATNBR = BATNBR and [F:YBDT]YBATTYP = 1
#  For [F:YBDT]
#   #Get Current Transaction Number(s) and run query to get distinct IE sites
#   If YIEMINTRN = 0 : YIEMINTRN = [F:YBDT]YTRANSNBR : Endif
#   IEQRY(0) = "" :  IEQRY(1) = "" #Clear Values
#   IEQRY(0) = "SELECT distinct top 1 YFCY_0 FROM YBBDETAILTEM"
#   IEQRY(1) -= "WHERE YTRANSNBR_0 = "+num$(YIEMINTRN)+" AND YBATNBR_0 = '"+BATNBR+"'"
#   For (Char YFCY1) From "5" Sql IEQRY As [SQL1]
#    FCY1 = [F:SQL1]YFCY1
#   Next
#   IEQRY(1) = ""
#   IEQRY(1) -= "WHERE YTRANSNBR_0 = "+num$(YIEMINTRN)+" AND YBATNBR_0 =  '"+BATNBR+"' AND YFCY_0 <> '"+FCY1+"'"
#   For (Char YFCY2) From "5" Sql IEQRY As [SQL2]
#    FCY2 = [F:SQL2]YFCY2
#   Next
#   #Assign Transaction number
#   YIEMINTRN = [F:YBDT]YTRANSNBR
#   Infbox FCY1, FCY2
#
#  Next
#  Filter [F:YBDT]



#If clalev([F:PYH]) = 0 : Local File PAYMENTH [PYH] : Endif
#Local Integer FLG : FLG = 1
#Local Char YNUM(50) : YNUM = "EFT1901004-1000002"
#
#Filter [F:PYH] Where [F:PYH]FRMFLG = FLG and [F:PYH]FRMNUM = YNUM Order By [F:PYH]FRMLIN Asc
#For [F:PYH]
#
#Next
#Filter [F:PYH]

#Local Char QUERY(250)(0..)
#Local Char DISTNUMQRY(250)(0..)
#
#DISTNUMQRY(0) = "SELECT distinct YNUM_0"
#DISTNUMQRY(1) -= "From YPAYMSIM"
#DISTNUMQRY(2) -= "Where YMESS_0 = 'Validated'"
#
#For (Char YDISTNUM) From "5" Sql DISTNUMQRY As [YDNUM]
#
#  Infbox "Distinct Number Rep: "-[F:YDNUM]YDISTNUM
#  QUERY(0) = "" : QUERY(1) = "" : QUERY(2) = "" : QUERY(3) = "" : QUERY(4) = "" : QUERY(5) = "" : QUERY(6) = ""
#
#  QUERY(0) =  "SELECT YNUM_0, YENTTYP_0, YJOU_0, YTRANSNBR_0, YDES_0, YFCY_0, YCOA_0, YACC_0, YLIGDES_0, YCTRL_0, YBP_0, YDEB_0, YCDT_0, YREF_0,"
#  QUERY(1) -=  "YDIE0_0, YCCE0_0,YDIE1_0, YCCE1_0,YDIE2_0, YCCE2_0,YDIE3_0, YCCE3_0,YDIE4_0, YCCE4_0,YLIG_0, YBAN_0, YFRMFCY_0, YTOFCY_0"
#  QUERY(2) -=  "From YPAYMSIM"
#  QUERY(3) -=  "Where YMESS_0 = 'Validated'  and YNUM_0 = '"+[F:YDNUM]YDISTNUM+"'"
#  QUERY(4) -=  "GROUP By YFCY_0, YNUM_0, YENTTYP_0, YJOU_0, YTRANSNBR_0, YDES_0, YCOA_0, YACC_0, YLIGDES_0, YCTRL_0, YBP_0, YDEB_0, YCDT_0, YREF_0, YDIE0_0, YCCE0_0,YDIE1_0, YCCE1_0,"
#  QUERY(5) -=  "YDIE2_0, YCCE2_0,YDIE3_0, YCCE3_0,YDIE4_0, YCCE4_0, YLIG_0, YBAN_0, YFRMFCY_0, YTOFCY_0"
#  QUERY(6) -=  "Order By YNUM_0, YTRANSNBR_0 Asc"
#
#  For (Char YNUM, Char YENTTYP, Char YJOU, Integer YTRANSNBR , Char YDETDES, Char YFCY,
#&       Char YCOA, Char YACC, Char YLIGDES, Char YCTRL, Char YBP, Decimal YDEB, Decimal YCDT,
#&       Char YREF, Char YDIE0, Char YCCE0,Char YDIE1, Char YCCE1,
#&       Char YDIE2, Char YCCE2, Char YDIE3, Char YCCE3, Char YDIE4, Char YCCE4,
#&       Integer YLIG, Char YBAN, Char YFRMFCY, Char YTOFCY)
#&       From "5" Sql QUERY As [YGLD]
#
#  Infbox "FILCRE:"-[F:YGLD]YNUM, [F:YGLD]YLIGDES
#
#  Next
#Next


#--------------------
# Distinct SUM
#--------------------
#Local Char PQUERY(250)(0..)
#Local Char SUMQRY(250)(0..)
#
#PQUERY(0) = "SELECT distinct PAY.FRMNUM_0, PAY.BAN_0, BAN.YELA_0, PAY.SNS_0, PAY.FRMFLG_0"
#PQUERY(1) -= "FROM PAYMENTH PAY"
#PQUERY(2) -= "INNER JOIN BANK BAN ON PAY.BAN_0 = BAN.BAN_0"
#PQUERY(3) -= "WHERE PAY.STA_0 = 9 AND (PAY.FRMNUM_0 <> '') and BAN.YBANPRNSTA_0 = 1 and PAY.YPSTSTA_0 not in (2,4)"
#PQUERY(4) -= "GROUP BY FRMNUM_0, PAY.BAN_0, BAN.YELA_0,  PAY.NUM_0, PAY.SNS_0, PAY.BPRSAC_0, PAY.BPR_0, PAY.FRMFLG_0"
#
#For (Char YNUM, Char YBAN, Char YELA, Integer YSNS, Integer YFRMFLG) From "5" Sql PQUERY As [YLNK]
#  #-- Get Sum for each distinct YNUM
#  Local Decimal SUMAMT : SUMAMT = 0
#  SUMQRY(0) = "" : SUMQRY(1) = "" : SUMQRY(2) = ""
#  SUMQRY(0) = "SELECT sum(AMTBAN_0)"
#  SUMQRY(1) -= "From PAYMENTH"
#  SUMQRY(2) -= "Where FRMNUM_0 = '"+[F:YLNK]YNUM+"'"
#  For (Decimal YSUM) From "5" Sql SUMQRY As [YSLNK]
#    SUMAMT = [F:YSLNK]YSUM
#  Next
#  Infbox [F:YLNK]YNUM, num$(SUMAMT)
#Next

