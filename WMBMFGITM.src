#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
## BI-REGLE ## Synchronization rule MFGITM

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".MFGITM" : If clalev([F:MFI])=0 : Local File =OUVTAB [MFI] : Endif
OUVTAB = GDOSSIER+".MFGHEAD" : If clalev([F:MFG])=0 : Local File =OUVTAB [MFG] : Endif
OUVTAB = "Link [MFI]"
Link [MFI] With
& [MFG]MFG0 = [F:MFI]MFGNUM
& As [LNK_]
& Where MFGSTA=4
FILTRE = ""
Return

$FERME
If clalev([F:MFI]) : Close local File [MFI] : Endif
If clalev([F:MFG]) : Close local File [MFG] : Endif
Return

$LIEN
Return

$MAJFLD
### MFGFCY
[L]FLD="MFGFCY"
[L]FORMULE='[F:MFI]MFGFCY'
If dim([F:AAA_]MFGFCY)>0
 [F:AAA_]MFGFCY = [F:MFI]MFGFCY
Endif

### MFGSTA
[L]FLD="MFGSTA"
[L]FORMULE='[F:MFI]MFGSTA'
If dim([F:AAA_]MFGSTA)>0
 [F:AAA_]MFGSTA = [F:MFI]MFGSTA
Endif

### MFGNUM
[L]FLD="MFGNUM"
[L]FORMULE='[F:MFI]MFGNUM'
If dim([F:AAA_]MFGNUM)>0
 [F:AAA_]MFGNUM = [F:MFI]MFGNUM
Endif

### LINTYP
[L]FLD="LINTYP"
[L]FORMULE='2'
If dim([F:AAA_]LINTYP)>0
 [F:AAA_]LINTYP = 2
Endif

### STRDAT
[L]FLD="STRDAT"
[L]FORMULE='[F:MFI]STRDAT'
If dim([F:AAA_]STRDAT)>0
 [F:AAA_]STRDAT = [F:MFI]STRDAT
Endif

### ENDDAT
[L]FLD="ENDDAT"
[L]FORMULE='[F:MFI]ENDDAT'
If dim([F:AAA_]ENDDAT)>0
 [F:AAA_]ENDDAT = [F:MFI]ENDDAT
Endif

### DOSSIER
[L]FLD="DOSSIER"
[L]FORMULE='GDOSSIER'
If dim([F:AAA_]DOSSIER)>0
 [F:AAA_]DOSSIER = GDOSSIER
Endif

### ROUNUM
[L]FLD="ROUNUM"
[L]FORMULE='[F:MFG]ROUNUM'
If dim([F:AAA_]ROUNUM)>0
 [F:AAA_]ROUNUM = [F:MFG]ROUNUM
Endif

### ROUALT
[L]FLD="ROUALT"
[L]FORMULE='[F:MFG]ROUALT'
If dim([F:AAA_]ROUALT)>0
 [F:AAA_]ROUALT = [F:MFG]ROUALT
Endif

### MFGPIO
[L]FLD="MFGPIO"
[L]FORMULE='[F:MFI]MFGPIO'
If dim([F:AAA_]MFGPIO)>0
 K   = max(1,val(num$([F:MFI]MFGPIO)))
 [F:AAA_]MFGPIO = mess(K,365,1)
Endif

### ITMLINNBR
[L]FLD="ITMLINNBR"
[L]FORMULE='0'
If dim([F:AAA_]ITMLINNBR)>0
 [F:AAA_]ITMLINNBR = 0
Endif

### MATLINNBR
[L]FLD="MATLINNBR"
[L]FORMULE='0'
If dim([F:AAA_]MATLINNBR)>0
 [F:AAA_]MATLINNBR = 0
Endif

### OPELINNBR
[L]FLD="OPELINNBR"
[L]FORMULE='0'
If dim([F:AAA_]OPELINNBR)>0
 [F:AAA_]OPELINNBR = 0
Endif

### TRKFIRST
[L]FLD="TRKFIRST"
[L]FORMULE='[F:MFI]TRKFIRST'
If dim([F:AAA_]TRKFIRST)>0
 [F:AAA_]TRKFIRST = [F:MFI]TRKFIRST
Endif

### TRKLAST
[L]FLD="TRKLAST"
[L]FORMULE='[F:MFI]TRKLAST'
If dim([F:AAA_]TRKLAST)>0
 [F:AAA_]TRKLAST = [F:MFI]TRKLAST
Endif

### CLODAT
[L]FLD="CLODAT"
[L]FORMULE='[F:MFI]CLODAT'
If dim([F:AAA_]CLODAT)>0
 [F:AAA_]CLODAT = [F:MFI]CLODAT
Endif

### OBJDAT
[L]FLD="OBJDAT"
[L]FORMULE='[F:MFG]OBJDAT'
If dim([F:AAA_]OBJDAT)>0
 [F:AAA_]OBJDAT = [F:MFG]OBJDAT
Endif

### CPY
[L]FLD="CPY"
[L]FORMULE='func TRTX3BI.GETCPY([F:MFG]MFGFCY)'
If dim([F:AAA_]CPY)>0
 [F:AAA_]CPY = func TRTX3BI.GETCPY([F:MFG]MFGFCY)
Endif

### FIYNUM
[L]FLD="FIYNUM"
[L]FORMULE='func TRTX3BI.GETEXE([F:MFG]MFGFCY,[F:MFG]ENDDAT)'
If dim([F:AAA_]FIYNUM)>0
 [F:AAA_]FIYNUM = func TRTX3BI.GETEXE([F:MFG]MFGFCY,[F:MFG]ENDDAT)
Endif

### PERNUM
[L]FLD="PERNUM"
[L]FORMULE='func TRTX3BI.GETPER([F:MFG]MFGFCY,[F:MFG]ENDDAT)'
If dim([F:AAA_]PERNUM)>0
 [F:AAA_]PERNUM = func TRTX3BI.GETPER([F:MFG]MFGFCY,[F:MFG]ENDDAT)
Endif

### PJT
[L]FLD="PJT"
[L]FORMULE='vireblc([F:MFI]PJT,2)'
If dim([F:AAA_]PJT)>0
 [F:AAA_]PJT = vireblc([F:MFI]PJT,2)
Endif

### MFGLIN
[L]FLD="MFGLIN"
[L]FORMULE='[F:MFI]MFGLIN'
If dim([F:AAA_]MFGLIN)>0
 [F:AAA_]MFGLIN = [F:MFI]MFGLIN
Endif

### ITMTYP
[L]FLD="ITMTYP"
[L]FORMULE='[F:MFI]ITMTYP'
If dim([F:AAA_]ITMTYP)>0
 [F:AAA_]ITMTYP = [F:MFI]ITMTYP
Endif

### ITMREF
[L]FLD="ITMREF"
[L]FORMULE='[F:MFI]ITMREF'
If dim([F:AAA_]ITMREF)>0
 [F:AAA_]ITMREF = [F:MFI]ITMREF
Endif

### MFGDES
[L]FLD="MFGDES"
[L]FORMULE='[F:MFI]MFGDES'
If dim([F:AAA_]MFGDES)>0
 [F:AAA_]MFGDES = [F:MFI]MFGDES
Endif

### UOM
[L]FLD="UOM"
[L]FORMULE='[F:MFI]UOM'
If dim([F:AAA_]UOM)>0
 [F:AAA_]UOM = [F:MFI]UOM
Endif

### UOMSTUCOE
[L]FLD="UOMSTUCOE"
[L]FORMULE='[F:MFI]UOMSTUCOE'
If dim([F:AAA_]UOMSTUCOE)>0
 [F:AAA_]UOMSTUCOE = [F:MFI]UOMSTUCOE
Endif

### TRKFLG
[L]FLD="TRKFLG"
[L]FORMULE='[F:MFI]MFITRKFLG'
If dim([F:AAA_]TRKFLG)>0
 [F:AAA_]TRKFLG = [F:MFI]MFITRKFLG
Endif

### CPNITMREF
[L]FLD="CPNITMREF"
[L]FORMULE='""'
If dim([F:AAA_]CPNITMREF)>0
FORMULE = ''
 [F:AAA_]CPNITMREF = ''
Endif

### EXTQTY
[L]FLD="EXTQTY"
[L]FORMULE='[F:MFI]EXTQTY'
If dim([F:AAA_]EXTQTY)>0
 [F:AAA_]EXTQTY = [F:MFI]EXTQTY
Endif

### CPLQTY
[L]FLD="CPLQTY"
[L]FORMULE='[F:MFI]CPLQTY'
If dim([F:AAA_]CPLQTY)>0
 [F:AAA_]CPLQTY = [F:MFI]CPLQTY
Endif

### REJQTY
[L]FLD="REJQTY"
[L]FORMULE='[F:MFI]REJCPLQTY'
If dim([F:AAA_]REJQTY)>0
 [F:AAA_]REJQTY = [F:MFI]REJCPLQTY
Endif

### QUAQTY
[L]FLD="QUAQTY"
[L]FORMULE='[F:MFI]QUACPLQTY'
If dim([F:AAA_]QUAQTY)>0
 [F:AAA_]QUAQTY = [F:MFI]QUACPLQTY
Endif

### TRKQTY
[L]FLD="TRKQTY"
[L]FORMULE='0'
If dim([F:AAA_]TRKQTY)>0
 [F:AAA_]TRKQTY = 0
Endif

### CPNTYP
[L]FLD="CPNTYP"
[L]FORMULE='0'
If dim([F:AAA_]CPNTYP)>0
 K   = max(1,val(num$(0)))
 [F:AAA_]CPNTYP = mess(K,438,1)
Endif

### OPENUM
[L]FLD="OPENUM"
[L]FORMULE='0'
If dim([F:AAA_]OPENUM)>0
 [F:AAA_]OPENUM = 0
Endif

### EXTWST
[L]FLD="EXTWST"
[L]FORMULE='""'
If dim([F:AAA_]EXTWST)>0
FORMULE = ''
 [F:AAA_]EXTWST = ''
Endif

### CPLWST
[L]FLD="CPLWST"
[L]FORMULE='""'
If dim([F:AAA_]CPLWST)>0
FORMULE = ''
 [F:AAA_]CPLWST = ''
Endif

### EXTSETTIM
[L]FLD="EXTSETTIM"
[L]FORMULE='0'
If dim([F:AAA_]EXTSETTIM)>0
 [F:AAA_]EXTSETTIM = 0
Endif

### CPLSETTIM
[L]FLD="CPLSETTIM"
[L]FORMULE='0'
If dim([F:AAA_]CPLSETTIM)>0
 [F:AAA_]CPLSETTIM = 0
Endif

### EXTOPETIM
[L]FLD="EXTOPETIM"
[L]FORMULE='0'
If dim([F:AAA_]EXTOPETIM)>0
 [F:AAA_]EXTOPETIM = 0
Endif

### CPLOPETIM
[L]FLD="CPLOPETIM"
[L]FORMULE='0'
If dim([F:AAA_]CPLOPETIM)>0
 [F:AAA_]CPLOPETIM = 0
Endif

### TRKOPETIM
[L]FLD="TRKOPETIM"
[L]FORMULE='0'
If dim([F:AAA_]TRKOPETIM)>0
 [F:AAA_]TRKOPETIM = 0
Endif

K = instr(1,GDOSSIER,'@')
If K
 [F:AAA_]ADOS = right$(GDOSSIER,K+1)
Else
 [F:AAA_]ADOS = GDOSSIER
Endif
[F:AAA_]AREG = 'MFGITM'
[F:AAA_]AIND = indice
[L]FLD="ACLE"
[L]FORMULE="ACLE"
[F:AAA_]ACLE = num$([F:MFI]MFGNUM)+'~'+num$([F:MFI]MFGLIN)
Return

