#<AdxTL>@(#)0.0.0.0 $Revision$
Subprog YBBIMP(YBATFCY,YBATNBR,YBATDES,YBATDAT,YBATREF,YBATSTA,YBATCAT,YFINSTA
&,YBATNBRTEMP,YDETLIG,YENTTYP,YJOU,YTRANSNBR,YDETDES,YFCY,YCPY
&,YACM,YLED1,YELA,YBAN,YCOA,YACC,YLIGDES,YCTRL,YBP,YDEB,YCDT,YTAX,YGSTAMT,YAMTTAX,YREF,YPJT
&,YDIE0,YCCE0,YDIE1,YCCE1,YDIE2,YCCE2,YDIE3,YCCE3,YDIE4,YCCE4,YBATTYP,YGSTINC,YSTATUS,YMESS)

Value Char YBATFCY
Value Char YBATNBR
Value Char YBATDES
Value Date YBATDAT
Value Char YBATREF
Value Integer YBATSTA
Value Integer YBATCAT
Value Integer YFINSTA
Value Char YBATNBRTEMP

Value Integer YDETLIG(1..2000)
Value Char YENTTYP()(1..2000)
Value Char YJOU()(1..2000)
Value Integer YTRANSNBR(1..2000)
Value Char YDETDES()(1..2000)
Value Char YFCY()(1..2000)
Value Char YCPY()(1..2000)
Value Char YACM()(1..2000)
Value Char YLED1()(1..2000)
Value Char YELA()(1..2000)
Value Char YBAN()(1..2000)
Value Char YCOA()(1..2000)
Value Char YACC()(1..2000)
Value Char YLIGDES()(1..2000)
Value Char YCTRL()(1..2000)
Value Char YBP()(1..2000)
Value Decimal YDEB(1..2000)
Value Decimal YCDT(1..2000)
Value Char YTAX()(1..2000)
Value Decimal YGSTAMT(1..2000)
Value Decimal YAMTTAX(1..2000)
Value Char YREF()(1..2000)
Value Char YPJT()(1..2000)
Value Char YDIE0()(1..2000)
Value Char YCCE0()(1..2000)
Value Char YDIE1()(1..2000)
Value Char YCCE1()(1..2000)
Value Char YDIE2()(1..2000)
Value Char YCCE2()(1..2000)
Value Char YDIE3()(1..2000)
Value Char YCCE3()(1..2000)
Value Char YDIE4()(1..2000)
Value Char YCCE4()(1..2000)
Value Integer YBATTYP(1..2000)
Value Integer YGSTINC(1..2000)

Variable Integer YSTATUS
Variable Char YMESS

Local Integer YSTA

If clalev([F:YBBH]) = 0: Local File YBBHEADER[YBBH] : Endif
If clalev([F:YBBD]) = 0: Local File YBBDETAIL[YBBD] : Endif

YSTA = 2

Trbegin[F:YBBH],[F:YBBD]

[F:YBBH]YBATFCY = [L]YBATFCY
[F:YBBH]YBATNBR = [L]YBATNBR
[F:YBBH]YBATDES = [L]YBATDES
[F:YBBH]YBATDAT = [L]YBATDAT
[F:YBBH]YBATREF = [L]YBATREF
[F:YBBH]YBATSTA = [L]YBATSTA
[F:YBBH]YBATCAT = [L]YBATCAT
[F:YBBH]YFINSTA = [L]YFINSTA
[F:YBBH]YBATNBRTEMP = [L]YBATNBRTEMP

For I = 1 To maxtab([L]YDETLIG)

If YDETLIG(I) = ""
  Break
Endif

[F:YBBD]YBATNBR   = [L]YBATNBR
[F:YBBD]YDETLIG   = [L]YDETLIG(I)
[F:YBBD]YENTTYP   = [L]YENTTYP(I)
[F:YBBD]YJOU      = [L]YJOU(I)
[F:YBBD]YTRANSNBR = [L]YTRANSNBR(I)
[F:YBBD]YDETDES   = [L]YDETDES(I)
[F:YBBD]YFCY      = [L]YFCY(I)
[F:YBBD]YCPY      = [L]YCPY(I)
[F:YBBD]YACM      = [L]YACM(I)
[F:YBBD]YLED1     = [L]YLED1(I)
[F:YBBD]YELA      = [L]YELA(I)
[F:YBBD]YBAN      = [L]YBAN(I)
[F:YBBD]YCOA      = [L]YCOA(I)
[F:YBBD]YACC      = [L]YACC(I)
[F:YBBD]YLIGDES   = [L]YLIGDES(I)
[F:YBBD]YCTRL     = [L]YCTRL(I)
[F:YBBD]YBP       = [L]YBP(I)
[F:YBBD]YDEB      = [L]YDEB(I)
[F:YBBD]YCDT      = [L]YCDT(I)
[F:YBBD]YTAX      = [L]YTAX(I)
[F:YBBD]YGSTAMT   = [L]YGSTAMT(I)
[F:YBBD]YAMTTAX   = [L]YAMTTAX(I)
[F:YBBD]YREF      = [L]YREF(I)
[F:YBBD]YPJT      = [L]YPJT(I)
[F:YBBD]YDIE0     = [L]YDIE0(I)
[F:YBBD]YCCE0     = [L]YCCE0(I)
[F:YBBD]YDIE1     = [L]YDIE1(I)
[F:YBBD]YCCE1     = [L]YCCE1(I)
[F:YBBD]YDIE2     = [L]YDIE2(I)
[F:YBBD]YCCE2     = [L]YCCE2(I)
[F:YBBD]YDIE3     = [L]YDIE3(I)
[F:YBBD]YCCE3     = [L]YCCE3(I)
[F:YBBD]YDIE4     = [L]YDIE4(I)
[F:YBBD]YCCE4     = [L]YCCE4(I)
[F:YBBD]YBATTYP   = [L]YBATTYP(I)
[F:YBBD]YGSTINC   = [L]YGSTINC(I)

Write [F:YBBD]
If fstat <> 0
  YSTA = 1
  Break
Endif
Next

If YSTA = 1
  YSTATUS = 1
  YMESS = "Record create failed."
  Rollback
Else
  Commit
  YSTATUS = 2
  YMESS = "Record create success."
Endif

End

