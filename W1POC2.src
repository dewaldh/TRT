#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management POC2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:08:25"
A_USER  = "ADMIN"
A_STAMP = "20180828000825"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBART"
  If [M]NBART=0
  Endif
 When "NBCOA"
  If [M]NBCOA=0
  Endif
 When "NBLIG"
  If [M]NBLIG=0
   If GFORREM(0)<>""
    Chgfmt DISCRGVAL1 With GFORREM(0)
   Else
    Chgfmt DISCRGVAL1 With "-K:1X"
   Endif
   If GFORREM(1)<>""
    Chgfmt DISCRGVAL2 With GFORREM(1)
   Else
    Chgfmt DISCRGVAL2 With "-K:1X"
   Endif
   If GFORREM(2)<>""
    Chgfmt DISCRGVAL3 With GFORREM(2)
   Else
    Chgfmt DISCRGVAL3 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask POC2 [POC2]
Gosub HORODAT
Local Inpbox "POC2" From GFONCTION At A_STAMP With A_WINDPREV Mask [POC2] As [SIM_]
Grizo [POC2]5
Grizo [POC2]10
Grizo [POC2]15
Grizo [POC2]20
Grizo [POC2]25
Grizo [POC2]30
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [POC2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=0 : Y1(0)=1 : Y2(0)=23
X1(1)=1 : X2(1)=90 : Y1(1)=1 : Y2(1)=6
X1(2)=1 : X2(2)=62 : Y1(2)=7 : Y2(2)=16
X1(3)=63 : X2(3)=90 : Y1(3)=7 : Y2(3)=14
X1(4)=63 : X2(4)=90 : Y1(4)=15 : Y2(4)=16
X1(5)=1 : X2(5)=90 : Y1(5)=17 : Y2(5)=23
Return

$ON_NBART
Onevent BEFORE_INPUT Call AS_NBART From W1POC2
Onevent CONTROL Call C_NBART From W1POC2
Onevent BEFORE_LINE Call AVANT_NBART From W1POC2
Return

Subprog IB_NBART
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBART From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_NBART
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(17664,GBOUT1) From OBJDIV
Call TEXTE(38402,GBOUT3) From OBJDIV
Call TEXTE(7030,GBOUT4) From OBJDIV
Call IB_NBART
## Action STD
Call AS_NBART From SUBPOC
Onkey 129 Titled GBOUT1 Call B1_NBART From W1POC2
Onkey 131 Titled GBOUT3 Call B3_NBART From W1POC2
Onkey 132 Titled GBOUT4 Call B4_NBART From W1POC2
Gosub _AFF
End

Subprog C_NBART
Local Decimal BASPAG
## Action STD
Call C_NBART From SUBPOC
If mkstat : GERR = 1 : GZONE = "NBART" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBART
Local Decimal BASPAG
If !GWEBSERV
 ## Action DIVADDLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVADDLIN"
 Call S_AFF_NUM(BASPAG,PARMSK,"DIVADDLIN","SUBPOC","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBART
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSPIA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSPIA"
 PARMSK(1) = "POC"
 PARMSK(2) = [M:POC0]POHNUM
 PARMSK(3) = num$([M:POC2]POPLIN)
 Call CONSULT_NUM(BASPAG,"PIA",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBART
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_NBART" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = num$([M:POC2]POPLIN)
 Call OBJET_CHAR(OBJCLE,"POD",[M:POC0]POHNUM) From GOBJET
 ACTION = "BB4_NBART" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBART
Local Decimal BASPAG
## Action STD
Call AVANT_NBART From SUBPOC
If mkstat : End : Endif
Gosub _AFF
End

$ON_XITMREF
Return

$ON_XPRHFCY
Return

$ON_XLINSTOFCY
Return

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1POC2
Onevent INIT_AREA Call D_ITMREF(zc) From W1POC2
Onevent AFTER_AREA Call AP_ITMREF(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1POC2
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1POC2
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
If !GWEBSERV
 ## Action STD
 Call IB_ITMREF From SUBPOC
Endif
Gosub _AFF
End

Subprog D_ITMREF(VALEUR)
Variable Char    VALEUR()
If varinit([M]ITMREF,indice)=0
 ## Action PJTINIBATA
 Call PJT_INIBATA(0,"[M:POC1]PJTH","[M:POC2]PJT") From TRTPJT
Endif
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16517,GBOUT2) From OBJDIV
Call TEXTE(49019,GBOUT3) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
Onkey 130 Titled GBOUT2 Call B2_ITMREF(zc) From W1POC2
Onkey 131 Titled GBOUT3 Call B3_ITMREF(zc) From W1POC2
Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1POC2
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREF(VALEUR) From SUBPOC
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STKINIECC
Call STKINIECC(VALEUR,"","POC2",1,1,0,2,func TRTX3FNC.VALFLD_C("[M]ECCVALMAJ")
&,"ECCVALMAJ","ECCVALMIN","","",1,[M:POC0]BPSNUM) From STKACT
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREF(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action NOTE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "NOTE"
  PARMSK(1) = VALEUR
  PARMSK(2) = "ITMREF"
  Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action INIECCSTA
 Call INIECCSTA(VALEUR,"POC2",0) From STKECR
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITM"
 PARMSK(1) = GBIDC3
 PARMSK(2) = "A"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITM","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B2_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITMBPS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMBPS"
 PARMSK(1) = [M:POC0]BPSNUM
 PARMSK(2) = "BPS"
 Call SAISIE_CHAR(VALEUR,PARMSK,"IITP2W","TRTACHSEL1","XWIITP2W") From GSAISIE
 [M:POC0]BPSNUM = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = VALEUR
 PARMSK(2) = "ITMREF"
 Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ITMREFBPS
Onevent CONTROL Call C_ITMREFBPS(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_ITMREFBPS From W1POC2
Onevent BEFORE_INPUT Call AS_ITMREFBPS(zc) From W1POC2
Return

Subprog IB_ITMREFBPS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMREFBPS From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_ITMREFBPS(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16517,GBOUT1) From OBJDIV
Call IB_ITMREFBPS(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_ITMREFBPS(zc) From W1POC2
Gosub _AFF
End

Subprog C_ITMREFBPS(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ITMREFBPS(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ITMREFBPS" : GZNUM = 17273 : Endif
Gosub _AFF
End

$AMM_ITMREFBPS
Call AM_ITMREFBPS(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFBPS" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFBPS(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFBPS(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ITMREFBPS" : GZNUM = 17273 : Endif
Gosub _AFF
End

Subprog B1_ITMREFBPS(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITMBPS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMBPS"
 PARMSK(1) = [M:POC0]BPSNUM
 PARMSK(2) = "ITP"
 Call SAISIE_CHAR(VALEUR,PARMSK,"IITP2W","TRTACHSEL1","XWIITP2W") From GSAISIE
 [M:POC0]BPSNUM = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMDES
Onevent AFTER_CHANGE Gosub AMM_ITMDES From W1POC2
Return

$AMM_ITMDES
Call AM_ITMDES(zc)
If !mkstat & GOBJET
 zoncou = "ITMDES" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMDES(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMDES(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ITMDES" : GZNUM = 282 : Endif
Gosub _AFF
End

$ON_ITMDES1
Onevent AFTER_CHANGE Gosub AMM_ITMDES1 From W1POC2
Return

$AMM_ITMDES1
Call AM_ITMDES1(zc)
If !mkstat & GOBJET
 zoncou = "ITMDES1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMDES1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMDES1(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ITMDES1" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_ECCVALMAJ
Onevent CONTROL Call C_ECCVALMAJ(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_ECCVALMAJ From W1POC2
Onevent BEFORE_INPUT Call AS_ECCVALMAJ(zc) From W1POC2
Return

Subprog AS_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1281,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ECCVALMAJ(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_ECCVALMAJ(zc) From W1POC2
Gosub _AFF
End

Subprog C_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STKCTRECC
Call STKCTRECC([M:POC2]ITMREF,VALEUR,"","",3) From STKACT
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

$AMM_ECCVALMAJ
Call AM_ECCVALMAJ(zc)
If !mkstat & GOBJET
 zoncou = "ECCVALMAJ" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ECCVALMAJ(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

Subprog S_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELMAJ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELMAJ"
 PARMSK(1) = [M:POC2]ITMREF
 PARMSK(2) = ""
 PARMSK(3) = "POC2"
 PARMSK(4) = "0"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELMAJ","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0B
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0B"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ECCVALMAJ" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:POC2]ITMREF
 Call OBJET_CHAR(OBJCLE,"ECS",[M:POC2]ECCVALMAJ) From GOBJET
 ACTION = "BB1_ECCVALMAJ" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ECCVALMIN
Onevent BEFORE_INPUT Call AS_ECCVALMIN(zc) From W1POC2
Onevent CONTROL Call C_ECCVALMIN(zc) From W1POC2
Return

Subprog AS_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(44284,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
If !GWEBSERV
 ## Action STKASMIN
 Call STKASMIN([M:POC2]ECCVALMAJ) From STKACT
 If mkstat=2
  [M]ECCVALMIN(INDIC) = VALEUR
  Affzo ECCVALMIN(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_ECCVALMIN(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_ECCVALMIN(zc) From W1POC2
Gosub _AFF
End

Subprog C_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
## Action STKCTRECC
Call STKCTRECC([M:POC2]ITMREF,[M:POC2]ECCVALMAJ,VALEUR,"",4) From STKACT
If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
Gosub _AFF
End

Subprog S_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELMIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELMIN"
 PARMSK(1) = [M:POC2]ITMREF
 PARMSK(2) = [M:POC2]ECCVALMAJ
 PARMSK(3) = "POC2"
 PARMSK(4) = "0"
 PARMSK(5) = "4"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELMIN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ECCVAL"
 PARMSK(1) = [M:POC2]ITMREF
 PARMSK(2) = "4"
 PARMSK(3) = [M:POC2]ECCVALMAJ
 Call SAISIE_CHAR(VALEUR,PARMSK,"FECCVAL","ECCVAL","SPEECCVAL") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PRHFCY
Onevent CONTROL Call C_PRHFCY(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_PRHFCY From W1POC2
Onevent BEFORE_INPUT Call AS_PRHFCY(zc) From W1POC2
Return

Subprog IB_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_PRHFCY From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12817,GBOUT3) From OBJDIV
Call TEXTE(16776,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PRHFCY(VALEUR)
Onkey 131 Titled GBOUT3 Call B3_PRHFCY(zc) From W1POC2
Onkey 132 Titled GBOUT4 Call B4_PRHFCY(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_PRHFCY(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_PRHFCY(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_PRHFCY(zc) From W1POC2
Gosub _AFF
End

Subprog C_PRHFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
 If !mkstat
  ## Action PCOPRHFCY
  Call C_PRHFCY(VALEUR,[M:POC2]ITMREF) From TRTACHCTL1
  If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
  If !mkstat
   ## Action STD
   Call C_PRHFCY(VALEUR) From SUBPOC
   If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PRHFCY
Call AM_PRHFCY(zc)
If !mkstat & GOBJET
 zoncou = "PRHFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRHFCY(VALEUR)
Variable Char    VALEUR()
## Action TRTPRHFCY
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "TRTPRHFCY"
PARMSK(1) = [M:POC2]ITMREF
Call TRAITE_CHAR(VALEUR,PARMSK,"","TRTACHCTL1","",1,"XYTRTACHCTL1") From GTRAITE
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
If !mkstat
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AAM_PRHFCY" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = VALEUR
 Call OBJET_CHAR(OBJCLE,WOBJET,[M:POC2]ITMREF) From GOBJET
 ACTION = "BAM_PRHFCY" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
 If !mkstat
  ## Action STD
  Call AM_PRHFCY(VALEUR) From SUBPOC
  If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 2552 : Endif
  If !mkstat & evalue("dim("+clanam([M])+"ZPRHFCY)")>indice
   [M]PRHFCY(indice) = VALEUR
   Affzo ZPRHFCY(indice)
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPRHFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPRHFCY"
 PARMSK(1) = num$([F:ITM]STOMGTCOD)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPRHFCY","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B3_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_PRHFCY" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = VALEUR
 PARMSK(3) = [M:POC2]ITMREF
 PARMSK(4) = ""
 Call CONSULT_CHAR(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB3_PRHFCY" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITMFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMFCY"
 PARMSK(1) = "ITMREF=[M:POC2]ITMREF"
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITMFCY","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPRHFCY
Onevent BEFORE_AREA Gosub AV_ZPRHFCY From W1POC2
Return

$AV_ZPRHFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]PRHFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_FCYADD
Onevent INIT_AREA Call D_FCYADD(zc) From W1POC2
Onevent CONTROL Call C_FCYADD(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_FCYADD From W1POC2
Onevent BEFORE_INPUT Call AS_FCYADD(zc) From W1POC2
Return

Subprog IB_FCYADD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_FCYADD From SUBPOC
Endif
Gosub _AFF
End

Subprog D_FCYADD(VALEUR)
Variable Char    VALEUR()
If varinit([M]FCYADD,indice)=0
 ## Action STD
 Call D_FCYADD(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_FCYADD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_FCYADD(VALEUR)
Onkey   2 Titled GBOUTS Call S_FCYADD(zc) From W1POC2
Gosub _AFF
End

Subprog C_FCYADD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_FCYADD(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "FCYADD" : GZNUM = 1499 : Endif
Gosub _AFF
End

$AMM_FCYADD
Call AM_FCYADD(zc)
If !mkstat & GOBJET
 zoncou = "FCYADD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FCYADD(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_FCYADD(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "FCYADD" : GZNUM = 1499 : Endif
Gosub _AFF
End

Subprog S_FCYADD(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SAISELADR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAISELADR"
 PARMSK(1) = "3"
 PARMSK(2) = [M:POC2]PRHFCY
 PARMSK(3) = [F:FCY]FCYNAM
 PARMSK(4) = GBIDC3
 Call SAISIE_CHAR(VALEUR,PARMSK,"IBPAW","TRTX3","XWIBPAW") From GSAISIE
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_LINSTOFCY
Onevent CONTROL Call C_LINSTOFCY(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_LINSTOFCY From W1POC2
Onevent BEFORE_INPUT Call AS_LINSTOFCY(zc) From W1POC2
Return

Subprog AS_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_LINSTOFCY(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_LINSTOFCY(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_LINSTOFCY(zc) From W1POC2
Gosub _AFF
End

Subprog C_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "LINSTOFCY" : GZNUM = 3676 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINSTOFCY" : GZNUM = 3676 : Endif
 If !mkstat
  ## Action STD
  Call C_LINSTOFCY(VALEUR) From SUBPOC
  If mkstat : GERR = 1 : GZONE = "LINSTOFCY" : GZNUM = 3676 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINSTOFCY
Call AM_LINSTOFCY(zc)
If !mkstat & GOBJET
 zoncou = "LINSTOFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINSTOFCY(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "LINSTOFCY" : GZNUM = 3676 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZLINSTOFCY)")>indice
 [M]LINSTOFCY(indice) = VALEUR
 Affzo ZLINSTOFCY(indice)
Endif
Gosub _AFF
End

Subprog S_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSHIFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSHIFCY"
 PARMSK(1) = [M:POC2]ITMREF
 PARMSK(2) = "[F:FCY]LEGCPY=GCPY & [F:FCY]FCY<>[M:POC2]PRHFCY"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSHIFCY","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINSTOFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZLINSTOFCY
Onevent BEFORE_AREA Gosub AV_ZLINSTOFCY From W1POC2
Return

$AV_ZLINSTOFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]LINSTOFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_XSTRDAT
Onevent CONTROL Call C_XSTRDAT(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_XSTRDAT From W1POC2
Onevent BEFORE_AREA Gosub AV_XSTRDAT From W1POC2
Return

$AV_XSTRDAT
Chgfmt [M]XSTRDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_XSTRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_XSTRDAT(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "XSTRDAT" : GZNUM = 51175 : Endif
Gosub _AFF
End

$AMM_XSTRDAT
Call AM_XSTRDAT(zc)
If !mkstat & GOBJET
 zoncou = "XSTRDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_XSTRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_XSTRDAT(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "XSTRDAT" : GZNUM = 51175 : Endif
Gosub _AFF
End

$ON_XENDDAT
Onevent CONTROL Call C_XENDDAT(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_XENDDAT From W1POC2
Onevent BEFORE_AREA Gosub AV_XENDDAT From W1POC2
Return

$AV_XENDDAT
Chgfmt [M]XENDDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_XENDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_XENDDAT(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "XENDDAT" : GZNUM = 51176 : Endif
Gosub _AFF
End

$AMM_XENDDAT
Call AM_XENDDAT(zc)
If !mkstat & GOBJET
 zoncou = "XENDDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_XENDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_XENDDAT(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "XENDDAT" : GZNUM = 51176 : Endif
Gosub _AFF
End

$ON_PUU
Onevent CONTROL Call C_PUU(zc) From W1POC2
Onevent BEFORE_INPUT Call AS_PUU(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_PUU From W1POC2
Return

Subprog AS_PUU(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_PUU(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_PUU(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_PUU(zc) From W1POC2
Gosub _AFF
End

Subprog C_PUU(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TUN","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PUU" : GZNUM = 1858 : Endif
If !mkstat
 ## Action STD
 Call C_PUU(VALEUR) From SUBPOC
 If mkstat : GERR = 1 : GZONE = "PUU" : GZNUM = 1858 : Endif
Endif
Gosub _AFF
End

$AMM_PUU
Call AM_PUU(zc)
If !mkstat & GOBJET
 zoncou = "PUU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PUU(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPUU)")>indice
 [M]PUU(indice) = VALEUR
 Affzo ZPUU(indice)
Endif
Gosub _AFF
End

Subprog S_PUU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPUOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPUOM"
 PARMSK(1) = [M:POC0]BPSNUM
 PARMSK(2) = [M:POC2]ITMREF
 PARMSK(3) = "3"
 PARMSK(4) = "6"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELPUOM","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_PUU(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PUU(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPUU
Onevent BEFORE_AREA Gosub AV_ZPUU From W1POC2
Return

$AV_ZPUU
Call LECTEXTRA(zc,"TABUNIT","DES",num$([M]PUU(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_XPUUFLG
Onevent INIT_AREA Call D_XPUUFLG(zc) From W1POC2
Return

Subprog D_XPUUFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]XPUUFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EXTQTYPUU
Onevent BEFORE_AREA Gosub AV_EXTQTYPUU From W1POC2
Onevent CONTROL Call C_EXTQTYPUU(zc) From W1POC2
Onevent AFTER_AREA Call AP_EXTQTYPUU(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_EXTQTYPUU From W1POC2
Onevent BEFORE_INPUT Call AS_EXTQTYPUU(zc) From W1POC2
Return

Subprog IB_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_EXTQTYPUU From SUBPOC
Endif
Gosub _AFF
End

$AV_EXTQTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]PUU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTYPUU(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12817,GBOUT1) From OBJDIV
Call IB_EXTQTYPUU(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_EXTQTYPUU(zc) From W1POC2
Gosub _AFF
End

Subprog C_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_EXTQTYPUU(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "EXTQTYPUU" : GZNUM = 1906 : Endif
Gosub _AFF
End

Subprog AP_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AP_EXTQTYPUU(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "EXTQTYPUU" : GZNUM = 1906 : Endif
Gosub _AFF
End

$AMM_EXTQTYPUU
Call AM_EXTQTYPUU(zc)
If !mkstat & GOBJET
 zoncou = "EXTQTYPUU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTQTYPUU(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "EXTQTYPUU" : GZNUM = 1906 : Endif
Gosub _AFF
End

Subprog B1_EXTQTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_EXTQTYPUU" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = [M:POC2]PRHFCY
 PARMSK(3) = [M:POC2]ITMREF
 PARMSK(4) = ""
 Call CONSULT_NUM(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB1_EXTQTYPUU" : PROGSUB = "SUBPOC" : PROGSPE = "SPEPOC" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FIMHOR
Onevent INIT_AREA Call D_FIMHOR(zc) From W1POC2
Onevent BEFORE_INPUT Call AS_FIMHOR(zc) From W1POC2
Return

Subprog IB_FIMHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_FIMHOR From SUBPOC
Endif
Gosub _AFF
End

Subprog D_FIMHOR(VALEUR)
Variable Decimal VALEUR
If varinit([M]FIMHOR,indice)=0
 ## Action STD
 Call D_FIMHOR(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_FIMHOR(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7262,GBOUT1) From OBJDIV
Call IB_FIMHOR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_FIMHOR(zc) From W1POC2
Gosub _AFF
End

Subprog B1_FIMHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREP1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREP1"
 Call SAISIE_NUM(VALEUR,PARMSK,"IPREPART1","TRTACHFEN1","XWIPREPART1") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FIMHORUOM
Onevent INIT_AREA Call D_FIMHORUOM(zc) From W1POC2
Return

Subprog D_FIMHORUOM(VALEUR)
Variable Integer VALEUR
If varinit([M]FIMHORUOM,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FRTHOR
Onevent INIT_AREA Call D_FRTHOR(zc) From W1POC2
Onevent BEFORE_INPUT Call AS_FRTHOR(zc) From W1POC2
Return

Subprog IB_FRTHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_FRTHOR From SUBPOC
Endif
Gosub _AFF
End

Subprog D_FRTHOR(VALEUR)
Variable Decimal VALEUR
If varinit([M]FRTHOR,indice)=0
 ## Action STD
 Call D_FRTHOR(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_FRTHOR(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7262,GBOUT1) From OBJDIV
Call IB_FRTHOR(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_FRTHOR(zc) From W1POC2
Gosub _AFF
End

Subprog B1_FRTHOR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREP2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREP2"
 Call SAISIE_NUM(VALEUR,PARMSK,"IPREPART2","TRTACHFEN1","XWIPREPART2") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FRTHORUOM
Onevent INIT_AREA Call D_FRTHORUOM(zc) From W1POC2
Onevent BEFORE_INPUT Call AS_FRTHORUOM(zc) From W1POC2
Return

Subprog D_FRTHORUOM(VALEUR)
Variable Integer VALEUR
If varinit([M]FRTHORUOM,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_FRTHORUOM(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_FRTHORUOM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1POC2
Onevent CONTROL Call C_PJT(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_PJT From W1POC2
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1POC2
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1POC2
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1POC2
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1POC2
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1POC2
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1POC2
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1POC2
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1POC2
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1POC2
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJT(VALEUR) From SUBPOC
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"POC2","PJT",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:POC0]POHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "POC2"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:POC0]POHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:POC0]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PLI
Onevent INIT_AREA Call D_PLI(zc) From W1POC2
Onevent CONTROL Call C_PLI(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_PLI From W1POC2
Onevent BEFORE_INPUT Call AS_PLI(zc) From W1POC2
Return

Subprog IB_PLI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_PLI From SUBPOC
Endif
Gosub _AFF
End

Subprog D_PLI(VALEUR)
Variable Char    VALEUR()
If varinit([M]PLI,indice)=0
 ## Action STD
 Call D_PLI(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_PLI(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(87,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PLI(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_PLI(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_PLI(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_PLI(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_PLI(zc) From W1POC2
Gosub _AFF
End

Subprog C_PLI(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("PPC","!A",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PLI" : GZNUM = 2652 : Endif
If !mkstat
 ## Action STD
 Call C_PLI(VALEUR) From SUBPOC
 If mkstat : GERR = 1 : GZONE = "PLI" : GZNUM = 2652 : Endif
Endif
Gosub _AFF
End

$AMM_PLI
Call AM_PLI(zc)
If !mkstat & GOBJET
 zoncou = "PLI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PLI(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_PLI(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "PLI" : GZNUM = 2652 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZPLI)")>indice
 [M]PLI(indice) = VALEUR
 Affzo ZPLI(indice)
Endif
Gosub _AFF
End

Subprog S_PLI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPPC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPPC"
 PARMSK(1) = "PLISTC=[F:BPS]PLISTC & PLITYP=1"
 PARMSK(2) = "A"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPPC","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PLI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJET
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJET"
 Call OBJET_CHAR(VALEUR,"PPC","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PLI(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PPC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PLI(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PPC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPLI
Onevent BEFORE_AREA Gosub AV_ZPLI From W1POC2
Return

$AV_ZPLI
Call LECTEXTRA(zc,"PPRICCONF","DESAXX",num$([M]PLI(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PRIVLT
Onevent BEFORE_AREA Gosub AV_PRIVLT From W1POC2
Return

$AV_PRIVLT
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_WCURVLT
Return

$ON_AMTVLT
Onevent BEFORE_AREA Gosub AV_AMTVLT From W1POC2
Return

$AV_AMTVLT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POC1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VAT
Return

$ON_TAXRCP
Return

$ON_TAXISS
Return

$ON_TAXOTH1
Return

$ON_TAXOTH2
Return

$ON_EECICT2
Return

$ON_FFWNUM2
Return

$ON_EECLOC2
Onevent INIT_AREA Call D_EECLOC2(zc) From W1POC2
Return

Subprog D_EECLOC2(VALEUR)
Variable Integer VALEUR
If varinit([M]EECLOC2,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_NBCOA
Onevent INIT_AREA Call D_NBCOA From W1POC2
Return

Subprog D_NBCOA
Local Decimal BASPAG
If varinit([M]NBCOA)=0
 ## Action STD
 Call D_NBCOA From SUBPOC
Endif
Gosub _AFF
End

$ON_COA
Return

$ON_NAMCOA
Onevent BEFORE_AREA Gosub AV_NAMCOA From W1POC2
Return

$AV_NAMCOA
zc = GCOLCOA(nolign)
Gosub _AFF
Return

$ON_LINACC
Onevent BEFORE_AREA Gosub AV_LINACC From W1POC2
Onevent CONTROL Call C_LINACC(zc) From W1POC2
Onevent BEFORE_INPUT Call AS_LINACC(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_LINACC From W1POC2
Return

$AV_LINACC
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(nolign))) From SETGLBCOA
If GFMTACC<>""
 Chgfmt [M]LINACC(indice) With "K:"+GFMTACC
Else
 Chgfmt [M]LINACC(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC(VALEUR) From SUBPOC
If mkstat=2
 [M]LINACC(INDIC) = VALEUR
 Affzo LINACC(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC(zc) From W1POC2
Onkey   2 Titled GBOUTS Call S_LINACC(zc) From W1POC2
Onkey 144 Titled GBOUTP Call P_LINACC(zc) From W1POC2
Onkey 146 Titled GBOUTA Call SA_LINACC(zc) From W1POC2
Gosub _AFF
End

Subprog C_LINACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(nolign))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC" : GZNUM = 3956 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(nolign))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC" : GZNUM = 3956 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(nolign)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC" : GZNUM = 3956 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC(VALEUR) From SUBPOC
  If mkstat : GERR = 1 : GZONE = "LINACC" : GZNUM = 3956 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC
Call AM_LINACC(zc)
If !mkstat & GOBJET
 zoncou = "LINACC" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "LINACC" : GZNUM = 3956 : Endif
Gosub _AFF
End

Subprog S_LINACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(nolign)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:POC1]ENDDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "[M:POC2]COA(0"
 PARMSK(6) = "[M:POC2]LINACC(0"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(nolign))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(nolign))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(nolign))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINPURTYP
Onevent INIT_AREA Call D_LINPURTYP(zc) From W1POC2
Onevent AFTER_CHANGE Gosub AMM_LINPURTYP From W1POC2
Onevent BEFORE_INPUT Call AS_LINPURTYP(zc) From W1POC2
Return

Subprog D_LINPURTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]LINPURTYP,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_LINPURTYP(VALEUR) From SUBPOC
Endif
Gosub _AFF
End

Subprog AS_LINPURTYP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_LINPURTYP
Call AM_LINPURTYP(zc)
If !mkstat & GOBJET
 zoncou = "LINPURTYP" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINPURTYP(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_LINPURTYP(VALEUR) From SUBPOC
If mkstat : GERR = 1 : GZONE = "LINPURTYP" : GZNUM = 2507 : Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2POC2
Return

$TIT_COL
Gosub TIT_COL From W2POC2
Return


