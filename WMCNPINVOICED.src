#<AdxTL>@(#)0.0.0.0 $Revision$Class Purchase invoice detail
# Supervisor
## ACLA-CLASSE ## PINVOICED
# 2018-08-27 12:39:24 822

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMC0PINVOICED
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
For TBLINE=1 to 5
 [L]ALINE = func ASYRSUBTAB.ADDLINE([L]TBLINE,"C_TSICOD","C_PINVOICED_C_TSICOD",this)
 If [L]ALINE=[V]CST_ANOTDEFINED : [L]ASTATUS = [V]CST_AERROR : Break : Endif
Next
If [L]ASTATUS = [V]CST_AERROR :  Gosub TESTALLSTAT : Endif
Gosub INIT_INVTYP From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_NUM From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PIDLIN From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PIVTYP From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PIHTYP From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CPY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FCY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ACCDAT From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_BPR From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FCYLIN From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TYPORI From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_NUMORI From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINORI From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SEQORI From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ITMREF From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ITMDES1 From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ITMDES From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_UOM From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PUU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_STU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_UOMPUUCOE From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYUOM From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYPUU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ORIQTYPUU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYSTU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYWEU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ORIQTYWEU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYVOU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ORIQTYVOU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_GROPRI From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PRIREN From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGVAL1 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGVAL2 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGVAL3 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGREN1 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGREN2 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGREN3 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_NETPRI From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ORINETPRI From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINPURTYP From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT1 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT2 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT3 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT4 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT5 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT6 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT7 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT8 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISCRGAMT9 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_NETCUR From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_POHNUM From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_POPLIN From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_POQSEQ From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SHIPNUM From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PTHNUM From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SHIPLIN From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PTDLIN From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PNHNUM From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PNDLIN From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_INVNUM From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub INIT_INVLIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SIDLIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_BPSNUM From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_RCPDAT From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PJT From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CRY From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SATISS From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_SATRCP From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TAXRCP From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TAXISS From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TAXOTH1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TAXOTH2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTNOTLIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTATILIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYBUDLIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_QTYGLU From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_GLU From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT3 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT4 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT5 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT6 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLCAMT7 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DISBASLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_BASTAXLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXLIN2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXLIN3 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXRCP From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXISS From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXOTH1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTTAXOTH2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXLIN1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXLIN2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXLIN3 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXRCP From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXISS From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXOTH1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DEDTAXOTH2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CPRCOE From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CPRAMT From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CPR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CSTPUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINAMTCPR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINCSTPUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_STCNUM From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CPRCUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FCSCPR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FCSCSTPUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PRTFLG From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINTEX From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CLALINTEX From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINEECFLG From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_EECFLOPHY From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_STRDAT From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ENDDAT From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PERNBR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_PERTYP From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FASREF From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LINTYP From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_LIKQTYCOE From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CMMNUM From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CREUSR From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CREDAT From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_UPDUSR From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_UPDDAT From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_MATTOL From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_FLG1099 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_TWMSTA From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_ITMLNK From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_BPRLNK From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_EXIPRTFLG From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DIFQTY From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_DIFPRI From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CREDATTIM From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_UPDDATTIM From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AUUID From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_AMTNOTLINCAL From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_CSTMAJLIN From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_VAT1 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_VAT2 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_VAT3 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub INIT_VATLEG From WMC5PINVOICED : Gosub TESTALLSTAT
If this.PIDCAL<>null
 [L]ASTATUS = fmet this.PIDCAL.AINIT : Gosub TESTALLSTAT
Endif
Gosub AINIT From WMC0PINVOICED : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMC0PINVOICED
Gosub _ALOADATTRIBUTE_NUM From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_PIDLIN From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CPY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_FCY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_BPR From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_FCYLIN From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_PUU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_STU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_NETCUR From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_BPSNUM From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CPRCUR From WMC4PINVOICED : Gosub TESTALLSTAT
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMC0PINVOICED
Gosub LNKPRO_CPY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_FCY From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_BPR From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_FCYLIN From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_ITMREF From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_UOM From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_PUU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_STU From WMC1PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT1 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT2 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT3 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT4 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT5 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT6 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT7 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT8 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISCRGAMT9 From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_NETCUR From WMC2PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_BPSNUM From WMC3PINVOICED : Gosub TESTALLSTAT
For AINDCLA=1 To 5
 If this.C_TSICOD(AINDCLA)<>null& find(this.C_TSICOD(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_TSICOD(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_CRY From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_SATISS From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_SATRCP From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_TAXRCP From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_TAXISS From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_TAXOTH1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_TAXOTH2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTNOTLIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTATILIN From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_GLU From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT3 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT4 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT5 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT6 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLCAMT7 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DISBASLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_BASTAXLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXLIN1 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXLIN2 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXLIN3 From WMC3PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXRCP From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXISS From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXOTH1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTTAXOTH2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXLIN1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXLIN2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXLIN3 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXRCP From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXISS From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXOTH1 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_DEDTAXOTH2 From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CPRAMT From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_LINAMTCPR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_LINCSTPUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CPRCUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_FCSCPR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_FCSCSTPUR From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_CLALINTEX From WMC4PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_AMTNOTLINCAL From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_VAT1 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_VAT2 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_VAT3 From WMC5PINVOICED : Gosub TESTALLSTAT
Gosub LNKPRO_VATLEG From WMC5PINVOICED : Gosub TESTALLSTAT
If this.PIDCAL<>null
 [L]ASTATUS = fmet this.PIDCAL._ALNKPRO : Gosub TESTALLSTAT
Endif
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



