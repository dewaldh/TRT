#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management TDUPDW2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "13:04:49"
A_USER  = "ADMIN"
A_STAMP = "20180326130449"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask TDUPDW2 [TUW2]
Gosub HORODAT
Local Inpbox "TDUPDW2" From GFONCTION At A_STAMP With A_WINDPREV Mask [TUW2] As [SIM_]
Grizo [TUW2]15
Grizo [TUW2]20
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [TUW2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=80 : Y1(0)=1 : Y2(0)=5
X1(1)=1 : X2(1)=80 : Y1(1)=6 : Y2(1)=23
Return

$ON_WCRDEB
Onevent AFTER_CHANGE Gosub AMM_WCRDEB From W1TDUPDW2
Onevent CONTROL Call C_WCRDEB(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WCRDEB(zc) From W1TDUPDW2
Return

Subprog AS_WCRDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6522,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WCRDEB(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_WCRDEB(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_WCRDEB(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_WCRDEB(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_WCRDEB(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TWC","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WCRDEB" : GZNUM = 3633 : Endif
Gosub _AFF
End

$AMM_WCRDEB
Call AM_WCRDEB(zc)
If !mkstat & GOBJET
 zoncou = "WCRDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WCRDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WCRDEB(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "WCRDEB" : GZNUM = 3633 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWCRDEB)")>indice
 [M]WCRDEB(indice) = VALEUR
 Affzo ZWCRDEB(indice)
Endif
Gosub _AFF
End

Subprog S_WCRDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TWC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WCRDEB(VALEUR)
Variable Char    VALEUR()
Call OBJET("TWC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_WCRDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TWC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WCRDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TWC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWCRDEB
Onevent BEFORE_AREA Gosub AV_ZWCRDEB From W1TDUPDW2
Return

$AV_ZWCRDEB
Call LECTEXTRA(zc,"TABWRKCTR","WCRDESAXX",num$([M]WCRDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WCRFIN
Onevent CONTROL Call C_WCRFIN(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WCRFIN(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_WCRFIN From W1TDUPDW2
Return

Subprog AS_WCRFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6522,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WCRFIN(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_WCRFIN(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_WCRFIN(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_WCRFIN(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_WCRFIN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TWC","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WCRFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M:TUW2]WCRDEB) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "WCRFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_WCRFIN
Call AM_WCRFIN(zc)
If !mkstat & GOBJET
 zoncou = "WCRFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WCRFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWCRFIN)")>indice
 [M]WCRFIN(indice) = VALEUR
 Affzo ZWCRFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WCRFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TWC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WCRFIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("TWC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_WCRFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TWC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WCRFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TWC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWCRFIN
Onevent BEFORE_AREA Gosub AV_ZWCRFIN From W1TDUPDW2
Return

$AV_ZWCRFIN
Call LECTEXTRA(zc,"TABWRKCTR","WCRDESAXX",num$([M]WCRFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WSTTYPDEB
Onevent AFTER_CHANGE Gosub AMM_WSTTYPDEB From W1TDUPDW2
Onevent INIT_AREA Call D_WSTTYPDEB(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WSTTYPDEB(zc) From W1TDUPDW2
Return

Subprog D_WSTTYPDEB(VALEUR)
Variable Integer VALEUR
If varinit([M]WSTTYPDEB,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_WSTTYPDEB(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_WSTTYPDEB
Call AM_WSTTYPDEB(zc)
If !mkstat & GOBJET
 zoncou = "WSTTYPDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WSTTYPDEB(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_WSTTYPDEB(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "WSTTYPDEB" : GZNUM = 5960 : Endif
Gosub _AFF
End

$ON_WSTTYPFIN
Onevent CONTROL Call C_WSTTYPFIN(zc) From W1TDUPDW2
Onevent INIT_AREA Call D_WSTTYPFIN(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WSTTYPFIN(zc) From W1TDUPDW2
Return

Subprog D_WSTTYPFIN(VALEUR)
Variable Integer VALEUR
If varinit([M]WSTTYPFIN,indice)=0
 VALEUR = 3
Endif
Gosub _AFF
End

Subprog AS_WSTTYPFIN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog C_WSTTYPFIN(VALEUR)
Variable Integer VALEUR
## Action STD
Call C_WSTTYPFIN(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "WSTTYPFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_WSTDEB
Onevent AFTER_CHANGE Gosub AMM_WSTDEB From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WSTDEB(zc) From W1TDUPDW2
Return

Subprog IB_WSTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_WSTDEB From FUNTDUPDW
Endif
Gosub _AFF
End

Subprog AS_WSTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(6668,GBOUTS) From OBJDIV
Call IB_WSTDEB(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_WSTDEB(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_WSTDEB(zc) From W1TDUPDW2
Gosub _AFF
End

$AMM_WSTDEB
Call AM_WSTDEB(zc)
If !mkstat & GOBJET
 zoncou = "WSTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WSTDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WSTDEB(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "WSTDEB" : GZNUM = 5964 : Endif
Gosub _AFF
End

Subprog S_WSTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:TUW1]WCRFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WSTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0"
 Local Char    OBJCLE(30)
 OBJCLE = [M:TUW1]WCRFCY
 Call OBJET_CHAR(OBJCLE,"MWS",VALEUR) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_WSTFIN
Onevent CONTROL Call C_WSTFIN(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WSTFIN(zc) From W1TDUPDW2
Return

Subprog IB_WSTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_WSTFIN From FUNTDUPDW
Endif
Gosub _AFF
End

Subprog AS_WSTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(6668,GBOUTS) From OBJDIV
Call IB_WSTFIN(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_WSTFIN(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_WSTFIN(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_WSTFIN(VALEUR)
Variable Char    VALEUR()
## Action CTLALPV
Call CTLALPV(VALEUR,[M]WSTDEB) From CONTDIV
If mkstat : GERR = 1 : GZONE = "WSTFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_WSTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:TUW1]WCRFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WSTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0"
 Local Char    OBJCLE(30)
 OBJCLE = [M:TUW1]WCRFCY
 Call OBJET_CHAR(OBJCLE,"MWS",VALEUR) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FORMULE
Onevent INIT_AREA Call D_FORMULE(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FORMULE(zc) From W1TDUPDW2
Onevent CONTROL Call C_FORMULE(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_FORMULE From W1TDUPDW2
Return

Subprog D_FORMULE(VALEUR)
Variable Char    VALEUR()
If varinit([M]FORMULE,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("MWS") From CXTFOR
 If mkstat=2
  [M]FORMULE(INDIC) = VALEUR
  Affzo FORMULE(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_FORMULE(zc) From W1TDUPDW2
Onkey 130 Titled GBOUT2 Call B2_FORMULE(zc) From W1TDUPDW2
Onkey 131 Titled GBOUT3 Call B3_FORMULE(zc) From W1TDUPDW2
Onkey 132 Titled GBOUT4 Call B4_FORMULE(zc) From W1TDUPDW2
Onkey 133 Titled GBOUT5 Call B5_FORMULE(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_FORMULE(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_FORMULE(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_FORMULE(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_FORMULE(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "FORMULE" : GZNUM = 12877 : Endif
Gosub _AFF
End

$AMM_FORMULE
Call AM_FORMULE(zc)
If !mkstat & GOBJET
 zoncou = "FORMULE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FORMULE(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZFORMULE)")>indice
 [M]FORMULE(indice) = VALEUR
 Affzo ZFORMULE(indice)
Endif
Gosub _AFF
End

Subprog S_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_FORMULE(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_FORMULE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_FORMULE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_FORMULE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_FORMULE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("MWS") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_FORMULE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZFORMULE
Onevent BEFORE_AREA Gosub AV_ZFORMULE From W1TDUPDW2
Return

$AV_ZFORMULE
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]FORMULE(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FVLTCCE
Onevent AFTER_CHANGE Gosub AMM_FVLTCCE From W1TDUPDW2
Onevent INIT_AREA Call D_FVLTCCE(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FVLTCCE(zc) From W1TDUPDW2
Return

Subprog D_FVLTCCE(VALEUR)
Variable Integer VALEUR
If varinit([M]FVLTCCE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FVLTCCE(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FVLTCCE
Call AM_FVLTCCE(zc)
If !mkstat & GOBJET
 zoncou = "FVLTCCE" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FVLTCCE(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FVLTCCE(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FVLTCCE" : GZNUM = 6017 : Endif
Gosub _AFF
End

$ON_VLTCCE
Onevent CONTROL Call C_VLTCCE(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_VLTCCE(zc) From W1TDUPDW2
Return

Subprog IB_VLTCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_VLTCCE From FUNTDUPDW
Endif
Gosub _AFF
End

Subprog AS_VLTCCE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_VLTCCE(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_VLTCCE(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_VLTCCE(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_VLTCCE(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "VLTCCE" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_VLTCCE(VALEUR) From FUNTDUPDW
 If mkstat : GERR = 1 : GZONE = "VLTCCE" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VLTCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVLTCCE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVLTCCE"
 PARMSK(1) = [M:TUW1]WCRFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVLTCCE","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_VLTCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC1"
 Call OBJET_CHAR([M:TUW1]WCRFCY,"MWC",VALEUR) From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FTWD
Onevent AFTER_CHANGE Gosub AMM_FTWD From W1TDUPDW2
Onevent INIT_AREA Call D_FTWD(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FTWD(zc) From W1TDUPDW2
Return

Subprog D_FTWD(VALEUR)
Variable Integer VALEUR
If varinit([M]FTWD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FTWD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FTWD
Call AM_FTWD(zc)
If !mkstat & GOBJET
 zoncou = "FTWD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FTWD(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FTWD(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FTWD" : GZNUM = 1809 : Endif
Gosub _AFF
End

$ON_TWD
Onevent CONTROL Call C_TWD(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_TWD(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_TWD From W1TDUPDW2
Return

Subprog AS_TWD(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3514,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_TWD(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_TWD(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_TWD(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_TWD(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_TWD(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "TWD" : GZNUM = 0 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TWD","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "TWD" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_TWD
Call AM_TWD(zc)
If !mkstat & GOBJET
 zoncou = "TWD" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_TWD(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZTWD)")>indice
 [M]TWD(indice) = VALEUR
 Affzo ZTWD(indice)
Endif
Gosub _AFF
End

Subprog S_TWD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TWD"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_TWD(VALEUR)
Variable Char    VALEUR()
Call OBJET("TWD",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_TWD(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TWD"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_TWD(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TWD",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZTWD
Onevent BEFORE_AREA Gosub AV_ZTWD From W1TDUPDW2
Return

$AV_ZTWD
Call LECTEXTRA(zc,"TABWEEDIA","TWDDESAXX",num$([M]TWD(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_FWSTNBR
Onevent AFTER_CHANGE Gosub AMM_FWSTNBR From W1TDUPDW2
Onevent INIT_AREA Call D_FWSTNBR(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FWSTNBR(zc) From W1TDUPDW2
Return

Subprog D_FWSTNBR(VALEUR)
Variable Integer VALEUR
If varinit([M]FWSTNBR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FWSTNBR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FWSTNBR
Call AM_FWSTNBR(zc)
If !mkstat & GOBJET
 zoncou = "FWSTNBR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FWSTNBR(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FWSTNBR(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FWSTNBR" : GZNUM = 14503 : Endif
Gosub _AFF
End

$ON_WSTNBRV
Onevent BEFORE_INPUT Call AS_WSTNBRV(zc) From W1TDUPDW2
Onevent CONTROL Call C_WSTNBRV(zc) From W1TDUPDW2
Return

Subprog AS_WSTNBRV(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WSTNBRV(VALEUR) From FUNTDUPDW
If mkstat=2
 [M]WSTNBRV(INDIC) = VALEUR
 Affzo WSTNBRV(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_WSTNBRV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_WSTNBRF
Onevent INIT_AREA Call D_WSTNBRF(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_WSTNBRF(zc) From W1TDUPDW2
Onevent CONTROL Call C_WSTNBRF(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_WSTNBRF From W1TDUPDW2
Return

Subprog D_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If varinit([M]WSTNBRF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_WSTNBRF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]WSTNBRF(INDIC) = VALEUR
  Affzo WSTNBRF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_WSTNBRF(zc) From W1TDUPDW2
Onkey 130 Titled GBOUT2 Call B2_WSTNBRF(zc) From W1TDUPDW2
Onkey 131 Titled GBOUT3 Call B3_WSTNBRF(zc) From W1TDUPDW2
Onkey 132 Titled GBOUT4 Call B4_WSTNBRF(zc) From W1TDUPDW2
Onkey 133 Titled GBOUT5 Call B5_WSTNBRF(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_WSTNBRF(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_WSTNBRF(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_WSTNBRF(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_WSTNBRF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WSTNBRF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_WSTNBRF
Call AM_WSTNBRF(zc)
If !mkstat & GOBJET
 zoncou = "WSTNBRF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWSTNBRF)")>indice
 [M]WSTNBRF(indice) = VALEUR
 Affzo ZWSTNBRF(indice)
Endif
Gosub _AFF
End

Subprog S_WSTNBRF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WSTNBRF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_WSTNBRF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WSTNBRF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WSTNBRF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWSTNBRF
Onevent BEFORE_AREA Gosub AV_ZWSTNBRF From W1TDUPDW2
Return

$AV_ZWSTNBRF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]WSTNBRF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FPCTAUT
Onevent AFTER_CHANGE Gosub AMM_FPCTAUT From W1TDUPDW2
Onevent INIT_AREA Call D_FPCTAUT(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FPCTAUT(zc) From W1TDUPDW2
Return

Subprog D_FPCTAUT(VALEUR)
Variable Integer VALEUR
If varinit([M]FPCTAUT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FPCTAUT(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FPCTAUT
Call AM_FPCTAUT(zc)
If !mkstat & GOBJET
 zoncou = "FPCTAUT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FPCTAUT(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FPCTAUT(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FPCTAUT" : GZNUM = 10749 : Endif
Gosub _AFF
End

$ON_CLEPCTAUTV
Onevent BEFORE_INPUT Call AS_CLEPCTAUTV(zc) From W1TDUPDW2
Return

Subprog AS_CLEPCTAUTV(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_CLEPCTAUTV(VALEUR) From FUNTDUPDW
If mkstat=2
 [M]CLEPCTAUTV(INDIC) = VALEUR
 Affzo CLEPCTAUTV(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_CLEPCTAUTF
Onevent INIT_AREA Call D_CLEPCTAUTF(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_CLEPCTAUTF(zc) From W1TDUPDW2
Onevent CONTROL Call C_CLEPCTAUTF(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_CLEPCTAUTF From W1TDUPDW2
Return

Subprog D_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If varinit([M]CLEPCTAUTF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]CLEPCTAUTF(INDIC) = VALEUR
  Affzo CLEPCTAUTF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 130 Titled GBOUT2 Call B2_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 131 Titled GBOUT3 Call B3_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 132 Titled GBOUT4 Call B4_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 133 Titled GBOUT5 Call B5_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_CLEPCTAUTF(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_CLEPCTAUTF(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "CLEPCTAUTF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_CLEPCTAUTF
Call AM_CLEPCTAUTF(zc)
If !mkstat & GOBJET
 zoncou = "CLEPCTAUTF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZCLEPCTAUTF)")>indice
 [M]CLEPCTAUTF(indice) = VALEUR
 Affzo ZCLEPCTAUTF(indice)
Endif
Gosub _AFF
End

Subprog S_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CLEPCTAUTF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCLEPCTAUTF
Onevent BEFORE_AREA Gosub AV_ZCLEPCTAUTF From W1TDUPDW2
Return

$AV_ZCLEPCTAUTF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]CLEPCTAUTF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FSTOLOC
Onevent AFTER_CHANGE Gosub AMM_FSTOLOC From W1TDUPDW2
Onevent INIT_AREA Call D_FSTOLOC(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FSTOLOC(zc) From W1TDUPDW2
Return

Subprog D_FSTOLOC(VALEUR)
Variable Integer VALEUR
If varinit([M]FSTOLOC,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FSTOLOC(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FSTOLOC
Call AM_FSTOLOC(zc)
If !mkstat & GOBJET
 zoncou = "FSTOLOC" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FSTOLOC(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FSTOLOC(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FSTOLOC" : GZNUM = 5973 : Endif
Gosub _AFF
End

$ON_STOLOC
Onevent CONTROL Call C_STOLOC(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_STOLOC From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_STOLOC(zc) From W1TDUPDW2
Return

Subprog IB_STOLOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_STOLOC From FUNTDUPDW
Endif
Gosub _AFF
End

Subprog AS_STOLOC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3234,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call IB_STOLOC(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_STOLOC(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_STOLOC(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_STOLOC(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "STOLOC" : GZNUM = 0 : Endif
If !mkstat
 ## Action CTLEMPFMT
 Call CTLEMPFMT(VALEUR,"") From STKACT
 If mkstat : GERR = 1 : GZONE = "STOLOC" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_STOLOC(VALEUR) From FUNTDUPDW
  If mkstat : GERR = 1 : GZONE = "STOLOC" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_STOLOC
Call AM_STOLOC(zc)
If !mkstat & GOBJET
 zoncou = "STOLOC" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STOLOC(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_STOLOC(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "STOLOC" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_STOLOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELEMP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELEMP"
 PARMSK(1) = [M:TUW1]WCRFCY
 PARMSK(2) = ""
 PARMSK(3) = "14"
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELEMP","STKLOC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_STOLOC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSEA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSEA"
 PARMSK(1) = "0"
 PARMSK(2) = [M:TUW1]WCRFCY
 PARMSK(3) = VALEUR
 PARMSK(4) = ""
 PARMSK(5) = "14"
 PARMSK(6) = "2"
 PARMSK(7) = "0"
 PARMSK(8) = ""
 PARMSK(9) = VALEUR
 Call CONSULT_CHAR(VALEUR,"SEA",PARMSK) From GCONSULT
 VALEUR = PARMSK(9)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_FQLFLEV
Onevent AFTER_CHANGE Gosub AMM_FQLFLEV From W1TDUPDW2
Onevent INIT_AREA Call D_FQLFLEV(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FQLFLEV(zc) From W1TDUPDW2
Return

Subprog D_FQLFLEV(VALEUR)
Variable Integer VALEUR
If varinit([M]FQLFLEV,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FQLFLEV(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FQLFLEV
Call AM_FQLFLEV(zc)
If !mkstat & GOBJET
 zoncou = "FQLFLEV" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FQLFLEV(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FQLFLEV(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FQLFLEV" : GZNUM = 5980 : Endif
Gosub _AFF
End

$ON_QLFLEV
Onevent CONTROL Call C_QLFLEV(zc) From W1TDUPDW2
Return

Subprog C_QLFLEV(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "QLFLEV" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_FEFF
Onevent AFTER_CHANGE Gosub AMM_FEFF From W1TDUPDW2
Onevent INIT_AREA Call D_FEFF(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FEFF(zc) From W1TDUPDW2
Return

Subprog D_FEFF(VALEUR)
Variable Integer VALEUR
If varinit([M]FEFF,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FEFF(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FEFF
Call AM_FEFF(zc)
If !mkstat & GOBJET
 zoncou = "FEFF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FEFF(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FEFF(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FEFF" : GZNUM = 16173 : Endif
Gosub _AFF
End

$ON_EFFV
Onevent BEFORE_INPUT Call AS_EFFV(zc) From W1TDUPDW2
Onevent CONTROL Call C_EFFV(zc) From W1TDUPDW2
Return

Subprog AS_EFFV(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_EFFV(VALEUR) From FUNTDUPDW
If mkstat=2
 [M]EFFV(INDIC) = VALEUR
 Affzo EFFV(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_EFFV(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$ON_EFFF
Onevent INIT_AREA Call D_EFFF(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_EFFF(zc) From W1TDUPDW2
Onevent CONTROL Call C_EFFF(zc) From W1TDUPDW2
Onevent AFTER_CHANGE Gosub AMM_EFFF From W1TDUPDW2
Return

Subprog D_EFFF(VALEUR)
Variable Char    VALEUR()
If varinit([M]EFFF,indice)=0
 ## Action MEMFOR0
 Call MEMINI(VALEUR) From GMEMFOR
Endif
Gosub _AFF
End

Subprog AS_EFFF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(845,GBOUT2) From OBJDIV
Call TEXTE(48414,GBOUT3) From OBJDIV
Call TEXTE(49954,GBOUT4) From OBJDIV
Call TEXTE(22164,GBOUT5) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
If !GWEBSERV
 ## Action CXTFORDEF
 Call CXTDEF("") From CXTFOR
 If mkstat=2
  [M]EFFF(INDIC) = VALEUR
  Affzo EFFF(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_EFFF(zc) From W1TDUPDW2
Onkey 130 Titled GBOUT2 Call B2_EFFF(zc) From W1TDUPDW2
Onkey 131 Titled GBOUT3 Call B3_EFFF(zc) From W1TDUPDW2
Onkey 132 Titled GBOUT4 Call B4_EFFF(zc) From W1TDUPDW2
Onkey 133 Titled GBOUT5 Call B5_EFFF(zc) From W1TDUPDW2
Onkey   2 Titled GBOUTS Call S_EFFF(zc) From W1TDUPDW2
Onkey 144 Titled GBOUTP Call P_EFFF(zc) From W1TDUPDW2
Onkey 146 Titled GBOUTA Call SA_EFFF(zc) From W1TDUPDW2
Gosub _AFF
End

Subprog C_EFFF(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"9",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "EFFF" : GZNUM = 4574 : Endif
Gosub _AFF
End

$AMM_EFFF
Call AM_EFFF(zc)
If !mkstat & GOBJET
 zoncou = "EFFF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EFFF(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZEFFF)")>indice
 [M]EFFF(indice) = VALEUR
 Affzo ZEFFF(indice)
Endif
Gosub _AFF
End

Subprog S_EFFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "9"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_EFFF(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"9") From GOBJET
Gosub _AFF
End

Subprog B2_EFFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR1"
 Call SAISIE_CHAR(VALEUR,PARMSK,"GMEMFOR","GMEMFOR","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_EFFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR3
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR3"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_EFFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action MEMFOR2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "MEMFOR2"
 Call TRAITE_CHAR(VALEUR,PARMSK,"","GMEMFOR","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_EFFF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CXTFORDOC
 Call CXTDOC("") From CXTFOR
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_EFFF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "9"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_EFFF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "9"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZEFFF
Onevent BEFORE_AREA Gosub AV_ZEFFF From W1TDUPDW2
Return

$AV_ZEFFF
Call LECTEXTRA(zc,"TABFOR","DES","9",num$([M]EFFF(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_FSHR
Onevent AFTER_CHANGE Gosub AMM_FSHR From W1TDUPDW2
Onevent INIT_AREA Call D_FSHR(zc) From W1TDUPDW2
Onevent BEFORE_INPUT Call AS_FSHR(zc) From W1TDUPDW2
Return

Subprog D_FSHR(VALEUR)
Variable Integer VALEUR
If varinit([M]FSHR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_FSHR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_FSHR
Call AM_FSHR(zc)
If !mkstat & GOBJET
 zoncou = "FSHR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_FSHR(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_FSHR(VALEUR) From FUNTDUPDW
If mkstat : GERR = 1 : GZONE = "FSHR" : GZNUM = 17672 : Endif
Gosub _AFF
End

$ON_FUSE
Onevent INIT_AREA Call D_FUSE(zc) From W1TDUPDW2
Return

Subprog D_FUSE(VALEUR)
Variable Integer VALEUR
If varinit([M]FUSE,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2TDUPDW2
Return

$TIT_COL
Gosub TIT_COL From W2TDUPDW2
Return


