#<AdxTL>@(#)0.0.0.0 $Revision$Class Purchase invoices
# Supervisor
## ACLA-CLASSE ## PINVOICE
# 2018-08-27 12:39:18 756

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMC0PINVOICE
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
Gosub INIT_INVTYP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_NUM From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PIVTYP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PIVTYPDES From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PIHTYP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ORIMOD From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRSAC From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CPY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_FCY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PJTH From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_GTE From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_JOU From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ACCDAT From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ACCNUM From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_INVREF From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRDAT From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRVCR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CUR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CURTYP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RATDAT From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DAS2 From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRPAY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_STRDUDDAT From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PTE From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_LEG From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DEP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_VAC From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CEEFLG From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECNUMDEB From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_STA From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PAZ From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_INVNUM From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_SNS From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AMTATI From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AMTNOT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AMTATIL From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AMTNOTL From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_VATDAT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_NBRTAX From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPAINV From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_POSCOD From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CTY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_SAT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CRY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CRYNAM From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPAPAY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYPOSCOD From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYCTY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYSAT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYCRY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYCRYNAM From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECNAT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECSCH From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECTRN From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECICT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECICT2 From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ICTCTY From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ICTCTY2 From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECLOC From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EECNUM From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_FFWNUM From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_FFWADD From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_FIY From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PER From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RITNBR From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RITINV From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RITPAY From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_STRDATSVC From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_ENDDATSVC From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_LASDATSVC From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_EXPNUM From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CREDAT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CREUSR From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UPDDAT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UPDUSR From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UBLUSR From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UBLDAT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UBLAMT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_TWMSTA From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_FRM1099 From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BOX1099 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AMTSUBJ1099 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRLNK From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_PURPRITYP From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CREDATTIM From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_UPDDATTIM From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_AUUID From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BASDEP From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DEPTYP From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CSTMAJ From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_TOTATIAMT1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CUR2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_LIBPAZ From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DUDAT1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRNAME1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPRNAME2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPAADDLIG1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPAADDLIG2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPAADDLIG3 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYNAME1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYNAME2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYADDLIG1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYADDLIG2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_BPYADDLIG3 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RAT1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CURDIV From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_RAT2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CURMLT From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DIFAMTATI From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CUR3 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DIFLINAMT From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DIFTAXAMT From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub INIT_DOCCUR From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CPYCUR From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub INIT_CUMLINAMT1 From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub INIT_WCUR From WMC5PINVOICE : Gosub TESTALLSTAT
If this.PIV<>null
 [L]ASTATUS = fmet this.PIV.AINIT : Gosub TESTALLSTAT
Endif
If this.PIV2<>null
 [L]ASTATUS = fmet this.PIV2.AINIT : Gosub TESTALLSTAT
Endif
Gosub AINIT From WMC0PINVOICE : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMC0PINVOICE
Gosub _ALOADATTRIBUTE_NUM From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_BPR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CPY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_FCY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CUR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_PTE From WMC1PINVOICE : Gosub TESTALLSTAT
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMC0PINVOICE
Gosub LNKPRO_BPR From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CPY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_FCY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_GTE From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_JOU From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CUR From WMC1PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 10
 If this.C_LED(AINDCLA)<>null& find(this.C_LED(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_LED(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_BPRPAY From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_PTE From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_LEG From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_DEP From WMC1PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_VAC From WMC1PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 5
 If this.C_DES(AINDCLA)<>null& find(this.C_DES(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_DES(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_AMTATI From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_AMTNOT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_AMTATIL From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_AMTNOTL From WMC2PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 20
 If this.C_TAX(AINDCLA)<>null& find(this.C_TAX(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_TAX(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To 20
 If this.C_DIE(AINDCLA)<>null& find(this.C_DIE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_DIE(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_BPAINV From WMC2PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 2
 If this.C_BPRNAM(AINDCLA)<>null& find(this.C_BPRNAM(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_BPRNAM(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To 3
 If this.C_BPAADDLIG(AINDCLA)<>null& find(this.C_BPAADDLIG(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_BPAADDLIG(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_POSCOD From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CTY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_SAT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CRY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPAPAY From WMC2PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 2
 If this.C_BPYNAM(AINDCLA)<>null& find(this.C_BPYNAM(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_BPYNAM(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To 3
 If this.C_BPYADDLIG(AINDCLA)<>null& find(this.C_BPYADDLIG(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_BPYADDLIG(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_BPYPOSCOD From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYCTY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYSAT From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYCRY From WMC2PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_EECICT From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_EECICT2 From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_ICTCTY From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_ICTCTY2 From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_FFWNUM From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_FFWADD From WMC3PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 10
 If this.C_RITCOD(AINDCLA)<>null& find(this.C_RITCOD(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.C_RITCOD(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_UBLUSR From WMC3PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_AMTSUBJ1099 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BASDEP From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_TOTATIAMT1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CUR2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPAADDLIG1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPAADDLIG2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPAADDLIG3 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYADDLIG1 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYADDLIG2 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_BPYADDLIG3 From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CURDIV From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CURMLT From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_DIFAMTATI From WMC4PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CUR3 From WMC4PINVOICE : Gosub TESTALLSTAT
For AINDCLA=1 To 15
 If this.COL_COSTS(AINDCLA)<>null& find(this.COL_COSTS(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.COL_COSTS(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_DIFLINAMT From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_DIFTAXAMT From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_DOCCUR From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CPYCUR From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_CUMLINAMT1 From WMC5PINVOICE : Gosub TESTALLSTAT
Gosub LNKPRO_WCUR From WMC5PINVOICE : Gosub TESTALLSTAT
If this.PIV<>null
 [L]ASTATUS = fmet this.PIV._ALNKPRO : Gosub TESTALLSTAT
Endif
For AINDCLA=1 To maxtab(this.PVV)
 If this.PVV(AINDCLA)<>null& find(this.PVV(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.PVV(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.PID)
 If this.PID(AINDCLA)<>null& find(this.PID(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.PID(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.PVF)
 If this.PVF(AINDCLA)<>null& find(this.PVF(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.PVF(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.PVF2)
 If this.PVF2(AINDCLA)<>null& find(this.PVF2(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.PVF2(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If this.PIV2<>null
 [L]ASTATUS = fmet this.PIV2._ALNKPRO : Gosub TESTALLSTAT
Endif
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



