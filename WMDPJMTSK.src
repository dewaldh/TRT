#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
## BI-DIMENSION ## Synchronization rule PJMTSK

$OUVRE
Local Char FILTRE(250)
OUVTAB = GDOSSIER+".PJMTSK" : If clalev([F:PJTA])=0 : Local File =OUVTAB [PJTA] : Endif
OUVTAB = GDOSSIER+".PJMTSK" : If clalev([F:A_])=0 : Local File =OUVTAB [A_] : Endif
OUVTAB = "Link [PJTA]"
Link [PJTA] With
& [A_]PTA0=[PJTA]OPPNUM;[PJTA]TASCOD
& As [LNK_]
& Order By Key CLE = [PJTA]OPPNUM;[PJTA]TASCOD
FILTRE = ""
Return

$FERME
If clalev([F:PJTA]) : Close local File [PJTA] : Endif
If clalev([F:A_]) : Close local File [A_] : Endif
Return

$DCLE
Local Char    DCLE(GLONAVA)(1..2)
Local Integer DTYP(1..2)
Local Integer NBDCLE
NBDCLE = 2
DCLE(1) = "OPPNUM"
DTYP(1) =  7
DCLE(2) = "TASCOD"
DTYP(2) =  7
Return

$CHARGE_CLE
If dim([F:AAA_]OPPNUM)>0
 [F:AAA_]OPPNUM = [F:PJTA]OPPNUM
Endif
If dim([F:AAA_]TASCOD)>0
 [F:AAA_]TASCOD = [F:PJTA]TASCOD
Endif
Return

########################################################################
# Return the filter necessary for incremental delete in synchroonization
Subprog GET_FLTDELINC(PFLT)
Variable Clbfile PFLT
PFLT = "1=1"
Append PFLT, " & [F:AAA_]OPPNUM=[F:PJTA]OPPNUM"
Append PFLT, " & [F:AAA_]TASCOD=[F:PJTA]TASCOD"

End

$MAJFLD
### TASFCY
[L]FLD="TASFCY"
[L]FORMULE='[F:PJTA]TASFCY'
If dim([F:AAA_]TASFCY)>0
 [F:AAA_]TASFCY = [F:PJTA]TASFCY
Endif

### OPPNUM
[L]FLD="OPPNUM"
[L]FORMULE='[F:PJTA]OPPNUM'
If dim([F:AAA_]OPPNUM)>0
 [F:AAA_]OPPNUM = [F:PJTA]OPPNUM
Endif

### TASPAE
[L]FLD="TASPAE"
[L]FORMULE='[F:PJTA]TASPAE'
If dim([F:AAA_]TASPAE)>0
 [F:AAA_]TASPAE = [F:PJTA]TASPAE
Endif

### TASCOD
[L]FLD="TASCOD"
[L]FORMULE='[F:PJTA]TASCOD'
If dim([F:AAA_]TASCOD)>0
 [F:AAA_]TASCOD = [F:PJTA]TASCOD
Endif

### TASTYP
[L]FLD="TASTYP"
[L]FORMULE='[F:PJTA]TASTYP'
If dim([F:AAA_]TASTYP)>0
 K   = max(1,val(num$([F:PJTA]TASTYP)))
 [F:AAA_]TASTYP = mess(K,2258,1)
Endif

### TASSTARTDT
[L]FLD="TASSTARTDT"
[L]FORMULE='[F:PJTA]TASSTARTDT'
If dim([F:AAA_]TASSTARTDT)>0
 [F:AAA_]TASSTARTDT = [F:PJTA]TASSTARTDT
Endif

### TASENDDT
[L]FLD="TASENDDT"
[L]FORMULE='[F:PJTA]TASENDDT'
If dim([F:AAA_]TASENDDT)>0
 [F:AAA_]TASENDDT = [F:PJTA]TASENDDT
Endif

### TASDATL
[L]FLD="TASDATL"
[L]FORMULE='[F:PJTA]TASDATL'
If dim([F:AAA_]TASDATL)>0
 [F:AAA_]TASDATL = [F:PJTA]TASDATL
Endif

### TASDATB
[L]FLD="TASDATB"
[L]FORMULE='[F:PJTA]TASDATB'
If dim([F:AAA_]TASDATB)>0
 [F:AAA_]TASDATB = [F:PJTA]TASDATB
Endif

### TASDATS
[L]FLD="TASDATS"
[L]FORMULE='[F:PJTA]TASDATS'
If dim([F:AAA_]TASDATS)>0
 [F:AAA_]TASDATS = [F:PJTA]TASDATS
Endif

### TASDATH
[L]FLD="TASDATH"
[L]FORMULE='[F:PJTA]TASDATH'
If dim([F:AAA_]TASDATH)>0
 [F:AAA_]TASDATH = [F:PJTA]TASDATH
Endif

### TASTLA
[L]FLD="TASTLA"
[L]FORMULE='[F:PJTA]TASTLA'
If dim([F:AAA_]TASTLA)>0
 K   = max(1,val(num$([F:PJTA]TASTLA)))
 [F:AAA_]TASTLA = mess(K,1,1)
Endif

### TASSTATE
[L]FLD="TASSTATE"
[L]FORMULE='[F:PJTA]TASSTATE'
If dim([F:AAA_]TASSTATE)>0
 K   = max(1,val(num$([F:PJTA]TASSTATE)))
 [F:AAA_]TASSTATE = mess(K,2250,1)
Endif

### TASRESP
[L]FLD="TASRESP"
[L]FORMULE='[F:PJTA]TASRESP'
If dim([F:AAA_]TASRESP)>0
 [F:AAA_]TASRESP = [F:PJTA]TASRESP
Endif

### TCACOD
[L]FLD="TCACOD"
[L]FORMULE='[F:PJTA]TCACOD'
If dim([F:AAA_]TCACOD)>0
 [F:AAA_]TCACOD = [F:PJTA]TCACOD
Endif

### PBUCOD
[L]FLD="PBUCOD"
[L]FORMULE='[F:PJTA]PBUCOD'
If dim([F:AAA_]PBUCOD)>0
 [F:AAA_]PBUCOD = [F:PJTA]PBUCOD
Endif

### KEYCONCAT
[L]FLD="KEYCONCAT"
[L]FORMULE='[F:PJTA]KEYCONCAT'
If dim([F:AAA_]KEYCONCAT)>0
 [F:AAA_]KEYCONCAT = [F:PJTA]KEYCONCAT
Endif

### TASNUM
[L]FLD="TASNUM"
[L]FORMULE='[F:PJTA]TASNUM'
If dim([F:AAA_]TASNUM)>0
 [F:AAA_]TASNUM = [F:PJTA]TASNUM
Endif


Return

