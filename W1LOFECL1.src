#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management LOFECL1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:04:44"
A_USER  = "ADMIN"
A_STAMP = "20180828000444"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBDEP"
  If [M]NBDEP=0
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask LOFECL1 [LOF5]
Gosub HORODAT
Local Inpbox "LOFECL1" From GFONCTION At A_STAMP With A_WINDPREV Mask [LOF5] As [SIM_]
Grizo [LOF5]10
Grizo [LOF5]15
Grizo [LOF5]20
Grizo [LOF5]30
Grizo [LOF5]35
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [LOF5]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(1)=24 : X2(1)=86 : Y1(1)=2 : Y2(1)=5
X1(2)=24 : X2(2)=54 : Y1(2)=6 : Y2(2)=8
X1(3)=55 : X2(3)=84 : Y1(3)=6 : Y2(3)=8
X1(5)=24 : X2(5)=89 : Y1(5)=9 : Y2(5)=10
X1(6)=24 : X2(6)=89 : Y1(6)=11 : Y2(6)=26
Return

$ON_ECLBAS
Onevent AFTER_AREA Call AP_ECLBAS(zc) From W1LOFECL1
Onevent AFTER_CHANGE Gosub AMM_ECLBAS From W1LOFECL1
Onevent INIT_AREA Call D_ECLBAS(zc) From W1LOFECL1
Onevent BEFORE_INPUT Call AS_ECLBAS(zc) From W1LOFECL1
Return

Subprog D_ECLBAS(VALEUR)
Variable Integer VALEUR
If varinit([M]ECLBAS,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_ECLBAS(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AP_ECLBAS(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_ECLBAS(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "ECLBAS" : GZNUM = 6578 : Endif
Gosub _AFF
End

$AMM_ECLBAS
Call AM_ECLBAS(zc)
If !mkstat & GOBJET
 zoncou = "ECLBAS" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ECLBAS(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_ECLBAS(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "ECLBAS" : GZNUM = 6578 : Endif
Gosub _AFF
End

$ON_QTYECL
Onevent BEFORE_INPUT Call AS_QTYECL(zc) From W1LOFECL1
Onevent CONTROL Call C_QTYECL(zc) From W1LOFECL1
Onevent AFTER_AREA Call AP_QTYECL(zc) From W1LOFECL1
Onevent AFTER_CHANGE Gosub AMM_QTYECL From W1LOFECL1
Onevent INIT_AREA Call D_QTYECL(zc) From W1LOFECL1
Return

Subprog D_QTYECL(VALEUR)
Variable Integer VALEUR
If varinit([M]QTYECL,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_QTYECL(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_QTYECL(VALEUR) From TRTLOFECL
If mkstat=2
 [M]QTYECL(INDIC) = VALEUR
 Affzo QTYECL(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog C_QTYECL(VALEUR)
Variable Integer VALEUR
## Action STD
Call C_QTYECL(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "QTYECL" : GZNUM = 34988 : Endif
Gosub _AFF
End

Subprog AP_QTYECL(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_QTYECL(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "QTYECL" : GZNUM = 34988 : Endif
Gosub _AFF
End

$AMM_QTYECL
Call AM_QTYECL(zc)
If !mkstat & GOBJET
 zoncou = "QTYECL" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYECL(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_QTYECL(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "QTYECL" : GZNUM = 34988 : Endif
Gosub _AFF
End

$ON_NBLOF
Onevent AFTER_CHANGE Gosub AMM_NBLOF From W1LOFECL1
Onevent CONTROL Call C_NBLOF(zc) From W1LOFECL1
Return

Subprog C_NBLOF(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "NBLOF" : GZNUM = 34987 : Endif
Gosub _AFF
End

$AMM_NBLOF
Call AM_NBLOF(zc)
If !mkstat & GOBJET
 zoncou = "NBLOF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NBLOF(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_NBLOF(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "NBLOF" : GZNUM = 34987 : Endif
Gosub _AFF
End

$ON_QTYBEF
Onevent BEFORE_AREA Gosub AV_QTYBEF From W1LOFECL1
Return

$AV_QTYBEF
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYBEF(indice) With "NPz:"+GUNTFMT
Gosub _AFF
Return

$ON_NOTCPYBEF
Onevent BEFORE_AREA Gosub AV_NOTCPYBEF From W1LOFECL1
Return

$AV_NOTCPYBEF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]NOTCPYBEF(indice) With "NPz3:"+GDEVFMT
Gosub _AFF
Return

$ON_NOTIASBEF
Onevent BEFORE_AREA Gosub AV_NOTIASBEF From W1LOFECL1
Return

$AV_NOTIASBEF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_QTYAFT
Onevent BEFORE_AREA Gosub AV_QTYAFT From W1LOFECL1
Return

$AV_QTYAFT
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYAFT(indice) With "NPz:"+GUNTFMT
Gosub _AFF
Return

$ON_NOTCPYAFT
Onevent BEFORE_AREA Gosub AV_NOTCPYAFT From W1LOFECL1
Return

$AV_NOTCPYAFT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]NOTCPYAFT(indice) With "NPz3:"+GDEVFMT
Gosub _AFF
Return

$ON_NOTIASAFT
Onevent BEFORE_AREA Gosub AV_NOTIASAFT From W1LOFECL1
Return

$AV_NOTIASAFT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_UOM
Onevent INIT_AREA Call D_UOM(zc) From W1LOFECL1
Return

Subprog D_UOM(VALEUR)
Variable Char    VALEUR()
If varinit([M]UOM,indice)=0
 VALEUR = GDEFUOM
Endif
Gosub _AFF
End

$ON_CUR
Return

$ON_NOTCURBE
Onevent BEFORE_AREA Gosub AV_NOTCURBE From W1LOFECL1
Return

$AV_NOTCURBE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATCURBE
Onevent BEFORE_AREA Gosub AV_TVATCURBE From W1LOFECL1
Return

$AV_TVATCURBE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATCPYBE
Onevent BEFORE_AREA Gosub AV_TVATCPYBE From W1LOFECL1
Return

$AV_TVATCPYBE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATRCURBE
Onevent BEFORE_AREA Gosub AV_TVATRCURBE From W1LOFECL1
Return

$AV_TVATRCURBE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATRCPYBE
Onevent BEFORE_AREA Gosub AV_TVATRCPYBE From W1LOFECL1
Return

$AV_TVATRCPYBE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VATIASBEF
Onevent BEFORE_AREA Gosub AV_VATIASBEF From W1LOFECL1
Return

$AV_VATIASBEF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VATRIASBEF
Onevent BEFORE_AREA Gosub AV_VATRIASBEF From W1LOFECL1
Return

$AV_VATRIASBEF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTGRABE
Onevent BEFORE_AREA Gosub AV_AMTGRABE From W1LOFECL1
Return

$AV_AMTGRABE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_NOTCURAF
Onevent BEFORE_AREA Gosub AV_NOTCURAF From W1LOFECL1
Return

$AV_NOTCURAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATCURAF
Onevent BEFORE_AREA Gosub AV_TVATCURAF From W1LOFECL1
Return

$AV_TVATCURAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATCPYAF
Onevent BEFORE_AREA Gosub AV_TVATCPYAF From W1LOFECL1
Return

$AV_TVATCPYAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATRCURAF
Onevent BEFORE_AREA Gosub AV_TVATRCURAF From W1LOFECL1
Return

$AV_TVATRCURAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_TVATRCPYAF
Onevent BEFORE_AREA Gosub AV_TVATRCPYAF From W1LOFECL1
Return

$AV_TVATRCPYAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VATIASAFT
Onevent BEFORE_AREA Gosub AV_VATIASAFT From W1LOFECL1
Return

$AV_VATIASAFT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VATRIASAFT
Onevent BEFORE_AREA Gosub AV_VATRIASAFT From W1LOFECL1
Return

$AV_VATRIASAFT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTGRAAF
Onevent BEFORE_AREA Gosub AV_AMTGRAAF From W1LOFECL1
Return

$AV_AMTGRAAF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM1BE
Onevent BEFORE_AREA Gosub AV_USRFLDM1BE From W1LOFECL1
Return

$AV_USRFLDM1BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT1,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM2BE
Onevent BEFORE_AREA Gosub AV_USRFLDM2BE From W1LOFECL1
Return

$AV_USRFLDM2BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT2,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM3BE
Onevent BEFORE_AREA Gosub AV_USRFLDM3BE From W1LOFECL1
Return

$AV_USRFLDM3BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT3,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM4BE
Onevent BEFORE_AREA Gosub AV_USRFLDM4BE From W1LOFECL1
Return

$AV_USRFLDM4BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT4,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM5BE
Onevent BEFORE_AREA Gosub AV_USRFLDM5BE From W1LOFECL1
Return

$AV_USRFLDM5BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT5,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM6BE
Onevent BEFORE_AREA Gosub AV_USRFLDM6BE From W1LOFECL1
Return

$AV_USRFLDM6BE
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT6,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM1AF
Onevent BEFORE_AREA Gosub AV_USRFLDM1AF From W1LOFECL1
Return

$AV_USRFLDM1AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT1,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM2AF
Onevent BEFORE_AREA Gosub AV_USRFLDM2AF From W1LOFECL1
Return

$AV_USRFLDM2AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT2,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM3AF
Onevent BEFORE_AREA Gosub AV_USRFLDM3AF From W1LOFECL1
Return

$AV_USRFLDM3AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT3,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM4AF
Onevent BEFORE_AREA Gosub AV_USRFLDM4AF From W1LOFECL1
Return

$AV_USRFLDM4AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT4,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM5AF
Onevent BEFORE_AREA Gosub AV_USRFLDM5AF From W1LOFECL1
Return

$AV_USRFLDM5AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT5,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM6AF
Onevent BEFORE_AREA Gosub AV_USRFLDM6AF From W1LOFECL1
Return

$AV_USRFLDM6AF
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT6,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_FLGFLDM1
Onevent INIT_AREA Call D_FLGFLDM1(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM1(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM1,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FLGFLDM2
Onevent INIT_AREA Call D_FLGFLDM2(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM2(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM2,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FLGFLDM3
Onevent INIT_AREA Call D_FLGFLDM3(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM3(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM3,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FLGFLDM4
Onevent INIT_AREA Call D_FLGFLDM4(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM4(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM4,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FLGFLDM5
Onevent INIT_AREA Call D_FLGFLDM5(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM5(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM5,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_FLGFLDM6
Onevent INIT_AREA Call D_FLGFLDM6(zc) From W1LOFECL1
Return

Subprog D_FLGFLDM6(VALEUR)
Variable Integer VALEUR
If varinit([M]FLGFLDM6,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_TYPNUM
Onevent BEFORE_INPUT Call AS_TYPNUM(zc) From W1LOFECL1
Onevent AFTER_AREA Call AP_TYPNUM(zc) From W1LOFECL1
Onevent INIT_AREA Call D_TYPNUM(zc) From W1LOFECL1
Onevent CONTROL Call C_TYPNUM(zc) From W1LOFECL1
Return

Subprog D_TYPNUM(VALEUR)
Variable Integer VALEUR
If varinit([M]TYPNUM,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

Subprog AS_TYPNUM(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(3120) From COMBOS
## Action STD
Call AS_TYPNUM(VALEUR) From TRTLOFECL
If mkstat=2
 [M]TYPNUM(INDIC) = VALEUR
 Affzo TYPNUM(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,3120,1))))
Endif
If !mkstat
 Discombo 0 From TYPNUM(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From TYPNUM(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_TYPNUM(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

Subprog AP_TYPNUM(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_TYPNUM(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "TYPNUM" : GZNUM = 35003 : Endif
Gosub _AFF
End

$ON_LIGSTR
Onevent AFTER_CHANGE Gosub AMM_LIGSTR From W1LOFECL1
Return

$AMM_LIGSTR
Call AM_LIGSTR(zc)
If !mkstat & GOBJET
 zoncou = "LIGSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LIGSTR(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call AM_LIGSTR(VALEUR) From TRTLOFECL
 If mkstat : GERR = 1 : GZONE = "LIGSTR" : GZNUM = 35285 : Endif
Endif
Gosub _AFF
End

$ON_LIGINC
Onevent AFTER_CHANGE Gosub AMM_LIGINC From W1LOFECL1
Onevent CONTROL Call C_LIGINC(zc) From W1LOFECL1
Return

Subprog C_LIGINC(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_LIGINC
Call AM_LIGINC(zc)
If !mkstat & GOBJET
 zoncou = "LIGINC" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LIGINC(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_LIGINC(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "LIGINC" : GZNUM = 5899 : Endif
Gosub _AFF
End

$ON_CODLOF
Onevent BEFORE_INPUT Call AS_CODLOF(zc) From W1LOFECL1
Onevent AFTER_CHANGE Gosub AMM_CODLOF From W1LOFECL1
Return

Subprog AS_CODLOF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_CODLOF(VALEUR) From TRTLOFECL
If mkstat=2
 [M]CODLOF(INDIC) = VALEUR
 Affzo CODLOF(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$AMM_CODLOF
Call AM_CODLOF(zc)
If !mkstat & GOBJET
 zoncou = "CODLOF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CODLOF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CODLOF(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "CODLOF" : GZNUM = 1371 : Endif
Gosub _AFF
End

$ON_LINLOF
Onevent BEFORE_INPUT Call AS_LINLOF(zc) From W1LOFECL1
Return

Subprog AS_LINLOF(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_LINLOF(VALEUR) From TRTLOFECL
If mkstat=2
 [M]LINLOF(INDIC) = VALEUR
 Affzo LINLOF(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$ON_QTY
Onevent BEFORE_AREA Gosub AV_QTY From W1LOFECL1
Onevent AFTER_CHANGE Gosub AMM_QTY From W1LOFECL1
Onevent CONTROL Call C_QTY(zc) From W1LOFECL1
Return

$AV_QTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]UOM,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog C_QTY(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "QTY" : GZNUM = 271 : Endif
Gosub _AFF
End

$AMM_QTY
Call AM_QTY(zc)
If !mkstat & GOBJET
 zoncou = "QTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_QTY(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "QTY" : GZNUM = 271 : Endif
Gosub _AFF
End

$ON_AMTNOTCPY
Onevent BEFORE_AREA Gosub AV_AMTNOTCPY From W1LOFECL1
Onevent AFTER_CHANGE Gosub AMM_AMTNOTCPY From W1LOFECL1
Return

$AV_AMTNOTCPY
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]AMTNOTCPY(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

$AMM_AMTNOTCPY
Call AM_AMTNOTCPY(zc)
If !mkstat & GOBJET
 zoncou = "AMTNOTCPY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_AMTNOTCPY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_AMTNOTCPY(VALEUR) From TRTLOFECL
If mkstat : GERR = 1 : GZONE = "AMTNOTCPY" : GZNUM = 5808 : Endif
Gosub _AFF
End

$ON_AMTNOTCUR
Onevent BEFORE_AREA Gosub AV_AMTNOTCUR From W1LOFECL1
Return

$AV_AMTNOTCUR
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATCUR
Onevent BEFORE_AREA Gosub AV_AMTVATCUR From W1LOFECL1
Return

$AV_AMTVATCUR
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATCPY
Onevent BEFORE_AREA Gosub AV_AMTVATCPY From W1LOFECL1
Return

$AV_AMTVATCPY
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATRCUR
Onevent BEFORE_AREA Gosub AV_AMTVATRCUR From W1LOFECL1
Return

$AV_AMTVATRCUR
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATRCPY
Onevent BEFORE_AREA Gosub AV_AMTVATRCPY From W1LOFECL1
Return

$AV_AMTVATRCPY
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTGRA
Onevent BEFORE_AREA Gosub AV_AMTGRA From W1LOFECL1
Return

$AV_AMTGRA
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GLOCALDEV,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTNOTIAS
Onevent BEFORE_AREA Gosub AV_AMTNOTIAS From W1LOFECL1
Return

$AV_AMTNOTIAS
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATIAS
Onevent BEFORE_AREA Gosub AV_AMTVATIAS From W1LOFECL1
Return

$AV_AMTVATIAS
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_AMTVATRIAS
Onevent BEFORE_AREA Gosub AV_AMTVATRIAS From W1LOFECL1
Return

$AV_AMTVATRIAS
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find("",GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM1
Onevent BEFORE_AREA Gosub AV_USRFLDM1 From W1LOFECL1
Return

$AV_USRFLDM1
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT1,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM2
Onevent BEFORE_AREA Gosub AV_USRFLDM2 From W1LOFECL1
Return

$AV_USRFLDM2
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT2,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM3
Onevent BEFORE_AREA Gosub AV_USRFLDM3 From W1LOFECL1
Return

$AV_USRFLDM3
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT3,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM4
Onevent BEFORE_AREA Gosub AV_USRFLDM4 From W1LOFECL1
Return

$AV_USRFLDM4
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT4,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM5
Onevent BEFORE_AREA Gosub AV_USRFLDM5 From W1LOFECL1
Return

$AV_USRFLDM5
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT5,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_USRFLDM6
Onevent BEFORE_AREA Gosub AV_USRFLDM6 From W1LOFECL1
Return

$AV_USRFLDM6
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find(GABZLMNT6,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$CHG_STY
Return


