#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management YSTR 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$ON_YTLONLGR
Onevent BEFORE_INPUT Call AS_YTLONLGR(zc) From W2YSTR
Onevent CONTROL Call C_YTLONLGR(zc) From W2YSTR
Return

Subprog AS_YTLONLGR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(100685,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YTLONLGR(zc) From W2YSTR
Onkey   2 Titled GBOUTS Call S_YTLONLGR(zc) From W2YSTR
Onkey 144 Titled GBOUTP Call P_YTLONLGR(zc) From W2YSTR
Onkey 146 Titled GBOUTA Call SA_YTLONLGR(zc) From W2YSTR
Gosub _AFF
End

Subprog C_YTLONLGR(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("YELA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YTLONLGR" : GZNUM = 100118 : Endif
Gosub _AFF
End

Subprog S_YTLONLGR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YELASEL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YELASEL"
 PARMSK(1) = ""
 Call S_LIS_CHAR(VALEUR,PARMSK,"YELASEL","","YSELELA") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YTLONLGR(VALEUR)
Variable Char    VALEUR()
Call OBJET("YELA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTLONLGR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YELA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTLONLGR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YELA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTPJTLIN
Onevent BEFORE_INPUT Call AS_YTPJTLIN(zc) From W2YSTR
Onevent CONTROL Call C_YTPJTLIN(zc) From W2YSTR
Onevent AFTER_CHANGE Gosub AMM_YTPJTLIN From W2YSTR
Return

Subprog IB_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YTPJTLIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]YTPJTLIN(INDIC) = VALEUR
 Affzo YTPJTLIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_YTPJTLIN(zc) From W2YSTR
Onkey 130 Titled GBOUT2 Call B2_YTPJTLIN(zc) From W2YSTR
Onkey 131 Titled GBOUT3 Call B3_YTPJTLIN(zc) From W2YSTR
Onkey 132 Titled GBOUT4 Call B4_YTPJTLIN(zc) From W2YSTR
Onkey 172 Titled GBOUT15 Call B15_YTPJTLIN(zc) From W2YSTR
Onkey 173 Titled GBOUT16 Call B16_YTPJTLIN(zc) From W2YSTR
Onkey 174 Titled GBOUT17 Call B17_YTPJTLIN(zc) From W2YSTR
Onkey 175 Titled GBOUT18 Call B18_YTPJTLIN(zc) From W2YSTR
Onkey 176 Titled GBOUT19 Call B19_YTPJTLIN(zc) From W2YSTR
Onkey   2 Titled GBOUTS Call S_YTPJTLIN(zc) From W2YSTR
Onkey 144 Titled GBOUTP Call P_YTPJTLIN(zc) From W2YSTR
Onkey 146 Titled GBOUTA Call SA_YTPJTLIN(zc) From W2YSTR
Gosub _AFF
End

Subprog C_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
Endif
Gosub _AFF
End

$AMM_YTPJTLIN
Call AM_YTPJTLIN(zc)
If !mkstat & GOBJET
 zoncou = "YTPJTLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YTPJTLIN" : GZNUM = 54491 : Endif
Gosub _AFF
End

Subprog S_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTPJTLIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTCCE
Onevent BEFORE_AREA Gosub AV_YTCCE From W2YSTR
Onevent CONTROL Call C_YTCCE(zc) From W2YSTR
Onevent BEFORE_INPUT Call AS_YTCCE(zc) From W2YSTR
Return

$AV_YTCCE
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YTCCE(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YTCCE(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YTCCE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YTCCE(zc) From W2YSTR
Onkey   2 Titled GBOUTS Call S_YTCCE(zc) From W2YSTR
Onkey 144 Titled GBOUTP Call P_YTCCE(zc) From W2YSTR
Onkey 146 Titled GBOUTA Call SA_YTCCE(zc) From W2YSTR
Gosub _AFF
End

Subprog C_YTCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YTCCE" : GZNUM = 3997 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YTCCE" : GZNUM = 3997 : Endif
Endif
Gosub _AFF
End

Subprog S_YTCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YTCCE(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTCCE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Return


