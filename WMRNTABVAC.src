#<AdxTL>@(#)0.0.0.0 $Revision$Class Tax determination table
# Supervisor
## ACLA-CLASSE ## TABVAC
# 2018-08-27 13:39:13 868

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMR0TABVAC
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
this._AFCRIGHT = "GESTVC"
Gosub INIT_FLD1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_DES1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_OPE1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VAL1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VALI1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBL1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_ANDOR2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_FLD2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_DES2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_OPE2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VAL2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VALI2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBL2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_ANDOR3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_FLD3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_DES3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_OPE3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VAL3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VALI3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBL3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_ANDOR4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_FLD4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_DES4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_OPE4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VAL4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_VALI4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBL4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_ANDOR5 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_FLD5 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_DES5 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub INIT_OPE5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_VAL5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_VALI5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBL5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_EXPRESSION From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_EXPTOT From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NOLIB1 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NOLIB2 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NOLIB3 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NOLIB4 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NOLIB5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_OBJ From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_ABR From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_TITDIC From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_ABTBL From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_FMT1 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_FMT2 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_FMT3 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_FMT4 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_FMT5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_NBTBL From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_SUPP1 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_SUPP2 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_SUPP3 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_SUPP4 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_SUPP5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub INIT_TBTBL From WMR2TABVAC : Gosub TESTALLSTAT
If this.TVC<>null
 [L]ASTATUS = fmet this.TVC.AINIT : Gosub TESTALLSTAT
Endif
Gosub AINIT From WMR0TABVAC : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMR0TABVAC
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMR0TABVAC
Gosub LNKPRO_TBL1 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_TBL2 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_TBL3 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_TBL4 From WMR1TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_TBL5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_OBJ From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_FMT1 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_FMT2 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_FMT3 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_FMT4 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_FMT5 From WMR2TABVAC : Gosub TESTALLSTAT
Gosub LNKPRO_TBTBL From WMR2TABVAC : Gosub TESTALLSTAT
If this.TVC<>null
 [L]ASTATUS = fmet this.TVC._ALNKPRO : Gosub TESTALLSTAT
Endif
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



