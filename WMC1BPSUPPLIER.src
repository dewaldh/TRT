#<AdxTL>@(#)0.0.0.0 $Revision$Class Suppliers
# Supervisor
## ACLA-CLASSE ## BPSUPPLIER
# 2018-08-27 12:26:26 608


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : BPSNUM Supplier ( Field BPS 15)
####################################################################

$SET_BPSNUM
If [L]_AOLDVAL<>this.BPSNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSNUM
 Gosub PROPAGATE_BPSNUM
Endif
Return

$INIT_BPSNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSNUM
[L]CURPRO = "BPSNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSNUM
[L]CURPRO = "BPSNUM"
If vireblc(this.BPSNUM,2)<>vireblc(format$("K:15c",this.BPSNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSNUM
[L]CURPRO = "BPSNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSNUM
[L]CURPRO = "BPSNUM"
Return

$PROPAGATE_BPSNUM
this.isReadonly = 0
[L]CURPRO = "BPSNUM"
Gosub _LNKPRO_BPSNUM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNUM"
$_LNKPRO_BPSNUM
If vireblc(this.BPSNUM,2)<>""
 # Link BPSUPPLIER
 Local File BPSUPPLIER [WBPS]
 Read [F:WBPS]BPS0 = this.BPSNUM
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM","$title",[F:WBPS]BPSSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM","$description",[F:WBPS]BPSNAM)
 Endif
 LogicClose File [WBPS]
Endif
Return

$_ALOADATTRIBUTE_BPSNUM
[L]ASTATUS = fmet this.ASETATTRIBUTE("BPSNUM","$isMandatory","true")
Return


####################################################################
# 2 : CPY Company ( Field CPY 5)
####################################################################

$SET_CPY
If [L]_AOLDVAL<>this.CPY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CPY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CPY
 Gosub PROPAGATE_CPY
Endif
Return

$INIT_CPY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CPY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CPY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CPY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CPY
[L]CURPRO = "CPY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CPY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>vireblc(format$("K:5c",this.CPY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCPY.ACTRLREF(this,"CPY",this.CPY,this.CPY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CPY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CPY
[L]CURPRO = "CPY"
Return

$PROPAGATE_CPY
this.isReadonly = 0
[L]CURPRO = "CPY"
Gosub _LNKPRO_CPY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CPY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CPY"
$_LNKPRO_CPY
If vireblc(this.CPY,2)<>""
 # Link COMPANY
 Local File COMPANY [WCPY]
 Read [F:WCPY]CPY0 = this.CPY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$title",[F:WCPY]CPYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$description",[F:WCPY]CPYNAM)
 Endif
 LogicClose File [WCPY]
Endif
Return


####################################################################
# 3 : BPSNAM Company name ( Field NAM 35)
####################################################################

$SET_BPSNAM
If [L]_AOLDVAL<>this.BPSNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSNAM
 Gosub PROPAGATE_BPSNAM
Endif
Return

$INIT_BPSNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSNAM
[L]CURPRO = "BPSNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSNAM
[L]CURPRO = "BPSNAM"
If vireblc(this.BPSNAM,2)<>vireblc(format$("K:35X",this.BPSNAM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSNAM
[L]CURPRO = "BPSNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSNAM
[L]CURPRO = "BPSNAM"
Return

$PROPAGATE_BPSNAM
this.isReadonly = 0
[L]CURPRO = "BPSNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSNAM"
$_LNKPRO_BPSNAM
Return


####################################################################
# 4 : BPSSHO Short description ( Field SHO 10)
####################################################################

$SET_BPSSHO
If [L]_AOLDVAL<>this.BPSSHO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSSHO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSSHO
 Gosub PROPAGATE_BPSSHO
Endif
Return

$INIT_BPSSHO
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSSHO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSSHO
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSSHO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSSHO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSSHO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSSHO
[L]CURPRO = "BPSSHO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSSHO,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSSHO
[L]CURPRO = "BPSSHO"
If vireblc(this.BPSSHO,2)<>vireblc(format$("K:10X",this.BPSSHO),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSSHO
[L]CURPRO = "BPSSHO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSSHO
[L]CURPRO = "BPSSHO"
Return

$PROPAGATE_BPSSHO
this.isReadonly = 0
[L]CURPRO = "BPSSHO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSSHO
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSSHO"
$_LNKPRO_BPSSHO
Return


####################################################################
# 5 : BPSTYP Supplier type ( Field Local menu number 501)
####################################################################

$SET_BPSTYP
If [L]_AOLDVAL<>this.BPSTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSTYP
 Gosub PROPAGATE_BPSTYP
Endif
Return

$INIT_BPSTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.BPSTYP=0 and fmet this.AGETATTRIBUTE("BPSTYP","$isMandatory")="true"
 this.BPSTYP = 1
Endif
Return
 
$CONTROL_BPSTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSTYP
[L]CURPRO = "BPSTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BPSTYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSTYP
[L]CURPRO = "BPSTYP"
If this.BPSTYP<0 or this.BPSTYP>len(mess(0,501,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"501 ->"-num$(this.BPSTYP)-mess(99,123,1)):  Return : # Local menu "501 -> Invalid option
Endif
Return

$_AOTHERS_BPSTYP
[L]CURPRO = "BPSTYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSTYP
[L]CURPRO = "BPSTYP"
Return

$PROPAGATE_BPSTYP
this.isReadonly = 0
[L]CURPRO = "BPSTYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSTYP"
$_LNKPRO_BPSTYP
Return


####################################################################
# 6 : BSGCOD Category ( Field BSG 5)
####################################################################

$SET_BSGCOD
If [L]_AOLDVAL<>this.BSGCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BSGCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BSGCOD
 Gosub PROPAGATE_BSGCOD
Endif
Return

$INIT_BSGCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BSGCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BSGCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BSGCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BSGCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BSGCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BSGCOD
[L]CURPRO = "BSGCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BSGCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BSGCOD
[L]CURPRO = "BSGCOD"
If vireblc(this.BSGCOD,2)<>vireblc(format$("K:5c",this.BSGCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BSGCOD
[L]CURPRO = "BSGCOD"
If vireblc(this.BSGCOD,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBSG.ACTRLREF(this,"BSGCOD",this.BSGCOD,this.BSGCOD,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BSGCOD<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BSGCOD
[L]CURPRO = "BSGCOD"
Return

$PROPAGATE_BSGCOD
this.isReadonly = 0
[L]CURPRO = "BSGCOD"
Gosub _LNKPRO_BSGCOD
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BSGCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BSGCOD"
$_LNKPRO_BSGCOD
If vireblc(this.BSGCOD,2)<>""
 # Link BPSCATEG
 Local File BPSCATEG [WBSG]
 Read [F:WBSG]BSG0 = this.BSGCOD
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="BPSCATEG" & ZONE="SHOAXX" & IDENT1=[F:WBSG]BSGCOD & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BSGCOD","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="BPSCATEG" & ZONE="DESAXX" & IDENT1=[F:WBSG]BSGCOD & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("BSGCOD","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WBSG]
Endif
Return


####################################################################
# 7 : BPRPAY Pay-to ( Field BPR 15)
####################################################################

$SET_BPRPAY
If [L]_AOLDVAL<>this.BPRPAY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPRPAY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPRPAY
 Gosub PROPAGATE_BPRPAY
Endif
Return

$INIT_BPRPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPRPAY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPRPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPRPAY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPRPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPRPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPRPAY
[L]CURPRO = "BPRPAY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPRPAY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPRPAY
[L]CURPRO = "BPRPAY"
If vireblc(this.BPRPAY,2)<>vireblc(format$("K:15c",this.BPRPAY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPRPAY
[L]CURPRO = "BPRPAY"
If vireblc(this.BPRPAY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPR.ACTRLREF(this,"BPRPAY",this.BPRPAY,this.BPRPAY,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPRPAY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPRPAY
[L]CURPRO = "BPRPAY"
Return

$PROPAGATE_BPRPAY
this.isReadonly = 0
[L]CURPRO = "BPRPAY"
Gosub _LNKPRO_BPRPAY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPRPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPRPAY"
$_LNKPRO_BPRPAY
If vireblc(this.BPRPAY,2)<>""
 # Link BPARTNER
 Local File BPARTNER [WBPR]
 Read [F:WBPR]BPR0 = this.BPRPAY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPRPAY","$title",[F:WBPR]BPRSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPRPAY","$description",[F:WBPR]BPRNAM)
 Endif
 LogicClose File [WBPR]
Endif
Return


####################################################################
# 8 : BPAPAY Address paying BP ( Field ADR 5)
####################################################################

$SET_BPAPAY
If [L]_AOLDVAL<>this.BPAPAY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPAPAY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPAPAY
 Gosub PROPAGATE_BPAPAY
Endif
Return

$INIT_BPAPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAPAY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPAPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAPAY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPAPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPAPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPAPAY
[L]CURPRO = "BPAPAY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPAPAY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPAPAY
[L]CURPRO = "BPAPAY"
If vireblc(this.BPAPAY,2)<>vireblc(format$("K:5c",this.BPAPAY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPAPAY
[L]CURPRO = "BPAPAY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPAPAY
[L]CURPRO = "BPAPAY"
If vireblc(this.BPAPAY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPADR.ACTRLREF(this,"BPAPAY",this.BPAPAY,1,this.BPRPAY,this.BPAPAY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPAPAY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_BPAPAY
this.isReadonly = 0
[L]CURPRO = "BPAPAY"
Gosub _LNKPRO_BPAPAY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPAPAY
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAPAY"
$_LNKPRO_BPAPAY
If vireblc(this.BPAPAY,2)<>""
 # Link BPADDRESS
 Local File BPADDRESS [WBPA]
 Read [F:WBPA]BPA0 = 1;this.BPRPAY;this.BPAPAY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPAPAY","$description",[F:WBPA]BPADES)
 Endif
 LogicClose File [WBPA]
Endif
Return


####################################################################
# 9 : BPSINV Supplier invoice ( Field BPR 15)
####################################################################

$SET_BPSINV
If [L]_AOLDVAL<>this.BPSINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSINV
 Gosub PROPAGATE_BPSINV
Endif
Return

$INIT_BPSINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSINV
[L]CURPRO = "BPSINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSINV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSINV
[L]CURPRO = "BPSINV"
If vireblc(this.BPSINV,2)<>vireblc(format$("K:15c",this.BPSINV),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSINV
[L]CURPRO = "BPSINV"
If vireblc(this.BPSINV,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPR.ACTRLREF(this,"BPSINV",this.BPSINV,this.BPSINV,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPSINV<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSINV
[L]CURPRO = "BPSINV"
Return

$PROPAGATE_BPSINV
this.isReadonly = 0
[L]CURPRO = "BPSINV"
Gosub _LNKPRO_BPSINV
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSINV"
$_LNKPRO_BPSINV
If vireblc(this.BPSINV,2)<>""
 # Link BPARTNER
 Local File BPARTNER [WBPR]
 Read [F:WBPR]BPR0 = this.BPSINV
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSINV","$title",[F:WBPR]BPRSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSINV","$description",[F:WBPR]BPRNAM)
 Endif
 LogicClose File [WBPR]
Endif
Return


####################################################################
# 10 : BPAINV Billing address ( Field ADR 5)
####################################################################

$SET_BPAINV
If [L]_AOLDVAL<>this.BPAINV
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPAINV
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPAINV
 Gosub PROPAGATE_BPAINV
Endif
Return

$INIT_BPAINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAINV"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPAINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAINV"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPAINV                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPAINV
[L]CURPRO = "BPAINV"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPAINV,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>vireblc(format$("K:5c",this.BPAINV),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPAINV
[L]CURPRO = "BPAINV"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPAINV
[L]CURPRO = "BPAINV"
If vireblc(this.BPAINV,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPADR.ACTRLREF(this,"BPAINV",this.BPAINV,1,this.BPSINV,this.BPAINV,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPAINV<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_BPAINV
this.isReadonly = 0
[L]CURPRO = "BPAINV"
Gosub _LNKPRO_BPAINV
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPAINV
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPAINV"
$_LNKPRO_BPAINV
If vireblc(this.BPAINV,2)<>""
 # Link BPADDRESS
 Local File BPADDRESS [WBPA]
 Read [F:WBPA]BPA0 = 1;this.BPSINV;this.BPAINV
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPAINV","$description",[F:WBPA]BPADES)
 Endif
 LogicClose File [WBPA]
Endif
Return


####################################################################
# 11 : BPSGRU Supplier group ( Field BPR 15)
####################################################################

$SET_BPSGRU
If [L]_AOLDVAL<>this.BPSGRU
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSGRU
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSGRU
 Gosub PROPAGATE_BPSGRU
Endif
Return

$INIT_BPSGRU
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSGRU"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSGRU
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSGRU"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSGRU                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSGRU                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSGRU
[L]CURPRO = "BPSGRU"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSGRU,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSGRU
[L]CURPRO = "BPSGRU"
If vireblc(this.BPSGRU,2)<>vireblc(format$("K:15c",this.BPSGRU),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSGRU
[L]CURPRO = "BPSGRU"
If vireblc(this.BPSGRU,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPR.ACTRLREF(this,"BPSGRU",this.BPSGRU,this.BPSGRU,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPSGRU<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSGRU
[L]CURPRO = "BPSGRU"
Return

$PROPAGATE_BPSGRU
this.isReadonly = 0
[L]CURPRO = "BPSGRU"
Gosub _LNKPRO_BPSGRU
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSGRU
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSGRU"
$_LNKPRO_BPSGRU
If vireblc(this.BPSGRU,2)<>""
 # Link BPARTNER
 Local File BPARTNER [WBPR]
 Read [F:WBPR]BPR0 = this.BPSGRU
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSGRU","$title",[F:WBPR]BPRSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSGRU","$description",[F:WBPR]BPRNAM)
 Endif
 LogicClose File [WBPR]
Endif
Return


####################################################################
# 12 : BPSRSK Risk BP ( Field BPR 15)
####################################################################

$SET_BPSRSK
If [L]_AOLDVAL<>this.BPSRSK
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPSRSK
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPSRSK
 Gosub PROPAGATE_BPSRSK
Endif
Return

$INIT_BPSRSK
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSRSK"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPSRSK
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSRSK"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPSRSK                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPSRSK                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPSRSK
[L]CURPRO = "BPSRSK"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPSRSK,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPSRSK
[L]CURPRO = "BPSRSK"
If vireblc(this.BPSRSK,2)<>vireblc(format$("K:15c",this.BPSRSK),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPSRSK
[L]CURPRO = "BPSRSK"
If vireblc(this.BPSRSK,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPR.ACTRLREF(this,"BPSRSK",this.BPSRSK,this.BPSRSK,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPSRSK<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPSRSK
[L]CURPRO = "BPSRSK"
Return

$PROPAGATE_BPSRSK
this.isReadonly = 0
[L]CURPRO = "BPSRSK"
Gosub _LNKPRO_BPSRSK
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPSRSK
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPSRSK"
$_LNKPRO_BPSRSK
If vireblc(this.BPSRSK,2)<>""
 # Link BPARTNER
 Local File BPARTNER [WBPR]
 Read [F:WBPR]BPR0 = this.BPSRSK
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSRSK","$title",[F:WBPR]BPRSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPSRSK","$description",[F:WBPR]BPRNAM)
 Endif
 LogicClose File [WBPR]
Endif
Return


####################################################################
# 13 : BPCNUMBPS Our customer no. ( Field A 15)
####################################################################

$SET_BPCNUMBPS
If [L]_AOLDVAL<>this.BPCNUMBPS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPCNUMBPS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPCNUMBPS
 Gosub PROPAGATE_BPCNUMBPS
Endif
Return

$INIT_BPCNUMBPS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPCNUMBPS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPCNUMBPS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPCNUMBPS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPCNUMBPS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPCNUMBPS             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPCNUMBPS
[L]CURPRO = "BPCNUMBPS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPCNUMBPS,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPCNUMBPS
[L]CURPRO = "BPCNUMBPS"
Return

$_AOTHERS_BPCNUMBPS
[L]CURPRO = "BPCNUMBPS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPCNUMBPS
[L]CURPRO = "BPCNUMBPS"
Return

$PROPAGATE_BPCNUMBPS
this.isReadonly = 0
[L]CURPRO = "BPCNUMBPS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPCNUMBPS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPCNUMBPS"
$_LNKPRO_BPCNUMBPS
Return


####################################################################
# 14 : BPTNUM Carrier ( Field BPT 15)
####################################################################

$SET_BPTNUM
If [L]_AOLDVAL<>this.BPTNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPTNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPTNUM
 Gosub PROPAGATE_BPTNUM
Endif
Return

$INIT_BPTNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPTNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPTNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPTNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPTNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPTNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPTNUM
[L]CURPRO = "BPTNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPTNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPTNUM
[L]CURPRO = "BPTNUM"
If vireblc(this.BPTNUM,2)<>vireblc(format$("K:15c",this.BPTNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPTNUM
[L]CURPRO = "BPTNUM"
If vireblc(this.BPTNUM,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPT.ACTRLREF(this,"BPTNUM",this.BPTNUM,this.BPTNUM,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPTNUM<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPTNUM
[L]CURPRO = "BPTNUM"
Return

$PROPAGATE_BPTNUM
this.isReadonly = 0
[L]CURPRO = "BPTNUM"
Gosub _LNKPRO_BPTNUM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPTNUM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "BPTNUM"
$_LNKPRO_BPTNUM
If vireblc(this.BPTNUM,2)<>""
 # Link BPCARRIER
 Local File BPCARRIER [WBPT]
 Read [F:WBPT]BPT0 = this.BPTNUM
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPTNUM","$title",[F:WBPT]BPTSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPTNUM","$description",[F:WBPT]BPTNAM)
 Endif
 LogicClose File [WBPT]
Endif
Return


####################################################################
# 15 : CNTNAM Default contact ( Field NAM 35)
####################################################################

$SET_CNTNAM
If [L]_AOLDVAL<>this.CNTNAM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CNTNAM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CNTNAM
 Gosub PROPAGATE_CNTNAM
Endif
Return

$INIT_CNTNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CNTNAM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CNTNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CNTNAM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CNTNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CNTNAM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CNTNAM
[L]CURPRO = "CNTNAM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CNTNAM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CNTNAM
[L]CURPRO = "CNTNAM"
If vireblc(this.CNTNAM,2)<>vireblc(format$("K:35X",this.CNTNAM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CNTNAM
[L]CURPRO = "CNTNAM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CNTNAM
[L]CURPRO = "CNTNAM"
Return

$PROPAGATE_CNTNAM
this.isReadonly = 0
[L]CURPRO = "CNTNAM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CNTNAM
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CNTNAM"
$_LNKPRO_CNTNAM
Return


####################################################################
# 16 : LOC Location ( Field EMP 10)
####################################################################

$SET_LOC
If [L]_AOLDVAL<>this.LOC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LOC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LOC
 Gosub PROPAGATE_LOC
Endif
Return

$INIT_LOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "LOC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "LOC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LOC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LOC                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LOC
[L]CURPRO = "LOC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LOC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LOC
[L]CURPRO = "LOC"
Return

$_AOTHERS_LOC
[L]CURPRO = "LOC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LOC
[L]CURPRO = "LOC"
If vireblc(this.LOC,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPEMP.ACTRLREF(this,"LOC",this.LOC,"",this.LOC,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.LOC<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_LOC
this.isReadonly = 0
[L]CURPRO = "LOC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "LOC"
$_LNKPRO_LOC
Return


####################################################################
# 17 : ABCCLS ABC class ( Field Local menu number 212)
####################################################################

$SET_ABCCLS
If [L]_AOLDVAL<>this.ABCCLS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ABCCLS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ABCCLS
 Gosub PROPAGATE_ABCCLS
Endif
Return

$INIT_ABCCLS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "ABCCLS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.ABCCLS=0 and fmet this.AGETATTRIBUTE("ABCCLS","$isMandatory")="true"
 this.ABCCLS = 1
Endif
Return
 
$CONTROL_ABCCLS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "ABCCLS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ABCCLS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ABCCLS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ABCCLS
[L]CURPRO = "ABCCLS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ABCCLS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ABCCLS
[L]CURPRO = "ABCCLS"
If this.ABCCLS<0 or this.ABCCLS>len(mess(0,212,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"212 ->"-num$(this.ABCCLS)-mess(99,123,1)):  Return : # Local menu "212 -> Invalid option
Endif
Return

$_AOTHERS_ABCCLS
[L]CURPRO = "ABCCLS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ABCCLS
[L]CURPRO = "ABCCLS"
Return

$PROPAGATE_ABCCLS
this.isReadonly = 0
[L]CURPRO = "ABCCLS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ABCCLS
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "ABCCLS"
$_LNKPRO_ABCCLS
Return


####################################################################
# 18 : UVYCOD Unavailable ( Field UVY 5)
####################################################################

$SET_UVYCOD
If [L]_AOLDVAL<>this.UVYCOD
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_UVYCOD
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.UVYCOD
 Gosub PROPAGATE_UVYCOD
Endif
Return

$INIT_UVYCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "UVYCOD"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_UVYCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "UVYCOD"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_UVYCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_UVYCOD                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_UVYCOD
[L]CURPRO = "UVYCOD"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.UVYCOD,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_UVYCOD
[L]CURPRO = "UVYCOD"
If vireblc(this.UVYCOD,2)<>vireblc(format$("K:5c",this.UVYCOD),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_UVYCOD
[L]CURPRO = "UVYCOD"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_UVYCOD
[L]CURPRO = "UVYCOD"
Return

$PROPAGATE_UVYCOD
this.isReadonly = 0
[L]CURPRO = "UVYCOD"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_UVYCOD
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "UVYCOD"
$_LNKPRO_UVYCOD
Return


####################################################################
# 19 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return

$_ALOADATTRIBUTE_CUR
[L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$isMandatory","true")
Return


####################################################################
# 20 : CHGTYP Rate type ( Field Local menu number 202)
####################################################################

$SET_CHGTYP
If [L]_AOLDVAL<>this.CHGTYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CHGTYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CHGTYP
 Gosub PROPAGATE_CHGTYP
Endif
Return

$INIT_CHGTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CHGTYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.CHGTYP=0 and fmet this.AGETATTRIBUTE("CHGTYP","$isMandatory")="true"
 this.CHGTYP = 1
Endif
Return
 
$CONTROL_CHGTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CHGTYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CHGTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CHGTYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CHGTYP
[L]CURPRO = "CHGTYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.CHGTYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CHGTYP
[L]CURPRO = "CHGTYP"
If this.CHGTYP<0 or this.CHGTYP>len(mess(0,202,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"202 ->"-num$(this.CHGTYP)-mess(99,123,1)):  Return : # Local menu "202 -> Invalid option
Endif
Return

$_AOTHERS_CHGTYP
[L]CURPRO = "CHGTYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CHGTYP
[L]CURPRO = "CHGTYP"
Return

$PROPAGATE_CHGTYP
this.isReadonly = 0
[L]CURPRO = "CHGTYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CHGTYP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "CHGTYP"
$_LNKPRO_CHGTYP
Return


####################################################################
# 21 : PTE Payment term ( Field PTE 15)
####################################################################

$SET_PTE
If [L]_AOLDVAL<>this.PTE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PTE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PTE
 Gosub PROPAGATE_PTE
Endif
Return

$INIT_PTE
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PTE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PTE
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PTE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PTE                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PTE                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PTE
[L]CURPRO = "PTE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PTE,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PTE
[L]CURPRO = "PTE"
If vireblc(this.PTE,2)<>vireblc(format$("K:15c",this.PTE),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PTE
[L]CURPRO = "PTE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PTE
[L]CURPRO = "PTE"
If vireblc(this.PTE,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPPTE.ACTRLREF(this,"PTE",this.PTE,this.PTE,"",0,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.PTE<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_PTE
this.isReadonly = 0
[L]CURPRO = "PTE"
Gosub _LNKPRO_PTE
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PTE
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PTE"
$_LNKPRO_PTE
If vireblc(this.PTE,2)<>""
 # Link TABPAYTERM
 Local File TABPAYTERM [WTPT]
 Read [F:WTPT]TPT0 = this.PTE;"";0
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="SHOAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABPAYTERM" & ZONE="DESAXX" & IDENT1=[F:WTPT]PTE & IDENT2=[F:WTPT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("PTE","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTPT]
Endif
Return


####################################################################
# 22 : DEP Settlement discount ( Field TDA 5)
####################################################################

$SET_DEP
If [L]_AOLDVAL<>this.DEP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEP
 Gosub PROPAGATE_DEP
Endif
Return

$INIT_DEP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "DEP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "DEP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEP                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEP
[L]CURPRO = "DEP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DEP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEP
[L]CURPRO = "DEP"
If vireblc(this.DEP,2)<>vireblc(format$("K:5c",this.DEP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DEP
[L]CURPRO = "DEP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEP
[L]CURPRO = "DEP"
If vireblc(this.DEP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTDA.ACTRLREF(this,"DEP",this.DEP,this.DEP,"","")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.DEP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_DEP
this.isReadonly = 0
[L]CURPRO = "DEP"
Gosub _LNKPRO_DEP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEP
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "DEP"
$_LNKPRO_DEP
If vireblc(this.DEP,2)<>""
 # Link TABDEPAGIO
 Local File TABDEPAGIO [WTDA]
 Read [F:WTDA]TDA0 = this.DEP;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABDEPAGIO" & ZONE="SHOAXX" & IDENT1=[F:WTDA]DEP & IDENT2=[F:WTDA]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABDEPAGIO" & ZONE="DESAXX" & IDENT1=[F:WTDA]DEP & IDENT2=[F:WTDA]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTDA]
Endif
Return


####################################################################
# 23 : VACBPR Tax rule ( Field TVB 5)
####################################################################

$SET_VACBPR
If [L]_AOLDVAL<>this.VACBPR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VACBPR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VACBPR
 Gosub PROPAGATE_VACBPR
Endif
Return

$INIT_VACBPR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "VACBPR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VACBPR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "VACBPR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VACBPR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VACBPR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VACBPR
[L]CURPRO = "VACBPR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VACBPR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VACBPR
[L]CURPRO = "VACBPR"
If vireblc(this.VACBPR,2)<>vireblc(format$("K:5c",this.VACBPR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VACBPR
[L]CURPRO = "VACBPR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VACBPR
[L]CURPRO = "VACBPR"
If vireblc(this.VACBPR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTVB.ACTRLREF(this,"VACBPR",this.VACBPR,this.VACBPR,"",2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.VACBPR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_VACBPR
this.isReadonly = 0
[L]CURPRO = "VACBPR"
Gosub _LNKPRO_VACBPR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VACBPR
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "VACBPR"
$_LNKPRO_VACBPR
If vireblc(this.VACBPR,2)<>""
 # Link TABVACBPR
 Local File TABVACBPR [WTVB]
 Read [F:WTVB]TVB0 = this.VACBPR;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="SHOAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACBPR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVACBPR" & ZONE="DESAXX" & IDENT1=[F:WTVB]VACBPR & IDENT2=[F:WTVB]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VACBPR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVB]
Endif
Return

$_ALOADATTRIBUTE_VACBPR
[L]ASTATUS = fmet this.ASETATTRIBUTE("VACBPR","$isMandatory","true")
Return


####################################################################
# 24 : MDL Delivery mode ( Field MDL 5)
####################################################################

$SET_MDL
If [L]_AOLDVAL<>this.MDL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MDL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MDL
 Gosub PROPAGATE_MDL
Endif
Return

$INIT_MDL
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "MDL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_MDL
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "MDL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MDL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MDL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MDL
[L]CURPRO = "MDL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.MDL,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MDL
[L]CURPRO = "MDL"
If vireblc(this.MDL,2)<>vireblc(format$("K:5c",this.MDL),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_MDL
[L]CURPRO = "MDL"
If vireblc(this.MDL,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPMDL.ACTRLREF(this,"MDL",this.MDL,this.MDL,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.MDL<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MDL
[L]CURPRO = "MDL"
Return

$PROPAGATE_MDL
this.isReadonly = 0
[L]CURPRO = "MDL"
Gosub _LNKPRO_MDL
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MDL
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "MDL"
$_LNKPRO_MDL
If vireblc(this.MDL,2)<>""
 # Link TABMODELIV
 Local File TABMODELIV [WTMD]
 Read [F:WTMD]TMD0 = this.MDL
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABMODELIV" & ZONE="SHOAXX" & IDENT1=[F:WTMD]MDL & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("MDL","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABMODELIV" & ZONE="DESAXX" & IDENT1=[F:WTMD]MDL & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("MDL","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTMD]
Endif
Return


####################################################################
# 25 : EECICT Incoterm ( Field ICT 5)
####################################################################

$SET_EECICT
If [L]_AOLDVAL<>this.EECICT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECICT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECICT
 Gosub PROPAGATE_EECICT
Endif
Return

$INIT_EECICT
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECICT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_EECICT
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECICT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECICT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECICT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECICT
[L]CURPRO = "EECICT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.EECICT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECICT
[L]CURPRO = "EECICT"
If vireblc(this.EECICT,2)<>vireblc(format$("K:5c",this.EECICT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_EECICT
[L]CURPRO = "EECICT"
If vireblc(this.EECICT,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPICT.ACTRLREF(this,"EECICT",this.EECICT,this.EECICT,2,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.EECICT<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECICT
[L]CURPRO = "EECICT"
Return

$PROPAGATE_EECICT
this.isReadonly = 0
[L]CURPRO = "EECICT"
Gosub _LNKPRO_EECICT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECICT
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECICT"
$_LNKPRO_EECICT
If vireblc(this.EECICT,2)<>""
 # Link INCOTERM
 Local File INCOTERM [WICTH]
 Read [F:WICTH]ICT0 = this.EECICT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="INCOTERM" & ZONE="DES" & IDENT1=[F:WICTH]ICTCOD & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("EECICT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WICTH]
Endif
Return


####################################################################
# 26 : EECLOC EU transport location ( Field Local menu number 236)
####################################################################

$SET_EECLOC
If [L]_AOLDVAL<>this.EECLOC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_EECLOC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.EECLOC
 Gosub PROPAGATE_EECLOC
Endif
Return

$INIT_EECLOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECLOC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.EECLOC=0 and fmet this.AGETATTRIBUTE("EECLOC","$isMandatory")="true"
 this.EECLOC = 1
Endif
Return
 
$CONTROL_EECLOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECLOC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_EECLOC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_EECLOC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_EECLOC
[L]CURPRO = "EECLOC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.EECLOC=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_EECLOC
[L]CURPRO = "EECLOC"
If this.EECLOC<0 or this.EECLOC>len(mess(0,236,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"236 ->"-num$(this.EECLOC)-mess(99,123,1)):  Return : # Local menu "236 -> Invalid option
Endif
Return

$_AOTHERS_EECLOC
[L]CURPRO = "EECLOC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_EECLOC
[L]CURPRO = "EECLOC"
Return

$PROPAGATE_EECLOC
this.isReadonly = 0
[L]CURPRO = "EECLOC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_EECLOC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "EECLOC"
$_LNKPRO_EECLOC
Return


####################################################################
# 29 : PLISTC Price list structure ( Field PRS 10)
####################################################################

$SET_PLISTC
If [L]_AOLDVAL<>this.PLISTC
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PLISTC
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PLISTC
 Gosub PROPAGATE_PLISTC
Endif
Return

$INIT_PLISTC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PLISTC"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PLISTC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PLISTC"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PLISTC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PLISTC                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PLISTC
[L]CURPRO = "PLISTC"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PLISTC,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PLISTC
[L]CURPRO = "PLISTC"
If vireblc(this.PLISTC,2)<>vireblc(format$("K:10c",this.PLISTC),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PLISTC
[L]CURPRO = "PLISTC"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PLISTC
[L]CURPRO = "PLISTC"
Return

$PROPAGATE_PLISTC
this.isReadonly = 0
[L]CURPRO = "PLISTC"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PLISTC
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PLISTC"
$_LNKPRO_PLISTC
Return


####################################################################
# 30 : PAYBAN Payment bank ( Field BAN 5)
####################################################################

$SET_PAYBAN
If [L]_AOLDVAL<>this.PAYBAN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PAYBAN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PAYBAN
 Gosub PROPAGATE_PAYBAN
Endif
Return

$INIT_PAYBAN
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PAYBAN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PAYBAN
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PAYBAN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PAYBAN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PAYBAN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PAYBAN
[L]CURPRO = "PAYBAN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PAYBAN,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PAYBAN
[L]CURPRO = "PAYBAN"
If vireblc(this.PAYBAN,2)<>vireblc(format$("K:5c",this.PAYBAN),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PAYBAN
[L]CURPRO = "PAYBAN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PAYBAN
[L]CURPRO = "PAYBAN"
Return

$PROPAGATE_PAYBAN
this.isReadonly = 0
[L]CURPRO = "PAYBAN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PAYBAN
Gosub DECLARE_VAR From WMC0BPSUPPLIER
[L]CURPRO = "PAYBAN"
$_LNKPRO_PAYBAN
Return




