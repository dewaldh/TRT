#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management PJMFINOV1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$ON_PSCQTY31
Onevent BEFORE_AREA Gosub AV_PSCQTY31 From W2PJMFINOV1
Return

$AV_PSCQTY31
If func PJMFINOV0.COLGETFMT(27)<>""
 Chgfmt [M]PSCQTY31(indice) With func PJMFINOV0.COLGETFMT(27)
Else
 Chgfmt [M]PSCQTY31(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT31
Onevent BEFORE_AREA Gosub AV_PSCAMT31 From W2PJMFINOV1
Return

$AV_PSCAMT31
If func PJMFINOV0.COLGETFMT(28)<>""
 Chgfmt [M]PSCAMT31(indice) With func PJMFINOV0.COLGETFMT(28)
Else
 Chgfmt [M]PSCAMT31(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCQTY32
Onevent BEFORE_AREA Gosub AV_PSCQTY32 From W2PJMFINOV1
Return

$AV_PSCQTY32
If func PJMFINOV0.COLGETFMT(29)<>""
 Chgfmt [M]PSCQTY32(indice) With func PJMFINOV0.COLGETFMT(29)
Else
 Chgfmt [M]PSCQTY32(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT32
Onevent BEFORE_AREA Gosub AV_PSCAMT32 From W2PJMFINOV1
Return

$AV_PSCAMT32
If func PJMFINOV0.COLGETFMT(30)<>""
 Chgfmt [M]PSCAMT32(indice) With func PJMFINOV0.COLGETFMT(30)
Else
 Chgfmt [M]PSCAMT32(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCQTY33
Onevent BEFORE_AREA Gosub AV_PSCQTY33 From W2PJMFINOV1
Return

$AV_PSCQTY33
If func PJMFINOV0.COLGETFMT(31)<>""
 Chgfmt [M]PSCQTY33(indice) With func PJMFINOV0.COLGETFMT(31)
Else
 Chgfmt [M]PSCQTY33(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT33
Onevent BEFORE_AREA Gosub AV_PSCAMT33 From W2PJMFINOV1
Return

$AV_PSCAMT33
If func PJMFINOV0.COLGETFMT(32)<>""
 Chgfmt [M]PSCAMT33(indice) With func PJMFINOV0.COLGETFMT(32)
Else
 Chgfmt [M]PSCAMT33(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCQTY34
Onevent BEFORE_AREA Gosub AV_PSCQTY34 From W2PJMFINOV1
Return

$AV_PSCQTY34
If func PJMFINOV0.COLGETFMT(33)<>""
 Chgfmt [M]PSCQTY34(indice) With func PJMFINOV0.COLGETFMT(33)
Else
 Chgfmt [M]PSCQTY34(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT34
Onevent BEFORE_AREA Gosub AV_PSCAMT34 From W2PJMFINOV1
Return

$AV_PSCAMT34
If func PJMFINOV0.COLGETFMT(34)<>""
 Chgfmt [M]PSCAMT34(indice) With func PJMFINOV0.COLGETFMT(34)
Else
 Chgfmt [M]PSCAMT34(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCQTY35
Onevent BEFORE_AREA Gosub AV_PSCQTY35 From W2PJMFINOV1
Return

$AV_PSCQTY35
If func PJMFINOV0.COLGETFMT(35)<>""
 Chgfmt [M]PSCQTY35(indice) With func PJMFINOV0.COLGETFMT(35)
Else
 Chgfmt [M]PSCQTY35(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT35
Onevent BEFORE_AREA Gosub AV_PSCAMT35 From W2PJMFINOV1
Return

$AV_PSCAMT35
If func PJMFINOV0.COLGETFMT(36)<>""
 Chgfmt [M]PSCAMT35(indice) With func PJMFINOV0.COLGETFMT(36)
Else
 Chgfmt [M]PSCAMT35(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCQTY36
Onevent BEFORE_AREA Gosub AV_PSCQTY36 From W2PJMFINOV1
Return

$AV_PSCQTY36
If func PJMFINOV0.COLGETFMT(37)<>""
 Chgfmt [M]PSCQTY36(indice) With func PJMFINOV0.COLGETFMT(37)
Else
 Chgfmt [M]PSCQTY36(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCAMT36
Onevent BEFORE_AREA Gosub AV_PSCAMT36 From W2PJMFINOV1
Return

$AV_PSCAMT36
If func PJMFINOV0.COLGETFMT(38)<>""
 Chgfmt [M]PSCAMT36(indice) With func PJMFINOV0.COLGETFMT(38)
Else
 Chgfmt [M]PSCAMT36(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCESTTOTQTY
Onevent BEFORE_AREA Gosub AV_PSCESTTOTQTY From W2PJMFINOV1
Return

$AV_PSCESTTOTQTY
If func PJMFINOV0.COLGETFMT(39)<>""
 Chgfmt [M]PSCESTTOTQTY(indice) With func PJMFINOV0.COLGETFMT(39)
Else
 Chgfmt [M]PSCESTTOTQTY(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_PSCESTTOTAMT
Onevent BEFORE_AREA Gosub AV_PSCESTTOTAMT From W2PJMFINOV1
Return

$AV_PSCESTTOTAMT
If func PJMFINOV0.COLGETFMT(40)<>""
 Chgfmt [M]PSCESTTOTAMT(indice) With func PJMFINOV0.COLGETFMT(40)
Else
 Chgfmt [M]PSCESTTOTAMT(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_XSL
Onevent INIT_AREA Call D_XSL(zc) From W2PJMFINOV1
Return

Subprog D_XSL(VALEUR)
Variable Clbfile VALEUR
If varinit([M]XSL,indice)=0
 Call INIXSL(VALEUR,"ANOMV") From INTRUTILA
Endif
Gosub _AFF
End

$TIT_COL
Local Char TITCL(200)(1..39)
Raz TITCL
Case BASPAG
 When "NBDET"
  TITCL(1) = func PJMFINOV0.COL_GET_TITLE(1)
  TITCL(2) = func PJMFINOV0.COL_GET_TITLE(3)
  TITCL(3) = func PJMFINOV0.COL_GET_TITLE(4)
  TITCL(4) = func PJMFINOV0.COL_GET_TITLE(5)
  TITCL(5) = func PJMFINOV0.COL_GET_TITLE(6)
  TITCL(6) = func PJMFINOV0.COL_GET_TITLE(7)
  TITCL(7) = func PJMFINOV0.COL_GET_TITLE(8)
  TITCL(8) = func PJMFINOV0.COL_GET_TITLE(9)
  TITCL(9) = func PJMFINOV0.COL_GET_TITLE(10)
  TITCL(10) = func PJMFINOV0.COL_GET_TITLE(11)
  TITCL(11) = func PJMFINOV0.COL_GET_TITLE(12)
  TITCL(12) = func PJMFINOV0.COL_GET_TITLE(13)
  TITCL(13) = func PJMFINOV0.COL_GET_TITLE(14)
  TITCL(14) = func PJMFINOV0.COL_GET_TITLE(15)
  TITCL(15) = func PJMFINOV0.COL_GET_TITLE(16)
  TITCL(16) = func PJMFINOV0.COL_GET_TITLE(17)
  TITCL(17) = func PJMFINOV0.COL_GET_TITLE(18)
  TITCL(18) = func PJMFINOV0.COL_GET_TITLE(19)
  TITCL(19) = func PJMFINOV0.COL_GET_TITLE(20)
  TITCL(20) = func PJMFINOV0.COL_GET_TITLE(21)
  TITCL(21) = func PJMFINOV0.COL_GET_TITLE(22)
  TITCL(22) = func PJMFINOV0.COL_GET_TITLE(23)
  TITCL(23) = func PJMFINOV0.COL_GET_TITLE(24)
  TITCL(24) = func PJMFINOV0.COL_GET_TITLE(25)
  TITCL(25) = func PJMFINOV0.COL_GET_TITLE(26)
  TITCL(26) = func PJMFINOV0.COL_GET_TITLE(27)
  TITCL(27) = func PJMFINOV0.COL_GET_TITLE(28)
  TITCL(28) = func PJMFINOV0.COL_GET_TITLE(29)
  TITCL(29) = func PJMFINOV0.COL_GET_TITLE(30)
  TITCL(30) = func PJMFINOV0.COL_GET_TITLE(31)
  TITCL(31) = func PJMFINOV0.COL_GET_TITLE(32)
  TITCL(32) = func PJMFINOV0.COL_GET_TITLE(33)
  TITCL(33) = func PJMFINOV0.COL_GET_TITLE(34)
  TITCL(34) = func PJMFINOV0.COL_GET_TITLE(35)
  TITCL(35) = func PJMFINOV0.COL_GET_TITLE(36)
  TITCL(36) = func PJMFINOV0.COL_GET_TITLE(37)
  TITCL(37) = func PJMFINOV0.COL_GET_TITLE(38)
  TITCL(38) = func PJMFINOV0.COL_GET_TITLE(39)
  TITCL(39) = func PJMFINOV0.COL_GET_TITLE(40)
  If !GORITITCOL
   Titcol [M]NBDET TITCL(1) For OBJFATHER
   Titcol [M]NBDET TITCL(2) For PSCBUDQTY
   Titcol [M]NBDET TITCL(3) For PSCBUDAMT
   Titcol [M]NBDET TITCL(4) For PSCQTY1
   Titcol [M]NBDET TITCL(5) For PSCAMT1
   Titcol [M]NBDET TITCL(6) For PSCQTY2
   Titcol [M]NBDET TITCL(7) For PSCAMT2
   Titcol [M]NBDET TITCL(8) For PSCQTY3
   Titcol [M]NBDET TITCL(9) For PSCAMT3
   Titcol [M]NBDET TITCL(10) For PSCQTY4
   Titcol [M]NBDET TITCL(11) For PSCAMT4
   Titcol [M]NBDET TITCL(12) For PSCQTY5
   Titcol [M]NBDET TITCL(13) For PSCAMT5
   Titcol [M]NBDET TITCL(14) For PSCREMQTY
   Titcol [M]NBDET TITCL(15) For PSCREMAMT
   Titcol [M]NBDET TITCL(16) For PSCWIPQTY
   Titcol [M]NBDET TITCL(17) For PSCWIPAMT
   Titcol [M]NBDET TITCL(18) For PSCTOTQTY
   Titcol [M]NBDET TITCL(19) For PSCTOTAMT
   Titcol [M]NBDET TITCL(20) For PSCMARGQTY
   Titcol [M]NBDET TITCL(21) For PSCPCTMQTY
   Titcol [M]NBDET TITCL(22) For PSCMARGAMT
   Titcol [M]NBDET TITCL(23) For PSCPCTMAMT
   Titcol [M]NBDET TITCL(24) For PSCQTY30
   Titcol [M]NBDET TITCL(25) For PSCAMT30
   Titcol [M]NBDET TITCL(26) For PSCQTY31
   Titcol [M]NBDET TITCL(27) For PSCAMT31
   Titcol [M]NBDET TITCL(28) For PSCQTY32
   Titcol [M]NBDET TITCL(29) For PSCAMT32
   Titcol [M]NBDET TITCL(30) For PSCQTY33
   Titcol [M]NBDET TITCL(31) For PSCAMT33
   Titcol [M]NBDET TITCL(32) For PSCQTY34
   Titcol [M]NBDET TITCL(33) For PSCAMT34
   Titcol [M]NBDET TITCL(34) For PSCQTY35
   Titcol [M]NBDET TITCL(35) For PSCAMT35
   Titcol [M]NBDET TITCL(36) For PSCQTY36
   Titcol [M]NBDET TITCL(37) For PSCAMT36
   Titcol [M]NBDET TITCL(38) For PSCESTTOTQTY
   Titcol [M]NBDET TITCL(39) For PSCESTTOTAMT
  Else
   Titcol [M:PFOV1]NBDET TITCL(1) For OBJFATHER
   Titcol [M:PFOV1]NBDET TITCL(2) For PSCBUDQTY
   Titcol [M:PFOV1]NBDET TITCL(3) For PSCBUDAMT
   Titcol [M:PFOV1]NBDET TITCL(4) For PSCQTY1
   Titcol [M:PFOV1]NBDET TITCL(5) For PSCAMT1
   Titcol [M:PFOV1]NBDET TITCL(6) For PSCQTY2
   Titcol [M:PFOV1]NBDET TITCL(7) For PSCAMT2
   Titcol [M:PFOV1]NBDET TITCL(8) For PSCQTY3
   Titcol [M:PFOV1]NBDET TITCL(9) For PSCAMT3
   Titcol [M:PFOV1]NBDET TITCL(10) For PSCQTY4
   Titcol [M:PFOV1]NBDET TITCL(11) For PSCAMT4
   Titcol [M:PFOV1]NBDET TITCL(12) For PSCQTY5
   Titcol [M:PFOV1]NBDET TITCL(13) For PSCAMT5
   Titcol [M:PFOV1]NBDET TITCL(14) For PSCREMQTY
   Titcol [M:PFOV1]NBDET TITCL(15) For PSCREMAMT
   Titcol [M:PFOV1]NBDET TITCL(16) For PSCWIPQTY
   Titcol [M:PFOV1]NBDET TITCL(17) For PSCWIPAMT
   Titcol [M:PFOV1]NBDET TITCL(18) For PSCTOTQTY
   Titcol [M:PFOV1]NBDET TITCL(19) For PSCTOTAMT
   Titcol [M:PFOV1]NBDET TITCL(20) For PSCMARGQTY
   Titcol [M:PFOV1]NBDET TITCL(21) For PSCPCTMQTY
   Titcol [M:PFOV1]NBDET TITCL(22) For PSCMARGAMT
   Titcol [M:PFOV1]NBDET TITCL(23) For PSCPCTMAMT
   Titcol [M:PFOV1]NBDET TITCL(24) For PSCQTY30
   Titcol [M:PFOV1]NBDET TITCL(25) For PSCAMT30
   Titcol [M:PFOV1]NBDET TITCL(26) For PSCQTY31
   Titcol [M:PFOV1]NBDET TITCL(27) For PSCAMT31
   Titcol [M:PFOV1]NBDET TITCL(28) For PSCQTY32
   Titcol [M:PFOV1]NBDET TITCL(29) For PSCAMT32
   Titcol [M:PFOV1]NBDET TITCL(30) For PSCQTY33
   Titcol [M:PFOV1]NBDET TITCL(31) For PSCAMT33
   Titcol [M:PFOV1]NBDET TITCL(32) For PSCQTY34
   Titcol [M:PFOV1]NBDET TITCL(33) For PSCAMT34
   Titcol [M:PFOV1]NBDET TITCL(34) For PSCQTY35
   Titcol [M:PFOV1]NBDET TITCL(35) For PSCAMT35
   Titcol [M:PFOV1]NBDET TITCL(36) For PSCQTY36
   Titcol [M:PFOV1]NBDET TITCL(37) For PSCAMT36
   Titcol [M:PFOV1]NBDET TITCL(38) For PSCESTTOTQTY
   Titcol [M:PFOV1]NBDET TITCL(39) For PSCESTTOTAMT
  Endif
Endcase
Return

$CHG_STY
Return


