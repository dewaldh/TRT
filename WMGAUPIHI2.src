#<AdxTL>@(#)%I%
# Sage X3 supervisor
# Automatic document PIHI2

$OUVRE
If clalev([F:BPR])=0
 Local File BPARTNER [BPR]
Endif
If clalev([F:PIH])=0
 Local File PINVOICE [PIH]
Endif
If clalev([F:TDA])=0
 Local File TABDEPAGIO [TDA]
Endif
If clalev([F:DUD])=0
 Local File GACCDUDATE [DUD]
Endif
Return

$LIENS
Read [BPR]BPR0 = [F:TB0]BPR
Read [PIH]PIH0 = [F:TB0]NUM
If clalev([F:CPY])=0 : Local File COMPANY [CPY] : Endif
Call LEC_CPY([F:TB0]CPY) From CPTLEC
Read [TDA]TDA0 = [F:TB0]DEP;[F:CPY]LEG
If fstat
 Read [TDA]TDA0 = [F:TB0]DEP;""
Endif

Filter [DUD] Where ACCNUM=[F:PIH]ACCNUM
Read [DUD]DUD1 First
If fstat>2 : Raz [F:DUD] : Endif
Filter [DUD]
Return

$CLE
CLE(1) = "NUM"
NBCLE  = 1
INDCUR = 1
Return

$LNKTBL
Return

$AP_LIENS
Return

$AP_PIECE
Return

$EVAL0
Case EXPR
 When "BVC" :  ZONE = [F:PIH]BPRVCR
 When "BVD" :  ZONE = [F:PIH]BPRDAT
 When "CUR" :  ZONE = [F:PIH]CUR
 When "DAS" :  ZONE = [F:PIH]DAS2
 When "DAT" :  ZONE = [F:PIH]ACCDAT
 When "DIV1" :  ZONE = [F:PIH]RATDIV(0)
 When "DIV10" :  ZONE = [F:PIH]RATDIV(9)
 When "DIV2" :  ZONE = [F:PIH]RATDIV(1)
 When "DIV3" :  ZONE = [F:PIH]RATDIV(2)
 When "DIV4" :  ZONE = [F:PIH]RATDIV(3)
 When "DIV5" :  ZONE = [F:PIH]RATDIV(4)
 When "DIV6" :  ZONE = [F:PIH]RATDIV(5)
 When "DIV7" :  ZONE = [F:PIH]RATDIV(6)
 When "DIV8" :  ZONE = [F:PIH]RATDIV(7)
 When "DIV9" :  ZONE = [F:PIH]RATDIV(8)
 When "DUD" :  ZONE = [F:DUD]DUDDAT
 When "FCY" :  ZONE = [F:PIH]FCY
 When "FUP" :  ZONE = [F:PIH]PAZ
 When "GTE" :  ZONE = evalue(func SUBTFO.FC("P2G"))
 When "MLT1" :  ZONE = [F:PIH]RATMLT(0)
 When "MLT10" :  ZONE = [F:PIH]RATMLT(9)
 When "MLT2" :  ZONE = [F:PIH]RATMLT(1)
 When "MLT3" :  ZONE = [F:PIH]RATMLT(2)
 When "MLT4" :  ZONE = [F:PIH]RATMLT(3)
 When "MLT5" :  ZONE = [F:PIH]RATMLT(4)
 When "MLT6" :  ZONE = [F:PIH]RATMLT(5)
 When "MLT7" :  ZONE = [F:PIH]RATMLT(6)
 When "MLT8" :  ZONE = [F:PIH]RATMLT(7)
 When "MLT9" :  ZONE = [F:PIH]RATMLT(8)
 When "NUM" :  ZONE = [F:PIH]NUM
 When "REF" :  ZONE = [F:PIH]GTE-[F:PIH]BPR
 When "STA" :  ZONE = (func AFNC.PARAM("FRADGI",[F:PIH]CPY)="2")*2 + (func AFNC.PARAM("FRADGI",[F:PIH]CPY)<>"2")
 When "TCR" :  ZONE = [F:PIH]CURTYP
 When "VCR" :  ZONE = mess([PIH]INVTYP,645,1)-[F:PIH]BPR
Endcase
Return

$SPE0
Return

$SPE1
Return

$EVAL10
Case EXPR
 When "ACC1"
  ZONE = [F:PIH]BPRSAC
 When "AMT"
  ZONE = (([F:PIH]CEEFLG=2)*[F:PIH]AMTNOT) + (([F:PIH]CEEFLG<>2)*[F:PIH]AMTATI)
 When "BPR"
  ZONE = [F:PIH]BPR
 When "CCE1"
  ZONE = [F:PIH]CCE(0)
 When "CCE10"
  ZONE = [F:PIH]CCE(9)
 When "CCE11"
  ZONE = [F:PIH]CCE(10)
 When "CCE12"
  ZONE = [F:PIH]CCE(11)
 When "CCE13"
  ZONE = [F:PIH]CCE(12)
 When "CCE14"
  ZONE = [F:PIH]CCE(13)
 When "CCE15"
  ZONE = [F:PIH]CCE(14)
 When "CCE16"
  ZONE = [F:PIH]CCE(15)
 When "CCE17"
  ZONE = [F:PIH]CCE(16)
 When "CCE18"
  ZONE = [F:PIH]CCE(17)
 When "CCE19"
  ZONE = [F:PIH]CCE(18)
 When "CCE2"
  ZONE = [F:PIH]CCE(1)
 When "CCE20"
  ZONE = [F:PIH]CCE(19)
 When "CCE3"
  ZONE = [F:PIH]CCE(2)
 When "CCE4"
  ZONE = [F:PIH]CCE(3)
 When "CCE5"
  ZONE = [F:PIH]CCE(4)
 When "CCE6"
  ZONE = [F:PIH]CCE(5)
 When "CCE7"
  ZONE = [F:PIH]CCE(6)
 When "CCE8"
  ZONE = [F:PIH]CCE(7)
 When "CCE9"
  ZONE = [F:PIH]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:PIH]DIE(0)
 When "DIE10"
  ZONE = [F:PIH]DIE(9)
 When "DIE11"
  ZONE = [F:PIH]DIE(10)
 When "DIE12"
  ZONE = [F:PIH]DIE(11)
 When "DIE13"
  ZONE = [F:PIH]DIE(12)
 When "DIE14"
  ZONE = [F:PIH]DIE(13)
 When "DIE15"
  ZONE = [F:PIH]DIE(14)
 When "DIE16"
  ZONE = [F:PIH]DIE(15)
 When "DIE17"
  ZONE = [F:PIH]DIE(16)
 When "DIE18"
  ZONE = [F:PIH]DIE(17)
 When "DIE19"
  ZONE = [F:PIH]DIE(18)
 When "DIE2"
  ZONE = [F:PIH]DIE(1)
 When "DIE20"
  ZONE = [F:PIH]DIE(19)
 When "DIE3"
  ZONE = [F:PIH]DIE(2)
 When "DIE4"
  ZONE = [F:PIH]DIE(3)
 When "DIE5"
  ZONE = [F:PIH]DIE(4)
 When "DIE6"
  ZONE = [F:PIH]DIE(5)
 When "DIE7"
  ZONE = [F:PIH]DIE(6)
 When "DIE8"
  ZONE = [F:PIH]DIE(7)
 When "DIE9"
  ZONE = [F:PIH]DIE(8)
 When "FCY"
  ZONE = [F:PIH]FCY
 When "SNS"
  ZONE = 2*([F:PIH]INVTYP=2 or [F:PIH]INVTYP=4)-1
 When "ST1"
  ZONE = [F:TB0]TSSCOD(0)
 When "ST2"
  ZONE = [F:TB0]TSSCOD(1)
 When "ST3"
  ZONE = [F:TB0]TSSCOD(2)
Endcase
Return

$ACC10
Return

$CLE10
Return

$LIENS10
Return

$EVAL20
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))
 When "AMTA"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "QTY"
  ZONE = [F:TB1]QTYGLU
 When "QTYA"
  ZONE = [F:TB1]QTYGLU
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
 When "UNT"
  ZONE = [F:TB1]GLU
Endcase
Return

$ACC20
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]BPR)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
 When 2 :  ZONE = num$([F:TB1]ITMREF)
 When 3 :  ZONE = num$([F:TB1]ITMREF)
 When 4 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE20
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS20
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LEC_BPS([F:TB1]BPR) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Read [ITM]ITM0 = [F:TB1]ITMREF
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
If clalev([F:POQ])=0 : Local File PORDERQ [POQ] : Endif
Read [POQ]POQ0 = [F:TB1]POHNUM;[F:TB1]POPLIN;[F:TB1]POQSEQ
Return

$EVAL22
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))-sigma(I=1,9,evalue("[F:TB1]DDTADEP"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))-[F:TB1]AMTDEPLIN
 When "AMTA"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))-sigma(I=1,9,evalue("[F:TB1]DDTADEP"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))-[F:TB1]AMTDEPLIN
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "QTY"
  ZONE = [F:TB1]QTYGLU
 When "QTYA"
  ZONE = [F:TB1]QTYGLU
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
 When "UNT"
  ZONE = [F:TB1]GLU
Endcase
Return

$ACC22
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]BPR)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
 When 2 :  ZONE = num$([F:TB1]ITMREF)
 When 3 :  ZONE = num$([F:TB1]ITMREF)
 When 4 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE22
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS22
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LEC_BPS([F:TB1]BPR) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Read [ITM]ITM0 = [F:TB1]ITMREF
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
If clalev([F:POQ])=0 : Local File PORDERQ [POQ] : Endif
Read [POQ]POQ0 = [F:TB1]POHNUM;[F:TB1]POPLIN;[F:TB1]POQSEQ
Return

$EVAL23
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = sigma(I=1,9,evalue("[F:TB1]DDTADEP"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))+[F:TB1]AMTDEPLIN
 When "AMTA"
  ZONE = sigma(I=1,9,evalue("[F:TB1]DDTADEP"+num$(I))*([F:TB0]INVDTAVAT2(I-1)=""))+[F:TB1]AMTDEPLIN
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "QTYA"
  ZONE = [F:TB1]QTYGLU
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  Local Integer STAT
  Local Char VALPAR(30)
  Call LECVALPAR2([F:FCY]FINRSPFCY,"DEPEXETAX",[L]VALPAR,STAT) From CPTINIVAR
  ZONE = [L]VALPAR
Endcase
Return

$ACC23
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]BPR)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
 When 2 :  ZONE = num$([F:TB1]ITMREF)
 When 3 :  ZONE = num$([F:TB1]ITMREF)
 When 4 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE23
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS23
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LEC_BPS([F:TB1]BPR) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Read [ITM]ITM0 = [F:TB1]ITMREF
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
If clalev([F:POQ])=0 : Local File PORDERQ [POQ] : Endif
Read [POQ]POQ0 = [F:TB1]POHNUM;[F:TB1]POPLIN;[F:TB1]POQSEQ
Return

$EVAL25
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I)))
 When "AMTA"
  ZONE = [F:TB1]AMTNOTLIN+sigma(I=1,9,evalue("[F:TB1]DISCRGAMT"+num$(I)))
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "QTY"
  ZONE = [F:TB1]QTYGLU
 When "QTYA"
  ZONE = [F:TB1]QTYGLU
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
 When "UNT"
  ZONE = [F:TB1]GLU
Endcase
Return

$ACC25
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]ITMREF)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
Endcase
Return

$CLE25
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS25
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Read [ITM]ITM0 = [F:TB1]ITMREF
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL30
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN2
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN2
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(1)
Endcase
Return

$ACC30
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(1))
Endcase
Return

$CLE30
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS30
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(1)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL40
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN3
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN3
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(2)
Endcase
Return

$ACC40
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(2))
Endcase
Return

$CLE40
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS40
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(2)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL50
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC50
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE50
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS50
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL60
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC60
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE60
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS60
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL65
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC65
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE65
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS65
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL70
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:PIH]FCY)<>"POR",[F:TB1]VAT(0))+string$(func TRTX3FNC.GETLEG([F:PIH]FCY)="POR","PT009")
Endcase
Return

$ACC70
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE70
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS70
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL75
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "FREREF"
  ZONE = evalue(func SUBTFO.FC("PIF"))
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:PIH]FCY)<>"POR",[F:TB1]VAT(0))+string$(func TRTX3FNC.GETLEG([F:PIH]FCY)="POR","PT009")
Endcase
Return

$ACC75
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]ITMREF)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
Endcase
Return

$CLE75
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS75
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL80
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC80
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE80
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS80
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL90
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC90
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE90
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS90
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL95
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "AMTA"
  ZONE = ((func TRTX3FNC.GETLEG([F:PIH]FCY)<>"ITA")*[F:TB1]DEDTAXLIN1) + ((func TRTX3FNC.GETLEG([F:PIH]FCY)="ITA")*[F:TB1]AMTTAXLIN1)
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC95
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE95
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS95
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL100
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:PIH]FCY)<>"POR",[F:TB1]VAT(0))+string$(func TRTX3FNC.GETLEG([F:PIH]FCY)="POR","PT009")
Endcase
Return

$ACC100
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE100
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS100
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL105
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN1-[F:TB1]DEDTAXLIN1
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:PIH]FCY)<>"POR",[F:TB1]VAT(0))+string$(func TRTX3FNC.GETLEG([F:PIH]FCY)="POR","PT009")
Endcase
Return

$ACC105
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]ITMREF)
 When 1 :  ZONE = num$([F:TB1]ITMREF)
Endcase
Return

$CLE105
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS105
If clalev([F:ITM])=0 : Local File ITMMASTER [ITM] : Endif
Call LEC_ITM([F:TB1]ITMREF) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL110
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXLIN1
 When "AMTA"
  ZONE = [F:TB1]AMTTAXLIN1
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:FCY]FINRSPFCY
 When "SNS"
  ZONE = 2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)-1
 When "ST1"
  ZONE = [F:TB1]TSICOD(0)
 When "ST2"
  ZONE = [F:TB1]TSICOD(1)
 When "ST3"
  ZONE = [F:TB1]TSICOD(2)
 When "TAX"
  ZONE = [F:TB1]VAT(0)
Endcase
Return

$ACC110
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT(0))
 When 1 :  ZONE = num$([F:TB1]VAT(0))
Endcase
Return

$CLE110
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS110
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT(0)) From CPTLEC
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Read [FCY]FCY0 = [F:TB1]FCYLIN
Return

$EVAL120
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]INVDTAAMT
 When "AMTA"
  ZONE = [F:TB1]INVDTAAMT
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:PIH]FCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB0]TSSCOD(0)
 When "ST2"
  ZONE = [F:TB0]TSSCOD(1)
 When "ST3"
  ZONE = [F:TB0]TSSCOD(2)
 When "TAX"
  ZONE = [F:TB1]INVDTAVAT
Endcase
Return

$ACC120
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]INVDTA)
 When 1 :  ZONE = num$([F:TB1]INVDTA)
Endcase
Return

$CLE120
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS120
If clalev([F:PFI])=0 : Local File PFOOTINV [PFI] : Endif
Call LECTURE("PFI",num$([F:TB1]INVDTA),"") From CONTOBJ
Return

$EVAL122
Case EXPR
 When "ACC1"
  ZONE = [F:TB2]ACC(0)
 When "ACC10"
  ZONE = [F:TB2]ACC(9)
 When "ACC2"
  ZONE = [F:TB2]ACC(1)
 When "ACC3"
  ZONE = [F:TB2]ACC(2)
 When "ACC4"
  ZONE = [F:TB2]ACC(3)
 When "ACC5"
  ZONE = [F:TB2]ACC(4)
 When "ACC6"
  ZONE = [F:TB2]ACC(5)
 When "ACC7"
  ZONE = [F:TB2]ACC(6)
 When "ACC8"
  ZONE = [F:TB2]ACC(7)
 When "ACC9"
  ZONE = [F:TB2]ACC(8)
 When "AMT"
  ZONE = [F:TB1]INVDTAAMT-[F:TB1]DTADEP
 When "AMTA"
  ZONE = [F:TB1]INVDTAAMT-[F:TB1]DTADEP
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:PIH]DES(0)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB2]DSP
 When "FCY"
  ZONE = [F:PIH]FCY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB0]TSSCOD(0)
 When "ST2"
  ZONE = [F:TB0]TSSCOD(1)
 When "ST3"
  ZONE = [F:TB0]TSSCOD(2)
 When "TAX"
  ZONE = [F:TB1]INVDTAVAT
Endcase
Return

$ACC122
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]INVDTA)
 When 1 :  ZONE = num$([F:TB1]INVDTA)
Endcase
Return

$CLE122
CLE2(1) = "ABRFIC"
CLE2(2) = "VCRTYP"
CLE2(3) = "VCRNUM"
CLE2(4) = "VCRLIN"
CLE2(5) = "VCRSEQ"
CLE2(6) = "CPLCLE"
CLE2(7) = "ANALIG"
NBCLE2 = 7
Return

$LIENS122
If clalev([F:PFI])=0 : Local File PFOOTINV [PFI] : Endif
Call LECTURE("PFI",num$([F:TB1]INVDTA),"") From CONTOBJ
Return

$CLE_X
Case [F:GAD]LINNUM
 When 10 : Gosub CLE10
 When 20 : Gosub CLE20
 When 22 : Gosub CLE22
 When 23 : Gosub CLE23
 When 25 : Gosub CLE25
 When 30 : Gosub CLE30
 When 40 : Gosub CLE40
 When 50 : Gosub CLE50
 When 60 : Gosub CLE60
 When 65 : Gosub CLE65
 When 70 : Gosub CLE70
 When 75 : Gosub CLE75
 When 80 : Gosub CLE80
 When 90 : Gosub CLE90
 When 95 : Gosub CLE95
 When 100 : Gosub CLE100
 When 105 : Gosub CLE105
 When 110 : Gosub CLE110
 When 120 : Gosub CLE120
 When 122 : Gosub CLE122
 When 123 : Gosub CLE123 From WMGAVPIHI2A
 When 130 : Gosub CLE130 From WMGAVPIHI2A
 When 140 : Gosub CLE140 From WMGAVPIHI2A
 When 150 : Gosub CLE150 From WMGAVPIHI2A
 When 160 : Gosub CLE160 From WMGAVPIHI2A
 When 170 : Gosub CLE170 From WMGAVPIHI2A
 When 180 : Gosub CLE180 From WMGAVPIHI2A
 When 190 : Gosub CLE190 From WMGAVPIHI2A
 When 200 : Gosub CLE200 From WMGAVPIHI2A
 When 210 : Gosub CLE210 From WMGAVPIHI2A
 When 220 : Gosub CLE220 From WMGAVPIHI2A
 When 230 : Gosub CLE230 From WMGAVPIHI2A
 When 240 : Gosub CLE240 From WMGAVPIHI2A
Endcase
Return

$LIENS_X
Case [F:GAD]LINNUM
 When 10 : Gosub LIENS10
 When 20 : Gosub LIENS20
 When 22 : Gosub LIENS22
 When 23 : Gosub LIENS23
 When 25 : Gosub LIENS25
 When 30 : Gosub LIENS30
 When 40 : Gosub LIENS40
 When 50 : Gosub LIENS50
 When 60 : Gosub LIENS60
 When 65 : Gosub LIENS65
 When 70 : Gosub LIENS70
 When 75 : Gosub LIENS75
 When 80 : Gosub LIENS80
 When 90 : Gosub LIENS90
 When 95 : Gosub LIENS95
 When 100 : Gosub LIENS100
 When 105 : Gosub LIENS105
 When 110 : Gosub LIENS110
 When 120 : Gosub LIENS120
 When 122 : Gosub LIENS122
 When 123 : Gosub LIENS123 From WMGAVPIHI2A
 When 130 : Gosub LIENS130 From WMGAVPIHI2A
 When 140 : Gosub LIENS140 From WMGAVPIHI2A
 When 150 : Gosub LIENS150 From WMGAVPIHI2A
 When 160 : Gosub LIENS160 From WMGAVPIHI2A
 When 170 : Gosub LIENS170 From WMGAVPIHI2A
 When 180 : Gosub LIENS180 From WMGAVPIHI2A
 When 190 : Gosub LIENS190 From WMGAVPIHI2A
 When 200 : Gosub LIENS200 From WMGAVPIHI2A
 When 210 : Gosub LIENS210 From WMGAVPIHI2A
 When 220 : Gosub LIENS220 From WMGAVPIHI2A
 When 230 : Gosub LIENS230 From WMGAVPIHI2A
 When 240 : Gosub LIENS240 From WMGAVPIHI2A
Endcase
Return

$EVAL_X
Case [F:GAD]LINNUM
 When 10 : Gosub EVAL10
 When 20 : Gosub EVAL20
 When 22 : Gosub EVAL22
 When 23 : Gosub EVAL23
 When 25 : Gosub EVAL25
 When 30 : Gosub EVAL30
 When 40 : Gosub EVAL40
 When 50 : Gosub EVAL50
 When 60 : Gosub EVAL60
 When 65 : Gosub EVAL65
 When 70 : Gosub EVAL70
 When 75 : Gosub EVAL75
 When 80 : Gosub EVAL80
 When 90 : Gosub EVAL90
 When 95 : Gosub EVAL95
 When 100 : Gosub EVAL100
 When 105 : Gosub EVAL105
 When 110 : Gosub EVAL110
 When 120 : Gosub EVAL120
 When 122 : Gosub EVAL122
 When 123 : Gosub EVAL123 From WMGAVPIHI2A
 When 130 : Gosub EVAL130 From WMGAVPIHI2A
 When 140 : Gosub EVAL140 From WMGAVPIHI2A
 When 150 : Gosub EVAL150 From WMGAVPIHI2A
 When 160 : Gosub EVAL160 From WMGAVPIHI2A
 When 170 : Gosub EVAL170 From WMGAVPIHI2A
 When 180 : Gosub EVAL180 From WMGAVPIHI2A
 When 190 : Gosub EVAL190 From WMGAVPIHI2A
 When 200 : Gosub EVAL200 From WMGAVPIHI2A
 When 210 : Gosub EVAL210 From WMGAVPIHI2A
 When 220 : Gosub EVAL220 From WMGAVPIHI2A
 When 230 : Gosub EVAL230 From WMGAVPIHI2A
 When 240 : Gosub EVAL240 From WMGAVPIHI2A
Endcase
Return

$ACC_X
Case [F:GAD]LINNUM
 When 10 : Gosub ACC10
 When 20 : Gosub ACC20
 When 22 : Gosub ACC22
 When 23 : Gosub ACC23
 When 25 : Gosub ACC25
 When 30 : Gosub ACC30
 When 40 : Gosub ACC40
 When 50 : Gosub ACC50
 When 60 : Gosub ACC60
 When 65 : Gosub ACC65
 When 70 : Gosub ACC70
 When 75 : Gosub ACC75
 When 80 : Gosub ACC80
 When 90 : Gosub ACC90
 When 95 : Gosub ACC95
 When 100 : Gosub ACC100
 When 105 : Gosub ACC105
 When 110 : Gosub ACC110
 When 120 : Gosub ACC120
 When 122 : Gosub ACC122
 When 123 : Gosub ACC123 From WMGAVPIHI2A
 When 130 : Gosub ACC130 From WMGAVPIHI2A
 When 140 : Gosub ACC140 From WMGAVPIHI2A
 When 150 : Gosub ACC150 From WMGAVPIHI2A
 When 160 : Gosub ACC160 From WMGAVPIHI2A
 When 170 : Gosub ACC170 From WMGAVPIHI2A
 When 180 : Gosub ACC180 From WMGAVPIHI2A
 When 190 : Gosub ACC190 From WMGAVPIHI2A
 When 200 : Gosub ACC200 From WMGAVPIHI2A
 When 210 : Gosub ACC210 From WMGAVPIHI2A
 When 220 : Gosub ACC220 From WMGAVPIHI2A
 When 230 : Gosub ACC230 From WMGAVPIHI2A
 When 240 : Gosub ACC240 From WMGAVPIHI2A
Endcase
Return

$AP_LIENS_X
Case [F:GAD]LINNUM
 When 130 : Gosub LECPFIACC From TRTACHFAC1
 When 150 : Gosub LECPFIACC From TRTACHFAC1
Endcase
Return

$AV_CREAT_X
Case [F:GAD]LINNUM
Endcase
Return

$AP_CREAT_X
Case [F:GAD]LINNUM
 When 20 : Gosub INITAX From TRTACHFAC1
 When 22 : Gosub INITAX From TRTACHFAC1
 When 23 : Gosub INITAX From TRTACHFAC1
 When 25 : Gosub INITAX From TRTACHFAC1
 When 220 : Gosub INITAX From TRTACHFAC1
Endcase
Return


