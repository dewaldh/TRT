#<AdxTL>@(#)0.0.0.0 $Revision$Class Financial overview
# Supervisor
## ACLA-CLASSE ## TECFINOVE
# 2018-08-27 12:53:50 424

####################################################################
# _ACONTROL
####################################################################

$_ACONTROL
Gosub _AMANDATORY     : [L]ASTATUS = max([L]ASTATUS,[L]ALLSTAT)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AFORMAT        : [L]ASTATUS = max([L]ASTATUS,[L]ALLSTAT)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS        : [L]ASTATUS = max([L]ASTATUS,[L]ALLSTAT)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

####################################################################
# MANDATORY
####################################################################

$_AMANDATORY
Gosub DECLARE_VAR From WMC0TECFINOVE
Local Integer ALLSTAT
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_CUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_UOM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_OPPNUM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_PBUCOD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_SHOWGRP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_SHOWQTY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_SHOWMNT From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_ADVINCL From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_SESSION From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_OPPCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_CPYCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_CHGTYP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_FCY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_CPY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_AIMG From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_AIMGDATE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_OPPPROACTIV From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_ISBUDUPD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
For AINDCLA=1 To 40
 If this.TITLE(AINDCLA)<>null& find(this.TITLE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.TITLE(AINDCLA)._AMANDATORY : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_TECPDESEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_TECPSCSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_TECPSCCTSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AMANDATORY_CRELOGFILE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If this.LOGFILE<>null
 [L]ASTATUS = fmet this.LOGFILE._AMANDATORY : Gosub TESTALLSTAT
Endif
If this.PROJECT<>null
 [L]ASTATUS = fmet this.PROJECT._AMANDATORY : Gosub TESTALLSTAT
Endif
Return

####################################################################
# FORMAT
####################################################################

$_AFORMAT
Gosub DECLARE_VAR From WMC0TECFINOVE
Local Integer ALLSTAT
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_CUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_UOM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_OPPNUM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_PBUCOD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_SHOWGRP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_SHOWQTY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_SHOWMNT From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_ADVINCL From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_SESSION From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_OPPCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_CPYCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_CHGTYP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_FCY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_CPY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_AIMG From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_AIMGDATE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_OPPPROACTIV From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_ISBUDUPD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
For AINDCLA=1 To 40
 If this.TITLE(AINDCLA)<>null& find(this.TITLE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.TITLE(AINDCLA)._AFORMAT : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_TECPDESEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_TECPSCSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_TECPSCCTSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AFORMAT_CRELOGFILE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If this.LOGFILE<>null
 [L]ASTATUS = fmet this.LOGFILE._AFORMAT : Gosub TESTALLSTAT
Endif
If this.PROJECT<>null
 [L]ASTATUS = fmet this.PROJECT._AFORMAT : Gosub TESTALLSTAT
Endif
Return

####################################################################
# OTHERS
####################################################################

$_AOTHERS
Gosub DECLARE_VAR From WMC0TECFINOVE
Local Integer ALLSTAT
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_CUR From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_CUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_UOM From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_UOM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_OPPNUM From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_OPPNUM From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_PBUCOD From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_PBUCOD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_SHOWGRP From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_SHOWGRP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_SHOWQTY From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_SHOWQTY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_SHOWMNT From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_SHOWMNT From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_ADVINCL From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_ADVINCL From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_SESSION From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_SESSION From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_OPPCUR From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_OPPCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_CPYCUR From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_CPYCUR From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_CHGTYP From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_CHGTYP From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_FCY From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_FCY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_CPY From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_CPY From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_AIMG From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_AIMG From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_AIMGDATE From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_AIMGDATE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_OPPPROACTIV From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_OPPPROACTIV From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_ISBUDUPD From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_ISBUDUPD From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
For AINDCLA=1 To 40
 If this.TITLE(AINDCLA)<>null& find(this.TITLE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.TITLE(AINDCLA)._AOTHERS : Gosub TESTALLSTAT
 Endif
Next AINDCLA
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_TECPDESEQ From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_TECPDESEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_TECPSCSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_TECPSCSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_TECPSCCTSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_TECPSCCTSEQ From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If !find(this.ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL) : Gosub _AOTHERS_CRELOGFILE From WMC1TECFINOVE : Gosub TESTALLSTAT : Gosub _AOTHERS_REF_CRELOGFILE From WMC1TECFINOVE : Gosub TESTALLSTAT :  Endif
If this.LOGFILE<>null
 [L]ASTATUS = fmet this.LOGFILE._AOTHERS : Gosub TESTALLSTAT
Endif
If this.PROJECT<>null
 [L]ASTATUS = fmet this.PROJECT._AOTHERS : Gosub TESTALLSTAT
Endif
[L]ASTATUS = fmet this.ACONTROL
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



