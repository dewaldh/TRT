#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WE8ALL3 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:19:39"
A_USER  = "ADMIN"
A_STAMP = "20180828001939"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If "K:"+num$(GLONITM)+"X"<>""
    Chgfmt ITMREF With "K:"+num$(GLONITM)+"X"
   Else
    Chgfmt ITMREF With "-K:1X"
   Endif
   If GFMTCOA(1)<>""
    Chgfmt LINACC1 With GFMTCOA(1)
   Else
    Chgfmt LINACC1 With "-K:1X"
   Endif
   If GFMTCOA(2)<>""
    Chgfmt LINACC2 With GFMTCOA(2)
   Else
    Chgfmt LINACC2 With "-K:1X"
   Endif
   If GFMTCOA(3)<>""
    Chgfmt LINACC3 With GFMTCOA(3)
   Else
    Chgfmt LINACC3 With "-K:1X"
   Endif
   If GFMTCOA(4)<>""
    Chgfmt LINACC4 With GFMTCOA(4)
   Else
    Chgfmt LINACC4 With "-K:1X"
   Endif
   If GFMTCOA(5)<>""
    Chgfmt LINACC5 With GFMTCOA(5)
   Else
    Chgfmt LINACC5 With "-K:1X"
   Endif
   If GFMTCOA(6)<>""
    Chgfmt LINACC6 With GFMTCOA(6)
   Else
    Chgfmt LINACC6 With "-K:1X"
   Endif
   If GFMTCOA(7)<>""
    Chgfmt LINACC7 With GFMTCOA(7)
   Else
    Chgfmt LINACC7 With "-K:1X"
   Endif
   If GFMTCOA(8)<>""
    Chgfmt LINACC8 With GFMTCOA(8)
   Else
    Chgfmt LINACC8 With "-K:1X"
   Endif
   If GFMTCOA(9)<>""
    Chgfmt LINACC9 With GFMTCOA(9)
   Else
    Chgfmt LINACC9 With "-K:1X"
   Endif
   If GFMTCOA(10)<>""
    Chgfmt LINACC10 With GFMTCOA(10)
   Else
    Chgfmt LINACC10 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
   If GPIH_FMTPER(0)<>""
    Chgfmt STRDAT With GPIH_FMTPER(0)
   Else
    Chgfmt STRDAT With "-K:1X"
   Endif
   If GPIH_FMTPER(1)<>""
    Chgfmt ENDDAT With GPIH_FMTPER(1)
   Else
    Chgfmt ENDDAT With "-K:1X"
   Endif
   If GPIH_FMTPER(2)<>""
    Chgfmt PERNBR With GPIH_FMTPER(2)
   Else
    Chgfmt PERNBR With "-K:1X"
   Endif
   If GPIH_FMTPER(3)<>""
    Chgfmt PERTYP With GPIH_FMTPER(3)
   Else
    Chgfmt PERTYP With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WE8ALL3 [PIH3]
Gosub HORODAT
Local Inpbox "WE8ALL3" From GFONCTION At A_STAMP With A_WINDPREV Mask [PIH3] As [SIM_]
Grizo [PIH3]0
Grizo [PIH3]5
Grizo [PIH3]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [PIH3]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=38 : Y1(0)=1 : Y2(0)=0
X1(1)=1 : X2(1)=74 : Y1(1)=1 : Y2(1)=20
X1(2)=1 : X2(2)=38 : Y1(2)=21 : Y2(2)=22
Return

$ON_NBLIG
Onevent BEFORE_INPUT Call AS_NBLIG From W1WE8ALL3
Onevent CONTROL Call C_NBLIG From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_NBLIG From W1WE8ALL3
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WE8ALL3
Onevent AFTER_LINE Call APRES_NBLIG From W1WE8ALL3
Onevent BEFORE_AREA Call AV_NBLIG From W1WE8ALL3
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBPIH
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W3WE8ALL3
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(50506,GBOUT3) From OBJDIV
Call TEXTE(16569,GBOUT4) From OBJDIV
Call TEXTE(4685,GBOUT5) From OBJDIV
Call TEXTE(16572,GBOUT6) From OBJDIV
Call TEXTE(15766,GBOUT7) From OBJDIV
Call TEXTE(16572,GBOUT8) From OBJDIV
Call TEXTE(38447,GBOUT9) From OBJDIV
Call TEXTE(39129,GBOUT10) From OBJDIV
Call TEXTE(6183,GBOUT11) From OBJDIV
Call TEXTE(16563,GBOUT12) From OBJDIV
Call TEXTE(49019,GBOUT14) From OBJDIV
Call IB_NBLIG
## Action STD
Call AS_NBLIG From SUBPIH
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WE8ALL3
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WE8ALL3
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WE8ALL3
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WE8ALL3
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WE8ALL3
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WE8ALL3
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WE8ALL3
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WE8ALL3
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WE8ALL3
Onkey 139 Titled GBOUT11 Call B11_NBLIG From W1WE8ALL3
Onkey 140 Titled GBOUT12 Call B12_NBLIG From W1WE8ALL3
Onkey 171 Titled GBOUT14 Call B14_NBLIG From W1WE8ALL3
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBPIH
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVLINCONT
 Call INSERE("PIDLIN") From TABLEAUX
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_NBLIG
Call AM_NBLIG
If !mkstat & GOBJET
 zoncou = "NBLIG" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NBLIG
Local Decimal BASPAG
## Action STD
Call AM_NBLIG From SUBPIH
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB1_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUCSTLIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCSTLIN"
 PARMSK(1) = [M:PIH0]NUM
 PARMSK(2) = num$([M:PIH3]PIDLIN(nolign-1))
 PARMSK(3) = "0"
 PARMSK(4) = "17"
 PARMSK(5) = "PIH3"
 PARMSK(6) = num$(nolign-1)
 PARMSK(7) = [M:PIH1]EECICT2
 Call SAISIE_NUM(BASPAG,PARMSK,"IPCSTLIN","SUBPCST","SPEPCST") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUQTEPIH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUQTEPIH"
 PARMSK(1) = "PIH3"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYQTY","TRTACHFAC1","XWIPDSYQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBPIH
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action STD
Call APRES_NBLIG From SUBPIH
If mkstat : End : Endif
## Action DIVLINNUM
Call LINNUM("PIDLIN") From TABLEAUX
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ACLOB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ACLOB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:PIH3]LINTEX(nolign-1)
 PARMSK(2) = "PID"
 PARMSK(3) = "TRTX3TEX"
 PARMSK(4) = "PIH3"
 PARMSK(5) = num$(nolign)
 PARMSK(6) = "1"
 Call TRAITE_NUM(BASPAG,PARMSK,"","ACLOB","ACLOB",3,"XYACLOB") From GTRAITE
 [M:PIH3]LINTEX(nolign-1) = PARMSK(1)
 ACTION = "BB5_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIPICFCC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIPICFCC"
 Call SAISIE_NUM(BASPAG,PARMSK,"IPPICINV3","SUBPPI3","SPEPPI3") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action BIHPER
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BIHPER"
 Call SAISIE_NUM(BASPAG,PARMSK,"DBIHPER","SUBBIH","SPEBIH") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIFACCPIH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIFACCPIH"
 Call SAISIE_NUM(BASPAG,PARMSK,"IPPICINV1","SUBPIHD","SPEPIH") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSPIA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSPIA"
 PARMSK(1) = func CNSPIASTD.GET_TYP([M:PIH0]PIHTYP)
 PARMSK(2) = [M:PIH0]NUM
 PARMSK(3) = num$([M:PIH3]PIDLIN(nolign-1))
 Call CONSULT_NUM(BASPAG,"PIA",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUETAPIH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUETAPIH"
 PARMSK(1) = [M:PIH0]NUM
 PARMSK(2) = num$([M]PIDLIN(nolign-1))
 PARMSK(3) = "PIH3"
 PARMSK(4) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYPIH","SUBLIND","SPEPIH") From GSAISIE
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action VISUETAPIV
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUETAPIV"
 PARMSK(1) = [M:PIH0]NUM
 PARMSK(2) = num$([M]PIDLIN(nolign-1))
 PARMSK(3) = "PIH3"
 PARMSK(4) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYPIV","SUBLIND","SPEPIV") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC6A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC6A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB11_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = WCLE1
 Call OBJET_CHAR(OBJCLE,WOBJET,WCLE2) From GOBJET
 ACTION = "BB11_NBLIG" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B12_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action SAIFRSFAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIFRSFAC"
 PARMSK(1) = "PIH3"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDISCRG","TRTACHPRI1","XWIPDISCRG") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B14_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = [M:PIH3]ITMREF(nolign-1)
 PARMSK(2) = "ITMREF"
 Call TRAITE_NUM(BASPAG,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_TYPORI
Onevent BEFORE_INPUT Call AS_TYPORI(zc) From W1WE8ALL3
Onevent INIT_AREA Call D_TYPORI(zc) From W1WE8ALL3
Onevent CONTROL Call C_TYPORI(zc) From W1WE8ALL3
Return

Subprog D_TYPORI(VALEUR)
Variable Integer VALEUR
If varinit([M]TYPORI,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_TYPORI(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(511) From COMBOS
## Action PASLINPIH
Call PASLINPIH("TYPORI") From SUBPIH
If mkstat=2
 [M]TYPORI(INDIC) = VALEUR
 Affzo TYPORI(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_TYPORI(VALEUR) From SUBPIH
 If mkstat=2
  [M]TYPORI(INDIC) = VALEUR
  Affzo TYPORI(INDIC) : mkstat = 2
 Endif
 If VALEUR<1 | GMENLOC(VALEUR)=1
  VALEUR = find(0,GMENLOC(1..len(mess(0,511,1))))
 Endif
 If !mkstat
  Discombo 0 From TYPORI(INDIC)
  If sum(GMENLOC)<>0
   Gosub COMBOS From COMBOS
   For WI=1 to WN : Discombo WCOMBO(WI) From TYPORI(INDIC) : Next WI
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog C_TYPORI(VALEUR)
Variable Integer VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "TYPORI" : GZNUM = 169 : Endif
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_NUMORI
Onevent CONTROL Call C_NUMORI(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_NUMORI(zc) From W1WE8ALL3
Return

Subprog IB_NUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_NUMORI From SUBPIH
Endif
Gosub _AFF
End

Subprog AS_NUMORI(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(87,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_NUMORI(VALEUR)
## Action PASLINPIH
Call PASLINPIH("NUMORI") From SUBPIH
If mkstat=2
 [M]NUMORI(INDIC) = VALEUR
 Affzo NUMORI(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_NUMORI(VALEUR) From SUBPIH
 If mkstat=2
  [M]NUMORI(INDIC) = VALEUR
  Affzo NUMORI(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_NUMORI(zc) From W1WE8ALL3
 Onkey   2 Titled GBOUTS Call S_NUMORI(zc) From W1WE8ALL3
Endif
Gosub _AFF
End

Subprog C_NUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "NUMORI" : GZNUM = 171 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_NUMORI(VALEUR) From SUBPIH
 If mkstat : GERR = 1 : GZONE = "NUMORI" : GZNUM = 171 : Endif
Endif
Gosub _AFF
End

Subprog S_NUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPIHNUMO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPIHNUMO"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPIHNUMO","SUBPIHD","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_NUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_NUMORI" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(VALEUR,WOBJET,"") From GOBJET
 ACTION = "BB1_NUMORI" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_LINORI
Onevent BEFORE_INPUT Call AS_LINORI(zc) From W1WE8ALL3
Onevent CONTROL Call C_LINORI(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINORI From W1WE8ALL3
Return

Subprog AS_LINORI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action PASLINPIH
Call PASLINPIH("LINORI") From SUBPIH
If mkstat=2
 [M]LINORI(INDIC) = VALEUR
 Affzo LINORI(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_LINORI(VALEUR) From SUBPIH
 If mkstat=2
  [M]LINORI(INDIC) = VALEUR
  Affzo LINORI(INDIC) : mkstat = 2
 Endif
 Onkey   2 Titled GBOUTS Call S_LINORI(zc) From W1WE8ALL3
Endif
Gosub _AFF
End

Subprog C_LINORI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_LINORI(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINORI" : GZNUM = 641 : Endif
Gosub _AFF
End

$AMM_LINORI
Call AM_LINORI(zc)
If !mkstat & GOBJET
 zoncou = "LINORI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINORI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_LINORI(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINORI" : GZNUM = 641 : Endif
Gosub _AFF
End

Subprog S_LINORI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELITMFAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITMFAC"
 PARMSK(1) = [M:PIH0]BPR
 PARMSK(2) = num$([M:PIH3]TYPORI(nolign-1))
 PARMSK(3) = [M:PIH3]NUMORI(nolign-1)
 PARMSK(4) = "0"
 PARMSK(5) = "0"
 PARMSK(6) = ""
 PARMSK(7) = "LINORI"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELITMFAC","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_POHNUMORI
Return

$ON_ITMREF
Onevent INIT_AREA Call D_ITMREF(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1WE8ALL3
Onevent CONTROL Call C_ITMREF(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1WE8ALL3
Onevent BEFORE_AREA Gosub AV_ITMREF From W1WE8ALL3
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMREF From SUBPIH
Endif
Gosub _AFF
End

$AV_ITMREF
If "K:"+num$(GLONITM)+"X"<>""
 Chgfmt [M]ITMREF(indice) With "K:"+num$(GLONITM)+"X"
Else
 Chgfmt [M]ITMREF(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_ITMREF(VALEUR)
Variable Char    VALEUR()
If varinit([M]ITMREF,indice)=0
 ## Action PJTINIBATA
 Call PJT_INIBATA(nolign-1,"[M:PIH1]PJTH","[M:PIH3]PJT") From TRTPJT
Endif
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(87,GBOUT1) From OBJDIV
Call TEXTE(16517,GBOUT2) From OBJDIV
Call TEXTE(16517,GBOUT3) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call IB_ITMREF(VALEUR)
## Action PASLINPIH
Call PASLINPIH("ITMREF") From SUBPIH
If mkstat=2
 [M]ITMREF(INDIC) = VALEUR
 Affzo ITMREF(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_ITMREF(VALEUR) From SUBPIH
 If mkstat=2
  [M]ITMREF(INDIC) = VALEUR
  Affzo ITMREF(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_ITMREF(zc) From W1WE8ALL3
 Onkey 130 Titled GBOUT2 Call B2_ITMREF(zc) From W1WE8ALL3
 Onkey 131 Titled GBOUT3 Call B3_ITMREF(zc) From W1WE8ALL3
 Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1WE8ALL3
Endif
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITPCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITPCHOICE"
 PARMSK(1) = [M:PIH0]BPR
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITPCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_ITMREF(VALEUR) From SUBPIH
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREF(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action SELITMFAC
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "SELITMFAC"
  PARMSK(1) = [M:PIH0]BPR
  PARMSK(2) = num$([M:PIH3]TYPORI(nolign-1))
  PARMSK(3) = [M:PIH3]NUMORI(nolign-1)
  PARMSK(4) = num$([M:PIH3]LINORI(nolign-1))
  PARMSK(5) = num$([M:PIH3]SEQORI(nolign-1))
  PARMSK(6) = VALEUR
  PARMSK(7) = "ITMREF"
  Call S_TAB_CHAR(VALEUR,PARMSK,"SELITMFAC","TRTACHSEL1","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action NOTE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "NOTE"
  PARMSK(1) = VALEUR
  PARMSK(2) = "ITMREF"
  Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "ITM"
 PARMSK(2) = "AB"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJET
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJET"
 Call OBJET_CHAR(VALEUR,"ITM","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITP1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITP1"
 PARMSK(1) = [M:PIH0]BPR
 Call SAISIE_CHAR(VALEUR,PARMSK,"IPSELITP1","TRTACHSEL1","XWIPSELITP1") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITP2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITP2"
 PARMSK(1) = [M:PIH0]BPR
 Call SAISIE_CHAR(VALEUR,PARMSK,"IPSELITP2","TRTACHSEL1","XWIPSELITP2") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMDES
Onevent BEFORE_INPUT Call AS_ITMDES(zc) From W1WE8ALL3
Return

Subprog IB_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMDES From SUBPIH
Endif
Gosub _AFF
End

Subprog AS_ITMDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call IB_ITMDES(VALEUR)
## Action PASLINPIH
Call PASLINPIH("ITMDES") From SUBPIH
If mkstat=2
 [M]ITMDES(INDIC) = VALEUR
 Affzo ITMDES(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMDES(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog B1_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ITMDES" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PIH3]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 ACTION = "BB1_ITMDES" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMDES1
Onevent BEFORE_INPUT Call AS_ITMDES1(zc) From W1WE8ALL3
Return

Subprog IB_ITMDES1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMDES1 From SUBPIH
Endif
Gosub _AFF
End

Subprog AS_ITMDES1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call IB_ITMDES1(VALEUR)
## Action PASLINPIH
Call PASLINPIH("ITMDES1") From SUBPIH
If mkstat=2
 [M]ITMDES1(INDIC) = VALEUR
 Affzo ITMDES1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMDES1(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog B1_ITMDES1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ITMDES1" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PIH3]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 ACTION = "BB1_ITMDES1" : PROGSUB = "SUBPIH" : PROGSPE = "SPEPIH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_UOM
Onevent BEFORE_INPUT Call AS_UOM(zc) From W1WE8ALL3
Onevent CONTROL Call C_UOM(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_UOM From W1WE8ALL3
Return

Subprog AS_UOM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3612,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action PASLINPIH
Call PASLINPIH("UOM") From SUBPIH
If mkstat=2
 [M]UOM(INDIC) = VALEUR
 Affzo UOM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_UOM(VALEUR) From SUBPIH
 If mkstat=2
  [M]UOM(INDIC) = VALEUR
  Affzo UOM(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_UOM(zc) From W1WE8ALL3
 Onkey   2 Titled GBOUTS Call S_UOM(zc) From W1WE8ALL3
 Onkey 144 Titled GBOUTP Call P_UOM(zc) From W1WE8ALL3
 Onkey 146 Titled GBOUTA Call SA_UOM(zc) From W1WE8ALL3
Endif
Gosub _AFF
End

Subprog C_UOM(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("TUN","",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
 If !mkstat
  ## Action PCOUOM
  Call PCOUOM(VALEUR,[M:PIH3]BPSNUM(nolign-1),[M:PIH3]ITMREF(nolign-1),3,5) From TRTACHCTL1
  If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_UOM
Call AM_UOM(zc)
If !mkstat & GOBJET
 zoncou = "UOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_UOM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_UOM(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PIH3",nolign-1,"UOM") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "UOM" : GZNUM = 2685 : Endif
Endif
Gosub _AFF
End

Subprog S_UOM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPUOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPUOM"
 PARMSK(1) = [M:PIH3]BPSNUM(nolign-1)
 PARMSK(2) = [M:PIH3]ITMREF(nolign-1)
 PARMSK(3) = "3"
 PARMSK(4) = "5"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELPUOM","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_UOM(VALEUR)
Variable Char    VALEUR()
Call OBJET("TUN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_UOM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_QTYUOM
Onevent BEFORE_AREA Gosub AV_QTYUOM From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_QTYUOM(zc) From W1WE8ALL3
Onevent CONTROL Call C_QTYUOM(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_QTYUOM From W1WE8ALL3
Return

Subprog IB_QTYUOM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_QTYUOM From SUBPIH
Endif
Gosub _AFF
End

$AV_QTYUOM
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find(UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYUOM(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTYUOM(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16569,GBOUT1) From OBJDIV
Call IB_QTYUOM(VALEUR)
## Action PASLINPIH
Call PASLINPIH("QTYUOM") From SUBPIH
If mkstat=2
 [M]QTYUOM(INDIC) = VALEUR
 Affzo QTYUOM(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_QTYUOM(VALEUR) From SUBPIH
 If mkstat=2
  [M]QTYUOM(INDIC) = VALEUR
  Affzo QTYUOM(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_QTYUOM(zc) From W1WE8ALL3
Endif
Gosub _AFF
End

Subprog C_QTYUOM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_QTYUOM(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 8137 : Endif
Gosub _AFF
End

$AMM_QTYUOM
Call AM_QTYUOM(zc)
If !mkstat & GOBJET
 zoncou = "QTYUOM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYUOM(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_QTYUOM(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 8137 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PIH3",nolign-1,"QTYUOM") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "QTYUOM" : GZNUM = 8137 : Endif
Endif
Gosub _AFF
End

Subprog B1_QTYUOM(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUQTEPIH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUQTEPIH"
 PARMSK(1) = "PIH3"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPDSYQTY","TRTACHFAC1","XWIPDSYQTY") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PUU
Return

$ON_QTYPUU
Onevent BEFORE_AREA Gosub AV_QTYPUU From W1WE8ALL3
Return

$AV_QTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find(PUU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_ORIQTYPUU
Onevent BEFORE_AREA Gosub AV_ORIQTYPUU From W1WE8ALL3
Return

$AV_ORIQTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find(PUU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_GROPRI
Onevent BEFORE_AREA Gosub AV_GROPRI From W1WE8ALL3
Return

$AV_GROPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_NETPRI(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_NETPRI From W1WE8ALL3
Return

$AV_NETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

Subprog AS_NETPRI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action PASLINPIH
Call PASLINPIH("NETPRI") From SUBPIH
If mkstat=2
 [M]NETPRI(INDIC) = VALEUR
 Affzo NETPRI(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_NETPRI(VALEUR) From SUBPIH
 If mkstat=2
  [M]NETPRI(INDIC) = VALEUR
  Affzo NETPRI(INDIC) : mkstat = 2
 Endif
Endif
Gosub _AFF
End

$AMM_NETPRI
Call AM_NETPRI(zc)
If !mkstat & GOBJET
 zoncou = "NETPRI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NETPRI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_NETPRI(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "NETPRI" : GZNUM = 2619 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PIH3",nolign-1,"NETPRI") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "NETPRI" : GZNUM = 2619 : Endif
Endif
Gosub _AFF
End

$ON_ORINETPRI
Onevent BEFORE_AREA Gosub AV_ORINETPRI From W1WE8ALL3
Return

$AV_ORINETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_AMTNOTLIN
Onevent BEFORE_AREA Gosub AV_AMTNOTLIN From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_AMTNOTLIN(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_AMTNOTLIN From W1WE8ALL3
Return

$AV_AMTNOTLIN
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Chgfmt [M]AMTNOTLIN(indice) With "Nz3:"+GDEVFMT
Gosub _AFF
Return

Subprog AS_AMTNOTLIN(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action PASLINPIH
Call PASLINPIH("AMTNOTLIN") From SUBPIH
If mkstat=2
 [M]AMTNOTLIN(INDIC) = VALEUR
 Affzo AMTNOTLIN(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$AMM_AMTNOTLIN
Call AM_AMTNOTLIN(zc)
If !mkstat & GOBJET
 zoncou = "AMTNOTLIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_AMTNOTLIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_AMTNOTLIN(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "AMTNOTLIN" : GZNUM = 4841 : Endif
If !mkstat
 ## Action PAMVATFLG
 Call PAMVATFLG("PIH3",nolign-1,"AMTNOTLIN") From TRTACHFAC1
 If mkstat : GERR = 1 : GZONE = "AMTNOTLIN" : GZNUM = 4841 : Endif
Endif
Gosub _AFF
End

$ON_AMTNOTLINCAL
Onevent BEFORE_AREA Gosub AV_AMTNOTLINCAL From W1WE8ALL3
Return

$AV_AMTNOTLINCAL
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_NETCUR
Return

$ON_ZNETCUR
Onevent BEFORE_AREA Gosub AV_ZNETCUR From W1WE8ALL3
Return

$AV_ZNETCUR
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]NETCUR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_AMTDEPLIN
Onevent BEFORE_AREA Gosub AV_AMTDEPLIN From W1WE8ALL3
Return

$AV_AMTDEPLIN
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_CPRCOE
Return

$ON_CPRAMT
Onevent BEFORE_AREA Gosub AV_CPRAMT From W1WE8ALL3
Return

$AV_CPRAMT
## Action PARDEV
Gosub _AFF
Return

$ON_STCNUM
Return

$ON_CSTPUR
Onevent BEFORE_AREA Gosub AV_CSTPUR From W1WE8ALL3
Return

$AV_CSTPUR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_LINCSTPUR
Onevent BEFORE_AREA Gosub AV_LINCSTPUR From W1WE8ALL3
Return

$AV_LINCSTPUR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_LINAMTCPR
Onevent BEFORE_AREA Gosub AV_LINAMTCPR From W1WE8ALL3
Return

$AV_LINAMTCPR
If !GWEBSERV
 ## Action PARDEV
Endif
Gosub _AFF
Return

$ON_CPRCUR
Return

$ON_ZCPRCUR
Onevent BEFORE_AREA Gosub AV_ZCPRCUR From W1WE8ALL3
Return

$AV_ZCPRCUR
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CPRCUR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_FLG1099
Onevent INIT_AREA Call D_FLG1099(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_FLG1099(zc) From W1WE8ALL3
Return

Subprog D_FLG1099(VALEUR)
Variable Integer VALEUR
If varinit([M]FLG1099,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_FLG1099(VALEUR) From SUBPIH
Endif
Gosub _AFF
End

Subprog AS_FLG1099(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1WE8ALL3
Onevent CONTROL Call C_PJT(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_PJT From W1WE8ALL3
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
&,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
&,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action PASLINPIH
 Call PASLINPIH("PJT") From SUBPIH
 If mkstat=2
  [M]PJT(INDIC) = VALEUR
  Affzo PJT(INDIC) : mkstat = 2
 Endif
 If !GWEBSERV
  If !mkstat
   ## Action STD
   Call AS_PJT(VALEUR) From SUBPIH
   If mkstat=2
    [M]PJT(INDIC) = VALEUR
    Affzo PJT(INDIC) : mkstat = 2
   Endif
  Endif
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1WE8ALL3
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1WE8ALL3
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1WE8ALL3
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1WE8ALL3
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1WE8ALL3
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1WE8ALL3
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1WE8ALL3
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1WE8ALL3
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
&,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
&,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
& ,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
& ,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
& ,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"PIH3","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PIH0]FCY,""
& ,"","[M:PIH1]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "PIH3"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PIH0]FCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PIH1]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PIH0]FCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_DISCRGAMT1
Onevent BEFORE_AREA Gosub AV_DISCRGAMT1 From W1WE8ALL3
Return

$AV_DISCRGAMT1
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT2
Onevent BEFORE_AREA Gosub AV_DISCRGAMT2 From W1WE8ALL3
Return

$AV_DISCRGAMT2
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT3
Onevent BEFORE_AREA Gosub AV_DISCRGAMT3 From W1WE8ALL3
Return

$AV_DISCRGAMT3
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT4
Onevent BEFORE_AREA Gosub AV_DISCRGAMT4 From W1WE8ALL3
Return

$AV_DISCRGAMT4
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT5
Onevent BEFORE_AREA Gosub AV_DISCRGAMT5 From W1WE8ALL3
Return

$AV_DISCRGAMT5
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT6
Onevent BEFORE_AREA Gosub AV_DISCRGAMT6 From W1WE8ALL3
Return

$AV_DISCRGAMT6
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT7
Onevent BEFORE_AREA Gosub AV_DISCRGAMT7 From W1WE8ALL3
Return

$AV_DISCRGAMT7
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT8
Onevent BEFORE_AREA Gosub AV_DISCRGAMT8 From W1WE8ALL3
Return

$AV_DISCRGAMT8
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DISCRGAMT9
Onevent BEFORE_AREA Gosub AV_DISCRGAMT9 From W1WE8ALL3
Return

$AV_DISCRGAMT9
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP1
Onevent BEFORE_AREA Gosub AV_DDTADEP1 From W1WE8ALL3
Return

$AV_DDTADEP1
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP2
Onevent BEFORE_AREA Gosub AV_DDTADEP2 From W1WE8ALL3
Return

$AV_DDTADEP2
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP3
Onevent BEFORE_AREA Gosub AV_DDTADEP3 From W1WE8ALL3
Return

$AV_DDTADEP3
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP4
Onevent BEFORE_AREA Gosub AV_DDTADEP4 From W1WE8ALL3
Return

$AV_DDTADEP4
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP5
Onevent BEFORE_AREA Gosub AV_DDTADEP5 From W1WE8ALL3
Return

$AV_DDTADEP5
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP6
Onevent BEFORE_AREA Gosub AV_DDTADEP6 From W1WE8ALL3
Return

$AV_DDTADEP6
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP7
Onevent BEFORE_AREA Gosub AV_DDTADEP7 From W1WE8ALL3
Return

$AV_DDTADEP7
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP8
Onevent BEFORE_AREA Gosub AV_DDTADEP8 From W1WE8ALL3
Return

$AV_DDTADEP8
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_DDTADEP9
Onevent BEFORE_AREA Gosub AV_DDTADEP9 From W1WE8ALL3
Return

$AV_DDTADEP9
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:PIH1]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_LINACC1
Onevent BEFORE_AREA Gosub AV_LINACC1 From W1WE8ALL3
Onevent CONTROL Call C_LINACC1(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC1(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC1 From W1WE8ALL3
Return

$AV_LINACC1
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
If GFMTCOA(1)<>""
 Chgfmt [M]LINACC1(indice) With GFMTCOA(1)
Else
 Chgfmt [M]LINACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC1(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC1(INDIC) = VALEUR
 Affzo LINACC1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC1(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC1(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC1(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC1(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!G",VALEUR,num$(GCOA(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC1(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC1
Call AM_LINACC1(zc)
If !mkstat & GOBJET
 zoncou = "LINACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC1(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(1))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC2
Onevent BEFORE_AREA Gosub AV_LINACC2 From W1WE8ALL3
Onevent CONTROL Call C_LINACC2(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC2(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC2 From W1WE8ALL3
Return

$AV_LINACC2
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
If GFMTCOA(2)<>""
 Chgfmt [M]LINACC2(indice) With GFMTCOA(2)
Else
 Chgfmt [M]LINACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC2(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC2(INDIC) = VALEUR
 Affzo LINACC2(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC2(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC2(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC2(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC2(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(2))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!G",VALEUR,num$(GCOA(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC2(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC2
Call AM_LINACC2(zc)
If !mkstat & GOBJET
 zoncou = "LINACC2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC2(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(2)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC2(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(2))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(2))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC3
Onevent BEFORE_AREA Gosub AV_LINACC3 From W1WE8ALL3
Onevent CONTROL Call C_LINACC3(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC3(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC3 From W1WE8ALL3
Return

$AV_LINACC3
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
If GFMTCOA(3)<>""
 Chgfmt [M]LINACC3(indice) With GFMTCOA(3)
Else
 Chgfmt [M]LINACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC3(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC3(INDIC) = VALEUR
 Affzo LINACC3(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC3(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC3(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC3(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC3(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(3))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(3))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(3)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC3(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC3
Call AM_LINACC3(zc)
If !mkstat & GOBJET
 zoncou = "LINACC3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC3(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(3)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC3(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(3))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(3))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(3))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC4
Onevent BEFORE_AREA Gosub AV_LINACC4 From W1WE8ALL3
Onevent CONTROL Call C_LINACC4(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC4(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC4 From W1WE8ALL3
Return

$AV_LINACC4
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
If GFMTCOA(4)<>""
 Chgfmt [M]LINACC4(indice) With GFMTCOA(4)
Else
 Chgfmt [M]LINACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC4(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC4(INDIC) = VALEUR
 Affzo LINACC4(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC4(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC4(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC4(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC4(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(4))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(4))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(4)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC4(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC4
Call AM_LINACC4(zc)
If !mkstat & GOBJET
 zoncou = "LINACC4" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC4(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(4)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC4(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(4))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(4))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(4))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC5
Onevent BEFORE_AREA Gosub AV_LINACC5 From W1WE8ALL3
Onevent CONTROL Call C_LINACC5(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC5(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC5 From W1WE8ALL3
Return

$AV_LINACC5
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
If GFMTCOA(5)<>""
 Chgfmt [M]LINACC5(indice) With GFMTCOA(5)
Else
 Chgfmt [M]LINACC5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC5(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC5(INDIC) = VALEUR
 Affzo LINACC5(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC5(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC5(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC5(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC5(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(5))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(5))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(5)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC5(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC5
Call AM_LINACC5(zc)
If !mkstat & GOBJET
 zoncou = "LINACC5" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC5(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(5)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC5(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(5))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(5))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(5))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC6
Onevent BEFORE_AREA Gosub AV_LINACC6 From W1WE8ALL3
Onevent CONTROL Call C_LINACC6(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC6(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC6 From W1WE8ALL3
Return

$AV_LINACC6
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(6))) From SETGLBCOA
If GFMTCOA(6)<>""
 Chgfmt [M]LINACC6(indice) With GFMTCOA(6)
Else
 Chgfmt [M]LINACC6(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC6(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC6(INDIC) = VALEUR
 Affzo LINACC6(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC6(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC6(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC6(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC6(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(6))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(6))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(6)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC6(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC6
Call AM_LINACC6(zc)
If !mkstat & GOBJET
 zoncou = "LINACC6" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC6(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(6)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC6(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(6))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(6))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(6))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC7
Onevent BEFORE_AREA Gosub AV_LINACC7 From W1WE8ALL3
Onevent CONTROL Call C_LINACC7(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC7(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC7 From W1WE8ALL3
Return

$AV_LINACC7
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(7))) From SETGLBCOA
If GFMTCOA(7)<>""
 Chgfmt [M]LINACC7(indice) With GFMTCOA(7)
Else
 Chgfmt [M]LINACC7(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC7(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC7(INDIC) = VALEUR
 Affzo LINACC7(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC7(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC7(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC7(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC7(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(7))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(7))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(7)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC7(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC7
Call AM_LINACC7(zc)
If !mkstat & GOBJET
 zoncou = "LINACC7" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC7(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC7(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(7)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC7(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(7))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(7))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(7))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC8
Onevent BEFORE_AREA Gosub AV_LINACC8 From W1WE8ALL3
Onevent CONTROL Call C_LINACC8(zc) From W1WE8ALL3
Onevent BEFORE_INPUT Call AS_LINACC8(zc) From W1WE8ALL3
Onevent AFTER_CHANGE Gosub AMM_LINACC8 From W1WE8ALL3
Return

$AV_LINACC8
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(8))) From SETGLBCOA
If GFMTCOA(8)<>""
 Chgfmt [M]LINACC8(indice) With GFMTCOA(8)
Else
 Chgfmt [M]LINACC8(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC8(VALEUR) From SUBPIH
If mkstat=2
 [M]LINACC8(INDIC) = VALEUR
 Affzo LINACC8(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC8(zc) From W1WE8ALL3
Onkey   2 Titled GBOUTS Call S_LINACC8(zc) From W1WE8ALL3
Onkey 144 Titled GBOUTP Call P_LINACC8(zc) From W1WE8ALL3
Onkey 146 Titled GBOUTA Call SA_LINACC8(zc) From W1WE8ALL3
Gosub _AFF
End

Subprog C_LINACC8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(8))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(8))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(8)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC8(VALEUR) From SUBPIH
  If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC8
Call AM_LINACC8(zc)
If !mkstat & GOBJET
 zoncou = "LINACC8" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC8(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC8(VALEUR) From SUBPIH
If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(8)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PIH0]ACCDAT
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PIH3]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC8(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(8))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(8))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(8))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W3WE8ALL3
Return

$TIT_COL
Gosub TIT_COL From W3WE8ALL3
Return


