#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WT03TRS1 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone STOFCY
mkstat = 0
zoncou = "STOFCY"
indice = 0
WCHAR = [M]STOFCY
If varmode([M]STOFCY,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_STOFCY([M]STOFCY) From SUBSCS
 GACTION = SAVACT
 If mkstat=1 : Raz [M]STOFCY : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STKASFCY"
  Call STKASFCY([M]STOFCY) From STKACT
  GACTION = SAVACT
  If mkstat=1 : Raz [M]STOFCY : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "STOFCY" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If vireblc([M]STOFCY,2)=""
    mkstat = 1 : GMESSAGE = mess(10,123,1)
   Endif
   If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTFCY"
    Call CONTSITE([M]STOFCY) From SUBAGF
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     Call CONTROLE("FCY","D",[M]STOFCY,"",mkstat) From CONTOBJ
     If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
     If !mkstat
      SAVACT = GACTION : GACTION = "STKCTRFCY"
      Call STKCTRFCY([M]STOFCY) From STKACT
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
      If !mkstat
       SAVACT = GACTION : GACTION = "STD"
       Call C_STOFCY([M]STOFCY) From SUBSCS
       GACTION = SAVACT
       If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
       Gosub AFF From GSAISIE
       If mkstat : End : Endif
       If !mkstat
        If WCHAR<>[M]STOFCY or IMPMOD
         SAVACT = GACTION : GACTION = "STD"
         Call AM_STOFCY([M]STOFCY) From SUBSCS
         GACTION = SAVACT
         If mkstat : GERR = 1 : GZONE = "STOFCY" : GZNUM = 1347 : Endif
         Gosub AFF From GSAISIE
         If mkstat : End : Endif
        Endif
       Endif
      Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone SGHTYP
mkstat = 0
zoncou = "SGHTYP"
indice = 0
WCHAR = [M]SGHTYP
If varmode([M]SGHTYP,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call AS_SGHTYP([M]SGHTYP) From SUBSCS
 GACTION = SAVACT
 If mkstat=1 : Raz [M]SGHTYP : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "SGHTYP" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If vireblc([M]SGHTYP,2)=""
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "SGHTYP" : GZNUM = 3487 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTTSG"
   Call CONTTSG([M]SGHTYP,"","TSG1","SGHTYP","","",0,"") From SUBTSG
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "SGHTYP" : GZNUM = 3487 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]SGHTYP
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]SGHTYP = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "SGHTYP" : GZNUM = 3487 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_SGHTYP([M]SGHTYP) From SUBSCS
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "SGHTYP" : GZNUM = 3487 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
     If !mkstat
      If WCHAR<>[M]SGHTYP or IMPMOD
       SAVACT = GACTION : GACTION = "STD"
       Call AM_SGHTYP([M]SGHTYP) From SUBSCS
       GACTION = SAVACT
       If mkstat : GERR = 1 : GZONE = "SGHTYP" : GZNUM = 3487 : Endif
       Gosub AFF From GSAISIE
       If mkstat : End : Endif
      Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone BETFCYCOD
mkstat = 0
zoncou = "BETFCYCOD"
indice = 0
IMPENT = [M]BETFCYCOD
If varinit([M]BETFCYCOD,indice)=0
 IMPENT = 1
Endif
[M]BETFCYCOD = IMPENT

## Zone VCRTYP
mkstat = 0
zoncou = "VCRTYP"
indice = 0
IMPENT = [M]VCRTYP
If varinit([M]VCRTYP,indice)=0
 IMPENT = 1
Endif
[M]VCRTYP = IMPENT

## Zone VCRNUM
mkstat = 0
zoncou = "VCRNUM"
indice = 0
If varinit([M]VCRNUM,indice)=0
 SAVACT = GACTION : GACTION = "STD"
 Call D_VCRNUM([M]VCRNUM) From SUBSCS
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]VCRNUM,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "VCRNUM" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "STD"
  Call C_VCRNUM([M]VCRNUM) From SUBSCS
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "VCRNUM" : GZNUM = 3170 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif

## Zone VCRDES
mkstat = 0
zoncou = "VCRDES"
indice = 0
If varmode([M]VCRDES,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "VCRDES" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone IPTDAT
mkstat = 0
zoncou = "IPTDAT"
indice = 0
If varinit([M]IPTDAT,indice)=0
 [M]IPTDAT = date$
Endif
If varmode([M]IPTDAT,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "IPTDAT" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "STKCTRIPT"
 Call STKCTRIPT([M]IPTDAT,[M]STOFCY,"1") From STKLIB
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "IPTDAT" : GZNUM = 3205 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone PJT
mkstat = 0
zoncou = "PJT"
indice = 0
WCHAR = [M]PJT
If varmode([M]PJT,indice)=0
 SAVACT = GACTION : GACTION = "PJTBEFZON"
 Call PJT_BEFORE_ZONE([M]PJT,"SCS1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SCS1]STOFCY,"","","","",func TRTPJT.GET_CPY_FROM_FCY([M:SCS1]STOFCY)) From TRTPJT
 GACTION = SAVACT
 If mkstat=1 : Raz [M]PJT : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "PJT" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "PJTCTL"
  Call PJT_CONTROL([M]PJT,"SCS1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SCS1]STOFCY,"","","","",func TRTPJT.GET_CPY_FROM_FCY([M:SCS1]STOFCY)) From TRTPJT
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CONTOBJN"
   Local Char    VALEUR(250)
   VALEUR = [M]PJT
   Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
   [M]PJT = VALEUR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]PJT or IMPMOD
     SAVACT = GACTION : GACTION = "PJTAFTMOD"
     Call PJT_AFTER_MODIFY([M]PJT,"SCS1","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:SCS1]STOFCY,"","","","",func TRTPJT.GET_CPY_FROM_FCY([M:SCS1]STOFCY)) From TRTPJT
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone TRSFAM
mkstat = 0
zoncou = "TRSFAM"
indice = 0
If varinit([M]TRSFAM,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]TRSFAM,"9","") From SUBADI
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]TRSFAM,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "TRSFAM" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "CONTADI"
  Call CONTADI([M]TRSFAM,"9","") From SUBADI
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 17501 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTROLE("ADI","!",[M]TRSFAM,"9",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "TRSFAM" : GZNUM = 17501 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone TRSCOD
mkstat = 0
zoncou = "TRSCOD"
indice = 0
If varinit([M]TRSCOD,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]TRSCOD,"","") From SUBADI
 GACTION = SAVACT
Endif

## Zone CCE
mkstat = 0
zoncou = "CCE"
For indice=0 To 19
 SAVACT = GACTION : GACTION = "INICCEFMT"
 Call INICCEFMT("") From SETGLBDIE
 GACTION = SAVACT
 If mkstat=1 : Raz [M]CCE(indice) : Endif
 mkstat = 0
Next indice
If mkstat : End : Endif

## Zone CCECODS
mkstat = 0
zoncou = "CCECODS"
indice = 0
IMPENT = [M]CCECODS
If varinit([M]CCECODS,indice)=0
 IMPENT = 1
Endif
[M]CCECODS = IMPENT

####################################
## Bloc liste 2
####################################
IMPTBL = 0

## Zone FCYDES
mkstat = 0
zoncou = "FCYDES"
indice = 0
WCHAR = [M]FCYDES
If varmode([M]FCYDES,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "FCYDES" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "ACONTFCY"
 Call CONTSITE([M]FCYDES) From SUBAGF
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "FCYDES" : GZNUM = 18038 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("FCY","!D",[M]FCYDES,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "FCYDES" : GZNUM = 18038 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STKCTRFCY"
   Call STKCTRFCY([M]FCYDES) From STKACT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "FCYDES" : GZNUM = 18038 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_FCYDES([M]FCYDES) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "FCYDES" : GZNUM = 18038 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]FCYDES or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_FCYDES([M]FCYDES) From SUBSCS
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "FCYDES" : GZNUM = 18038 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone PURFCY
mkstat = 0
zoncou = "PURFCY"
indice = 0
If varmode([M]PURFCY,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "PURFCY" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "ACONTFCY"
 Call CONTSITE([M]PURFCY) From SUBAGF
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PURFCY" : GZNUM = 6635 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("FCY","!G",[M]PURFCY,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "PURFCY" : GZNUM = 6635 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_PURFCY([M]PURFCY) From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "PURFCY" : GZNUM = 6635 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone FCYADD
mkstat = 0
zoncou = "FCYADD"
indice = 0
If varmode([M]FCYADD,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "FCYADD" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone BETCPY
mkstat = 0
zoncou = "BETCPY"
indice = 0
IMPENT = [M]BETCPY
If varinit([M]BETCPY,indice)=0
 IMPENT = 1
Endif
[M]BETCPY = IMPENT

## Zone SALFCY
mkstat = 0
zoncou = "SALFCY"
indice = 0
If varmode([M]SALFCY,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "SALFCY" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "ACONTFCY"
 Call CONTSITE([M]SALFCY) From SUBAGF
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("FCY","!F",[M]SALFCY,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_SALFCY([M]SALFCY) From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone INVSGH
mkstat = 0
zoncou = "INVSGH"
indice = 0
IMPENT = [M]INVSGH
If varinit([M]INVSGH,indice)=0
 IMPENT = 1
Endif
If varmode([M]INVSGH,indice)=0
 [M]INVSGH(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "INVSGH" : Gosub ACTION From =IMPTRT
  IMPENT = [M]INVSGH(indice)
 Endif
Endif
[M]INVSGH = IMPENT

## Zone VACBPR
mkstat = 0
zoncou = "VACBPR"
indice = 0
If varinit([M]VACBPR,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]VACBPR,"","") From SUBADI
 GACTION = SAVACT
Endif

## Zone CHGTYP
mkstat = 0
zoncou = "CHGTYP"
indice = 0
IMPENT = [M]CHGTYP
If varinit([M]CHGTYP,indice)=0
 IMPENT = 1
Endif
[M]CHGTYP = IMPENT

## Zone PRITYP
mkstat = 0
zoncou = "PRITYP"
indice = 0
IMPENT = [M]PRITYP
If varinit([M]PRITYP,indice)=0
 IMPENT = 1
Endif
[M]PRITYP = IMPENT

####################################
## Bloc liste 3
####################################
IMPTBL = 0

####################################
## Bloc liste 4
####################################
IMPTBL = 0

## Zone ITMREFSEL
mkstat = 0
zoncou = "ITMREFSEL"
indice = 0
WCHAR = [M]ITMREFSEL
If varmode([M]ITMREFSEL,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "ITMREFSEL" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "VXADCUPC"
 Call ADCCTRUPC([M]ITMREFSEL) From VXADCUPC
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFSEL" : GZNUM = 3651 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("ITM","!",[M]ITMREFSEL,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFSEL" : GZNUM = 3651 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   If WCHAR<>[M]ITMREFSEL or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_ITMREFSEL([M]ITMREFSEL) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "ITMREFSEL" : GZNUM = 3651 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone ECSSEL
mkstat = 0
zoncou = "ECSSEL"
indice = 0
If varmode([M]ECSSEL,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "ECSSEL" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "STD"
 Call C_ECSSEL([M]ECSSEL) From SUBSCS
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ECSSEL" : GZNUM = 44205 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone WRHSEL
mkstat = 0
zoncou = "WRHSEL"
indice = 0
WCHAR = [M]WRHSEL
If varinit([M]WRHSEL,indice)=0
 SAVACT = GACTION : GACTION = "WRHINIT"
 Call WRHINIT([M]WRHSEL,[M]STOFCY,10) From STKWRH
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]WRHSEL,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "WRHSEL" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "WRHCTL"
  Call WRHCTL([M]WRHSEL,[M]STOFCY,1) From STKWRH
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "WRHSEL" : GZNUM = 281 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTROLE("WRH","!",[M]WRHSEL,"",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "WRHSEL" : GZNUM = 281 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]WRHSEL or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_WRHSEL([M]WRHSEL) From SUBSCS
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "WRHSEL" : GZNUM = 281 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

####################################
## Bloc liste 5
####################################
IMPTBL = 0

####################################
## Bloc liste 6
####################################
IMPTBL = 0

## Zone ALLINC
mkstat = 0
zoncou = "ALLINC"
indice = 0
If varinit([M]ALLINC,indice)=0
 [M]ALLINC = "236"
Endif

## Zone ALLEXC
mkstat = 0
zoncou = "ALLEXC"
indice = 0
If varinit([M]ALLEXC,indice)=0
 [M]ALLEXC = "235"
Endif

####################################
## Bloc tableau 7
####################################
IMPTBL = 1

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"
indice = 0
status = 1
zoncou = "NBLIG"
If varmode([M]NBLIG,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBLIG" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBLIG
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBLIG = nolign
   status = 75
   Call SAI_NBLIG(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
  SAVACT = GACTION : GACTION = "DIVLINCONT"
  Call INSERE("VCRLIN") From TABLEAUX
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_NBLIG From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

####################################
## Bloc liste 8
####################################
IMPTBL = 0

## Zone SHLLOT
mkstat = 0
zoncou = "SHLLOT"
indice = 0
IMPENT = [M]SHLLOT
If varinit([M]SHLLOT,indice)=0
 IMPENT = 1
Endif
[M]SHLLOT = IMPENT

## Zone ALLSTO
mkstat = 0
zoncou = "ALLSTO"
indice = 0
IMPENT = [M]ALLSTO
If varinit([M]ALLSTO,indice)=0
 IMPENT = 2
Endif
[M]ALLSTO = IMPENT

## Zone NOTALLSTO
mkstat = 0
zoncou = "NOTALLSTO"
indice = 0
IMPENT = [M]NOTALLSTO
If varinit([M]NOTALLSTO,indice)=0
 IMPENT = 2
Endif
[M]NOTALLSTO = IMPENT

mkstat = 0

End

####################################
## Bloc tableau 7
####################################
Subprog SAI_NBLIG(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"
SAVACT = GACTION : GACTION = "DIVLINCONT"
Call INSERE("VCRLIN") From TABLEAUX
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Gosub AFF From GSAISIE
If mkstat : End : Endif
If !mkstat
 SAVACT = GACTION : GACTION = "STD"
 Call C_NBLIG From SUBSCS
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 SAVACT = GACTION : GACTION = "STD"
 Call AVANT_NBLIG From SUBSCS
 GACTION = SAVACT
Endif

## Zone QTYPCU
mkstat = 0
zoncou = "QTYPCU"
WNUM = [M]QTYPCU(indice)
If varmode([M]QTYPCU,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYPCU" : Gosub ACTION From =IMPTRT
 Endif
 If [M]QTYPCU(indice)=0
  mkstat = 1 : GMESSAGE = mess(10,123,1)
 Endif
 If mkstat : GERR = 1 : GZONE = "QTYPCU" : GZNUM = 5374 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  If [M]QTYPCU(indice)<0
   mkstat = 1 : GMESSAGE = mess(180,141,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "QTYPCU" : GZNUM = 5374 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   If WNUM<>[M]QTYPCU(indice) or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_QTYPCU([M]QTYPCU(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "QTYPCU" : GZNUM = 5374 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone QTYSTUDES
mkstat = 0
zoncou = "QTYSTUDES"
WNUM = [M]QTYSTUDES(indice)
If varmode([M]QTYSTUDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("QTYSTUDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]QTYSTUDES(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "QTYSTUDES" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If [M]QTYSTUDES(indice)=0
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "QTYSTUDES" : GZNUM = 2602 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   If [M]QTYSTUDES(indice)<0
    mkstat = 1 : GMESSAGE = mess(180,141,1)
   Endif
   If mkstat : GERR = 1 : GZONE = "QTYSTUDES" : GZNUM = 2602 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WNUM<>[M]QTYSTUDES(indice) or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_QTYSTUDES([M]QTYSTUDES(indice)) From SUBSCS
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "QTYSTUDES" : GZNUM = 2602 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone SERNUM
mkstat = 0
zoncou = "SERNUM"
If varmode([M]SERNUM,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "SERNUM" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "STD"
 Call C_SERNUM([M]SERNUM(indice)) From SUBSCS
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SERNUM" : GZNUM = 3206 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
Endif

## Zone PCUDES
mkstat = 0
zoncou = "PCUDES"
WCHAR = [M]PCUDES(indice)
If varmode([M]PCUDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("PCUDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]PCUDES(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "PCUDES" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  Call CONTROLE("TUN","!",[M]PCUDES(indice),"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "PCUDES" : GZNUM = 25403 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   If WCHAR<>[M]PCUDES(indice) or IMPMOD
    SAVACT = GACTION : GACTION = "STD"
    Call AM_PCUDES([M]PCUDES(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "PCUDES" : GZNUM = 25403 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone COEDES
mkstat = 0
zoncou = "COEDES"
WNUM = [M]COEDES(indice)
If varmode([M]COEDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("COEDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]COEDES(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "COEDES" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If WNUM<>[M]COEDES(indice) or IMPMOD
   SAVACT = GACTION : GACTION = "STD"
   Call AM_COEDES([M]COEDES(indice)) From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "COEDES" : GZNUM = 25342 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone WRHDES
mkstat = 0
zoncou = "WRHDES"
WCHAR = [M]WRHDES(indice)
If varmode([M]WRHDES,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHDES" : Gosub ACTION From =IMPTRT
 Endif
 SAVACT = GACTION : GACTION = "WRHCTL"
 Call WRHCTL([M]WRHDES(indice),[M]FCYDES,1) From STKWRH
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WRHDES" : GZNUM = 41042 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  Call CONTROLE("WRH","!",[M]WRHDES(indice),"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WRHDES" : GZNUM = 41042 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_WRHDES([M]WRHDES(indice)) From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "WRHDES" : GZNUM = 41042 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]WRHDES(indice) or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_WRHDES([M]WRHDES(indice)) From SUBSCS
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "WRHDES" : GZNUM = 41042 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone STADES
mkstat = 0
zoncou = "STADES"
WCHAR = [M]STADES(indice)
If varmode([M]STADES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("STADES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]STADES(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "STADES" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  If vireblc([M]STADES(indice),2)=""
   mkstat = 1 : GMESSAGE = mess(10,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "STADES" : GZNUM = 19145 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_STADES([M]STADES(indice)) From SUBSCS
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "STADES" : GZNUM = 19145 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STKCTRSTA"
    Call STKCTRSTA([M]STADES(indice),GSCSAUZSST,1,2,0,mkstat) From STKACT
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "STADES" : GZNUM = 19145 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     If WCHAR<>[M]STADES(indice) or IMPMOD
      SAVACT = GACTION : GACTION = "STD"
      Call AM_STADES([M]STADES(indice)) From SUBSCS
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "STADES" : GZNUM = 19145 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone LOCTYPDES
mkstat = 0
zoncou = "LOCTYPDES"
WCHAR = [M]LOCTYPDES(indice)
If varmode([M]LOCTYPDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("LOCTYPDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]LOCTYPDES(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STKSUGTLO"
  Call STKSUGTLO([M:SCS1]WLOCSEQ(nolign-1),[M:SCS1]TRSTYP,[M:SCS1]TRSCOD,[M:SCS1]FCYDES,[M:SCS1]ITMREF(nolign-1),[M:SCS1]PCUDES(nolign-1),[M:SCS1]QTYPCUDES(nolign-1),[M:SCS1]STADES(nolign-1),[M]LOCTYPDES(indice),"QU",GFILLOCENT,string$(GWRHACT-1,num$(sigma(1,min(1,dim([M]WRHDES)),[M:SCS1]WRHDES(nolign-1)))),[M:SCS1]LOCDES(nolign-1)) From STKLOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]LOCTYPDES(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "LOCTYPDES" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "CTLTEMFMT"
   Call CTLTEMFMT([M]LOCTYPDES(indice),"") From STKACT
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "LOCTYPDES" : GZNUM = 25343 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    If WCHAR<>[M]LOCTYPDES(indice) or IMPMOD
     SAVACT = GACTION : GACTION = "STD"
     Call AM_LOCTYPDES([M]LOCTYPDES(indice)) From SUBSCS
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "LOCTYPDES" : GZNUM = 25343 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone LOCDES
mkstat = 0
zoncou = "LOCDES"
If varmode([M]LOCDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("LOCDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]LOCDES(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STKMODREMP"
  Call STKMODREMP([M:SCS1]WLOCSEQ(nolign-1),[M:SCS1]STOFCY,[M:SCS1]ITMREF(nolign-1),[M:SCS1]PCU(nolign-1),[M:SCS1]QTYPCU(nolign-1),[M:SCS1]STA(nolign-1),[M:SCS1]LOC(nolign-1),"",mkstat,string$([M]LOCDES(indice)=[M:SCS1]LOC(nolign-1),"QU")) From STKLOC
  GACTION = SAVACT
  If mkstat=1 : Raz [M]LOCDES(indice) : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STKSUGEMP"
   Call STKSUGEMP([M:SCS1]WLOCSEQ(nolign-1),[M:SCS1]TRSTYP,[M:SCS1]TRSCOD,[M:SCS1]FCYDES,[M:SCS1]ITMREF(nolign-1),[M:SCS1]PCUDES(nolign-1),[M:SCS1]QTYPCUDES(nolign-1),[M:SCS1]STADES(nolign-1),[M:SCS1]LOCTYPDES(nolign-1),[M]LOCDES(indice),"",string$([M]LOCDES(indice)=[M:SCS1]LOC(nolign-1),"QU"),GFILLOCENT,string$(GWRHACT-1,num$(sigma(1,min(1,dim([M]WRHDES)),[M:SCS1]WRHDES(nolign-1))))) From STKLOC
   GACTION = SAVACT
   If mkstat=1 : Raz [M]LOCDES(indice) : Endif
   If !mkstat
    IMPMOD = 0 : IMPZON = "LOCDES" : Gosub ACTION From =IMPTRT
   Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CTLEMPFMT"
    Call CTLEMPFMT([M]LOCDES(indice),"") From STKACT
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "LOCDES" : GZNUM = 7101 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone QLYCTLFLG
mkstat = 0
zoncou = "QLYCTLFLG"
IMPENT = [M]QLYCTLFLG(indice)
If varinit([M]QLYCTLFLG,indice)=0
 IMPENT = 1
Endif
If varmode([M]QLYCTLFLG,indice)=0
 [M]QLYCTLFLG(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "QLYCTLFLG" : Gosub ACTION From =IMPTRT
  IMPENT = [M]QLYCTLFLG(indice)
 Endif
Endif
[M]QLYCTLFLG(indice) = IMPENT

## Zone MVTDES
mkstat = 0
zoncou = "MVTDES"
If varmode([M]MVTDES,indice)=0
 SAVACT = GACTION : GACTION = "SAIZONCHG"
 Call SAIZONCHG("MVTDES",nolign-1) From SUBSCSB
 GACTION = SAVACT
 If mkstat=1 : Raz [M]MVTDES(indice) : Endif
 If !mkstat
  IMPMOD = 0 : IMPZON = "MVTDES" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone PRI
mkstat = 0
zoncou = "PRI"
SAVACT = GACTION : GACTION = "PARDEV"
GACTION = SAVACT
If mkstat=1 : Raz [M]PRI(indice) : Endif
If !mkstat
 If varmode([M]PRI,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "PRI" : Gosub ACTION From =IMPTRT
  Endif
 Endif
Endif

## Zone CCE1
mkstat = 0
zoncou = "CCE1"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(1))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE1(indice) : Endif
If !mkstat
 If varinit([M]CCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE1([M]CCE1(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE1,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE1([M]CCE1(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE1(indice),num$(GDIE(1)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE1([M]CCE1(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE2
mkstat = 0
zoncou = "CCE2"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(2))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE2(indice) : Endif
If !mkstat
 If varinit([M]CCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE2([M]CCE2(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE2,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE2([M]CCE2(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE2(indice),num$(GDIE(2)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE2([M]CCE2(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE3
mkstat = 0
zoncou = "CCE3"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(3))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE3(indice) : Endif
If !mkstat
 If varinit([M]CCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE3([M]CCE3(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE3,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE3([M]CCE3(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE3(indice),num$(GDIE(3)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE3([M]CCE3(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE4
mkstat = 0
zoncou = "CCE4"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(4))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE4(indice) : Endif
If !mkstat
 If varinit([M]CCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE4([M]CCE4(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE4,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE4([M]CCE4(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE4(indice),num$(GDIE(4)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE4([M]CCE4(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE5
mkstat = 0
zoncou = "CCE5"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(5))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE5(indice) : Endif
If !mkstat
 If varinit([M]CCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE5([M]CCE5(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE5,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE5([M]CCE5(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE5(indice),num$(GDIE(5)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE5([M]CCE5(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE6
mkstat = 0
zoncou = "CCE6"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(6))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE6(indice) : Endif
If !mkstat
 If varinit([M]CCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE6([M]CCE6(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE6,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE6([M]CCE6(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE6(indice),num$(GDIE(6)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE6([M]CCE6(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE7
mkstat = 0
zoncou = "CCE7"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(7))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE7(indice) : Endif
If !mkstat
 If varinit([M]CCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE7([M]CCE7(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE7,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE7([M]CCE7(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE7(indice),num$(GDIE(7)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE7([M]CCE7(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE8
mkstat = 0
zoncou = "CCE8"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(8))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE8(indice) : Endif
If !mkstat
 If varinit([M]CCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE8([M]CCE8(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE8,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE8([M]CCE8(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE8(indice),num$(GDIE(8)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE8([M]CCE8(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE9
mkstat = 0
zoncou = "CCE9"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(9))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE9(indice) : Endif
If !mkstat
 If varinit([M]CCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE9([M]CCE9(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE9,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE9([M]CCE9(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE9(indice),num$(GDIE(9)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE9([M]CCE9(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE10
mkstat = 0
zoncou = "CCE10"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(10))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE10(indice) : Endif
If !mkstat
 If varinit([M]CCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE10([M]CCE10(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE10,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE10([M]CCE10(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE10(indice),num$(GDIE(10)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE10([M]CCE10(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE11
mkstat = 0
zoncou = "CCE11"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(11))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE11(indice) : Endif
If !mkstat
 If varinit([M]CCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE11([M]CCE11(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE11,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE11([M]CCE11(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE11(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE11" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE11(indice),num$(GDIE(11)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE11" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE11([M]CCE11(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE11" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE12
mkstat = 0
zoncou = "CCE12"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(12))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE12(indice) : Endif
If !mkstat
 If varinit([M]CCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE12([M]CCE12(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE12,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE12([M]CCE12(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE12(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE12" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE12(indice),num$(GDIE(12)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE12" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE12([M]CCE12(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE12" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE13
mkstat = 0
zoncou = "CCE13"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(13))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE13(indice) : Endif
If !mkstat
 If varinit([M]CCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE13([M]CCE13(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE13,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE13([M]CCE13(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE13(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE13" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE13(indice),num$(GDIE(13)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE13" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE13([M]CCE13(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE13" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE14
mkstat = 0
zoncou = "CCE14"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(14))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE14(indice) : Endif
If !mkstat
 If varinit([M]CCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE14([M]CCE14(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE14,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE14([M]CCE14(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE14(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE14" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE14(indice),num$(GDIE(14)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE14" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE14([M]CCE14(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE14" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE15
mkstat = 0
zoncou = "CCE15"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(15))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE15(indice) : Endif
If !mkstat
 If varinit([M]CCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE15([M]CCE15(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE15,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE15([M]CCE15(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE15(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE15" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE15(indice),num$(GDIE(15)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE15" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE15([M]CCE15(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE15" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE16
mkstat = 0
zoncou = "CCE16"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(16))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE16(indice) : Endif
If !mkstat
 If varinit([M]CCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE16([M]CCE16(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE16,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE16([M]CCE16(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE16(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE16" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE16(indice),num$(GDIE(16)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE16" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE16([M]CCE16(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE16" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE17
mkstat = 0
zoncou = "CCE17"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(17))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE17(indice) : Endif
If !mkstat
 If varinit([M]CCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE17([M]CCE17(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE17,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE17([M]CCE17(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE17(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE17" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE17(indice),num$(GDIE(17)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE17" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE17([M]CCE17(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE17" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE18
mkstat = 0
zoncou = "CCE18"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(18))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE18(indice) : Endif
If !mkstat
 If varinit([M]CCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE18([M]CCE18(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE18,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE18([M]CCE18(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE18(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE18" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE18(indice),num$(GDIE(18)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE18" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE18([M]CCE18(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE18" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE19
mkstat = 0
zoncou = "CCE19"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(19))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE19(indice) : Endif
If !mkstat
 If varinit([M]CCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE19([M]CCE19(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE19,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE19([M]CCE19(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE19(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE19" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE19(indice),num$(GDIE(19)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE19" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE19([M]CCE19(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE19" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone CCE20
mkstat = 0
zoncou = "CCE20"
SAVACT = GACTION : GACTION = "INICCEFMT"
Call INICCEFMT(num$(GDIE(20))) From SETGLBDIE
GACTION = SAVACT
If mkstat=1 : Raz [M]CCE20(indice) : Endif
If !mkstat
 If varinit([M]CCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call D_CCE20([M]CCE20(indice)) From SUBSCS
  GACTION = SAVACT
 Endif
Endif
If !mkstat
 If varmode([M]CCE20,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CCE20([M]CCE20(indice)) From SUBSCS
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CCE20(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CCE20" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   Call CONTROLE("CCE","!",[M]CCE20(indice),num$(GDIE(20)),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "CCE20" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_CCE20([M]CCE20(indice)) From SUBSCS
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CCE20" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"
status = 71
SAVACT = GACTION : GACTION = "DIVLINNUM"
Call LINNUM("VCRLIN") From TABLEAUX
GACTION = SAVACT

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "WT03TRS1"
Return

