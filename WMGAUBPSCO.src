#<AdxTL>@(#)%I%
# Sage X3 supervisor
# Automatic document BPSCO

$OUVRE
If clalev([F:BPR])=0
 Local File BPARTNER [BPR]
Endif
If clalev([F:GTE])=0
 Local File GTYPACCENT [GTE]
Endif
If clalev([F:DUD])=0
 Local File GACCDUDATE [DUD]
Endif
Return

$LIENS
Read [BPR]BPR0 = [F:TB0]BPR
If clalev([F:CPY])=0 : Local File COMPANY [CPY] : Endif
Call LEC_CPY([F:TB0]CPY) From CPTLEC
Read [GTE]GTE0 = [F:TB0]GTE;[F:CPY]LEG
If fstat
 Read [GTE]GTE0 = [F:TB0]GTE;""
Endif

Filter [DUD] Where ACCNUM=[F:TB0]ACCNUM
Read [DUD]DUD1 First
If fstat>2 : Raz [F:DUD] : Endif
Filter [DUD]
Return

$CLE
CLE(1) = "NUM"
NBCLE  = 1
INDCUR = 1
Return

$LNKTBL
Return

$AP_LIENS
Gosub LIKICFPIH From INTCPYLIB2
Return

$AP_PIECE
Return

$EVAL0
Case EXPR
 When "BVC" :  ZONE = string$([F:TB0]BPRVCR<>"",[F:TB0]BPRVCR)+string$([F:TB0]BPRVCR="",[F:TB0]NUM)
 When "BVD" :  ZONE = [F:TB0]BPRDAT
 When "CUR" :  ZONE = [F:TB0]CUR
 When "DAS" :  ZONE = [F:TB0]DAS2
 When "DAT" :  ZONE = [F:TB0]ACCDAT
 When "DIV1" :  ZONE = [F:ICF]RATDIV(0)
 When "DIV10" :  ZONE = [F:ICF]RATDIV(9)
 When "DIV2" :  ZONE = [F:ICF]RATDIV(1)
 When "DIV3" :  ZONE = [F:ICF]RATDIV(2)
 When "DIV4" :  ZONE = [F:ICF]RATDIV(3)
 When "DIV5" :  ZONE = [F:ICF]RATDIV(4)
 When "DIV6" :  ZONE = [F:ICF]RATDIV(5)
 When "DIV7" :  ZONE = [F:ICF]RATDIV(6)
 When "DIV8" :  ZONE = [F:ICF]RATDIV(7)
 When "DIV9" :  ZONE = [F:ICF]RATDIV(8)
 When "DUD" :  ZONE = [F:DUD]DUDDAT
 When "FCY" :  ZONE = [F:ICF]FCY
 When "GTE" :  ZONE = evalue(func SUBTFO.FC("BSO"))
 When "JOU" :  ZONE = evalue(func SUBTFO.FC("BOJ"))
 When "MLT1" :  ZONE = [F:ICF]RATMLT(0)
 When "MLT10" :  ZONE = [F:ICF]RATMLT(9)
 When "MLT2" :  ZONE = [F:ICF]RATMLT(1)
 When "MLT3" :  ZONE = [F:ICF]RATMLT(2)
 When "MLT4" :  ZONE = [F:ICF]RATMLT(3)
 When "MLT5" :  ZONE = [F:ICF]RATMLT(4)
 When "MLT6" :  ZONE = [F:ICF]RATMLT(5)
 When "MLT7" :  ZONE = [F:ICF]RATMLT(6)
 When "MLT8" :  ZONE = [F:ICF]RATMLT(7)
 When "MLT9" :  ZONE = [F:ICF]RATMLT(8)
 When "NUM" :  ZONE = string$([F:TB0]CPY=GSOCIETE,[F:TB0]NUM)+string$([F:TB0]CPY<>GSOCIETE,"")
 When "REF" :  ZONE = [F:GTE]TYP-[F:TB0]BPR
 When "STA" :  ZONE = (func AFNC.PARAM("FRADGI",GSOCIETE)="2")*2 + (func AFNC.PARAM("FRADGI",GSOCIETE)<>"2")
 When "TCR" :  ZONE = [F:TB0]CURTYP
 When "VCR" :  ZONE = mess([F:TB0]INVTYP,645,1)-[F:BPR]BPRNAM
Endcase
Return

$SPE0
Return

$SPE1
Return

$EVAL1
Case EXPR
 When "ACC1"
  ZONE = [F:TB0]BPRSAC
 When "AMT"
  ZONE = [F:TB0]AMTATI
 When "BPR"
  ZONE = [F:TB0]BPR
 When "CCE1"
  ZONE = [F:TB0]CCE(0)
 When "CCE10"
  ZONE = [F:TB0]CCE(9)
 When "CCE11"
  ZONE = [F:TB0]CCE(10)
 When "CCE12"
  ZONE = [F:TB0]CCE(11)
 When "CCE13"
  ZONE = [F:TB0]CCE(12)
 When "CCE14"
  ZONE = [F:TB0]CCE(13)
 When "CCE15"
  ZONE = [F:TB0]CCE(14)
 When "CCE16"
  ZONE = [F:TB0]CCE(15)
 When "CCE17"
  ZONE = [F:TB0]CCE(16)
 When "CCE18"
  ZONE = [F:TB0]CCE(17)
 When "CCE19"
  ZONE = [F:TB0]CCE(18)
 When "CCE2"
  ZONE = [F:TB0]CCE(1)
 When "CCE20"
  ZONE = [F:TB0]CCE(19)
 When "CCE3"
  ZONE = [F:TB0]CCE(2)
 When "CCE4"
  ZONE = [F:TB0]CCE(3)
 When "CCE5"
  ZONE = [F:TB0]CCE(4)
 When "CCE6"
  ZONE = [F:TB0]CCE(5)
 When "CCE7"
  ZONE = [F:TB0]CCE(6)
 When "CCE8"
  ZONE = [F:TB0]CCE(7)
 When "CCE9"
  ZONE = [F:TB0]CCE(8)
 When "DES"
  ZONE = [F:TB0]DES(0)
 When "DIE1"
  ZONE = [F:TB0]DIE(0)
 When "DIE10"
  ZONE = [F:TB0]DIE(9)
 When "DIE11"
  ZONE = [F:TB0]DIE(10)
 When "DIE12"
  ZONE = [F:TB0]DIE(11)
 When "DIE13"
  ZONE = [F:TB0]DIE(12)
 When "DIE14"
  ZONE = [F:TB0]DIE(13)
 When "DIE15"
  ZONE = [F:TB0]DIE(14)
 When "DIE16"
  ZONE = [F:TB0]DIE(15)
 When "DIE17"
  ZONE = [F:TB0]DIE(16)
 When "DIE18"
  ZONE = [F:TB0]DIE(17)
 When "DIE19"
  ZONE = [F:TB0]DIE(18)
 When "DIE2"
  ZONE = [F:TB0]DIE(1)
 When "DIE20"
  ZONE = [F:TB0]DIE(19)
 When "DIE3"
  ZONE = [F:TB0]DIE(2)
 When "DIE4"
  ZONE = [F:TB0]DIE(3)
 When "DIE5"
  ZONE = [F:TB0]DIE(4)
 When "DIE6"
  ZONE = [F:TB0]DIE(5)
 When "DIE7"
  ZONE = [F:TB0]DIE(6)
 When "DIE8"
  ZONE = [F:TB0]DIE(7)
 When "DIE9"
  ZONE = [F:TB0]DIE(8)
 When "FCY"
  ZONE = [F:TB0]FCY
 When "SNS"
  ZONE = 2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)-1
Endcase
Return

$ACC1
Return

$CLE1
Return

$LIENS1
Return

$EVAL2
Case EXPR
 When "ACC1"
  ZONE = [F:TB1]ACC(0)
 When "ACC10"
  ZONE = [F:TB1]ACC(9)
 When "ACC2"
  ZONE = [F:TB1]ACC(1)
 When "ACC3"
  ZONE = [F:TB1]ACC(2)
 When "ACC4"
  ZONE = [F:TB1]ACC(3)
 When "ACC5"
  ZONE = [F:TB1]ACC(4)
 When "ACC6"
  ZONE = [F:TB1]ACC(5)
 When "ACC7"
  ZONE = [F:TB1]ACC(6)
 When "ACC8"
  ZONE = [F:TB1]ACC(7)
 When "ACC9"
  ZONE = [F:TB1]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTNOTLIN
 When "AMTA"
  ZONE = [F:TB2]AMT
 When "BPR"
  ZONE = [F:TB1]BPRLIN
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "QTY"
  ZONE = [F:TB1]QTY
 When "QTYA"
  ZONE = [F:TB2]QTY
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
 When "UNT"
  ZONE = [F:TB1]UOM
Endcase
Return

$ACC2
Return

$CLE2
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS2
Return

$EVAL5
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAX1
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:PIL]AMTNOTLIN,[F:PIA]AMT,[F:PIL]AMTTAX1,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAX1
Endcase
Return

$ACC5
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAX1)
 When 1 :  ZONE = num$([F:TB1]TAX1)
Endcase
Return

$CLE5
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS5
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAX1) From CPTLEC
Return

$EVAL6
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAX2
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTTAX2,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(11)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAX2
Endcase
Return

$ACC6
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAX2)
 When 1 :  ZONE = num$([F:TB1]TAX2)
Endcase
Return

$CLE6
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS6
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAX2) From CPTLEC
Return

$EVAL10
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC10
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
 When 1 :  ZONE = num$([F:TB1]VAT)
 When 2 :  ZONE = num$([F:TB1]VAT)
 When 3 :  ZONE = num$([F:TB1]VAT)
 When 4 :  ZONE = num$([F:TB1]VAT)
 When 5 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE10
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS10
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL11
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC11
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
 When 1 :  ZONE = num$([F:TB1]VAT)
 When 2 :  ZONE = num$([F:TB1]VAT)
 When 3 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE11
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS11
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL12
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC12
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
 When 1 :  ZONE = num$([F:TB1]VAT)
 When 2 :  ZONE = num$([F:TB1]VAT)
 When 3 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE12
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS12
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL13
Case EXPR
 When "ACC1"
  ZONE = [F:TB1]ACC(0)
 When "ACC10"
  ZONE = [F:TB1]ACC(9)
 When "ACC2"
  ZONE = [F:TB1]ACC(1)
 When "ACC3"
  ZONE = [F:TB1]ACC(2)
 When "ACC4"
  ZONE = [F:TB1]ACC(3)
 When "ACC5"
  ZONE = [F:TB1]ACC(4)
 When "ACC6"
  ZONE = [F:TB1]ACC(5)
 When "ACC7"
  ZONE = [F:TB1]ACC(6)
 When "ACC8"
  ZONE = [F:TB1]ACC(7)
 When "ACC9"
  ZONE = [F:TB1]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTVAT-[F:TB1]DEDVAT
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTVAT-[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:TB0]FCY)<>"POR",[F:TB1]VAT)+string$(func TRTX3FNC.GETLEG([F:TB0]FCY)="POR","PT009")
Endcase
Return

$ACC13
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE13
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS13
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL20
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC20
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE20
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS20
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL21
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC21
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE21
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS21
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL22
Case EXPR
 When "AMT"
  ZONE = ((func TRTX3FNC.GETLEG([F:TB0]FCY)<>"ITA")*[F:TB1]DEDVAT) + ((func TRTX3FNC.GETLEG([F:TB0]FCY)="ITA")*[F:TB1]AMTVAT)
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC22
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE22
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS22
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL23
Case EXPR
 When "ACC1"
  ZONE = [F:TB1]ACC(0)
 When "ACC10"
  ZONE = [F:TB1]ACC(9)
 When "ACC2"
  ZONE = [F:TB1]ACC(1)
 When "ACC3"
  ZONE = [F:TB1]ACC(2)
 When "ACC4"
  ZONE = [F:TB1]ACC(3)
 When "ACC5"
  ZONE = [F:TB1]ACC(4)
 When "ACC6"
  ZONE = [F:TB1]ACC(5)
 When "ACC7"
  ZONE = [F:TB1]ACC(6)
 When "ACC8"
  ZONE = [F:TB1]ACC(7)
 When "ACC9"
  ZONE = [F:TB1]ACC(8)
 When "AMT"
  ZONE = [F:TB1]AMTVAT-[F:TB1]DEDVAT
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTVAT-[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = string$(func TRTX3FNC.GETLEG([F:TB0]FCY)<>"POR",[F:TB1]VAT)+string$(func TRTX3FNC.GETLEG([F:TB0]FCY)="POR","PT009")
Endcase
Return

$ACC23
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE23
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS23
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL30
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTVAT
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = 2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)-1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
Endcase
Return

$ACC30
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
 When 1 :  ZONE = num$([F:TB1]VAT)
 When 2 :  ZONE = num$([F:TB1]VAT)
 When 3 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE30
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS30
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL40
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXRCP
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTTAXRCP,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAXRCP
Endcase
Return

$ACC40
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAXRCP)
 When 1 :  ZONE = num$([F:TB1]TAXRCP)
Endcase
Return

$CLE40
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS40
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAXRCP) From CPTLEC
Return

$EVAL41
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXISS
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTTAXISS,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAXISS
Endcase
Return

$ACC41
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAXISS)
 When 1 :  ZONE = num$([F:TB1]TAXISS)
Endcase
Return

$CLE41
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS41
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAXISS) From CPTLEC
Return

$EVAL42
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXOTH1
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTTAXOTH1,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAXOTH1
Endcase
Return

$ACC42
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAXOTH1)
 When 1 :  ZONE = num$([F:TB1]TAXOTH1)
Endcase
Return

$CLE42
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS42
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAXOTH1) From CPTLEC
Return

$EVAL43
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTTAXOTH2
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTTAXOTH2,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]TAXOTH2
Endcase
Return

$ACC43
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]TAXOTH2)
 When 1 :  ZONE = num$([F:TB1]TAXOTH2)
Endcase
Return

$CLE43
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS43
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]TAXOTH2) From CPTLEC
Return

$EVAL60
Case EXPR
 When "AMT"
  ZONE = [F:TB1]AMTVAT-[F:TB1]DEDVAT
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTVAT-[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = 2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)-1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = "IT999"
Endcase
Return

$ACC60
Case val(EXPR)
 When 0 :  ZONE = num$([F:TB1]VAT)
Endcase
Return

$CLE60
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS60
If clalev([F:TVT])=0 : Local File TABVAT [TVT] : Endif
Call LEC_TVT_LEG(GCURLEG,[F:TB1]VAT) From CPTLEC
Return

$EVAL61
Case EXPR
 When "ACC1"
  ZONE = [F:TB1]ACC
 When "AMT"
  ZONE = [F:TB1]AMTVAT-[F:TB1]DEDVAT
 When "AMTA"
  Local Integer STAT
  Local Decimal AMTDES
  Call VALBPC([F:TB1]AMTNOTLIN,[F:TB2]AMT,[F:TB1]AMTVAT-[F:TB1]DEDVAT,[L]AMTDES,STAT) From BPCVAL
  ZONE = [L]AMTDES
 When "CCE1"
  ZONE = [F:TB2]CCE(0)
 When "CCE10"
  ZONE = [F:TB2]CCE(9)
 When "CCE11"
  ZONE = [F:TB2]CCE(10)
 When "CCE12"
  ZONE = [F:TB2]CCE(11)
 When "CCE13"
  ZONE = [F:TB2]CCE(12)
 When "CCE14"
  ZONE = [F:TB2]CCE(13)
 When "CCE15"
  ZONE = [F:TB2]CCE(14)
 When "CCE16"
  ZONE = [F:TB2]CCE(15)
 When "CCE17"
  ZONE = [F:TB2]CCE(16)
 When "CCE18"
  ZONE = [F:TB2]CCE(17)
 When "CCE19"
  ZONE = [F:TB2]CCE(18)
 When "CCE2"
  ZONE = [F:TB2]CCE(1)
 When "CCE20"
  ZONE = [F:TB2]CCE(19)
 When "CCE3"
  ZONE = [F:TB2]CCE(2)
 When "CCE4"
  ZONE = [F:TB2]CCE(3)
 When "CCE5"
  ZONE = [F:TB2]CCE(4)
 When "CCE6"
  ZONE = [F:TB2]CCE(5)
 When "CCE7"
  ZONE = [F:TB2]CCE(6)
 When "CCE8"
  ZONE = [F:TB2]CCE(7)
 When "CCE9"
  ZONE = [F:TB2]CCE(8)
 When "DES"
  ZONE = [F:TB1]DES
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = [F:TB1]FCYLIN
 When "SNS"
  ZONE = -2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = "IT999"
Endcase
Return

$ACC61
Return

$CLE61
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS61
Return

$EVAL70
Case EXPR
 When "ACC1"
  Local Integer STAT
  Local Char ACC(30)
  Call INTCOACC("PIH",GSOCIETE,1,[L]ACC,STAT) From INTCPYLIB2
  ZONE = [L]ACC
 When "AMT"
  ZONE = [F:TB1]AMTNOTLIN
 When "AMTA"
  ZONE = [F:TB2]AMT
 When "BPR"
  Local Integer STAT
  Local Char ACC(30)
  Call INTCOBPR("PIH",GSOCIETE,[L]ACC,STAT) From INTCPYLIB2
  ZONE = [L]ACC
 When "DES"
  ZONE = mess(150,102,1)-string$([F:TB0]CPY=GSOCIETE,[F:TB1]CPYLIN+"/"+[F:TB1]FCYLIN)+string$([F:TB0]CPY<>GSOCIETE,[F:TB0]CPY)
 When "DIE1"
  ZONE = [F:TB2]DIE(0)
 When "DIE10"
  ZONE = [F:TB2]DIE(9)
 When "DIE11"
  ZONE = [F:TB2]DIE(10)
 When "DIE12"
  ZONE = [F:TB2]DIE(11)
 When "DIE13"
  ZONE = [F:TB2]DIE(12)
 When "DIE14"
  ZONE = [F:TB2]DIE(13)
 When "DIE15"
  ZONE = [F:TB2]DIE(14)
 When "DIE16"
  ZONE = [F:TB2]DIE(15)
 When "DIE17"
  ZONE = [F:TB2]DIE(16)
 When "DIE18"
  ZONE = [F:TB2]DIE(17)
 When "DIE19"
  ZONE = [F:TB2]DIE(18)
 When "DIE2"
  ZONE = [F:TB2]DIE(1)
 When "DIE20"
  ZONE = [F:TB2]DIE(19)
 When "DIE3"
  ZONE = [F:TB2]DIE(2)
 When "DIE4"
  ZONE = [F:TB2]DIE(3)
 When "DIE5"
  ZONE = [F:TB2]DIE(4)
 When "DIE6"
  ZONE = [F:TB2]DIE(5)
 When "DIE7"
  ZONE = [F:TB2]DIE(6)
 When "DIE8"
  ZONE = [F:TB2]DIE(7)
 When "DIE9"
  ZONE = [F:TB2]DIE(8)
 When "DSP"
  ZONE = [F:TB1]DSP
 When "FCY"
  ZONE = string$([F:TB0]CPY=GSOCIETE,[F:TB0]FCY)+string$([F:TB0]CPY<>GSOCIETE,[F:TB1]FCYLIN)
 When "QTY"
  ZONE = [F:TB1]QTY
 When "QTYA"
  ZONE = [F:TB2]QTY
 When "SNS"
  ZONE = val(string$([F:TB0]CPY=GSOCIETE,num$(-2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)+1))+string$([F:TB0]CPY<>GSOCIETE,num$(2*([F:TB0]INVTYP=2 or [F:TB0]INVTYP=4)-1)))
 When "ST1"
  ZONE = [F:TB1]STT1
 When "ST2"
  ZONE = [F:TB1]STT2
 When "ST3"
  ZONE = [F:TB1]STT3
 When "TAX"
  ZONE = [F:TB1]VAT
 When "UNT"
  ZONE = [F:TB1]UOM
Endcase
Return

$ACC70
Return

$CLE70
CLE2(1) = "NUM"
CLE2(2) = "LIG"
CLE2(3) = "ANALIG"
NBCLE2 = 3
Return

$LIENS70
Return

$CLE_X
Case [F:GAD]LINNUM
 When 1 : Gosub CLE1
 When 2 : Gosub CLE2
 When 5 : Gosub CLE5
 When 6 : Gosub CLE6
 When 10 : Gosub CLE10
 When 11 : Gosub CLE11
 When 12 : Gosub CLE12
 When 13 : Gosub CLE13
 When 20 : Gosub CLE20
 When 21 : Gosub CLE21
 When 22 : Gosub CLE22
 When 23 : Gosub CLE23
 When 30 : Gosub CLE30
 When 40 : Gosub CLE40
 When 41 : Gosub CLE41
 When 42 : Gosub CLE42
 When 43 : Gosub CLE43
 When 60 : Gosub CLE60
 When 61 : Gosub CLE61
 When 70 : Gosub CLE70
 When 72 : Gosub CLE72 From WMGAVBPSCOA
 When 73 : Gosub CLE73 From WMGAVBPSCOA
 When 74 : Gosub CLE74 From WMGAVBPSCOA
 When 75 : Gosub CLE75 From WMGAVBPSCOA
 When 76 : Gosub CLE76 From WMGAVBPSCOA
 When 77 : Gosub CLE77 From WMGAVBPSCOA
 When 80 : Gosub CLE80 From WMGAVBPSCOA
 When 81 : Gosub CLE81 From WMGAVBPSCOA
 When 82 : Gosub CLE82 From WMGAVBPSCOA
 When 83 : Gosub CLE83 From WMGAVBPSCOA
 When 84 : Gosub CLE84 From WMGAVBPSCOA
 When 90 : Gosub CLE90 From WMGAVBPSCOA
 When 91 : Gosub CLE91 From WMGAVBPSCOA
 When 92 : Gosub CLE92 From WMGAVBPSCOA
 When 93 : Gosub CLE93 From WMGAVBPSCOA
 When 95 : Gosub CLE95 From WMGAVBPSCOA
 When 96 : Gosub CLE96 From WMGAVBPSCOA
Endcase
Return

$LIENS_X
Case [F:GAD]LINNUM
 When 1 : Gosub LIENS1
 When 2 : Gosub LIENS2
 When 5 : Gosub LIENS5
 When 6 : Gosub LIENS6
 When 10 : Gosub LIENS10
 When 11 : Gosub LIENS11
 When 12 : Gosub LIENS12
 When 13 : Gosub LIENS13
 When 20 : Gosub LIENS20
 When 21 : Gosub LIENS21
 When 22 : Gosub LIENS22
 When 23 : Gosub LIENS23
 When 30 : Gosub LIENS30
 When 40 : Gosub LIENS40
 When 41 : Gosub LIENS41
 When 42 : Gosub LIENS42
 When 43 : Gosub LIENS43
 When 60 : Gosub LIENS60
 When 61 : Gosub LIENS61
 When 70 : Gosub LIENS70
 When 72 : Gosub LIENS72 From WMGAVBPSCOA
 When 73 : Gosub LIENS73 From WMGAVBPSCOA
 When 74 : Gosub LIENS74 From WMGAVBPSCOA
 When 75 : Gosub LIENS75 From WMGAVBPSCOA
 When 76 : Gosub LIENS76 From WMGAVBPSCOA
 When 77 : Gosub LIENS77 From WMGAVBPSCOA
 When 80 : Gosub LIENS80 From WMGAVBPSCOA
 When 81 : Gosub LIENS81 From WMGAVBPSCOA
 When 82 : Gosub LIENS82 From WMGAVBPSCOA
 When 83 : Gosub LIENS83 From WMGAVBPSCOA
 When 84 : Gosub LIENS84 From WMGAVBPSCOA
 When 90 : Gosub LIENS90 From WMGAVBPSCOA
 When 91 : Gosub LIENS91 From WMGAVBPSCOA
 When 92 : Gosub LIENS92 From WMGAVBPSCOA
 When 93 : Gosub LIENS93 From WMGAVBPSCOA
 When 95 : Gosub LIENS95 From WMGAVBPSCOA
 When 96 : Gosub LIENS96 From WMGAVBPSCOA
Endcase
Return

$EVAL_X
Case [F:GAD]LINNUM
 When 1 : Gosub EVAL1
 When 2 : Gosub EVAL2
 When 5 : Gosub EVAL5
 When 6 : Gosub EVAL6
 When 10 : Gosub EVAL10
 When 11 : Gosub EVAL11
 When 12 : Gosub EVAL12
 When 13 : Gosub EVAL13
 When 20 : Gosub EVAL20
 When 21 : Gosub EVAL21
 When 22 : Gosub EVAL22
 When 23 : Gosub EVAL23
 When 30 : Gosub EVAL30
 When 40 : Gosub EVAL40
 When 41 : Gosub EVAL41
 When 42 : Gosub EVAL42
 When 43 : Gosub EVAL43
 When 60 : Gosub EVAL60
 When 61 : Gosub EVAL61
 When 70 : Gosub EVAL70
 When 72 : Gosub EVAL72 From WMGAVBPSCOA
 When 73 : Gosub EVAL73 From WMGAVBPSCOA
 When 74 : Gosub EVAL74 From WMGAVBPSCOA
 When 75 : Gosub EVAL75 From WMGAVBPSCOA
 When 76 : Gosub EVAL76 From WMGAVBPSCOA
 When 77 : Gosub EVAL77 From WMGAVBPSCOA
 When 80 : Gosub EVAL80 From WMGAVBPSCOA
 When 81 : Gosub EVAL81 From WMGAVBPSCOA
 When 82 : Gosub EVAL82 From WMGAVBPSCOA
 When 83 : Gosub EVAL83 From WMGAVBPSCOA
 When 84 : Gosub EVAL84 From WMGAVBPSCOA
 When 90 : Gosub EVAL90 From WMGAVBPSCOA
 When 91 : Gosub EVAL91 From WMGAVBPSCOA
 When 92 : Gosub EVAL92 From WMGAVBPSCOA
 When 93 : Gosub EVAL93 From WMGAVBPSCOA
 When 95 : Gosub EVAL95 From WMGAVBPSCOA
 When 96 : Gosub EVAL96 From WMGAVBPSCOA
Endcase
Return

$ACC_X
Case [F:GAD]LINNUM
 When 1 : Gosub ACC1
 When 2 : Gosub ACC2
 When 5 : Gosub ACC5
 When 6 : Gosub ACC6
 When 10 : Gosub ACC10
 When 11 : Gosub ACC11
 When 12 : Gosub ACC12
 When 13 : Gosub ACC13
 When 20 : Gosub ACC20
 When 21 : Gosub ACC21
 When 22 : Gosub ACC22
 When 23 : Gosub ACC23
 When 30 : Gosub ACC30
 When 40 : Gosub ACC40
 When 41 : Gosub ACC41
 When 42 : Gosub ACC42
 When 43 : Gosub ACC43
 When 60 : Gosub ACC60
 When 61 : Gosub ACC61
 When 70 : Gosub ACC70
 When 72 : Gosub ACC72 From WMGAVBPSCOA
 When 73 : Gosub ACC73 From WMGAVBPSCOA
 When 74 : Gosub ACC74 From WMGAVBPSCOA
 When 75 : Gosub ACC75 From WMGAVBPSCOA
 When 76 : Gosub ACC76 From WMGAVBPSCOA
 When 77 : Gosub ACC77 From WMGAVBPSCOA
 When 80 : Gosub ACC80 From WMGAVBPSCOA
 When 81 : Gosub ACC81 From WMGAVBPSCOA
 When 82 : Gosub ACC82 From WMGAVBPSCOA
 When 83 : Gosub ACC83 From WMGAVBPSCOA
 When 84 : Gosub ACC84 From WMGAVBPSCOA
 When 90 : Gosub ACC90 From WMGAVBPSCOA
 When 91 : Gosub ACC91 From WMGAVBPSCOA
 When 92 : Gosub ACC92 From WMGAVBPSCOA
 When 93 : Gosub ACC93 From WMGAVBPSCOA
 When 95 : Gosub ACC95 From WMGAVBPSCOA
 When 96 : Gosub ACC96 From WMGAVBPSCOA
Endcase
Return

$AP_LIENS_X
Case [F:GAD]LINNUM
Endcase
Return

$AV_CREAT_X
Case [F:GAD]LINNUM
Endcase
Return

$AP_CREAT_X
Case [F:GAD]LINNUM
 When 2 : Gosub INITAX From SUBGAS
 When 70 : Gosub INITAX From SUBGAS
Endcase
Return


