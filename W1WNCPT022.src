#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WNCPT022 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:26:02"
A_USER  = "ADMIN"
A_STAMP = "20180828002602"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WNCPT022 [LST]
Gosub HORODAT
Local Inpbox "WNCPT022" From GFONCTION At A_STAMP With A_WINDPREV Mask [LST] As [SIM_]
Grizo [LST]10
Grizo [LST]15
Grizo [LST]20
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [LST]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=63 : Y1(0)=1 : Y2(0)=3
X1(1)=64 : X2(1)=112 : Y1(1)=1 : Y2(1)=3
X1(2)=1 : X2(2)=112 : Y1(2)=4 : Y2(2)=28
Return

$ON_COD
Return

$ON_DAT
Onevent BEFORE_AREA Gosub AV_DAT From W1WNCPT022
Return

$AV_DAT
Chgfmt [M]DAT(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_TIM
Onevent AFTER_AREA Call AP_TIM(zc) From W1WNCPT022
Return

Subprog AP_TIM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action INIHM
 Call INIHM(VALEUR) From OBJDIV
 If mkstat : GERR = 1 : GZONE = "TIM" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$ON_NBLIG
Onevent BEFORE_INPUT Call AS_NBLIG From W1WNCPT022
Onevent BEFORE_AREA Call AV_NBLIG From W1WNCPT022
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBALH
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W1WNCPT022
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(735,GBOUT2) From OBJDIV
Call TEXTE(735,GBOUT3) From OBJDIV
Call TEXTE(735,GBOUT4) From OBJDIV
Call TEXTE(735,GBOUT5) From OBJDIV
Call TEXTE(735,GBOUT6) From OBJDIV
Call TEXTE(735,GBOUT7) From OBJDIV
Call TEXTE(735,GBOUT8) From OBJDIV
Call TEXTE(735,GBOUT9) From OBJDIV
Call TEXTE(735,GBOUT10) From OBJDIV
Call TEXTE(735,GBOUT11) From OBJDIV
Call TEXTE(735,GBOUT12) From OBJDIV
Call TEXTE(735,GBOUT13) From OBJDIV
Call TEXTE(735,GBOUT14) From OBJDIV
Call TEXTE(735,GBOUT15) From OBJDIV
Call TEXTE(735,GBOUT16) From OBJDIV
Call IB_NBLIG
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WNCPT022
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WNCPT022
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WNCPT022
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WNCPT022
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WNCPT022
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WNCPT022
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WNCPT022
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WNCPT022
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WNCPT022
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WNCPT022
Onkey 139 Titled GBOUT11 Call B11_NBLIG From W1WNCPT022
Onkey 140 Titled GBOUT12 Call B12_NBLIG From W1WNCPT022
Onkey 170 Titled GBOUT13 Call B13_NBLIG From W1WNCPT022
Onkey 171 Titled GBOUT14 Call B14_NBLIG From W1WNCPT022
Onkey 172 Titled GBOUT15 Call B15_NBLIG From W1WNCPT022
Onkey 173 Titled GBOUT16 Call B16_NBLIG From W1WNCPT022
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB1_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB2_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB2_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB3_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB4_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB5_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB5_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB6_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB6_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB7_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB7_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB8_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB8_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB9_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB9_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB10_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB10_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB11_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB11_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B12_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB12_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB12_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB13_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB13_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B14_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB14_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB14_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB15_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB15_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETAA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETAA"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB16_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Call OBJET_CHAR(GBIDC2,GBIDC1,GBIDC3) From GOBJET
 ACTION = "BB16_NBLIG" : PROGSUB = "SUBALH" : PROGSPE = "SPEALH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_C04
Onevent BEFORE_AREA Gosub AV_C04 From W1WNCPT022
Return

$AV_C04
Chgfmt [M]C04(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_C08
Onevent INIT_AREA Call D_C08(zc) From W1WNCPT022
Return

Subprog D_C08(VALEUR)
Variable Integer VALEUR
If varinit([M]C08,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_TUNNEL
Return

$TIT_COL
Local Char TITCL(200)(1..8)
Raz TITCL
Case BASPAG
 When "NBLIG"
  TITCL(1) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","1")
  TITCL(2) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","2")
  TITCL(3) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","3")
  TITCL(4) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","4")
  TITCL(5) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","5")
  TITCL(6) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","6")
  TITCL(7) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","7")
  TITCL(8) = func AFNC.TEXTRA("ALISTED","INTITLIG","CPT022","8")
  If !GORITITCOL
   Titcol [M]NBLIG TITCL(1) For C01
   Titcol [M]NBLIG TITCL(2) For C02
   Titcol [M]NBLIG TITCL(3) For C03
   Titcol [M]NBLIG TITCL(4) For C04
   Titcol [M]NBLIG TITCL(5) For C05
   Titcol [M]NBLIG TITCL(6) For C06
   Titcol [M]NBLIG TITCL(7) For C07
   Titcol [M]NBLIG TITCL(8) For C08
  Else
   Titcol [M:LST]NBLIG TITCL(1) For C01
   Titcol [M:LST]NBLIG TITCL(2) For C02
   Titcol [M:LST]NBLIG TITCL(3) For C03
   Titcol [M:LST]NBLIG TITCL(4) For C04
   Titcol [M:LST]NBLIG TITCL(5) For C05
   Titcol [M:LST]NBLIG TITCL(6) For C06
   Titcol [M:LST]NBLIG TITCL(7) For C07
   Titcol [M:LST]NBLIG TITCL(8) For C08
  Endif
Endcase
Return

$CHG_STY
Return


