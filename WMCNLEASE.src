#<AdxTL>@(#)0.0.0.0 $Revision$Class Lease contracts
# Supervisor
## ACLA-CLASSE ## LEASE
# 2018-08-27 12:36:07 945

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMC0LEASE
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
Gosub INIT_CPY From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAREF From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_FCY From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEADES From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEADES2 From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEASTA From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEATYP From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LES From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAORI From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_STRLEADAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_ENDLEADAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_TRMLEADAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEANAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_BSENAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_ACCCOD From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_DSP From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEACUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_CUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_CURTYP From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_RATCUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_IASCUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_IASCURTYP From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_IASRATCUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAAMT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAAMTDEV From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAAMTIAS From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_LEARAT From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_RPUVAL From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_RPUVALDEV From WMC1LEASE : Gosub TESTALLSTAT
Gosub INIT_RPUVALIAS From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_RPUDAT From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAEXS From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_BEFRNT From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_DURPER From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_CUMIASBSE From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_CUMRNTAMT From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_CUTDAT From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_LEAREFORI From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_CIGCOD From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA1 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA2 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA3 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA4 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA5 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA6 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA7 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA8 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA9 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDA10 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDD1 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDD2 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDD3 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDD4 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM1 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM2 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM3 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM4 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM5 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDM6 From WMC2LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDC1 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_USRFLDC2 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB1 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB2 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB3 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB4 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB5 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB6 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB7 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB8 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB9 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_REFTAB10 From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_CREUSR From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_CREDAT From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_UPDUSR From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_UPDDAT From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_CREORI From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_CREDATTIM From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_UPDDATTIM From WMC3LEASE : Gosub TESTALLSTAT
Gosub INIT_AUUID From WMC3LEASE : Gosub TESTALLSTAT
Gosub AINIT From WMC0LEASE : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMC0LEASE
Gosub _ALOADATTRIBUTE_CPY From WMC1LEASE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_LEAREF From WMC1LEASE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_FCY From WMC1LEASE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_LEADES From WMC1LEASE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_LES From WMC1LEASE : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CUR From WMC1LEASE : Gosub TESTALLSTAT
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMC0LEASE
Gosub LNKPRO_CPY From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LEAREF From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_FCY From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LES From WMC1LEASE : Gosub TESTALLSTAT
For AINDCLA=1 To 20
 If this.CANA(AINDCLA)<>null& find(this.CANA(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CANA(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_LEACUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_CUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_IASCUR From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LEAAMT From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LEAAMTDEV From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LEAAMTIAS From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_RPUVAL From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_RPUVALDEV From WMC1LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_RPUVALIAS From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_LEAEXS From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_BEFRNT From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_CUMIASBSE From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_CUMRNTAMT From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA1 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA2 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA3 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA4 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA5 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA6 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA7 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA8 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA9 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDA10 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM1 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM2 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM3 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM4 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM5 From WMC2LEASE : Gosub TESTALLSTAT
Gosub LNKPRO_USRFLDM6 From WMC2LEASE : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.LEABILBOOK)
 If this.LEABILBOOK(AINDCLA)<>null& find(this.LEABILBOOK(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.LEABILBOOK(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.FASSETS)
 If this.FASSETS(AINDCLA)<>null& find(this.FASSETS(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.FASSETS(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.FE41E42)
 If this.FE41E42(AINDCLA)<>null& find(this.FE41E42(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.FE41E42(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



