#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management ADI1 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone NUMTAB
mkstat = 0
zoncou = "NUMTAB"
indice = 0
If varmode([M]NUMTAB,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NUMTAB" : Gosub ACTION From =IMPTRT
 Endif
 If [M]NUMTAB=0
  mkstat = 1 : GMESSAGE = mess(10,123,1)
 Endif
 If mkstat : GERR = 1 : GZONE = "NUMTAB" : GZNUM = 1176 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  If [M]NUMTAB<0
   mkstat = 1 : GMESSAGE = mess(180,141,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "NUMTAB" : GZNUM = 1176 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTNUM("ADV","",[M]NUMTAB,"",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "NUMTAB" : GZNUM = 1176 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

####################################
## Bloc tableau 2
####################################
IMPTBL = 1

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"
indice = 0
status = 1
zoncou = "NBLIG"
If varmode([M]NBLIG,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "NBLIG" : Gosub ACTION From =IMPTRT
 Endif
 If !mkstat
  NBLIG = [M]NBLIG
  For nolign=1 To NBLIG
   indice = nolign-1
   [M]NBLIG = nolign
   status = 75
   Call SAI_NBLIG(IMPFIC,ACTION,IMPTRT)
   If mkstat : Break : Endif
  Next nolign
  If mkstat : End : Endif
  indice = 0
 Endif
Endif

####################################
## Bloc liste 4
####################################
IMPTBL = 0

####################################
## Bloc liste 3
####################################
IMPTBL = 0

## Zone VALDEF
mkstat = 0
zoncou = "VALDEF"
indice = 0
If varinit([M]VALDEF,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]VALDEF,"","") From SUBADI
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]VALDEF,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "VALDEF" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "CONTADI"
  Call CONTADI([M]VALDEF,"","") From SUBADI
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "VALDEF" : GZNUM = 88 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "STD"
   Call C_VALDEF([M]VALDEF) From SUBADI
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "VALDEF" : GZNUM = 88 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTOBJN"
    Local Char    VALEUR(250)
    VALEUR = [M]VALDEF
    Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
    [M]VALDEF = VALEUR
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "VALDEF" : GZNUM = 88 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

mkstat = 0

End

####################################
## Bloc tableau 2
####################################
Subprog SAI_NBLIG(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

IMPTBL = 1

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"

## Zone NUMLIG
mkstat = 0
zoncou = "NUMLIG"
[M]NUMLIG(indice) = nolign

## Zone CODE
mkstat = 0
zoncou = "CODE"
If varinit([M]CODE,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]CODE(indice),"","") From SUBADI
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]CODE,indice)=0
  SAVACT = GACTION : GACTION = "STD"
  Call AS_CODE([M]CODE(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]CODE(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "CODE" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   If vireblc([M]CODE(indice),2)=""
    mkstat = 1 : GMESSAGE = mess(10,123,1)
   Endif
   If mkstat : GERR = 1 : GZONE = "CODE" : GZNUM = 5296 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "CONTADI"
    Call CONTADI([M]CODE(indice),"","") From SUBADI
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "CODE" : GZNUM = 5296 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_CODE([M]CODE(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "CODE" : GZNUM = 5296 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
     If !mkstat
      SAVACT = GACTION : GACTION = "CONTOBJN"
      Local Char    VALEUR(250)
      VALEUR = [M]CODE(indice)
      Call S_AFF_CHAR(VALEUR,PARAM,"CONTOBJN","CONTOBJ","") From GACTION
      [M]CODE(indice) = VALEUR
      GACTION = SAVACT
      If mkstat : GERR = 1 : GZONE = "CODE" : GZNUM = 5296 : Endif
      Gosub AFF From GSAISIE
      If mkstat : End : Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone LNGDES
mkstat = 0
zoncou = "LNGDES"
If varinit([M]LNGDES,indice)=0
 SAVACT = GACTION : GACTION = "LECTEXTRA"
 Call LECTEXTRA([M]LNGDES(indice),"ATABDIV","LNGDES",num$([M]NUMTAB),[M]CODE(nolign-1)) From ATEXTRA
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]LNGDES,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "LNGDES" : Gosub ACTION From =IMPTRT
  Endif
 Endif
Endif

## Zone SHODES
mkstat = 0
zoncou = "SHODES"
If varinit([M]SHODES,indice)=0
 SAVACT = GACTION : GACTION = "LECTEXTRA"
 Call LECTEXTRA([M]SHODES(indice),"ATABDIV","SHODES",num$([M]NUMTAB),[M]CODE(nolign-1)) From ATEXTRA
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]SHODES,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "SHODES" : Gosub ACTION From =IMPTRT
  Endif
 Endif
Endif

## Zone A1
mkstat = 0
zoncou = "A1"
If varmode([M]A1,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A1(indice),[M]CODTYP1) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A1(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A1([M]A1(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A1(indice),[M]CODTYP1,[M]LIB1,[M]LNG1,[M]AV1(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV1(nolign-1),[M]CODTYP1,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A1([M]A1(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A1" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A2
mkstat = 0
zoncou = "A2"
If varmode([M]A2,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A2(indice),[M]CODTYP2) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A2(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A2([M]A2(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A2(indice),[M]CODTYP2,[M]LIB2,[M]LNG2,[M]AV2(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV2(nolign-1),[M]CODTYP2,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A2([M]A2(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A2" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A3
mkstat = 0
zoncou = "A3"
If varmode([M]A3,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A3(indice),[M]CODTYP3) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A3(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A3([M]A3(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A3(indice),[M]CODTYP3,[M]LIB3,[M]LNG3,[M]AV3(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV3(nolign-1),[M]CODTYP3,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A3([M]A3(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A3" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A4
mkstat = 0
zoncou = "A4"
If varmode([M]A4,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A4(indice),[M]CODTYP4) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A4(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A4([M]A4(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A4(indice),[M]CODTYP4,[M]LIB4,[M]LNG4,[M]AV4(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV4(nolign-1),[M]CODTYP4,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A4([M]A4(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A4" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A5
mkstat = 0
zoncou = "A5"
If varmode([M]A5,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A5(indice),[M]CODTYP5) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A5(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A5([M]A5(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A5(indice),[M]CODTYP5,[M]LIB5,[M]LNG5,[M]AV5(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV5(nolign-1),[M]CODTYP5,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A5([M]A5(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A5" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A6
mkstat = 0
zoncou = "A6"
If varmode([M]A6,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A6(indice),[M]CODTYP6) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A6(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A6([M]A6(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A6(indice),[M]CODTYP6,[M]LIB6,[M]LNG6,[M]AV6(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV6(nolign-1),[M]CODTYP6,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A6([M]A6(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A6" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A7
mkstat = 0
zoncou = "A7"
If varmode([M]A7,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A7(indice),[M]CODTYP7) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A7(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A7([M]A7(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A7(indice),[M]CODTYP7,[M]LIB7,[M]LNG7,[M]AV7(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV7(nolign-1),[M]CODTYP7,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A7([M]A7(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A7" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A8
mkstat = 0
zoncou = "A8"
If varmode([M]A8,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A8(indice),[M]CODTYP8) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A8(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A8([M]A8(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A8(indice),[M]CODTYP8,[M]LIB8,[M]LNG8,[M]AV8(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV8(nolign-1),[M]CODTYP8,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A8([M]A8(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A8" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A9
mkstat = 0
zoncou = "A9"
If varmode([M]A9,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A9(indice),[M]CODTYP9) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A9(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A9([M]A9(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A9(indice),[M]CODTYP9,[M]LIB9,[M]LNG9,[M]AV9(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV9(nolign-1),[M]CODTYP9,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A9([M]A9(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A9" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A10
mkstat = 0
zoncou = "A10"
If varmode([M]A10,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A10(indice),[M]CODTYP10) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A10(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A10([M]A10(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A10(indice),[M]CODTYP10,[M]LIB10,[M]LNG10,[M]AV10(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV10(nolign-1),[M]CODTYP10,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A10([M]A10(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A10" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A11
mkstat = 0
zoncou = "A11"
If varmode([M]A11,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A11(indice),[M]CODTYP11) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A11(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A11([M]A11(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A11(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A11" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A11(indice),[M]CODTYP11,[M]LIB11,[M]LNG11,[M]AV11(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A11" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV11(nolign-1),[M]CODTYP11,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A11" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A11([M]A11(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A11" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A12
mkstat = 0
zoncou = "A12"
If varmode([M]A12,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A12(indice),[M]CODTYP12) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A12(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A12([M]A12(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A12(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A12" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A12(indice),[M]CODTYP12,[M]LIB12,[M]LNG12,[M]AV12(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A12" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV12(nolign-1),[M]CODTYP12,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A12" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A12([M]A12(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A12" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A13
mkstat = 0
zoncou = "A13"
If varmode([M]A13,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A13(indice),[M]CODTYP13) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A13(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A13([M]A13(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A13(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A13" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A13(indice),[M]CODTYP13,[M]LIB13,[M]LNG13,[M]AV13(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A13" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV13(nolign-1),[M]CODTYP13,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A13" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A13([M]A13(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A13" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A14
mkstat = 0
zoncou = "A14"
If varmode([M]A14,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A14(indice),[M]CODTYP14) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A14(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A14([M]A14(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A14(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A14" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A14(indice),[M]CODTYP14,[M]LIB14,[M]LNG14,[M]AV14(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A14" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV14(nolign-1),[M]CODTYP14,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A14" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A14([M]A14(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A14" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone A15
mkstat = 0
zoncou = "A15"
If varmode([M]A15,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]A15(indice),[M]CODTYP15) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]A15(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_A15([M]A15(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]A15(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "A15" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]A15(indice),[M]CODTYP15,[M]LIB15,[M]LNG15,[M]AV15(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "A15" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]AV15(nolign-1),[M]CODTYP15,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "A15" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_A15([M]A15(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "A15" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N1
mkstat = 0
zoncou = "N1"
If varmode([M]N1,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N1(indice),[M]CODTYPN1) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N1(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N1([M]N1(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N1(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N1" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N1(indice),[M]CODTYPN1,[M]LIBN1,[M]LNGN1,[M]NV1(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N1" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV1(nolign-1),[M]CODTYPN1,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N1" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N1([M]N1(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N1" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N2
mkstat = 0
zoncou = "N2"
If varmode([M]N2,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N2(indice),[M]CODTYPN2) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N2(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N2([M]N2(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N2(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N2" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N2(indice),[M]CODTYPN2,[M]LIBN2,[M]LNGN2,[M]NV2(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N2" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV2(nolign-1),[M]CODTYPN2,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N2" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N2([M]N2(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N2" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N3
mkstat = 0
zoncou = "N3"
If varmode([M]N3,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N3(indice),[M]CODTYPN3) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N3(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N3([M]N3(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N3(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N3" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N3(indice),[M]CODTYPN3,[M]LIBN3,[M]LNGN3,[M]NV3(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N3" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV3(nolign-1),[M]CODTYPN3,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N3" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N3([M]N3(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N3" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N4
mkstat = 0
zoncou = "N4"
If varmode([M]N4,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N4(indice),[M]CODTYPN4) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N4(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N4([M]N4(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N4(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N4" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N4(indice),[M]CODTYPN4,[M]LIBN4,[M]LNGN4,[M]NV4(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N4" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV4(nolign-1),[M]CODTYPN4,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N4" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N4([M]N4(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N4" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N5
mkstat = 0
zoncou = "N5"
If varmode([M]N5,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N5(indice),[M]CODTYPN5) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N5(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N5([M]N5(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N5(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N5" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N5(indice),[M]CODTYPN5,[M]LIBN5,[M]LNGN5,[M]NV5(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N5" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV5(nolign-1),[M]CODTYPN5,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N5" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N5([M]N5(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N5" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N6
mkstat = 0
zoncou = "N6"
If varmode([M]N6,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N6(indice),[M]CODTYPN6) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N6(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N6([M]N6(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N6(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N6" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N6(indice),[M]CODTYPN6,[M]LIBN6,[M]LNGN6,[M]NV6(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N6" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV6(nolign-1),[M]CODTYPN6,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N6" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N6([M]N6(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N6" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N7
mkstat = 0
zoncou = "N7"
If varmode([M]N7,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N7(indice),[M]CODTYPN7) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N7(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N7([M]N7(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N7(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N7" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N7(indice),[M]CODTYPN7,[M]LIBN7,[M]LNGN7,[M]NV7(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N7" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV7(nolign-1),[M]CODTYPN7,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N7" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N7([M]N7(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N7" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N8
mkstat = 0
zoncou = "N8"
If varmode([M]N8,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N8(indice),[M]CODTYPN8) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N8(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N8([M]N8(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N8(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N8" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N8(indice),[M]CODTYPN8,[M]LIBN8,[M]LNGN8,[M]NV8(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N8" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV8(nolign-1),[M]CODTYPN8,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N8" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N8([M]N8(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N8" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N9
mkstat = 0
zoncou = "N9"
If varmode([M]N9,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N9(indice),[M]CODTYPN9) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N9(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N9([M]N9(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N9(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N9" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N9(indice),[M]CODTYPN9,[M]LIBN9,[M]LNGN9,[M]NV9(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N9" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV9(nolign-1),[M]CODTYPN9,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N9" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N9([M]N9(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N9" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N10
mkstat = 0
zoncou = "N10"
If varmode([M]N10,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N10(indice),[M]CODTYPN10) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N10(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N10([M]N10(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N10(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N10" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N10(indice),[M]CODTYPN10,[M]LIBN10,[M]LNGN10,[M]NV10(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N10" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV10(nolign-1),[M]CODTYPN10,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N10" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone N11
mkstat = 0
zoncou = "N11"
If varmode([M]N11,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N11(indice),[M]CODTYPN11) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N11(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N11([M]N11(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N11(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N11" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N11(indice),[M]CODTYPN11,[M]LIBN11,[M]LNGN11,[M]NV11(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N11" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV11(nolign-1),[M]CODTYPN11,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N11" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N11([M]N11(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N11" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone N12
mkstat = 0
zoncou = "N12"
If varmode([M]N12,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N12(indice),[M]CODTYPN12) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N12(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N12([M]N12(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N12(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N12" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N12(indice),[M]CODTYPN12,[M]LIBN12,[M]LNGN12,[M]NV12(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N12" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV12(nolign-1),[M]CODTYPN12,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N12" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone N13
mkstat = 0
zoncou = "N13"
If varmode([M]N13,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N13(indice),[M]CODTYPN13) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N13(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N13([M]N13(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N13(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N13" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N13(indice),[M]CODTYPN13,[M]LIBN13,[M]LNGN13,[M]NV13(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N13" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV13(nolign-1),[M]CODTYPN13,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N13" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone N14
mkstat = 0
zoncou = "N14"
If varmode([M]N14,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N14(indice),[M]CODTYPN14) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N14(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N14([M]N14(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N14(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N14" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N14(indice),[M]CODTYPN14,[M]LIBN14,[M]LNGN14,[M]NV14(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N14" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV14(nolign-1),[M]CODTYPN14,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N14" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone N15
mkstat = 0
zoncou = "N15"
If varmode([M]N15,indice)=0
 SAVACT = GACTION : GACTION = "AFMTSAI"
 Call ASAISIE([M]N15(indice),[M]CODTYPN15) From FMTVAR
 GACTION = SAVACT
 If mkstat=1 : Raz [M]N15(indice) : Endif
 If !mkstat
  SAVACT = GACTION : GACTION = "STD"
  Call AS_N15([M]N15(indice)) From SUBADI
  GACTION = SAVACT
  If mkstat=1 : Raz [M]N15(indice) : Endif
  If !mkstat
   IMPMOD = 0 : IMPZON = "N15" : Gosub ACTION From =IMPTRT
  Endif
  If !mkstat
   SAVACT = GACTION : GACTION = "AFMTCONT"
   Call CONTROLE([M]N15(indice),[M]CODTYPN15,[M]LIBN15,[M]LNGN15,[M]NV15(nolign-1)) From FMTVAR
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "N15" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTACL"
    Call CONTACL([M]NV15(nolign-1),[M]CODTYPN15,"","") From SUBACL
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "N15" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_N15([M]N15(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "N15" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone DEPCOD
mkstat = 0
zoncou = "DEPCOD"
If varinit([M]DEPCOD,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]DEPCOD(indice),num$([M]DEPNUM),"") From SUBADI
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]DEPCOD,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "DEPCOD" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "CONTADI"
  Call CONTADI([M]DEPCOD(indice),num$([M]DEPNUM),"") From SUBADI
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "DEPCOD" : GZNUM = 13894 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTROLE("ADI","!$",[M]DEPCOD(indice),num$([M]DEPNUM),mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "DEPCOD" : GZNUM = 13894 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "STD"
    Call C_DEPCOD([M]DEPCOD(indice)) From SUBADI
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "DEPCOD" : GZNUM = 13894 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
   Endif
  Endif
 Endif
Endif

## Zone SOC
mkstat = 0
zoncou = "SOC"
WCHAR = [M]SOC(indice)
If varmode([M]SOC,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "SOC" : Gosub ACTION From =IMPTRT
 Endif
 Call CONTROLE("AGF","!C",[M]SOC(indice),"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "SOC" : GZNUM = 0 : Endif
 Gosub AFF From GSAISIE
 If mkstat : End : Endif
 If !mkstat
  If WCHAR<>[M]SOC(indice) or IMPMOD
   SAVACT = GACTION : GACTION = "STD"
   Call AM_SOC([M]SOC(indice)) From SUBADI
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "SOC" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
  Endif
 Endif
Endif

## Zone INTSOC
mkstat = 0
zoncou = "INTSOC"
If varmode([M]INTSOC,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "INTSOC" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone LEG
mkstat = 0
zoncou = "LEG"
WCHAR = [M]LEG(indice)
If varinit([M]LEG,indice)=0
 SAVACT = GACTION : GACTION = "INILEG"
 Call INILEG([M]LEG(indice),"909","") From SUBADI
 GACTION = SAVACT
Endif
If !mkstat
 If varmode([M]LEG,indice)=0
  If !mkstat
   IMPMOD = 0 : IMPZON = "LEG" : Gosub ACTION From =IMPTRT
  Endif
  SAVACT = GACTION : GACTION = "CONTADI"
  Call CONTADI([M]LEG(indice),"909","") From SUBADI
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "LEG" : GZNUM = 0 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
  If !mkstat
   Call CONTROLE("ADI","!$",[M]LEG(indice),"909",mkstat) From CONTOBJ
   If mkstat : GERR = 1 : GZONE = "LEG" : GZNUM = 0 : Endif
   Gosub AFF From GSAISIE
   If mkstat : End : Endif
   If !mkstat
    SAVACT = GACTION : GACTION = "ACONTLEG"
    Call CONTLEG([M]LEG(indice)) From SUBADI
    GACTION = SAVACT
    If mkstat : GERR = 1 : GZONE = "LEG" : GZNUM = 0 : Endif
    Gosub AFF From GSAISIE
    If mkstat : End : Endif
    If !mkstat
     SAVACT = GACTION : GACTION = "STD"
     Call C_LEG([M]LEG(indice)) From SUBADI
     GACTION = SAVACT
     If mkstat : GERR = 1 : GZONE = "LEG" : GZNUM = 0 : Endif
     Gosub AFF From GSAISIE
     If mkstat : End : Endif
     If !mkstat
      If WCHAR<>[M]LEG(indice) or IMPMOD
       SAVACT = GACTION : GACTION = "STD"
       Call AM_LEG([M]LEG(indice)) From SUBADI
       GACTION = SAVACT
       If mkstat : GERR = 1 : GZONE = "LEG" : GZNUM = 0 : Endif
       Gosub AFF From GSAISIE
       If mkstat : End : Endif
      Endif
     Endif
    Endif
   Endif
  Endif
 Endif
Endif

## Zone INTLEG
mkstat = 0
zoncou = "INTLEG"
If varmode([M]INTLEG,indice)=0
 If !mkstat
  IMPMOD = 0 : IMPZON = "INTLEG" : Gosub ACTION From =IMPTRT
 Endif
Endif

## Zone ENAFLG
mkstat = 0
zoncou = "ENAFLG"
IMPENT = [M]ENAFLG(indice)
If varinit([M]ENAFLG,indice)=0
 IMPENT = 1
Endif
If varmode([M]ENAFLG,indice)=0
 [M]ENAFLG(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "ENAFLG" : Gosub ACTION From =IMPTRT
  IMPENT = [M]ENAFLG(indice)
 Endif
Endif
[M]ENAFLG(indice) = IMPENT

## Zone NBLIG
mkstat = 0
zoncou = "NBLIG"

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "ADI1"
Return

