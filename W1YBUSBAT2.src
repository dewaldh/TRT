#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management YBUSBAT2 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [29/08/2018]
A_HEURE = "15:23:30"
A_USER  = "DH"
A_STAMP = "20180829152330"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "YLIG"
  If [M]YLIG=0
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask YBUSBAT2 [YBB2]
Gosub HORODAT
Local Inpbox "YBUSBAT2" From GFONCTION At A_STAMP With A_WINDPREV Mask [YBB2] As [SIM_]
Grizo [YBB2]5
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [YBB2]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=25
Return

$ON_YLIG
Onevent BEFORE_AREA Call AV_YLIG From W1YBUSBAT2
Return

Subprog AV_YLIG
Local Decimal BASPAG
GDEV1(1) = "EUR"
GDEV1(1) = ""
Gosub SETDEV From TRTDIV
Gosub _AFF
End

$ON_YENTTYP
Onevent CONTROL Call C_YENTTYP(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YENTTYP(zc) From W1YBUSBAT2
Return

Subprog AS_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5152,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YENTTYP(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YENTTYP(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YENTTYP(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YENTTYP(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YENTTYP(VALEUR)
Variable Char    VALEUR()
## Action CONTGTE
Call CONTGTE(VALEUR,"","") From SUBGTE
If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
Endif
Gosub _AFF
End

Subprog S_YENTTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGTE
 Call SELGTE(VALEUR,"","","") From SUBGTE
Endif
Gosub _AFF
End

Subprog B1_YENTTYP(VALEUR)
Variable Char    VALEUR()
Call OBJET("GTE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GTE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GTE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YJOU
Onevent CONTROL Call C_YJOU(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YJOU(zc) From W1YBUSBAT2
Return

Subprog AS_YJOU(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4314,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YJOU(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YJOU(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YJOU(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YJOU(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YJOU(VALEUR)
Variable Char    VALEUR()
## Action CONTJOU
Call CONTJOU(VALEUR,"","") From SUBJOU
If mkstat : GERR = 1 : GZONE = "YJOU" : GZNUM = 4314 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YJOU" : GZNUM = 4314 : Endif
Endif
Gosub _AFF
End

Subprog S_YJOU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELJOU
 Call SELJOU(VALEUR,"") From SUBJOU
Endif
Gosub _AFF
End

Subprog B1_YJOU(VALEUR)
Variable Char    VALEUR()
Call OBJET("JOU",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YJOU(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "JOU"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YJOU(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("JOU",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFCY
Onevent CONTROL Call C_YFCY(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YFCY(zc) From W1YBUSBAT2
Return

Subprog AS_YFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFCY(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YFCY(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YFCY(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YFCY(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "YFCY" : GZNUM = 1344 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFCY" : GZNUM = 1344 : Endif
Endif
Gosub _AFF
End

Subprog S_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCOA
Onevent CONTROL Call C_YCOA(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YCOA(zc) From W1YBUSBAT2
Return

Subprog AS_YCOA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(29357,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCOA(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YCOA(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YCOA(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YCOA(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YCOA(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("COA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YCOA" : GZNUM = 29354 : Endif
Gosub _AFF
End

Subprog S_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "COA"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCOA(VALEUR)
Variable Char    VALEUR()
Call OBJET("COA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "COA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("COA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YACC
Onevent BEFORE_AREA Gosub AV_YACC From W1YBUSBAT2
Onevent CONTROL Call C_YACC(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YACC(zc) From W1YBUSBAT2
Return

$AV_YACC
## Action INIACCFMT
Call INIACCFMT("") From SETGLBCOA
If GFMTACC<>""
 Chgfmt [M]YACC(indice) With "K:"+GFMTACC
Else
 Chgfmt [M]YACC(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YACC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YACC(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YACC(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YACC(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YACC(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,"") From CPTSUB
  If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
Endif
Gosub _AFF
End

Subprog S_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GAC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YACC(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCTRL
Onevent CONTROL Call C_YCTRL(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YCTRL(zc) From W1YBUSBAT2
Return

Subprog AS_YCTRL(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_YCTRL(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YCTRL(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,"") From CPTCNT
 If mkstat : GERR = 1 : GZONE = "YCTRL" : GZNUM = 321 : Endif
Endif
Gosub _AFF
End

Subprog S_YCTRL(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_YBP
Onevent CONTROL Call C_YBP(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YBP(zc) From W1YBUSBAT2
Return

Subprog AS_YBP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YBP(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YBP(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YBP(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YBP(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YBP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YBP" : GZNUM = 19569 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YBP" : GZNUM = 19569 : Endif
Endif
Gosub _AFF
End

Subprog S_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YBP(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDEB
Onevent BEFORE_AREA Gosub AV_YDEB From W1YBUSBAT2
Return

$AV_YDEB
Chgfmt [M]YDEB(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_YCDT
Onevent BEFORE_AREA Gosub AV_YCDT From W1YBUSBAT2
Return

$AV_YCDT
Chgfmt [M]YCDT(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_YTAX
Onevent CONTROL Call C_YTAX(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YTAX(zc) From W1YBUSBAT2
Return

Subprog IB_YTAX(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_YTAX(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YTAX(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_YTAX(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YTAX(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YTAX(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YTAX(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YTAX(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,"","","","","","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "YTAX" : GZNUM = 2554 : Endif
Gosub _AFF
End

Subprog S_YTAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YTAX(VALEUR)
Variable Char    VALEUR()
Call OBJET("TVT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTAX(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTAX(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YPJT
Onevent BEFORE_INPUT Call AS_YPJT(zc) From W1YBUSBAT2
Onevent CONTROL Call C_YPJT(zc) From W1YBUSBAT2
Onevent AFTER_CHANGE Gosub AMM_YPJT From W1YBUSBAT2
Return

Subprog IB_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
Gosub _AFF
End

Subprog AS_YPJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YPJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat=2
 [M]YPJT(INDIC) = VALEUR
 Affzo YPJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_YPJT(zc) From W1YBUSBAT2
Onkey 130 Titled GBOUT2 Call B2_YPJT(zc) From W1YBUSBAT2
Onkey 131 Titled GBOUT3 Call B3_YPJT(zc) From W1YBUSBAT2
Onkey 132 Titled GBOUT4 Call B4_YPJT(zc) From W1YBUSBAT2
Onkey 172 Titled GBOUT15 Call B15_YPJT(zc) From W1YBUSBAT2
Onkey 173 Titled GBOUT16 Call B16_YPJT(zc) From W1YBUSBAT2
Onkey 174 Titled GBOUT17 Call B17_YPJT(zc) From W1YBUSBAT2
Onkey 175 Titled GBOUT18 Call B18_YPJT(zc) From W1YBUSBAT2
Onkey 176 Titled GBOUT19 Call B19_YPJT(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YPJT(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YPJT(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YPJT(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
Endif
Gosub _AFF
End

$AMM_YPJT
Call AM_YPJT(zc)
If !mkstat & GOBJET
 zoncou = "YPJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"","","","","","",""
&,"","","","","","","",""
&,"","","","") From TRTPJT
If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
Gosub _AFF
End

Subprog S_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YPJT(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"","","","","","",""
& ,"","","","","","","",""
& ,"","","","") From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 PARMSK(8) = ""
 PARMSK(9) = ""
 PARMSK(10) = ""
 PARMSK(11) = ""
 PARMSK(12) = ""
 PARMSK(13) = ""
 PARMSK(14) = ""
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_YPJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YPJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE
Onevent CONTROL Call C_YDIE(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YDIE(zc) From W1YBUSBAT2
Return

Subprog AS_YDIE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6829,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YDIE(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YDIE(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YDIE(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YDIE(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YDIE(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("DIE","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YDIE" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_YDIE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "DIE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YDIE(VALEUR)
Variable Char    VALEUR()
Call OBJET("DIE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YDIE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "DIE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YDIE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("DIE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCCE
Onevent BEFORE_AREA Gosub AV_YCCE From W1YBUSBAT2
Onevent CONTROL Call C_YCCE(zc) From W1YBUSBAT2
Onevent BEFORE_INPUT Call AS_YCCE(zc) From W1YBUSBAT2
Return

$AV_YCCE
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE(zc) From W1YBUSBAT2
Onkey   2 Titled GBOUTS Call S_YCCE(zc) From W1YBUSBAT2
Onkey 144 Titled GBOUTP Call P_YCCE(zc) From W1YBUSBAT2
Onkey 146 Titled GBOUTA Call SA_YCCE(zc) From W1YBUSBAT2
Gosub _AFF
End

Subprog C_YCCE(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Return


