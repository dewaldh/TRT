#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management PBENCHW5 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:07:00"
A_USER  = "ADMIN"
A_STAMP = "20180828000700"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask PBENCHW5 [PBW5]
Gosub HORODAT
Local Inpbox "PBENCHW5" From GFONCTION At A_STAMP With A_WINDPREV Mask [PBW5] As [SIM_]
Grizo [PBW5]5
Grizo [PBW5]10
Grizo [PBW5]15
Grizo [PBW5]20
Grizo [PBW5]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [PBW5]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=99 : Y1(0)=9 : Y2(0)=13
X1(1)=100 : X2(1)=147 : Y1(1)=9 : Y2(1)=13
X1(2)=1 : X2(2)=147 : Y1(2)=14 : Y2(2)=15
X1(3)=1 : X2(3)=99 : Y1(3)=16 : Y2(3)=20
X1(4)=100 : X2(4)=147 : Y1(4)=16 : Y2(4)=20
Return

$ON_POHFCY
Return

$ON_ZPOHFCY
Onevent BEFORE_AREA Gosub AV_ZPOHFCY From W1PBENCHW5
Return

$AV_ZPOHFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]POHFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_BUY
Return

$ON_ZBUY
Onevent BEFORE_AREA Gosub AV_ZBUY From W1PBENCHW5
Return

$AV_ZBUY
Call LECTEXTRA(zc,"AUTILIS","INTUSR",num$([M]BUY(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_VCRNUM
Return

$ON_ITMREF
Return

$ON_ZITMREF
Onevent BEFORE_AREA Gosub AV_ZITMREF From W1PBENCHW5
Return

$AV_ZITMREF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ECCVALMAJ
Onevent BEFORE_INPUT Call AS_ECCVALMAJ(zc) From W1PBENCHW5
Onevent CONTROL Call C_ECCVALMAJ(zc) From W1PBENCHW5
Return

Subprog AS_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMAJ(VALEUR) From SUBPBW5
If mkstat=2
 [M]ECCVALMAJ(INDIC) = VALEUR
 Affzo ECCVALMAJ(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMAJ(zc) From W1PBENCHW5
Gosub _AFF
End

Subprog C_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ECCVALMAJ(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

Subprog S_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:PBW5]ITMREF
 PARMSK(2) = VALEUR
 PARMSK(3) = "[M:PBW5]ECCVALMIN"
 PARMSK(4) = "4"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "PBW5"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ECCVALMIN
Onevent BEFORE_INPUT Call AS_ECCVALMIN(zc) From W1PBENCHW5
Onevent CONTROL Call C_ECCVALMIN(zc) From W1PBENCHW5
Return

Subprog AS_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMIN(VALEUR) From SUBPBW5
If mkstat=2
 [M]ECCVALMIN(INDIC) = VALEUR
 Affzo ECCVALMIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMIN(zc) From W1PBENCHW5
Gosub _AFF
End

Subprog C_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ECCVALMIN(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
Gosub _AFF
End

Subprog S_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:PBW5]ITMREF
 PARMSK(2) = [M:PBW5]ECCVALMAJ
 PARMSK(3) = ""
 PARMSK(4) = "4"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "PBW5"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_STOMGTCOD
Onevent INIT_AREA Call D_STOMGTCOD(zc) From W1PBENCHW5
Return

Subprog D_STOMGTCOD(VALEUR)
Variable Integer VALEUR
If varinit([M]STOMGTCOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_POHTYP
Onevent INIT_AREA Call D_POHTYP(zc) From W1PBENCHW5
Return

Subprog D_POHTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]POHTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_LINAPPFLG
Onevent INIT_AREA Call D_LINAPPFLG(zc) From W1PBENCHW5
Return

Subprog D_LINAPPFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]LINAPPFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_RCPFLG
Onevent INIT_AREA Call D_RCPFLG(zc) From W1PBENCHW5
Return

Subprog D_RCPFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]RCPFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_INVFLG
Onevent INIT_AREA Call D_INVFLG(zc) From W1PBENCHW5
Return

Subprog D_INVFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]INVFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_STOFCY
Return

$ON_ZSTOFCY
Onevent BEFORE_AREA Gosub AV_ZSTOFCY From W1PBENCHW5
Return

$AV_ZSTOFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]STOFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_CAD
Onevent INIT_AREA Call D_CAD(zc) From W1PBENCHW5
Return

Subprog D_CAD(VALEUR)
Variable Integer VALEUR
If varinit([M]CAD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_EXTRCPDAT
Onevent CONTROL Call C_EXTRCPDAT(zc) From W1PBENCHW5
Onevent AFTER_CHANGE Gosub AMM_EXTRCPDAT From W1PBENCHW5
Onevent BEFORE_AREA Gosub AV_EXTRCPDAT From W1PBENCHW5
Return

$AV_EXTRCPDAT
Chgfmt [M]EXTRCPDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_EXTRCPDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_EXTRCPDAT(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "EXTRCPDAT" : GZNUM = 5883 : Endif
Gosub _AFF
End

$AMM_EXTRCPDAT
Call AM_EXTRCPDAT(zc)
If !mkstat & GOBJET
 zoncou = "EXTRCPDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTRCPDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_EXTRCPDAT(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "EXTRCPDAT" : GZNUM = 5883 : Endif
Gosub _AFF
End

$ON_QTYPUU
Onevent BEFORE_AREA Gosub AV_QTYPUU From W1PBENCHW5
Onevent BEFORE_INPUT Call AS_QTYPUU(zc) From W1PBENCHW5
Onevent CONTROL Call C_QTYPUU(zc) From W1PBENCHW5
Onevent AFTER_CHANGE Gosub AMM_QTYPUU From W1PBENCHW5
Return

$AV_QTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]PUU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYPUU(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTYPUU(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12817,GBOUT1) From OBJDIV
Call TEXTE(12817,GBOUT2) From OBJDIV
## Action STD
Call AS_QTYPUU(VALEUR) From SUBPBW5
If mkstat=2
 [M]QTYPUU(INDIC) = VALEUR
 Affzo QTYPUU(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_QTYPUU(zc) From W1PBENCHW5
Onkey 130 Titled GBOUT2 Call B2_QTYPUU(zc) From W1PBENCHW5
Gosub _AFF
End

Subprog C_QTYPUU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_QTYPUU(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
Gosub _AFF
End

$AMM_QTYPUU
Call AM_QTYPUU(zc)
If !mkstat & GOBJET
 zoncou = "QTYPUU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYPUU(VALEUR)
Variable Decimal VALEUR
## Action PCALQTY
Call PCAL_QTY(VALEUR,[M]PUU,[M]QTYSTU,[M]STU,[M]ITMREF,[M]BPSNUM,1,GBIDD1) From TRTACHQTE1
If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
If !mkstat
 ## Action STD
 Call AM_QTYPUU(VALEUR) From SUBPBW5
 If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
Endif
Gosub _AFF
End

Subprog B1_QTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_QTYPUU" : PROGSUB = "SUBPBW5" : PROGSPE = "SPEPBW5" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = [M]STOFCY
 PARMSK(3) = [M]ITMREF
 PARMSK(4) = ""
 Call CONSULT_NUM(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB1_QTYPUU" : PROGSUB = "SUBPBW5" : PROGSPE = "SPEPBW5" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_QTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B2_QTYPUU(VALEUR) From SUBPBW5
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PUU
Return

$ON_QTYSTU
Onevent BEFORE_AREA Gosub AV_QTYSTU From W1PBENCHW5
Onevent CONTROL Call C_QTYSTU(zc) From W1PBENCHW5
Onevent AFTER_CHANGE Gosub AMM_QTYSTU From W1PBENCHW5
Return

$AV_QTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYSTU(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog C_QTYSTU(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_QTYSTU(VALEUR) From SUBPBW5
If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
Gosub _AFF
End

$AMM_QTYSTU
Call AM_QTYSTU(zc)
If !mkstat & GOBJET
 zoncou = "QTYSTU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYSTU(VALEUR)
Variable Decimal VALEUR
## Action PCALQTY
Call PCAL_QTY(VALEUR,[M]STU,[M]QTYPUU,[M]PUU,[M]ITMREF,[M]BPSNUM,1,GBIDD1) From TRTACHQTE1
If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
If !mkstat
 ## Action STD
 Call AM_QTYSTU(VALEUR) From SUBPBW5
 If mkstat : GERR = 1 : GZONE = "QTYSTU" : GZNUM = 2602 : Endif
Endif
Gosub _AFF
End

$ON_STU
Return

$ON_RCPQTYPUU
Onevent BEFORE_AREA Gosub AV_RCPQTYPUU From W1PBENCHW5
Return

$AV_RCPQTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]PUU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]RCPQTYPUU(indice) With "NPz:"+GUNTFMT
Gosub _AFF
Return

$ON_BPSNUM
Return

$ON_ZBPSNUM
Onevent BEFORE_AREA Gosub AV_ZBPSNUM From W1PBENCHW5
Return

$AV_ZBPSNUM
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LECTURE("BPS",num$([M]BPSNUM(indice)),"") From CONTOBJ
zc = [F:BPS]BPSNAM
Gosub _AFF
Return

$ON_POCNUM
Return

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1PBENCHW5
Onevent CONTROL Call C_PJT(zc) From W1PBENCHW5
Onevent AFTER_CHANGE Gosub AMM_PJT From W1PBENCHW5
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1PBENCHW5
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1PBENCHW5
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1PBENCHW5
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1PBENCHW5
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1PBENCHW5
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1PBENCHW5
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1PBENCHW5
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1PBENCHW5
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1PBENCHW5
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1PBENCHW5
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1PBENCHW5
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1PBENCHW5
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJT(VALEUR) From SUBPBW5
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"PBW5","PJT",0,7,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PBW5]POHFCY,[M:PBW5]BPSNUM
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "PBW5"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "7"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PBW5]POHFCY
 PARMSK(15) = [M:PBW5]BPSNUM
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PBW5]POHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_SELIND
Onevent INIT_AREA Call D_SELIND(zc) From W1PBENCHW5
Return

Subprog D_SELIND(VALEUR)
Variable Integer VALEUR
If varinit([M]SELIND,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_POHNUM
Return

$ON_BPSNUM2
Return

$ON_PUU2
Return

$ON_PURFCY
Return

$ON_MRPMES
Onevent INIT_AREA Call D_MRPMES(zc) From W1PBENCHW5
Return

Subprog D_MRPMES(VALEUR)
Variable Integer VALEUR
If varinit([M]MRPMES,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_MRPQTY
Onevent BEFORE_AREA Gosub AV_MRPQTY From W1PBENCHW5
Return

$AV_MRPQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find("",GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_STU2
Return

$ON_EXTQTY1
Onevent BEFORE_AREA Gosub AV_EXTQTY1 From W1PBENCHW5
Return

$AV_EXTQTY1
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU2,GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_EXTQTY2
Onevent BEFORE_AREA Gosub AV_EXTQTY2 From W1PBENCHW5
Return

$AV_EXTQTY2
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU2,GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_INITAR
Onevent INIT_AREA Call D_INITAR(zc) From W1PBENCHW5
Return

Subprog D_INITAR(VALEUR)
Variable Integer VALEUR
If varinit([M]INITAR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Return


