#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management YBUSBAT1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [14/09/2018]
A_HEURE = "13:09:58"
A_USER  = "DH"
A_STAMP = "20180914130958"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask YBUSBAT1 [YBB1]
Gosub HORODAT
Local Inpbox "YBUSBAT1" From GFONCTION At A_STAMP With A_WINDPREV Mask [YBB1] As [SIM_]
Grizo [YBB1]5
Grizo [YBB1]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [YBB1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=23
X1(1)=1 : X2(1)=74 : Y1(1)=24 : Y2(1)=25
Return

$ON_NBLIG
Onevent BEFORE_AREA Call AV_NBLIG From W1YBUSBAT1
Return

Subprog AV_NBLIG
Local Decimal BASPAG
GDEV1(1) = "EUR"
GDEV1(1) = ""
Gosub SETDEV From TRTDIV
Gosub _AFF
End

$ON_YENTTYP
Onevent CONTROL Call C_YENTTYP(zc) From W1YBUSBAT1
Onevent INIT_AREA Call D_YENTTYP(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YENTTYP(zc) From W1YBUSBAT1
Return

Subprog D_YENTTYP(VALEUR)
Variable Char    VALEUR()
If varinit([M]YENTTYP,indice)=0
 VALEUR = GTYPPCE
 ## Action FLDDEFCAR
 Call FLDDEFCAR(VALEUR,"YENTTYP") From TRTGAS
Endif
Gosub _AFF
End

Subprog AS_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5152,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action FLDAVTCAR
Call FLDAVTCAR(VALEUR,"YENTTYP") From TRTGAS
If mkstat=2
 [M]YENTTYP(INDIC) = VALEUR
 Affzo YENTTYP(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_YENTTYP(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YENTTYP(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YENTTYP(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YENTTYP(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YENTTYP(VALEUR)
Variable Char    VALEUR()
## Action CONTGTE
Call CONTGTE(VALEUR,GCURLEG,"") From SUBGTE
If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
 If !mkstat
  ## Action FLDCTLCAR
  Call FLDCTLCAR(VALEUR,"YENTTYP") From TRTGAS
  If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
  If !mkstat
   ## Action SPE
   Call C_YENTTYP(VALEUR) From SPEYBB
   If mkstat : GERR = 1 : GZONE = "YENTTYP" : GZNUM = 4969 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_YENTTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YBBSELGTE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YBBSELGTE"
 Call S_LIS_CHAR(VALEUR,PARMSK,"","","YBBSELGTE") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YENTTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNGTE
 Call TUNGTE(VALEUR,GCURLEG) From SUBGTE
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GTE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YENTTYP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GTE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YJOU
Onevent CONTROL Call C_YJOU(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YJOU(zc) From W1YBUSBAT1
Return

Subprog AS_YJOU(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4314,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YJOU(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YJOU(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YJOU(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YJOU(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YJOU(VALEUR)
Variable Char    VALEUR()
## Action CONTJOU
Call CONTJOU(VALEUR,"","") From SUBJOU
If mkstat : GERR = 1 : GZONE = "YJOU" : GZNUM = 4314 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YJOU" : GZNUM = 4314 : Endif
 If !mkstat
  ## Action SPE
  Call C_YJOU(VALEUR) From SPEYBB
  If mkstat : GERR = 1 : GZONE = "YJOU" : GZNUM = 4314 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_YJOU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YBBSELJOU
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YBBSELJOU"
 Call S_LIS_CHAR(VALEUR,PARMSK,"","","YBBSELJOU") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YJOU(VALEUR)
Variable Char    VALEUR()
Call OBJET("JOU",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YJOU(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "JOU"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YJOU(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("JOU",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YFCY
Onevent CONTROL Call C_YFCY(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YFCY(zc) From W1YBUSBAT1
Return

Subprog AS_YFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YFCY(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YFCY(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YFCY(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YFCY(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "YFCY" : GZNUM = 1344 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YFCY" : GZNUM = 1344 : Endif
 If !mkstat
  ## Action SPE
  Call C_YFCY(VALEUR) From SPEYBB
  If mkstat : GERR = 1 : GZONE = "YFCY" : GZNUM = 1344 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YELA
Onevent CONTROL Call C_YELA(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YELA(zc) From W1YBUSBAT1
Return

Subprog AS_YELA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(100685,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YELA(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YELA(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YELA(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YELA(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YELA(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("YELA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YELA" : GZNUM = 100109 : Endif
If !mkstat
 ## Action SPE
 Call C_YELA(VALEUR) From SPEYBB
 If mkstat : GERR = 1 : GZONE = "YELA" : GZNUM = 100109 : Endif
Endif
Gosub _AFF
End

Subprog S_YELA(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action YBBSELELA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "YBBSELELA"
 Call S_LIS_CHAR(VALEUR,PARMSK,"","","YBBSELELA") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YELA(VALEUR)
Variable Char    VALEUR()
Call OBJET("YELA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YELA(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "YELA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YELA(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("YELA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YBAN
Onevent CONTROL Call C_YBAN(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YBAN(zc) From W1YBUSBAT1
Return

Subprog AS_YBAN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7396,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YBAN(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YBAN(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YBAN(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YBAN(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YBAN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("BAN","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YBAN" : GZNUM = 38162 : Endif
Gosub _AFF
End

Subprog S_YBAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BAN"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YBAN(VALEUR)
Variable Char    VALEUR()
Call OBJET("BAN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YBAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BAN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YBAN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BAN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCOA
Onevent CONTROL Call C_YCOA(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCOA(zc) From W1YBUSBAT1
Return

Subprog AS_YCOA(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(29357,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCOA(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCOA(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCOA(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCOA(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCOA(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("COA","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "YCOA" : GZNUM = 29354 : Endif
Gosub _AFF
End

Subprog S_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "COA"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCOA(VALEUR)
Variable Char    VALEUR()
Call OBJET("COA",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "COA"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCOA(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("COA",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YACC
Onevent BEFORE_AREA Gosub AV_YACC From W1YBUSBAT1
Onevent CONTROL Call C_YACC(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YACC(zc) From W1YBUSBAT1
Return

$AV_YACC
## Action INIACCFMT
Call INIACCFMT("") From SETGLBCOA
If GFMTACC<>""
 Chgfmt [M]YACC(indice) With "K:"+GFMTACC
Else
 Chgfmt [M]YACC(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YACC(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YACC(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YACC(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YACC(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YACC(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YACC(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,"") From CPTSUB
  If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YACC" : GZNUM = 3956 : Endif
Endif
Gosub _AFF
End

Subprog S_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GAC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YACC(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YACC(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YCTRL
Onevent CONTROL Call C_YCTRL(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCTRL(zc) From W1YBUSBAT1
Return

Subprog AS_YCTRL(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_YCTRL(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCTRL(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTSAC
 Call CONTSAC(VALEUR,"") From CPTCNT
 If mkstat : GERR = 1 : GZONE = "YCTRL" : GZNUM = 321 : Endif
Endif
Gosub _AFF
End

Subprog S_YCTRL(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSAC"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSAC","CPTSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_YBP
Onevent CONTROL Call C_YBP(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YBP(zc) From W1YBUSBAT1
Return

Subprog AS_YBP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1500,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YBP(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YBP(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YBP(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YBP(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YBP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPRCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPRCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPRCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YBP" : GZNUM = 19569 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPR","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YBP" : GZNUM = 19569 : Endif
Endif
Gosub _AFF
End

Subprog S_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPR"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YBP(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPR",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPR"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YBP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPR",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDEB
Onevent CONTROL Call C_YDEB(zc) From W1YBUSBAT1
Onevent AFTER_CHANGE Gosub AMM_YDEB From W1YBUSBAT1
Onevent BEFORE_AREA Gosub AV_YDEB From W1YBUSBAT1
Return

$AV_YDEB
Chgfmt [M]YDEB(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

Subprog C_YDEB(VALEUR)
Variable Decimal VALEUR
## Action SPE
Call C_YDEB(VALEUR) From SPEYBB
If mkstat : GERR = 1 : GZONE = "YDEB" : GZNUM = 5252 : Endif
Gosub _AFF
End

$AMM_YDEB
Call AM_YDEB(zc)
If !mkstat & GOBJET
 zoncou = "YDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YDEB(VALEUR)
Variable Decimal VALEUR
## Action SPE
Call AM_YDEB(VALEUR) From SPEYBB
If mkstat : GERR = 1 : GZONE = "YDEB" : GZNUM = 5252 : Endif
Gosub _AFF
End

$ON_YCDT
Onevent CONTROL Call C_YCDT(zc) From W1YBUSBAT1
Onevent AFTER_CHANGE Gosub AMM_YCDT From W1YBUSBAT1
Onevent BEFORE_AREA Gosub AV_YCDT From W1YBUSBAT1
Return

$AV_YCDT
Chgfmt [M]YCDT(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

Subprog C_YCDT(VALEUR)
Variable Decimal VALEUR
## Action SPE
Call C_YCDT(VALEUR) From SPEYBB
If mkstat : GERR = 1 : GZONE = "YCDT" : GZNUM = 5253 : Endif
Gosub _AFF
End

$AMM_YCDT
Call AM_YCDT(zc)
If !mkstat & GOBJET
 zoncou = "YCDT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YCDT(VALEUR)
Variable Decimal VALEUR
## Action SPE
Call AM_YCDT(VALEUR) From SPEYBB
If mkstat : GERR = 1 : GZONE = "YCDT" : GZNUM = 5253 : Endif
Gosub _AFF
End

$ON_YTAX
Onevent CONTROL Call C_YTAX(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YTAX(zc) From W1YBUSBAT1
Return

Subprog IB_YTAX(VALEUR)
Variable Char    VALEUR()
## Action CONTOBJN
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CONTOBJN"
Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
GACTION = SAVACT
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_YTAX(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(5342,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YTAX(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_YTAX(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YTAX(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YTAX(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YTAX(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YTAX(VALEUR)
Variable Char    VALEUR()
## Action CONTTVT
Call CONTTVT(VALEUR,"","","","","","") From SUBTVT
If mkstat : GERR = 1 : GZONE = "YTAX" : GZNUM = 2554 : Endif
Gosub _AFF
End

Subprog S_YTAX(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTVTLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTVTLEG"
 PARMSK(1) = ""
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = ""
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTVT","SUBTVT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YTAX(VALEUR)
Variable Char    VALEUR()
Call OBJET("TVT",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YTAX(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TVT"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YTAX(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TVT",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YGSTAMT
Onevent BEFORE_AREA Gosub AV_YGSTAMT From W1YBUSBAT1
Return

$AV_YGSTAMT
Chgfmt [M]YGSTAMT(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_YAMTTAX
Onevent BEFORE_AREA Gosub AV_YAMTTAX From W1YBUSBAT1
Return

$AV_YAMTTAX
Chgfmt [M]YAMTTAX(indice) With "Nz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_YPJT
Onevent BEFORE_INPUT Call AS_YPJT(zc) From W1YBUSBAT1
Onevent CONTROL Call C_YPJT(zc) From W1YBUSBAT1
Onevent AFTER_CHANGE Gosub AMM_YPJT From W1YBUSBAT1
Return

Subprog IB_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Gosub _AFF
End

Subprog AS_YPJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_YPJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat=2
 [M]YPJT(INDIC) = VALEUR
 Affzo YPJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_YPJT(zc) From W1YBUSBAT1
Onkey 130 Titled GBOUT2 Call B2_YPJT(zc) From W1YBUSBAT1
Onkey 131 Titled GBOUT3 Call B3_YPJT(zc) From W1YBUSBAT1
Onkey 132 Titled GBOUT4 Call B4_YPJT(zc) From W1YBUSBAT1
Onkey 172 Titled GBOUT15 Call B15_YPJT(zc) From W1YBUSBAT1
Onkey 173 Titled GBOUT16 Call B16_YPJT(zc) From W1YBUSBAT1
Onkey 174 Titled GBOUT17 Call B17_YPJT(zc) From W1YBUSBAT1
Onkey 175 Titled GBOUT18 Call B18_YPJT(zc) From W1YBUSBAT1
Onkey 176 Titled GBOUT19 Call B19_YPJT(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YPJT(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YPJT(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YPJT(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
Endif
Gosub _AFF
End

$AMM_YPJT
Call AM_YPJT(zc)
If !mkstat & GOBJET
 zoncou = "YPJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_YPJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
&,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
If mkstat : GERR = 1 : GZONE = "YPJT" : GZNUM = 18260 : Endif
Gosub _AFF
End

Subprog S_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_YPJT(VALEUR)
Variable Char    VALEUR()
Call OBJET("PIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"YBB1","YPJT",0,2,[V]CST_ANO,[V]CST_ANO,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,func SUBGA0.GET_VALUE_FIELD("FCY"),""
& ,"","",func SUBGA0.GET_NAME_FIELD("PJTLIN"),func SUBGA0.GET_VALUE_FIELD("CPY")) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_YPJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "YBB1"
 PARMSK(2) = "YPJT"
 PARMSK(3) = "0"
 PARMSK(4) = "2"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_ANO)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = func SUBGA0.GET_VALUE_FIELD("FCY")
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = func SUBGA0.GET_NAME_FIELD("PJTLIN")
 PARMSK(19) = func SUBGA0.GET_VALUE_FIELD("CPY")
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_YPJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YPJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE1
Return

$ON_YCCE1
Onevent BEFORE_AREA Gosub AV_YCCE1 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE1(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE1(zc) From W1YBUSBAT1
Return

$AV_YCCE1
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE1(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE1(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE1(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE1(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE1(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE1" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE1" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE1(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE2
Return

$ON_YCCE2
Onevent BEFORE_AREA Gosub AV_YCCE2 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE2(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE2(zc) From W1YBUSBAT1
Return

$AV_YCCE2
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE2(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE2(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE2(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE2(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE2(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE2" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE2" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE2(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE3
Return

$ON_YCCE3
Onevent BEFORE_AREA Gosub AV_YCCE3 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE3(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE3(zc) From W1YBUSBAT1
Return

$AV_YCCE3
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE3(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE3(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE3(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE3(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE3(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE3" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE3" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE3(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE4
Return

$ON_YCCE4
Onevent BEFORE_AREA Gosub AV_YCCE4 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE4(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE4(zc) From W1YBUSBAT1
Return

$AV_YCCE4
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE4(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE4(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE4(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE4(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE4(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE4" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE4" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE4(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE5
Return

$ON_YCCE5
Onevent BEFORE_AREA Gosub AV_YCCE5 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE5(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE5(zc) From W1YBUSBAT1
Return

$AV_YCCE5
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE5(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE5(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE5(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE5(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE5(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE5" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE5" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE5(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE5(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE6
Return

$ON_YCCE6
Onevent BEFORE_AREA Gosub AV_YCCE6 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE6(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE6(zc) From W1YBUSBAT1
Return

$AV_YCCE6
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE6(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE6(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE6(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE6(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE6(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE6(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE6" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE6" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE6(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE6(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE7
Return

$ON_YCCE7
Onevent BEFORE_AREA Gosub AV_YCCE7 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE7(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE7(zc) From W1YBUSBAT1
Return

$AV_YCCE7
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE7(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE7(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE7(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE7(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE7(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE7(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE7(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE7" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE7" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE7(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE7(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE8
Return

$ON_YCCE8
Onevent BEFORE_AREA Gosub AV_YCCE8 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE8(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE8(zc) From W1YBUSBAT1
Return

$AV_YCCE8
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE8(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE8(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE8(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE8(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE8(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE8(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE8(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE8" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE8" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE8(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE8(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YDIE9
Return

$ON_YCCE9
Onevent BEFORE_AREA Gosub AV_YCCE9 From W1YBUSBAT1
Onevent CONTROL Call C_YCCE9(zc) From W1YBUSBAT1
Onevent BEFORE_INPUT Call AS_YCCE9(zc) From W1YBUSBAT1
Return

$AV_YCCE9
## Action INICCEFMT
Call INICCEFMT("") From SETGLBDIE
If GCCEFMT<>""
 Chgfmt [M]YCCE9(indice) With "K:"+GCCEFMT
Else
 Chgfmt [M]YCCE9(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_YCCE9(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_YCCE9(zc) From W1YBUSBAT1
Onkey   2 Titled GBOUTS Call S_YCCE9(zc) From W1YBUSBAT1
Onkey 144 Titled GBOUTP Call P_YCCE9(zc) From W1YBUSBAT1
Onkey 146 Titled GBOUTA Call SA_YCCE9(zc) From W1YBUSBAT1
Gosub _AFF
End

Subprog C_YCCE9(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "YCCE9" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "YCCE9" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_YCCE9(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CCE"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_YCCE9(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_YCCE9(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_YCCE9(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_YTOTDEB
Onevent BEFORE_AREA Gosub AV_YTOTDEB From W1YBUSBAT1
Return

$AV_YTOTDEB
Chgfmt [M]YTOTDEB(indice) With "NPz3:"+GDEVFM1(1)
Gosub _AFF
Return

$ON_YTOTCRE
Onevent BEFORE_AREA Gosub AV_YTOTCRE From W1YBUSBAT1
Return

$AV_YTOTCRE
Chgfmt [M]YTOTCRE(indice) With "NPz3:"+GDEVFM1(1)
Gosub _AFF
Return

$CHG_STY
Return


