#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management WE2ALL1 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:18:29"
A_USER  = "ADMIN"
A_STAMP = "20180828001829"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If GFMTCOA(1)<>""
    Chgfmt LINACC1 With GFMTCOA(1)
   Else
    Chgfmt LINACC1 With "-K:1X"
   Endif
   If GFMTCOA(2)<>""
    Chgfmt LINACC2 With GFMTCOA(2)
   Else
    Chgfmt LINACC2 With "-K:1X"
   Endif
   If GFMTCOA(3)<>""
    Chgfmt LINACC3 With GFMTCOA(3)
   Else
    Chgfmt LINACC3 With "-K:1X"
   Endif
   If GFMTCOA(4)<>""
    Chgfmt LINACC4 With GFMTCOA(4)
   Else
    Chgfmt LINACC4 With "-K:1X"
   Endif
   If GFMTCOA(5)<>""
    Chgfmt LINACC5 With GFMTCOA(5)
   Else
    Chgfmt LINACC5 With "-K:1X"
   Endif
   If GFMTCOA(6)<>""
    Chgfmt LINACC6 With GFMTCOA(6)
   Else
    Chgfmt LINACC6 With "-K:1X"
   Endif
   If GFMTCOA(7)<>""
    Chgfmt LINACC7 With GFMTCOA(7)
   Else
    Chgfmt LINACC7 With "-K:1X"
   Endif
   If GFMTCOA(8)<>""
    Chgfmt LINACC8 With GFMTCOA(8)
   Else
    Chgfmt LINACC8 With "-K:1X"
   Endif
   If GFMTCOA(9)<>""
    Chgfmt LINACC9 With GFMTCOA(9)
   Else
    Chgfmt LINACC9 With "-K:1X"
   Endif
   If GFMTCOA(10)<>""
    Chgfmt LINACC10 With GFMTCOA(10)
   Else
    Chgfmt LINACC10 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask WE2ALL1 [PSH1]
Gosub HORODAT
Local Inpbox "WE2ALL1" From GFONCTION At A_STAMP With A_WINDPREV Mask [PSH1] As [SIM_]
Grizo [PSH1]5
Grizo [PSH1]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [PSH1]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=74 : Y1(0)=1 : Y2(0)=19
X1(1)=1 : X2(1)=74 : Y1(1)=20 : Y2(1)=22
Return

$ON_NBLIG
Onevent CONTROL Call C_NBLIG From W1WE2ALL1
Onevent BEFORE_LINE Call AVANT_NBLIG From W1WE2ALL1
Onevent AFTER_LINE Call APRES_NBLIG From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_NBLIG From W1WE2ALL1
Onevent BEFORE_AREA Call AV_NBLIG From W1WE2ALL1
Return

Subprog IB_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call IB_NBLIG From SUBPSH
Endif
Gosub _AFF
End

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W2WE2ALL1
Endif
Gosub _AFF
End

Subprog AS_NBLIG
Local Decimal BASPAG
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
Call TEXTE(15975,GBOUT2) From OBJDIV
Call TEXTE(15904,GBOUT3) From OBJDIV
Call TEXTE(12580,GBOUT4) From OBJDIV
Call TEXTE(735,GBOUT5) From OBJDIV
Call TEXTE(15331,GBOUT6) From OBJDIV
Call TEXTE(27863,GBOUT7) From OBJDIV
Call TEXTE(29126,GBOUT8) From OBJDIV
Call TEXTE(38447,GBOUT9) From OBJDIV
Call TEXTE(39161,GBOUT10) From OBJDIV
Call TEXTE(49019,GBOUT11) From OBJDIV
Call IB_NBLIG
Onkey 129 Titled GBOUT1 Call B1_NBLIG From W1WE2ALL1
Onkey 130 Titled GBOUT2 Call B2_NBLIG From W1WE2ALL1
Onkey 131 Titled GBOUT3 Call B3_NBLIG From W1WE2ALL1
Onkey 132 Titled GBOUT4 Call B4_NBLIG From W1WE2ALL1
Onkey 133 Titled GBOUT5 Call B5_NBLIG From W1WE2ALL1
Onkey 134 Titled GBOUT6 Call B6_NBLIG From W1WE2ALL1
Onkey 135 Titled GBOUT7 Call B7_NBLIG From W1WE2ALL1
Onkey 136 Titled GBOUT8 Call B8_NBLIG From W1WE2ALL1
Onkey 137 Titled GBOUT9 Call B9_NBLIG From W1WE2ALL1
Onkey 138 Titled GBOUT10 Call B10_NBLIG From W1WE2ALL1
Onkey 139 Titled GBOUT11 Call B11_NBLIG From W1WE2ALL1
Gosub _AFF
End

Subprog C_NBLIG
Local Decimal BASPAG
## Action STD
Call C_NBLIG From SUBPSH
If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
If !mkstat
 ## Action DIVLINCONT
 Call INSERE("PSDLIN") From TABLEAUX
 If mkstat : GERR = 1 : GZONE = "NBLIG" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog B1_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action DIVRECHNAT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "DIVRECHNAT"
 PARMSK(1) = "1"
 PARMSK(2) = num$(nolign-1)
 Call S_AFF_NUM(BASPAG,PARMSK,"DIVRECHNAT","TRTACHDEF1","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action VISBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISBUD"
 PARMSK(1) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = "[M:PSH1]LINACC#"
 PARMSK(4) = "[M:PSH1]CCE#"
 PARMSK(5) = "GDIE(1"
 PARMSK(6) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"VISBUD","TRTVISBUD","") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B2_NBLIG From SUBPSH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action STD
 Call B3_NBLIG From SUBPSH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ACLOB
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ACLOB"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB4_NBLIG" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = [M:PSH1]LINTEX(nolign-1)
 PARMSK(2) = "PSD"
 PARMSK(3) = "TRTX3TEX"
 PARMSK(4) = "PSH1"
 PARMSK(5) = num$(nolign)
 PARMSK(6) = "1"
 Call TRAITE_NUM(BASPAG,PARMSK,"","ACLOB","ACLOB",3,"XYACLOB") From GTRAITE
 [M:PSH1]LINTEX(nolign-1) = PARMSK(1)
 ACTION = "BB4_NBLIG" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog AVANT_NBLIG
Local Decimal BASPAG
## Action STD
Call AVANT_NBLIG From SUBPSH
If mkstat : End : Endif
Gosub _AFF
End

Subprog APRES_NBLIG
Local Decimal BASPAG
## Action STD
Call APRES_NBLIG From SUBPSH
If mkstat : End : Endif
## Action DIVLINNUM
Call LINNUM("PSDLIN") From TABLEAUX
If mkstat : End : Endif
Gosub _AFF
End

Subprog B5_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action GOBJETC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC"
 Call OBJET_CHAR(CMMPRPNUM(nolign-1),"CMM","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B6_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUCLCPRI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCLCPRI"
 PARMSK(1) = "PSH"
 PARMSK(2) = [M:PSH1]CUR(nolign-1)
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 Call SAISIE_NUM(BASPAG,PARMSK,"IDETPRI","TRTPRICE","XWIDETPRI") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B7_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ASIGCHR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ASIGCHR"
 PARMSK(1) = [M:PSH0]PSHNUM
 PARMSK(2) = "PREQUISD/"+[M:PSH0]PSHNUM+"~"+num$([M:PSH1]PSDLIN(nolign-1))
 Call S_TAB_NUM(BASPAG,PARMSK,"SIGCHR","SAIWRKSIG","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B8_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action ASIGCIR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ASIGCIR"
 PARMSK(1) = [M:PSH0]PSHNUM
 PARMSK(2) = "PREQUISD/"+[M:PSH0]PSHNUM+"~"+num$([M:PSH1]PSDLIN(nolign-1))
 Call S_TAB_NUM(BASPAG,PARMSK,"SIGCIR","SAIWRKSIG","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B9_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action CONSPIA
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSPIA"
 PARMSK(1) = "PSH"
 PARMSK(2) = [M:PSH0]PSHNUM
 PARMSK(3) = num$([M:PSH1]PSDLIN(nolign-1))
 Call CONSULT_NUM(BASPAG,"PIA",PARMSK) From GCONSULT
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B10_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action VISUETAPS2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUETAPS2"
 PARMSK(1) = [M:PSH0]PSHNUM
 PARMSK(2) = num$([M]PSDLIN(nolign-1))
 PARMSK(3) = "PSH1"
 PARMSK(4) = num$(nolign-1)
 Call SAISIE_NUM(BASPAG,PARMSK,"IPDSYPSH2","SUBLIND","SPEPSH") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B11_NBLIG
Local Decimal BASPAG
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = [M:PSH1]ITMREF(nolign-1)
 PARMSK(2) = "ITMREF"
 Call TRAITE_NUM(BASPAG,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1WE2ALL1
Onevent INIT_AREA Call D_ITMREF(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1WE2ALL1
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
If !GWEBSERV
 ## Action STD
 Call IB_ITMREF From SUBPSH
Endif
Gosub _AFF
End

Subprog D_ITMREF(VALEUR)
Variable Char    VALEUR()
If varinit([M]ITMREF,indice)=0
 ## Action PJTINIBATA
 Call PJT_INIBATA(nolign-1,"[M:PSH0]PJTH","[M:PSH1]PJT") From TRTPJT
Endif
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(11832,GBOUT2) From OBJDIV
Call TEXTE(15921,GBOUT3) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
## Action STD
Call AS_ITMREF(VALEUR) From SUBPSH
If mkstat=2
 [M]ITMREF(INDIC) = VALEUR
 Affzo ITMREF(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMREF(zc) From W1WE2ALL1
Onkey 130 Titled GBOUT2 Call B2_ITMREF(zc) From W1WE2ALL1
Onkey 131 Titled GBOUT3 Call B3_ITMREF(zc) From W1WE2ALL1
Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action ITMCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "ITMCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","AB",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action CTLPCOITMR
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "CTLPCOITMR"
   Call S_AFF_CHAR(VALEUR,PARMSK,"CTLPCOITMR","TRTACHCTL1","") From GACTION
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
   If !mkstat
    ## Action STD
    Call C_ITMREF(VALEUR) From SUBPSH
    If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action DIVPSHITM
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "DIVPSHITM"
Call S_AFF_CHAR(VALEUR,PARMSK,"DIVPSHITM","TRTACHPSH1","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !mkstat
 ## Action STD
 Call AM_ITMREF(VALEUR) From SUBPSH
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !GWEBSERV
  If !mkstat
   ## Action SAIPECB3
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "SAIPECB3"
   PARMSK(1) = [M:PSH1]BPSNUM(nolign-1)
   PARMSK(2) = VALEUR
   PARMSK(3) = ""
   PARMSK(4) = num$([M:PSH1]QTYPUU(nolign-1))
   PARMSK(5) = [M:PSH1]PUU(nolign-1)
   PARMSK(6) = "1"
   PARMSK(7) = "PSH"
   Call SAISIE_CHAR(VALEUR,PARMSK,"IPPICORD1","TRTACHPSH1","XWIPPICORD1") From GSAISIE
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action NOTE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "NOTE"
  PARMSK(1) = VALEUR
  PARMSK(2) = "ITMREF"
  Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action INIECCSTA
 Call INIECCSTA(VALEUR,"PSH1",nolign-1) From STKECR
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPITMREF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPITMREF"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPITMREF","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREF(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPPH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPPH"
 PARMSK(1) = "1"
 PARMSK(2) = [M:PSH1]BPSNUM(nolign-1)
 PARMSK(3) = VALEUR
 PARMSK(4) = num$(nolign)
 PARMSK(5) = "PSH1"
 PARMSK(6) = ""
 PARMSK(7) = "PSH0"
 Call SAISIE_CHAR(VALEUR,PARMSK,"IPPHW","TRTACHPIC1","XWIPPHW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action VISUDETPOH
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUDETPOH"
 Call SAISIE_CHAR(VALEUR,PARMSK,"DPOPW","TRTACHFEN1","XWDPOPW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ITMDES
Onevent BEFORE_INPUT Call AS_ITMDES(zc) From W1WE2ALL1
Return

Subprog IB_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMDES From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_ITMDES(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15994,GBOUT1) From OBJDIV
Call IB_ITMDES(VALEUR)
## Action STD
Call AS_ITMDES(VALEUR) From SUBPSH
If mkstat=2
 [M]ITMDES(INDIC) = VALEUR
 Affzo ITMDES(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMDES(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog B1_ITMDES(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNPSHITM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "TUNPSHITM"
 Local Char    OBJCLE(30)
 OBJCLE = [M:PSH1]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action LECPSHITM
 Call LECPSHITM From SUBPSH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMDES1
Onevent BEFORE_INPUT Call AS_ITMDES1(zc) From W1WE2ALL1
Return

Subprog IB_ITMDES1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_ITMDES1 From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_ITMDES1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15994,GBOUT1) From OBJDIV
Call IB_ITMDES1(VALEUR)
## Action STD
Call AS_ITMDES1(VALEUR) From SUBPSH
If mkstat=2
 [M]ITMDES1(INDIC) = VALEUR
 Affzo ITMDES1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMDES1(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog B1_ITMDES1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNPSHITM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "TUNPSHITM"
 Local Char    OBJCLE(30)
 OBJCLE = ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ITM","") From GOBJET
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action LECPSHITM
 Call LECPSHITM From SUBPSH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PRHFCY
Onevent CONTROL Call C_PRHFCY(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_PRHFCY(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_PRHFCY From W1WE2ALL1
Return

Subprog IB_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_PRHFCY From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12817,GBOUT3) From OBJDIV
Call TEXTE(454,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PRHFCY(VALEUR)
## Action STD
Call AS_PRHFCY(VALEUR) From SUBPSH
If mkstat=2
 [M]PRHFCY(INDIC) = VALEUR
 Affzo PRHFCY(INDIC) : mkstat = 2
Endif
Onkey 131 Titled GBOUT3 Call B3_PRHFCY(zc) From W1WE2ALL1
Onkey 132 Titled GBOUT4 Call B4_PRHFCY(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_PRHFCY(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_PRHFCY(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_PRHFCY(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_PRHFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
 If !mkstat
  ## Action CTLPRHFCY
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CTLPRHFCY"
  PARMSK(1) = [M:PSH1]ITMREF (nolign-1)
  Call S_AFF_CHAR(VALEUR,PARMSK,"CTLPRHFCY","TRTACHCTL1","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PRHFCY
Call AM_PRHFCY(zc)
If !mkstat & GOBJET
 zoncou = "PRHFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRHFCY(VALEUR)
Variable Char    VALEUR()
## Action TRTPRHFCY
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "TRTPRHFCY"
PARMSK(1) = [M:PSH1]ITMREF (nolign-1)
Call TRAITE_CHAR(VALEUR,PARMSK,"","TRTACHCTL1","",1,"XYTRTACHCTL1") From GTRAITE
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
If !mkstat
 ## Action GOBJETC0A
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0A"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AAM_PRHFCY" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = VALEUR
 Call OBJET_CHAR(OBJCLE,WOBJET,[M:PSH1]ITMREF(nolign-1)) From GOBJET
 ACTION = "BAM_PRHFCY" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
 If !mkstat
  ## Action STD
  Call AM_PRHFCY(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "PRHFCY" : GZNUM = 5102 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPRHFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPRHFCY"
 PARMSK(1) = num$([F:ITM]STOMGTCOD)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPRHFCY","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B3_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_PRHFCY" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = VALEUR
 PARMSK(3) = [M:PSH1]ITMREF (nolign-1)
 PARMSK(4) = ""
 Call CONSULT_CHAR(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB3_PRHFCY" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PRHFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPITMFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPITMFCY"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPITMFCY","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PRHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_EXTRCPDAT
Onevent BEFORE_INPUT Call AS_EXTRCPDAT(zc) From W1WE2ALL1
Onevent CONTROL Call C_EXTRCPDAT(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_EXTRCPDAT From W1WE2ALL1
Onevent BEFORE_AREA Gosub AV_EXTRCPDAT From W1WE2ALL1
Return

$AV_EXTRCPDAT
Chgfmt [M]EXTRCPDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_EXTRCPDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_EXTRCPDAT(VALEUR) From SUBPSH
If mkstat=2
 [M]EXTRCPDAT(INDIC) = VALEUR
 Affzo EXTRCPDAT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_EXTRCPDAT(VALEUR)
Variable Date    VALEUR
## Action %OBLIG
If VALEUR=[0/0/0]
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "EXTRCPDAT" : GZNUM = 5336 : Endif
If !mkstat
 ## Action CTLJOU2
 Call CTL_JOU2(VALEUR,[M:PSH0]PRQDAT,[F:FCY]UVYDAY,[F:FCY]UVYCOD,1) From CONTX3
 If mkstat : GERR = 1 : GZONE = "EXTRCPDAT" : GZNUM = 5336 : Endif
Endif
Gosub _AFF
End

$AMM_EXTRCPDAT
Call AM_EXTRCPDAT(zc)
If !mkstat & GOBJET
 zoncou = "EXTRCPDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTRCPDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_EXTRCPDAT(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "EXTRCPDAT" : GZNUM = 5336 : Endif
Gosub _AFF
End

$ON_PUU
Onevent BEFORE_INPUT Call AS_PUU(zc) From W1WE2ALL1
Onevent CONTROL Call C_PUU(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_PUU From W1WE2ALL1
Return

Subprog AS_PUU(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3612,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_PUU(VALEUR) From SUBPSH
If mkstat=2
 [M]PUU(INDIC) = VALEUR
 Affzo PUU(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PUU(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_PUU(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_PUU(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_PUU(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_PUU(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TUN","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PUU" : GZNUM = 1857 : Endif
If !mkstat
 ## Action PCOUOM
 Call PCOUOM(VALEUR,[M]BPSNUM(nolign-1),[M]ITMREF (nolign-1),3,5) From TRTACHCTL1
 If mkstat : GERR = 1 : GZONE = "PUU" : GZNUM = 1857 : Endif
Endif
Gosub _AFF
End

$AMM_PUU
Call AM_PUU(zc)
If !mkstat & GOBJET
 zoncou = "PUU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PUU(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_PUU(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "PUU" : GZNUM = 1857 : Endif
Gosub _AFF
End

Subprog S_PUU(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPUOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPUOM"
 PARMSK(1) = [M]BPSNUM(nolign-1)
 PARMSK(2) = [M]ITMREF (nolign-1)
 PARMSK(3) = "3"
 PARMSK(4) = "5"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELPUOM","TRTACHSEL1","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PUU(VALEUR)
Variable Char    VALEUR()
Call OBJET("TUN",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_PUU(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TUN"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PUU(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TUN",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_QTYPUU
Onevent BEFORE_AREA Gosub AV_QTYPUU From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_QTYPUU(zc) From W1WE2ALL1
Onevent CONTROL Call C_QTYPUU(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_QTYPUU From W1WE2ALL1
Return

Subprog IB_QTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_QTYPUU From SUBPSH
Endif
Gosub _AFF
End

$AV_QTYPUU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]PUU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYPUU(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_QTYPUU(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12817,GBOUT3) From OBJDIV
Call IB_QTYPUU(VALEUR)
## Action STD
Call AS_QTYPUU(VALEUR) From SUBPSH
If mkstat=2
 [M]QTYPUU(INDIC) = VALEUR
 Affzo QTYPUU(INDIC) : mkstat = 2
Endif
Onkey 131 Titled GBOUT3 Call B3_QTYPUU(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_QTYPUU(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
If !mkstat
 ## Action STD
 Call C_QTYPUU(VALEUR) From SUBPSH
 If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
Endif
Gosub _AFF
End

$AMM_QTYPUU
Call AM_QTYPUU(zc)
If !mkstat & GOBJET
 zoncou = "QTYPUU" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_QTYPUU(VALEUR)
Variable Decimal VALEUR
## Action PCALQTY
Call PCAL_QTY(VALEUR,[M]PUU (nolign-1),[M]QTYSTU (nolign-1),[M]STU (nolign-1),[M]ITMREF (nolign-1),[M]BPSNUM (nolign-1),1,GBIDD1) From TRTACHQTE1
If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
If !mkstat
 ## Action STD
 Call AM_QTYPUU(VALEUR) From SUBPSH
 If mkstat : GERR = 1 : GZONE = "QTYPUU" : GZNUM = 2540 : Endif
Endif
Gosub _AFF
End

Subprog B3_QTYPUU(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action CONSSFC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONSSFC"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB3_QTYPUU" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 PARMSK(1) = "0"
 PARMSK(2) = [M]PRHFCY (nolign-1)
 PARMSK(3) = [M]ITMREF (nolign-1)
 PARMSK(4) = ""
 Call CONSULT_NUM(VALEUR,"SFC",PARMSK) From GCONSULT
 ACTION = "BB3_QTYPUU" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_QTYPUUOLD
Onevent BEFORE_AREA Gosub AV_QTYPUUOLD From W1WE2ALL1
Return

$AV_QTYPUUOLD
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]PUU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_STU
Return

$ON_QTYSTU
Onevent BEFORE_AREA Gosub AV_QTYSTU From W1WE2ALL1
Return

$AV_QTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]QTYSTU(indice) With "NP+z:"+GUNTFMT
Gosub _AFF
Return

$ON_QTYSTUOLD
Onevent BEFORE_AREA Gosub AV_QTYSTUOLD From W1WE2ALL1
Return

$AV_QTYSTUOLD
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
Gosub _AFF
Return

$ON_BPSNUM
Onevent CONTROL Call C_BPSNUM(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_BPSNUM(zc) From W1WE2ALL1
Onevent AFTER_AREA Call AP_BPSNUM(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_BPSNUM From W1WE2ALL1
Return

Subprog IB_BPSNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STD
 Call IB_BPSNUM From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_BPSNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1515,GBOUT1) From OBJDIV
Call TEXTE(16086,GBOUT2) From OBJDIV
Call TEXTE(16098,GBOUT3) From OBJDIV
Call TEXTE(49041,GBOUT4) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_BPSNUM(VALEUR)
## Action STD
Call AS_BPSNUM(VALEUR) From SUBPSH
If mkstat=2
 [M]BPSNUM(INDIC) = VALEUR
 Affzo BPSNUM(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_BPSNUM(zc) From W1WE2ALL1
Onkey 130 Titled GBOUT2 Call B2_BPSNUM(zc) From W1WE2ALL1
Onkey 131 Titled GBOUT3 Call B3_BPSNUM(zc) From W1WE2ALL1
Onkey 132 Titled GBOUT4 Call B4_BPSNUM(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_BPSNUM(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_BPSNUM(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_BPSNUM(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_BPSNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPSCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPSCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPSCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPS","!AB",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
 If !mkstat
  ## Action CTLBPRCPY
  Call CTLBPRCPY(VALEUR,[M:PSH0]PSHFCY) From CONTX3
  If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
  If !mkstat
   ## Action STD
   Call C_BPSNUM(VALEUR) From SUBPSH
   If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_BPSNUM(VALEUR)
Variable Char    VALEUR()
## Action STKINIECC
Call STKINIECC([M:PSH1]ITMREF(nolign-1),"","PSH1",1,2,nolign-1,2,func TRTX3FNC.VALFLD_C("[M:PSH1]ECCVALMAJ(nolign-1)")
&,"ECCVALMAJ","ECCVALMIN","","",1,VALEUR) From STKACT
If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
Gosub _AFF
End

$AMM_BPSNUM
Call AM_BPSNUM(zc)
If !mkstat & GOBJET
 zoncou = "BPSNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPSNUM(VALEUR)
Variable Char    VALEUR()
## Action PAMBPSNUM
Call AM_BPSNUM(VALEUR) From TRTACHCTL1
If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
If !mkstat
 ## Action STD
 Call AM_BPSNUM(VALEUR) From SUBPSH
 If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
 If !GWEBSERV
  If !mkstat
   ## Action NOTE
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "NOTE"
   PARMSK(1) = VALEUR
   PARMSK(2) = "BPSNUM"
   Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "BPSNUM" : GZNUM = 3680 : Endif
  Endif
 Endif
Endif
If !mkstat & evalue("dim("+clanam([M])+"ZBPSNUM)")>indice
 [M]BPSNUM(indice) = VALEUR
 Affzo ZBPSNUM(indice)
Endif
Gosub _AFF
End

Subprog S_BPSNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPS"
PARMSK(2) = "!AB"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPSNUM(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPS",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_BPSNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPSITM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPSITM"
 PARMSK(1) = [M:PSH1]ITMREF(nolign-1)
 Call SAISIE_CHAR(VALEUR,PARMSK,"IITPW","TRTACHSEL1","XWIITPW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_BPSNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action VISUPLP2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUPLP2"
 PARMSK(1) = VALEUR
 PARMSK(2) = [M:PSH1]ITMREF(nolign-1)
 Call SAISIE_CHAR(VALEUR,PARMSK,"IPLP2","TRTACHFEN1","XWIPLP2") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_BPSNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = VALEUR
 PARMSK(2) = "BPSNUM"
 Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BPSNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPS"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPSNUM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPS",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPSNUM
Onevent BEFORE_AREA Gosub AV_ZBPSNUM From W1WE2ALL1
Return

$AV_ZBPSNUM
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LECTURE("BPS",num$([M]BPSNUM(indice)),"") From CONTOBJ
zc = [F:BPS]BPSNAM
Gosub _AFF
Return

$ON_LAN
Return

$ON_ECCVALMAJ
Onevent CONTROL Call C_ECCVALMAJ(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_ECCVALMAJ From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_ECCVALMAJ(zc) From W1WE2ALL1
Return

Subprog AS_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(735,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ECCVALMAJ(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_ECCVALMAJ(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STKCTRECC
Call STKCTRECC([M:PSH1]ITMREF(nolign-1),VALEUR,"","",3) From STKACT
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

$AMM_ECCVALMAJ
Call AM_ECCVALMAJ(zc)
If !mkstat & GOBJET
 zoncou = "ECCVALMAJ" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ECCVALMAJ(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

Subprog S_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELMAJ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELMAJ"
 PARMSK(1) = [M:PSH1]ITMREF(nolign-1)
 PARMSK(2) = ""
 PARMSK(3) = "PSH1"
 PARMSK(4) = num$(nolign-1)
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELMAJ","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GOBJETC0B
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GOBJETC0B"
 Local Char ACTION(20), PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
 ACTION = "AB1_ECCVALMAJ" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 Local Char    OBJCLE(30)
 OBJCLE = [M:PSH1]ITMREF(nolign-1)
 Call OBJET_CHAR(OBJCLE,"ECS","[M:PSH1]ECCVALMAJ(nolign-1)") From GOBJET
 ACTION = "BB1_ECCVALMAJ" : PROGSUB = "SUBPSH" : PROGSPE = "SPEPSH" : PROGSPV = ""
 Gosub ACTSUB From GOBJSUB
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ECCVALMIN
Onevent BEFORE_INPUT Call AS_ECCVALMIN(zc) From W1WE2ALL1
Onevent CONTROL Call C_ECCVALMIN(zc) From W1WE2ALL1
Return

Subprog AS_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(44284,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
If !GWEBSERV
 ## Action STKASMIN
 Call STKASMIN([M:PSH1]ECCVALMAJ(nolign-1)) From STKACT
 If mkstat=2
  [M]ECCVALMIN(INDIC) = VALEUR
  Affzo ECCVALMIN(INDIC) : mkstat = 2
 Endif
Endif
Onkey 129 Titled GBOUT1 Call B1_ECCVALMIN(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_ECCVALMIN(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
## Action STKCTRECC
Call STKCTRECC([M:PSH1]ITMREF(nolign-1),[M:PSH1]ECCVALMAJ(nolign-1),VALEUR,"",4) From STKACT
If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
Gosub _AFF
End

Subprog S_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action STKSELMIN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "STKSELMIN"
 PARMSK(1) = [M:PSH1]ITMREF(nolign-1)
 PARMSK(2) = [M:PSH1]ECCVALMAJ(nolign-1)
 PARMSK(3) = "PSH1"
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "4"
 Call S_TAB_CHAR(VALEUR,PARMSK,"STKSELMIN","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ECCVAL"
 PARMSK(1) = [M:PSH1]ITMREF(nolign-1)
 PARMSK(2) = "4"
 PARMSK(3) = [M:PSH1]ECCVALMAJ(nolign-1)
 Call SAISIE_CHAR(VALEUR,PARMSK,"FECCVAL","ECCVAL","SPEECCVAL") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1WE2ALL1
Onevent CONTROL Call C_PJT(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_PJT From W1WE2ALL1
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
&,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
&,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
If !mkstat
 ## Action STD
 Call AS_PJT(VALEUR) From SUBPSH
 If mkstat=2
  [M]PJT(INDIC) = VALEUR
  Affzo PJT(INDIC) : mkstat = 2
 Endif
 Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1WE2ALL1
 Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1WE2ALL1
 Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1WE2ALL1
 Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1WE2ALL1
 Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1WE2ALL1
 Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1WE2ALL1
 Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1WE2ALL1
 Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1WE2ALL1
 Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1WE2ALL1
 Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1WE2ALL1
 Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1WE2ALL1
 Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1WE2ALL1
Endif
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
&,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
&,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJT(VALEUR) From SUBPSH
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
& ,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
& ,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
& ,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"PSH1","PJT",nolign-1,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:PSH0]PSHFCY,""
& ,"","[M:PSH0]PJTH","",func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "PSH1"
 PARMSK(2) = "PJT"
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:PSH0]PSHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = "[M:PSH0]PJTH"
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:PSH0]PSHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_EXTORDDAT
Onevent BEFORE_AREA Gosub AV_EXTORDDAT From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_EXTORDDAT(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_EXTORDDAT From W1WE2ALL1
Return

$AV_EXTORDDAT
## Action STD
Call AV_EXTORDDAT(zc) From SUBPSH
Chgfmt [M]EXTORDDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_EXTORDDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_EXTORDDAT(VALEUR) From SUBPSH
If mkstat=2
 [M]EXTORDDAT(INDIC) = VALEUR
 Affzo EXTORDDAT(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

$AMM_EXTORDDAT
Call AM_EXTORDDAT(zc)
If !mkstat & GOBJET
 zoncou = "EXTORDDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTORDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_EXTORDDAT(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "EXTORDDAT" : GZNUM = 5334 : Endif
Gosub _AFF
End

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_NETPRI(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_NETPRI From W1WE2ALL1
Onevent CONTROL Call C_NETPRI(zc) From W1WE2ALL1
Return

Subprog IB_NETPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call IB_NETPRI From SUBPSH
Endif
Gosub _AFF
End

$AV_NETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
## Action STD
Call AV_NETPRI(zc) From SUBPSH
Gosub _AFF
Return

Subprog AS_NETPRI(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(7958,GBOUT1) From OBJDIV
Call TEXTE(16100,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
Call TEXTE(15331,GBOUT4) From OBJDIV
Call IB_NETPRI(VALEUR)
## Action STD
Call AS_NETPRI(VALEUR) From SUBPSH
If mkstat=2
 [M]NETPRI(INDIC) = VALEUR
 Affzo NETPRI(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_NETPRI(zc) From W1WE2ALL1
Onkey 130 Titled GBOUT2 Call B2_NETPRI(zc) From W1WE2ALL1
Onkey 131 Titled GBOUT3 Call B3_NETPRI(zc) From W1WE2ALL1
Onkey 132 Titled GBOUT4 Call B4_NETPRI(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_NETPRI(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_NETPRI
Call AM_NETPRI(zc)
If !mkstat & GOBJET
 zoncou = "NETPRI" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_NETPRI(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_NETPRI(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "NETPRI" : GZNUM = 2619 : Endif
Gosub _AFF
End

Subprog B1_NETPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUPPV
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUPPV"
 PARMSK(1) = [M:PSH0]PRQDAT
 PARMSK(2) = [M:PSH1]ITMREF(nolign-1)
 PARMSK(3) = [M:PSH1]BPSNUM(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPPV","FUNACHPPV","XWIPPV") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_NETPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SAIREMFRS
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SAIREMFRS"
 PARMSK(1) = "PSH1"
 PARMSK(2) = num$(nolign-1)
 Call SAISIE_NUM(VALEUR,PARMSK,"IPURPRICE","TRTACHPRI1","XWIPURPRICE") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_NETPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B3_NETPRI(VALEUR) From SUBPSH
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_NETPRI(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action VISUCLCPRI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VISUCLCPRI"
 PARMSK(1) = "PSH"
 PARMSK(2) = [M:PSH1]CUR(nolign-1)
 PARMSK(3) = num$(nolign-1)
 PARMSK(4) = "2"
 Call SAISIE_NUM(VALEUR,PARMSK,"IDETPRI","TRTPRICE","XWIDETPRI") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_LINAMT
Onevent BEFORE_AREA Gosub AV_LINAMT From W1WE2ALL1
Return

$AV_LINAMT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR(nolign-1),GDEVISE(1..GNBDEV)),1))
Chgfmt [M]LINAMT(indice) With "NPz3:"+GDEVFMT
Gosub _AFF
Return

$ON_LINAMTOLD
Onevent BEFORE_AREA Gosub AV_LINAMTOLD From W1WE2ALL1
Return

$AV_LINAMTOLD
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M]CUR(nolign-1),GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_VACBPR
Return

$ON_CHGTYP
Onevent INIT_AREA Call D_CHGTYP(zc) From W1WE2ALL1
Return

Subprog D_CHGTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]CHGTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CUR
Return

$ON_LINACC1
Onevent BEFORE_AREA Gosub AV_LINACC1 From W1WE2ALL1
Onevent CONTROL Call C_LINACC1(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC1(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC1 From W1WE2ALL1
Return

$AV_LINACC1
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
If GFMTCOA(1)<>""
 Chgfmt [M]LINACC1(indice) With GFMTCOA(1)
Else
 Chgfmt [M]LINACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC1(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC1(INDIC) = VALEUR
 Affzo LINACC1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC1(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC1(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC1(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC1(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(1))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC1(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC1
Call AM_LINACC1(zc)
If !mkstat & GOBJET
 zoncou = "LINACC1" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC1(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC1(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC1" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC1(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(1))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(1))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC2
Onevent BEFORE_AREA Gosub AV_LINACC2 From W1WE2ALL1
Onevent CONTROL Call C_LINACC2(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC2(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC2 From W1WE2ALL1
Return

$AV_LINACC2
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
If GFMTCOA(2)<>""
 Chgfmt [M]LINACC2(indice) With GFMTCOA(2)
Else
 Chgfmt [M]LINACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC2(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC2(INDIC) = VALEUR
 Affzo LINACC2(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC2(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC2(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC2(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC2(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(2))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC2(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC2
Call AM_LINACC2(zc)
If !mkstat & GOBJET
 zoncou = "LINACC2" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC2(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC2(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC2" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(2)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC2(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(2))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(2))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC3
Onevent BEFORE_AREA Gosub AV_LINACC3 From W1WE2ALL1
Onevent CONTROL Call C_LINACC3(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC3(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC3 From W1WE2ALL1
Return

$AV_LINACC3
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
If GFMTCOA(3)<>""
 Chgfmt [M]LINACC3(indice) With GFMTCOA(3)
Else
 Chgfmt [M]LINACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC3(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC3(INDIC) = VALEUR
 Affzo LINACC3(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC3(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC3(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC3(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC3(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(3))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(3))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(3)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC3(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC3
Call AM_LINACC3(zc)
If !mkstat & GOBJET
 zoncou = "LINACC3" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC3(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC3(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC3" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC3(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(3)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC3(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(3))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(3))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC3(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(3))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC4
Onevent BEFORE_AREA Gosub AV_LINACC4 From W1WE2ALL1
Onevent CONTROL Call C_LINACC4(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC4(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC4 From W1WE2ALL1
Return

$AV_LINACC4
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
If GFMTCOA(4)<>""
 Chgfmt [M]LINACC4(indice) With GFMTCOA(4)
Else
 Chgfmt [M]LINACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC4(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC4(INDIC) = VALEUR
 Affzo LINACC4(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC4(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC4(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC4(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC4(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(4))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(4))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(4)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC4(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC4
Call AM_LINACC4(zc)
If !mkstat & GOBJET
 zoncou = "LINACC4" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC4(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC4(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC4" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC4(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(4)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC4(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(4))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(4))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC4(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(4))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC5
Onevent BEFORE_AREA Gosub AV_LINACC5 From W1WE2ALL1
Onevent CONTROL Call C_LINACC5(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC5(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC5 From W1WE2ALL1
Return

$AV_LINACC5
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
If GFMTCOA(5)<>""
 Chgfmt [M]LINACC5(indice) With GFMTCOA(5)
Else
 Chgfmt [M]LINACC5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC5(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC5(INDIC) = VALEUR
 Affzo LINACC5(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC5(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC5(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC5(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC5(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(5))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(5))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(5)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC5(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC5
Call AM_LINACC5(zc)
If !mkstat & GOBJET
 zoncou = "LINACC5" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC5(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC5(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC5" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC5(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(5)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC5(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(5))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(5))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC5(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(5))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC6
Onevent BEFORE_AREA Gosub AV_LINACC6 From W1WE2ALL1
Onevent CONTROL Call C_LINACC6(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC6(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC6 From W1WE2ALL1
Return

$AV_LINACC6
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(6))) From SETGLBCOA
If GFMTCOA(6)<>""
 Chgfmt [M]LINACC6(indice) With GFMTCOA(6)
Else
 Chgfmt [M]LINACC6(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC6(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC6(INDIC) = VALEUR
 Affzo LINACC6(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC6(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC6(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC6(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC6(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(6))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(6))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(6)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC6(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC6
Call AM_LINACC6(zc)
If !mkstat & GOBJET
 zoncou = "LINACC6" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC6(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC6(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC6" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC6(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(6)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC6(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(6))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(6))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC6(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(6))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC7
Onevent BEFORE_AREA Gosub AV_LINACC7 From W1WE2ALL1
Onevent CONTROL Call C_LINACC7(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC7(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC7 From W1WE2ALL1
Return

$AV_LINACC7
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(7))) From SETGLBCOA
If GFMTCOA(7)<>""
 Chgfmt [M]LINACC7(indice) With GFMTCOA(7)
Else
 Chgfmt [M]LINACC7(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC7(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC7(INDIC) = VALEUR
 Affzo LINACC7(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC7(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC7(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC7(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC7(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(7))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(7))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(7)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC7(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC7
Call AM_LINACC7(zc)
If !mkstat & GOBJET
 zoncou = "LINACC7" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC7(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC7(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC7" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC7(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(7)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC7(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(7))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(7))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC7(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(7))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC8
Onevent BEFORE_AREA Gosub AV_LINACC8 From W1WE2ALL1
Onevent CONTROL Call C_LINACC8(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC8(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC8 From W1WE2ALL1
Return

$AV_LINACC8
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(8))) From SETGLBCOA
If GFMTCOA(8)<>""
 Chgfmt [M]LINACC8(indice) With GFMTCOA(8)
Else
 Chgfmt [M]LINACC8(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC8(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC8(INDIC) = VALEUR
 Affzo LINACC8(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC8(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC8(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC8(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC8(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(8))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(8))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(8)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC8(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC8
Call AM_LINACC8(zc)
If !mkstat & GOBJET
 zoncou = "LINACC8" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC8(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC8(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC8" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC8(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(8)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC8(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(8))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(8))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC8(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(8))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC9
Onevent BEFORE_AREA Gosub AV_LINACC9 From W1WE2ALL1
Onevent CONTROL Call C_LINACC9(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC9(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC9 From W1WE2ALL1
Return

$AV_LINACC9
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(9))) From SETGLBCOA
If GFMTCOA(9)<>""
 Chgfmt [M]LINACC9(indice) With GFMTCOA(9)
Else
 Chgfmt [M]LINACC9(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC9(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC9(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC9(INDIC) = VALEUR
 Affzo LINACC9(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC9(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC9(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC9(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC9(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC9(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(9))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC9" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(9))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC9" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(9)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC9" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC9(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC9" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC9
Call AM_LINACC9(zc)
If !mkstat & GOBJET
 zoncou = "LINACC9" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC9(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC9(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC9" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC9(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(9)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC9(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(9))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC9(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(9))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC9(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(9))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINACC10
Onevent BEFORE_AREA Gosub AV_LINACC10 From W1WE2ALL1
Onevent CONTROL Call C_LINACC10(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINACC10(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINACC10 From W1WE2ALL1
Return

$AV_LINACC10
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(10))) From SETGLBCOA
If GFMTCOA(10)<>""
 Chgfmt [M]LINACC10(indice) With GFMTCOA(10)
Else
 Chgfmt [M]LINACC10(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog AS_LINACC10(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6127,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_LINACC10(VALEUR) From SUBPSH
If mkstat=2
 [M]LINACC10(INDIC) = VALEUR
 Affzo LINACC10(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_LINACC10(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_LINACC10(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_LINACC10(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_LINACC10(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_LINACC10(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action GACCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "GACCHOICE"
 PARMSK(1) = num$(GCOA(10))
 Call S_TAB_CHAR(VALEUR,PARMSK,"GACCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "LINACC10" : GZNUM = 0 : Endif
Endif
If !GWEBSERV
 If !mkstat
  ## Action CONTCPT
  Call CONTCPT(VALEUR,num$(GCOA(10))) From CPTSUB
  If mkstat : GERR = 1 : GZONE = "LINACC10" : GZNUM = 0 : Endif
 Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("GAC","!",VALEUR,num$(GCOA(10)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "LINACC10" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_LINACC10(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "LINACC10" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_LINACC10
Call AM_LINACC10(zc)
If !mkstat & GOBJET
 zoncou = "LINACC10" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINACC10(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_LINACC10(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINACC10" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_LINACC10(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAC"
 PARMSK(1) = GCOA(10)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GCOA(1"
 PARMSK(6) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAC","SELGAC","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_LINACC10(VALEUR)
Variable Char    VALEUR()
Call OBJET("GAC",VALEUR,num$(GCOA(10))) From GOBJET
Gosub _AFF
End

Subprog SA_LINACC10(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GAC"
PARMSK(2) = num$(GCOA(10))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_LINACC10(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GCOA(10))
Call VISU("GAC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_LINPURTYP
Onevent INIT_AREA Call D_LINPURTYP(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_LINPURTYP(zc) From W1WE2ALL1
Onevent AFTER_CHANGE Gosub AMM_LINPURTYP From W1WE2ALL1
Onevent CONTROL Call C_LINPURTYP(zc) From W1WE2ALL1
Return

Subprog D_LINPURTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]LINPURTYP,indice)=0
 VALEUR = 1
 ## Action STD
 Call D_LINPURTYP(VALEUR) From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_LINPURTYP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_LINPURTYP(VALEUR) From SUBPSH
If mkstat=2
 [M]LINPURTYP(INDIC) = VALEUR
 Affzo LINPURTYP(INDIC) : mkstat = 2
Endif
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog C_LINPURTYP(VALEUR)
Variable Integer VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "LINPURTYP" : GZNUM = 2507 : Endif
Gosub _AFF
End

$AMM_LINPURTYP
Call AM_LINPURTYP(zc)
If !mkstat & GOBJET
 zoncou = "LINPURTYP" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_LINPURTYP(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_LINPURTYP(VALEUR) From SUBPSH
If mkstat : GERR = 1 : GZONE = "LINPURTYP" : GZNUM = 2507 : Endif
Gosub _AFF
End

$ON_CCE1
Onevent BEFORE_AREA Gosub AV_CCE1 From W1WE2ALL1
Onevent CONTROL Call C_CCE1(zc) From W1WE2ALL1
Onevent INIT_AREA Call D_CCE1(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_CCE1(zc) From W1WE2ALL1
Return

$AV_CCE1
## Action INICCEFMT
Call INICCEFMT(num$(GDIE(1))) From SETGLBDIE
If GFMTDIE(1)<>""
 Chgfmt [M]CCE1(indice) With GFMTDIE(1)
Else
 Chgfmt [M]CCE1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE1(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE1,indice)=0
 ## Action STD
 Call D_CCE1(VALEUR) From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_CCE1(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_CCE1(VALEUR) From SUBPSH
If mkstat=2
 [M]CCE1(INDIC) = VALEUR
 Affzo CCE1(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_CCE1(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_CCE1(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_CCE1(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_CCE1(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_CCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$(GDIE(1))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$(GDIE(1)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE1(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "CCE1" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CCE1(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELCCE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCE"
 PARMSK(1) = GDIE(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GDIE(1"
 PARMSK(6) = "[M:PSH1]CCE#"
 PARMSK(7) = "GCOA(1"
 PARMSK(8) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action SELCCEGDD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCEGDD"
 PARMSK(1) = GDIE(1)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GDIE(1"
 PARMSK(6) = "[M:PSH1]CCE#"
 PARMSK(7) = "GCOA(1"
 PARMSK(8) = "[M:PSH1]LINACC#"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE1(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$(GDIE(1))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$(GDIE(1))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE1(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GDIE(1))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_CCE2
Onevent BEFORE_AREA Gosub AV_CCE2 From W1WE2ALL1
Onevent CONTROL Call C_CCE2(zc) From W1WE2ALL1
Onevent INIT_AREA Call D_CCE2(zc) From W1WE2ALL1
Onevent BEFORE_INPUT Call AS_CCE2(zc) From W1WE2ALL1
Return

$AV_CCE2
## Action INICCEFMT
Call INICCEFMT(num$(GDIE(2))) From SETGLBDIE
If GFMTDIE(2)<>""
 Chgfmt [M]CCE2(indice) With GFMTDIE(2)
Else
 Chgfmt [M]CCE2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

Subprog D_CCE2(VALEUR)
Variable Char    VALEUR()
If varinit([M]CCE2,indice)=0
 ## Action STD
 Call D_CCE2(VALEUR) From SUBPSH
Endif
Gosub _AFF
End

Subprog AS_CCE2(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(3531,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_CCE2(VALEUR) From SUBPSH
If mkstat=2
 [M]CCE2(INDIC) = VALEUR
 Affzo CCE2(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_CCE2(zc) From W1WE2ALL1
Onkey   2 Titled GBOUTS Call S_CCE2(zc) From W1WE2ALL1
Onkey 144 Titled GBOUTP Call P_CCE2(zc) From W1WE2ALL1
Onkey 146 Titled GBOUTA Call SA_CCE2(zc) From W1WE2ALL1
Gosub _AFF
End

Subprog C_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CCECHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CCECHOICE"
 PARMSK(1) = num$(GDIE(2))
 Call S_TAB_CHAR(VALEUR,PARMSK,"CCECHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("CCE","!",VALEUR,num$(GDIE(2)),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_CCE2(VALEUR) From SUBPSH
  If mkstat : GERR = 1 : GZONE = "CCE2" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_CCE2(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELCCE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCE"
 PARMSK(1) = GDIE(2)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GDIE(1"
 PARMSK(6) = "[M:PSH1]CCE#"
 PARMSK(7) = "GCOA(1"
 PARMSK(8) = "[M:PSH1]LINACC#"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
If !GWEBSERV
 ## Action SELCCEGDD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELCCEGDD"
 PARMSK(1) = GDIE(2)
 PARMSK(2) = GFINRSP
 PARMSK(3) = [M:PSH1]EXTRCPDAT(nolign-1)
 PARMSK(4) = num$(nolign-1)
 PARMSK(5) = "GDIE(1"
 PARMSK(6) = "[M:PSH1]CCE#"
 PARMSK(7) = "GCOA(1"
 PARMSK(8) = "[M:PSH1]LINACC#"
 Call S_LIS_CHAR(VALEUR,PARMSK,"SELCCE","SELCCE","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_CCE2(VALEUR)
Variable Char    VALEUR()
Call OBJET("CCE",VALEUR,num$(GDIE(2))) From GOBJET
Gosub _AFF
End

Subprog SA_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CCE"
PARMSK(2) = num$(GDIE(2))
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CCE2(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$(GDIE(2))
Call VISU("CCE",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2WE2ALL1
Return

$TIT_COL
Gosub TIT_COL From W2WE2ALL1
Return


