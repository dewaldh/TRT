#<AdxTL>@(#)0.0.0.0 $Revision$Class Expense
# Supervisor
## ACLA-CLASSE ## EXPENSES
# 2018-08-27 12:31:12 841


####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 1 : CLB Employee ( Field AUS 5)
####################################################################

$SET_CLB
If [L]_AOLDVAL<>this.CLB
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CLB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CLB
 Gosub PROPAGATE_CLB
Endif
Return

$INIT_CLB
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CLB"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CLB
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CLB"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CLB                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CLB                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CLB
[L]CURPRO = "CLB"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CLB,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CLB
[L]CURPRO = "CLB"
If vireblc(this.CLB,2)<>vireblc(format$("K:5B",this.CLB),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CLB
[L]CURPRO = "CLB"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CLB
[L]CURPRO = "CLB"
Return

$PROPAGATE_CLB
this.isReadonly = 0
[L]CURPRO = "CLB"
Gosub _LNKPRO_CLB
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CLB
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CLB"
$_LNKPRO_CLB
If vireblc(this.CLB,2)<>""
 # Link AUTILIS
 Local File AUTILIS [WAUS]
 Read [F:WAUS]CODUSR = this.CLB
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CLB","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CLB","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WAUS]
Endif
Return

$_ALOADATTRIBUTE_CLB
[L]ASTATUS = fmet this.ASETATTRIBUTE("CLB","$isMandatory","true")
Return


####################################################################
# 2 : DATEXS Date ( Field D)
####################################################################

$SET_DATEXS
If [L]_AOLDVAL<>this.DATEXS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DATEXS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DATEXS
 Gosub PROPAGATE_DATEXS
Endif
Return

$INIT_DATEXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DATEXS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DATEXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DATEXS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DATEXS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DATEXS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DATEXS
[L]CURPRO = "DATEXS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DATEXS=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DATEXS
[L]CURPRO = "DATEXS"
Return

$_AOTHERS_DATEXS
[L]CURPRO = "DATEXS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DATEXS
[L]CURPRO = "DATEXS"
Return

$PROPAGATE_DATEXS
this.isReadonly = 0
[L]CURPRO = "DATEXS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DATEXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DATEXS"
$_LNKPRO_DATEXS
Return

$_ALOADATTRIBUTE_DATEXS
[L]ASTATUS = fmet this.ASETATTRIBUTE("DATEXS","$isMandatory","true")
Return


####################################################################
# 3 : NBREXS Line no. ( Field C 2)
####################################################################

$SET_NBREXS
If [L]_AOLDVAL<>this.NBREXS
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_NBREXS
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.NBREXS
 Gosub PROPAGATE_NBREXS
Endif
Return

$INIT_NBREXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "NBREXS"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_NBREXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "NBREXS"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_NBREXS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_NBREXS                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_NBREXS
[L]CURPRO = "NBREXS"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.NBREXS=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_NBREXS
[L]CURPRO = "NBREXS"
Return

$_AOTHERS_NBREXS
[L]CURPRO = "NBREXS"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_NBREXS
[L]CURPRO = "NBREXS"
Return

$PROPAGATE_NBREXS
this.isReadonly = 0
[L]CURPRO = "NBREXS"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_NBREXS
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "NBREXS"
$_LNKPRO_NBREXS
Return

$_ALOADATTRIBUTE_NBREXS
[L]ASTATUS = fmet this.ASETATTRIBUTE("NBREXS","$isMandatory","true")
Return


####################################################################
# 4 : CODEXP Expense code ( Field TES 10)
####################################################################

$SET_CODEXP
If [L]_AOLDVAL<>this.CODEXP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CODEXP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CODEXP
 Gosub PROPAGATE_CODEXP
Endif
Return

$INIT_CODEXP
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CODEXP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CODEXP
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CODEXP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CODEXP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CODEXP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CODEXP
[L]CURPRO = "CODEXP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CODEXP,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CODEXP
[L]CURPRO = "CODEXP"
If vireblc(this.CODEXP,2)<>vireblc(format$("K:10c",this.CODEXP),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CODEXP
[L]CURPRO = "CODEXP"
If vireblc(this.CODEXP,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPTES.ACTRLREF(this,"CODEXP",this.CODEXP,this.CODEXP,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CODEXP<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CODEXP
[L]CURPRO = "CODEXP"
Return

$PROPAGATE_CODEXP
this.isReadonly = 0
[L]CURPRO = "CODEXP"
Gosub _LNKPRO_CODEXP
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CODEXP
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CODEXP"
$_LNKPRO_CODEXP
If vireblc(this.CODEXP,2)<>""
 # Link TABEXPENS
 Local File TABEXPENS [WTES]
 Read [F:WTES]TES0 = this.CODEXP
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABEXPENS" & ZONE="SHOTRA" & IDENT1=[F:WTES]CODEXP & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CODEXP","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABEXPENS" & ZONE="DESTRA" & IDENT1=[F:WTES]CODEXP & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CODEXP","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTES]
Endif
Return

$_ALOADATTRIBUTE_CODEXP
[L]ASTATUS = fmet this.ASETATTRIBUTE("CODEXP","$isMandatory","true")
Return


####################################################################
# 5 : FCY Site ( Field FCY 5)
####################################################################

$SET_FCY
If [L]_AOLDVAL<>this.FCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_FCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.FCY
 Gosub PROPAGATE_FCY
Endif
Return

$INIT_FCY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "FCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_FCY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "FCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_FCY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_FCY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_FCY
[L]CURPRO = "FCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.FCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_FCY
[L]CURPRO = "FCY"
If vireblc(this.FCY,2)<>vireblc(format$("K:5c",this.FCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_FCY
[L]CURPRO = "FCY"
If vireblc(this.FCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"FCY",this.FCY,this.FCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.FCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_FCY
[L]CURPRO = "FCY"
Return

$PROPAGATE_FCY
this.isReadonly = 0
[L]CURPRO = "FCY"
Gosub _LNKPRO_FCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_FCY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "FCY"
$_LNKPRO_FCY
If vireblc(this.FCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.FCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("FCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("FCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return

$_ALOADATTRIBUTE_FCY
[L]ASTATUS = fmet this.ASETATTRIBUTE("FCY","$isMandatory","true")
Return


####################################################################
# 6 : CPY Company ( Field CPY 5)
####################################################################

$SET_CPY
If [L]_AOLDVAL<>this.CPY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CPY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CPY
 Gosub PROPAGATE_CPY
Endif
Return

$INIT_CPY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CPY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CPY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CPY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CPY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CPY
[L]CURPRO = "CPY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CPY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>vireblc(format$("K:5c",this.CPY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CPY
[L]CURPRO = "CPY"
If vireblc(this.CPY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCPY.ACTRLREF(this,"CPY",this.CPY,this.CPY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CPY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CPY
[L]CURPRO = "CPY"
Return

$PROPAGATE_CPY
this.isReadonly = 0
[L]CURPRO = "CPY"
Gosub _LNKPRO_CPY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CPY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CPY"
$_LNKPRO_CPY
If vireblc(this.CPY,2)<>""
 # Link COMPANY
 Local File COMPANY [WCPY]
 Read [F:WCPY]CPY0 = this.CPY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$title",[F:WCPY]CPYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$description",[F:WCPY]CPYNAM)
 Endif
 LogicClose File [WCPY]
Endif
Return

$_ALOADATTRIBUTE_CPY
[L]ASTATUS = fmet this.ASETATTRIBUTE("CPY","$isMandatory","true")
Return


####################################################################
# 7 : QTY Quantity ( Field L 6)
####################################################################

$SET_QTY
If [L]_AOLDVAL<>this.QTY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_QTY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.QTY
 Gosub PROPAGATE_QTY
Endif
Return

$INIT_QTY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "QTY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_QTY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "QTY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_QTY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_QTY                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_QTY
[L]CURPRO = "QTY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.QTY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_QTY
[L]CURPRO = "QTY"
Return

$_AOTHERS_QTY
[L]CURPRO = "QTY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_QTY
[L]CURPRO = "QTY"
Return

$PROPAGATE_QTY
this.isReadonly = 0
[L]CURPRO = "QTY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_QTY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "QTY"
$_LNKPRO_QTY
Return


####################################################################
# 8 : CUR Currency ( Field CUR 3)
####################################################################

$SET_CUR
If [L]_AOLDVAL<>this.CUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_CUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.CUR
 Gosub PROPAGATE_CUR
Endif
Return

$INIT_CUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_CUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_CUR                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_CUR
[L]CURPRO = "CUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.CUR,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>vireblc(format$("K:3c",this.CUR),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_CUR
[L]CURPRO = "CUR"
If vireblc(this.CUR,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPCUR.ACTRLREF(this,"CUR",this.CUR,this.CUR,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.CUR<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_CUR
[L]CURPRO = "CUR"
Return

$PROPAGATE_CUR
this.isReadonly = 0
[L]CURPRO = "CUR"
Gosub _LNKPRO_CUR
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_CUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "CUR"
$_LNKPRO_CUR
If vireblc(this.CUR,2)<>""
 # Link TABCUR
 Local File TABCUR [WTCU]
 Read [F:WTCU]TCU0 = this.CUR
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTSHO" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABCUR" & ZONE="INTDES" & IDENT1=[F:WTCU]CUR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$symbol",[F:WTCU]CURSYM)
  If int(val([F:WTCU]CURFMT1))>0
   Local Char WPREC(10)
   Local Char WSCALE(10)
   WPREC=num$(int(val([F:WTCU]CURFMT1)))
   WSCALE=num$(int(10*(val([F:WTCU]CURFMT1)-int(val([F:WTCU]CURFMT1)))))
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$precision",WPREC)
   [L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$scale",WSCALE)
  Endif
 Endif
 LogicClose File [WTCU]
Endif
Return

$_ALOADATTRIBUTE_CUR
[L]ASTATUS = fmet this.ASETATTRIBUTE("CUR","$isMandatory","true")
Return


####################################################################
# 9 : TYPRAT Rate type ( Field Local menu number 202)
####################################################################

$SET_TYPRAT
If [L]_AOLDVAL<>this.TYPRAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TYPRAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TYPRAT
 Gosub PROPAGATE_TYPRAT
Endif
Return

$INIT_TYPRAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TYPRAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.TYPRAT=0 and fmet this.AGETATTRIBUTE("TYPRAT","$isMandatory")="true"
 this.TYPRAT = 1
Endif
Return
 
$CONTROL_TYPRAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TYPRAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TYPRAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TYPRAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TYPRAT
[L]CURPRO = "TYPRAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.TYPRAT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TYPRAT
[L]CURPRO = "TYPRAT"
If this.TYPRAT<0 or this.TYPRAT>len(mess(0,202,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"202 ->"-num$(this.TYPRAT)-mess(99,123,1)):  Return : # Local menu "202 -> Invalid option
Endif
Return

$_AOTHERS_TYPRAT
[L]CURPRO = "TYPRAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TYPRAT
[L]CURPRO = "TYPRAT"
Return

$PROPAGATE_TYPRAT
this.isReadonly = 0
[L]CURPRO = "TYPRAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TYPRAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TYPRAT"
$_LNKPRO_TYPRAT
Return


####################################################################
# 10 : RATDAT Rate date ( Field D)
####################################################################

$SET_RATDAT
If [L]_AOLDVAL<>this.RATDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_RATDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.RATDAT
 Gosub PROPAGATE_RATDAT
Endif
Return

$INIT_RATDAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "RATDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_RATDAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "RATDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_RATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_RATDAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_RATDAT
[L]CURPRO = "RATDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.RATDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_RATDAT
[L]CURPRO = "RATDAT"
Return

$_AOTHERS_RATDAT
[L]CURPRO = "RATDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_RATDAT
[L]CURPRO = "RATDAT"
Return

$PROPAGATE_RATDAT
this.isReadonly = 0
[L]CURPRO = "RATDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_RATDAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "RATDAT"
$_LNKPRO_RATDAT
Return


####################################################################
# 14 : AMTPAY Actual amt. ( Field MD2 0)
####################################################################

$SET_AMTPAY
If [L]_AOLDVAL<>this.AMTPAY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTPAY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTPAY
 Gosub PROPAGATE_AMTPAY
Endif
Return

$INIT_AMTPAY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTPAY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTPAY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTPAY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTPAY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTPAY
[L]CURPRO = "AMTPAY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTPAY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTPAY
[L]CURPRO = "AMTPAY"
Return

$_AOTHERS_AMTPAY
[L]CURPRO = "AMTPAY"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTPAY",this.AMTPAY,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTPAY
[L]CURPRO = "AMTPAY"
Return

$PROPAGATE_AMTPAY
this.isReadonly = 0
[L]CURPRO = "AMTPAY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTPAY
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTPAY"
$_LNKPRO_AMTPAY
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTPAY",this.AMTPAY,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTPAY","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 15 : AMTCUR Amount in currency ( Field MD2 0)
####################################################################

$SET_AMTCUR
If [L]_AOLDVAL<>this.AMTCUR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTCUR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTCUR
 Gosub PROPAGATE_AMTCUR
Endif
Return

$INIT_AMTCUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTCUR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTCUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTCUR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTCUR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTCUR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTCUR
[L]CURPRO = "AMTCUR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTCUR=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTCUR
[L]CURPRO = "AMTCUR"
Return

$_AOTHERS_AMTCUR
[L]CURPRO = "AMTCUR"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTCUR",this.AMTCUR,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTCUR
[L]CURPRO = "AMTCUR"
Return

$PROPAGATE_AMTCUR
this.isReadonly = 0
[L]CURPRO = "AMTCUR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTCUR
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTCUR"
$_LNKPRO_AMTCUR
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTCUR",this.AMTCUR,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTCUR","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 16 : AMTATI Reimbursed amount ( Field MD2 0)
####################################################################

$SET_AMTATI
If [L]_AOLDVAL<>this.AMTATI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTATI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTATI
 Gosub PROPAGATE_AMTATI
Endif
Return

$INIT_AMTATI
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTATI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTATI
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTATI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTATI
[L]CURPRO = "AMTATI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTATI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTATI
[L]CURPRO = "AMTATI"
Return

$_AOTHERS_AMTATI
[L]CURPRO = "AMTATI"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTATI",this.AMTATI,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTATI
[L]CURPRO = "AMTATI"
Return

$PROPAGATE_AMTATI
this.isReadonly = 0
[L]CURPRO = "AMTATI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTATI
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTATI"
$_LNKPRO_AMTATI
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTATI",this.AMTATI,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTATI","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 17 : TAX1 Tax 1 ( Field VAT 5)
####################################################################

$SET_TAX1
If [L]_AOLDVAL<>this.TAX1
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TAX1
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TAX1
 Gosub PROPAGATE_TAX1
Endif
Return

$INIT_TAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX1"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX1"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TAX1                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TAX1                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TAX1
[L]CURPRO = "TAX1"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TAX1,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TAX1
[L]CURPRO = "TAX1"
If vireblc(this.TAX1,2)<>vireblc(format$("K:5c",this.TAX1),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TAX1
[L]CURPRO = "TAX1"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TAX1
[L]CURPRO = "TAX1"
If vireblc(this.TAX1,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPVAT.ACTRLREF(this,"TAX1",this.TAX1,this.TAX1,"","")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.TAX1<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_TAX1
this.isReadonly = 0
[L]CURPRO = "TAX1"
Gosub _LNKPRO_TAX1
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX1"
$_LNKPRO_TAX1
If vireblc(this.TAX1,2)<>""
 # Link TABVAT
 Local File TABVAT [WTVT]
 Read [F:WTVT]TVT0 = this.TAX1;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="SHOAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("TAX1","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="DESAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("TAX1","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVT]
Endif
Return


####################################################################
# 18 : TAX2 Tax 2 ( Field VAT 5)
####################################################################

$SET_TAX2
If [L]_AOLDVAL<>this.TAX2
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_TAX2
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.TAX2
 Gosub PROPAGATE_TAX2
Endif
Return

$INIT_TAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX2"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_TAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX2"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_TAX2                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_TAX2                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_TAX2
[L]CURPRO = "TAX2"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.TAX2,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_TAX2
[L]CURPRO = "TAX2"
If vireblc(this.TAX2,2)<>vireblc(format$("K:5c",this.TAX2),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_TAX2
[L]CURPRO = "TAX2"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_TAX2
[L]CURPRO = "TAX2"
If vireblc(this.TAX2,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPVAT.ACTRLREF(this,"TAX2",this.TAX2,this.TAX2,"","")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.TAX2<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_TAX2
this.isReadonly = 0
[L]CURPRO = "TAX2"
Gosub _LNKPRO_TAX2
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_TAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "TAX2"
$_LNKPRO_TAX2
If vireblc(this.TAX2,2)<>""
 # Link TABVAT
 Local File TABVAT [WTVT]
 Read [F:WTVT]TVT0 = this.TAX2;""
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="SHOAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("TAX2","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="DESAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("TAX2","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVT]
Endif
Return


####################################################################
# 19 : LEGVAT Legislation ( Field Miscellaneous table number)
####################################################################

$SET_LEGVAT
If [L]_AOLDVAL<>this.LEGVAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LEGVAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LEGVAT
 Gosub PROPAGATE_LEGVAT
Endif
Return

$INIT_LEGVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "LEGVAT"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"LEGVAT",this.LEGVAT,909)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LEGVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "LEGVAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LEGVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LEGVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LEGVAT
[L]CURPRO = "LEGVAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LEGVAT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LEGVAT
[L]CURPRO = "LEGVAT"
If vireblc(this.LEGVAT,2)<>vireblc(format$("K:20B",this.LEGVAT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_LEGVAT
[L]CURPRO = "LEGVAT"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"LEGVAT",this.LEGVAT,909,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LEGVAT
[L]CURPRO = "LEGVAT"
Return

$PROPAGATE_LEGVAT
this.isReadonly = 0
[L]CURPRO = "LEGVAT"
Gosub _LNKPRO_LEGVAT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LEGVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "LEGVAT"
$_LNKPRO_LEGVAT
If vireblc(this.LEGVAT,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 909;this.LEGVAT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("LEGVAT","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("LEGVAT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 20 : VAT Tax 3 ( Field VAT 5)
####################################################################

$SET_VAT
If [L]_AOLDVAL<>this.VAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VAT
 Gosub PROPAGATE_VAT
Endif
Return

$INIT_VAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VAT                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VAT                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VAT
[L]CURPRO = "VAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VAT,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VAT
[L]CURPRO = "VAT"
If vireblc(this.VAT,2)<>vireblc(format$("K:5c",this.VAT),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VAT
[L]CURPRO = "VAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VAT
[L]CURPRO = "VAT"
If vireblc(this.VAT,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPVAT.ACTRLREF(this,"VAT",this.VAT,this.VAT,this.LEGVAT,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.VAT<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
Return

$PROPAGATE_VAT
this.isReadonly = 0
[L]CURPRO = "VAT"
Gosub _LNKPRO_VAT
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VAT"
$_LNKPRO_VAT
If vireblc(this.VAT,2)<>""
 # Link TABVAT
 Local File TABVAT [WTVT]
 Read [F:WTVT]TVT0 = this.VAT;this.LEGVAT
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="SHOAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAT","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABVAT" & ZONE="DESAXX" & IDENT1=[F:WTVT]vat & IDENT2=[F:WTVT]LEG & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VAT","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTVT]
Endif
Return


####################################################################
# 21 : AMTTAX1 Tax amount ( Field MD2 0)
####################################################################

$SET_AMTTAX1
If [L]_AOLDVAL<>this.AMTTAX1
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTTAX1
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTTAX1
 Gosub PROPAGATE_AMTTAX1
Endif
Return

$INIT_AMTTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX1"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX1"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTTAX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTTAX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTTAX1
[L]CURPRO = "AMTTAX1"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTTAX1=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTTAX1
[L]CURPRO = "AMTTAX1"
Return

$_AOTHERS_AMTTAX1
[L]CURPRO = "AMTTAX1"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTTAX1",this.AMTTAX1,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTTAX1
[L]CURPRO = "AMTTAX1"
Return

$PROPAGATE_AMTTAX1
this.isReadonly = 0
[L]CURPRO = "AMTTAX1"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX1"
$_LNKPRO_AMTTAX1
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTTAX1",this.AMTTAX1,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTTAX1","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 22 : DEDTAX1 Deductible tax ( Field MD2 0)
####################################################################

$SET_DEDTAX1
If [L]_AOLDVAL<>this.DEDTAX1
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEDTAX1
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEDTAX1
 Gosub PROPAGATE_DEDTAX1
Endif
Return

$INIT_DEDTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX1"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEDTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX1"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEDTAX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEDTAX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEDTAX1
[L]CURPRO = "DEDTAX1"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DEDTAX1=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEDTAX1
[L]CURPRO = "DEDTAX1"
Return

$_AOTHERS_DEDTAX1
[L]CURPRO = "DEDTAX1"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"DEDTAX1",this.DEDTAX1,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEDTAX1
[L]CURPRO = "DEDTAX1"
Return

$PROPAGATE_DEDTAX1
this.isReadonly = 0
[L]CURPRO = "DEDTAX1"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEDTAX1
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX1"
$_LNKPRO_DEDTAX1
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"DEDTAX1",this.DEDTAX1,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("DEDTAX1","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 23 : AMTTAX2 Tax amount ( Field MD2 0)
####################################################################

$SET_AMTTAX2
If [L]_AOLDVAL<>this.AMTTAX2
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTTAX2
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTTAX2
 Gosub PROPAGATE_AMTTAX2
Endif
Return

$INIT_AMTTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX2"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX2"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTTAX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTTAX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTTAX2
[L]CURPRO = "AMTTAX2"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTTAX2=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTTAX2
[L]CURPRO = "AMTTAX2"
Return

$_AOTHERS_AMTTAX2
[L]CURPRO = "AMTTAX2"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTTAX2",this.AMTTAX2,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTTAX2
[L]CURPRO = "AMTTAX2"
Return

$PROPAGATE_AMTTAX2
this.isReadonly = 0
[L]CURPRO = "AMTTAX2"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTTAX2"
$_LNKPRO_AMTTAX2
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTTAX2",this.AMTTAX2,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTTAX2","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 24 : DEDTAX2 Deductible tax ( Field MD2 0)
####################################################################

$SET_DEDTAX2
If [L]_AOLDVAL<>this.DEDTAX2
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEDTAX2
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEDTAX2
 Gosub PROPAGATE_DEDTAX2
Endif
Return

$INIT_DEDTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX2"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEDTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX2"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEDTAX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEDTAX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEDTAX2
[L]CURPRO = "DEDTAX2"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DEDTAX2=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEDTAX2
[L]CURPRO = "DEDTAX2"
Return

$_AOTHERS_DEDTAX2
[L]CURPRO = "DEDTAX2"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"DEDTAX2",this.DEDTAX2,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEDTAX2
[L]CURPRO = "DEDTAX2"
Return

$PROPAGATE_DEDTAX2
this.isReadonly = 0
[L]CURPRO = "DEDTAX2"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEDTAX2
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDTAX2"
$_LNKPRO_DEDTAX2
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"DEDTAX2",this.DEDTAX2,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("DEDTAX2","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 25 : AMTVAT Tax amount ( Field MD2 0)
####################################################################

$SET_AMTVAT
If [L]_AOLDVAL<>this.AMTVAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_AMTVAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.AMTVAT
 Gosub PROPAGATE_AMTVAT
Endif
Return

$INIT_AMTVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTVAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_AMTVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTVAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_AMTVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_AMTVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_AMTVAT
[L]CURPRO = "AMTVAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.AMTVAT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_AMTVAT
[L]CURPRO = "AMTVAT"
Return

$_AOTHERS_AMTVAT
[L]CURPRO = "AMTVAT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"AMTVAT",this.AMTVAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_AMTVAT
[L]CURPRO = "AMTVAT"
Return

$PROPAGATE_AMTVAT
this.isReadonly = 0
[L]CURPRO = "AMTVAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_AMTVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "AMTVAT"
$_LNKPRO_AMTVAT
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"AMTVAT",this.AMTVAT,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("AMTVAT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 26 : DEDVAT Input VAT ( Field MD2 0)
####################################################################

$SET_DEDVAT
If [L]_AOLDVAL<>this.DEDVAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEDVAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEDVAT
 Gosub PROPAGATE_DEDVAT
Endif
Return

$INIT_DEDVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDVAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEDVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDVAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEDVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEDVAT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEDVAT
[L]CURPRO = "DEDVAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DEDVAT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEDVAT
[L]CURPRO = "DEDVAT"
Return

$_AOTHERS_DEDVAT
[L]CURPRO = "DEDVAT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD2(this,"DEDVAT",this.DEDVAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEDVAT
[L]CURPRO = "DEDVAT"
Return

$PROPAGATE_DEDVAT
this.isReadonly = 0
[L]CURPRO = "DEDVAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEDVAT
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DEDVAT"
$_LNKPRO_DEDVAT
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD2(this,"DEDVAT",this.DEDVAT,[L]AFORMAT,this.CUR)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("DEDVAT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 28 : DES Comments ( Field A 250)
####################################################################

$SET_DES
If [L]_AOLDVAL<>this.DES
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DES
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DES
 Gosub PROPAGATE_DES
Endif
Return

$INIT_DES
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DES"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DES
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DES"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DES                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DES                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DES
[L]CURPRO = "DES"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DES,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DES
[L]CURPRO = "DES"
Return

$_AOTHERS_DES
[L]CURPRO = "DES"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DES
[L]CURPRO = "DES"
Return

$PROPAGATE_DES
this.isReadonly = 0
[L]CURPRO = "DES"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DES
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "DES"
$_LNKPRO_DES
Return


####################################################################
# 29 : VISA Signature ( Field AUS 5)
####################################################################

$SET_VISA
If [L]_AOLDVAL<>this.VISA
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_VISA
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.VISA
 Gosub PROPAGATE_VISA
Endif
Return

$INIT_VISA
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VISA"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_VISA
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VISA"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_VISA                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_VISA                  : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_VISA
[L]CURPRO = "VISA"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.VISA,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_VISA
[L]CURPRO = "VISA"
If vireblc(this.VISA,2)<>vireblc(format$("K:5B",this.VISA),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_VISA
[L]CURPRO = "VISA"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_VISA
[L]CURPRO = "VISA"
Return

$PROPAGATE_VISA
this.isReadonly = 0
[L]CURPRO = "VISA"
Gosub _LNKPRO_VISA
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_VISA
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "VISA"
$_LNKPRO_VISA
If vireblc(this.VISA,2)<>""
 # Link AUTILIS
 Local File AUTILIS [WAUS]
 Read [F:WAUS]CODUSR = this.VISA
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VISA","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="AUTILIS" & ZONE="INTUSR" & IDENT1=[F:WAUS]USR & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("VISA","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WAUS]
Endif
Return


####################################################################
# 30 : ACCNUM Internal number ( Field UNQ 0)
####################################################################

$SET_ACCNUM
If [L]_AOLDVAL<>this.ACCNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ACCNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ACCNUM
 Gosub PROPAGATE_ACCNUM
Endif
Return

$INIT_ACCNUM
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "ACCNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ACCNUM
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "ACCNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ACCNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ACCNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ACCNUM
[L]CURPRO = "ACCNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ACCNUM=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ACCNUM
[L]CURPRO = "ACCNUM"
Return

$_AOTHERS_ACCNUM
[L]CURPRO = "ACCNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ACCNUM
[L]CURPRO = "ACCNUM"
Return

$PROPAGATE_ACCNUM
this.isReadonly = 0
[L]CURPRO = "ACCNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ACCNUM
Gosub DECLARE_VAR From WMC0EXPENSES
[L]CURPRO = "ACCNUM"
$_LNKPRO_ACCNUM
Return




