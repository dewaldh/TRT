#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management MULTIWOX 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:54:16"
A_USER  = "ADMIN"
A_STAMP = "20180326125416"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask MULTIWOX [DIA]
Gosub HORODAT
Local Inpbox "MULTIWOX" From GFONCTION At A_STAMP With A_WINDPREV Mask [DIA] As [SIM_]
Grizo [DIA]5
Grizo [DIA]10
Grizo [DIA]15
Grizo [DIA]20
Grizo [DIA]25
Grizo [DIA]35
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [DIA]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=167 : Y1(0)=7 : Y2(0)=10
X1(1)=1 : X2(1)=64 : Y1(1)=11 : Y2(1)=15
X1(2)=65 : X2(2)=167 : Y1(2)=11 : Y2(2)=15
X1(3)=1 : X2(3)=167 : Y1(3)=16 : Y2(3)=18
X1(4)=1 : X2(4)=64 : Y1(4)=19 : Y2(4)=22
X1(5)=65 : X2(5)=167 : Y1(5)=19 : Y2(5)=22
Return

$ON_MFGFCY
Onevent CONTROL Call C_MFGFCY(zc) From W1MULTIWOX
Onevent BEFORE_AREA Gosub AV_MFGFCY From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_MFGFCY From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_MFGFCY(zc) From W1MULTIWOX
Return

$AV_MFGFCY
## Action STD
Call AV_MFGFCY(zc) From SUBMUTX
Gosub _AFF
Return

Subprog AS_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGFCY(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_MFGFCY(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_MFGFCY(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_MFGFCY(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_MFGFCY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 1344 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 1344 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 1344 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_MFGFCY
Call AM_MFGFCY(zc)
If !mkstat & GOBJET
 zoncou = "MFGFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGFCY(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 1344 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZMFGFCY)")>indice
 [M]MFGFCY(indice) = VALEUR
 Affzo ZMFGFCY(indice)
Endif
Gosub _AFF
End

Subprog S_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_MFGFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZMFGFCY
Onevent BEFORE_AREA Gosub AV_ZMFGFCY From W1MULTIWOX
Return

$AV_ZMFGFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]MFGFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_BOMALTTYP
Onevent INIT_AREA Call D_BOMALTTYP(zc) From W1MULTIWOX
Return

Subprog D_BOMALTTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]BOMALTTYP,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

$ON_PLANNER
Onevent CONTROL Call C_PLANNER(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_PLANNER(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_PLANNER From W1MULTIWOX
Onevent INIT_AREA Call D_PLANNER(zc) From W1MULTIWOX
Return

Subprog D_PLANNER(VALEUR)
Variable Char    VALEUR()
If varinit([M]PLANNER,indice)=0
 VALEUR = GUSER
Endif
Gosub _AFF
End

Subprog AS_PLANNER(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(485,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_PLANNER(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_PLANNER(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_PLANNER(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_PLANNER(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_PLANNER(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("AUS","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PLANNER" : GZNUM = 3976 : Endif
Gosub _AFF
End

$AMM_PLANNER
Call AM_PLANNER(zc)
If !mkstat & GOBJET
 zoncou = "PLANNER" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PLANNER(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPLANNER)")>indice
 [M]PLANNER(indice) = VALEUR
 Affzo ZPLANNER(indice)
Endif
Gosub _AFF
End

Subprog S_PLANNER(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "AUS"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_PLANNER(VALEUR)
Variable Char    VALEUR()
Call OBJET("AUS",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_PLANNER(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "AUS"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PLANNER(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("AUS",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPLANNER
Onevent BEFORE_AREA Gosub AV_ZPLANNER From W1MULTIWOX
Return

$AV_ZPLANNER
Call LECTEXTRA(zc,"AUTILIS","INTUSR",num$([M]PLANNER(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ITMREF
Onevent CONTROL Call C_ITMREF(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_ITMREF(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_ITMREF From W1MULTIWOX
Return

Subprog IB_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
## Action STD
Call IB_ITMREF From SUBMUTX
Gosub _AFF
End

Subprog AS_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(2061,GBOUT1) From OBJDIV
Call TEXTE(16753,GBOUT2) From OBJDIV
Call TEXTE(49019,GBOUT3) From OBJDIV
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREF(VALEUR)
## Action STD
Call AS_ITMREF(VALEUR) From SUBMUTX
If mkstat=2
 [M]ITMREF(INDIC) = VALEUR
 Affzo ITMREF(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_ITMREF(zc) From W1MULTIWOX
Onkey 130 Titled GBOUT2 Call B2_ITMREF(zc) From W1MULTIWOX
Onkey 131 Titled GBOUT3 Call B3_ITMREF(zc) From W1MULTIWOX
Onkey 170 Titled GBOUT13 Call B13_ITMREF(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_ITMREF(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_ITMREF(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_ITMREF(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action ITMCHOICE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "ITMCHOICE"
  Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  If !mkstat
   ## Action STD
   Call C_ITMREF(VALEUR) From SUBMUTX
   If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREF
Call AM_ITMREF(zc)
If !mkstat & GOBJET
 zoncou = "ITMREF" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREF(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREF(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
If !GWEBSERV
 If !mkstat
  ## Action NOTE
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "NOTE"
  PARMSK(1) = VALEUR
  PARMSK(2) = "ITMREF"
  Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "ITMREF" : GZNUM = 3651 : Endif
 Endif
Endif
If !mkstat & evalue("dim("+clanam([M])+"ZITMREF)")>indice
 [M]ITMREF(indice) = VALEUR
 Affzo ZITMREF(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = "2"
 PARMSK(3) = "1"
 PARMSK(4) = "234"
 PARMSK(5) = "1234"
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_ITMREF(VALEUR)
Variable Char    VALEUR()
Call OBJET("ITM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B2_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOM"
 PARMSK(1) = num$([M]BOMALT)
 PARMSK(2) = ""
 PARMSK(3) = [M]ITMREF
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBOM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action NOTE1
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "NOTE1"
 PARMSK(1) = VALEUR
 PARMSK(2) = "ITMREF"
 Call TRAITE_CHAR(VALEUR,PARMSK,"NOTE","TRTNTSCTL","",1,"") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B13_ITMREF(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREF(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREF
Onevent BEFORE_AREA Gosub AV_ZITMREF From W1MULTIWOX
Return

$AV_ZITMREF
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREF(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ECCVALMAJ
Onevent BEFORE_INPUT Call AS_ECCVALMAJ(zc) From W1MULTIWOX
Onevent CONTROL Call C_ECCVALMAJ(zc) From W1MULTIWOX
Return

Subprog AS_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMAJ(VALEUR) From SUBMUTX
If mkstat=2
 [M]ECCVALMAJ(INDIC) = VALEUR
 Affzo ECCVALMAJ(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMAJ(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ECCVALMAJ(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ECCVALMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

Subprog S_ECCVALMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:DIA]ITMREF
 PARMSK(2) = VALEUR
 PARMSK(3) = "[M:DIA]ECCVALMIN"
 PARMSK(4) = "2"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "DIA"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ECCVALMIN
Onevent BEFORE_INPUT Call AS_ECCVALMIN(zc) From W1MULTIWOX
Onevent CONTROL Call C_ECCVALMIN(zc) From W1MULTIWOX
Return

Subprog AS_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ECCVALMIN(VALEUR) From SUBMUTX
If mkstat=2
 [M]ECCVALMIN(INDIC) = VALEUR
 Affzo ECCVALMIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ECCVALMIN(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ECCVALMIN(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ECCVALMIN" : GZNUM = 44207 : Endif
Gosub _AFF
End

Subprog S_ECCVALMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELECCVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELECCVAL"
 PARMSK(1) = [M:DIA]ITMREF
 PARMSK(2) = [M:DIA]ECCVALMAJ
 PARMSK(3) = ""
 PARMSK(4) = "2"
 PARMSK(5) = [0/0/0]
 PARMSK(6) = "DIA"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELECCVAL","ECCLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGSTA
Onevent AFTER_CHANGE Gosub AMM_MFGSTA From W1MULTIWOX
Onevent INIT_AREA Call D_MFGSTA(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_MFGSTA(zc) From W1MULTIWOX
Return

Subprog D_MFGSTA(VALEUR)
Variable Integer VALEUR
If varinit([M]MFGSTA,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MFGSTA(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_MFGSTA
Call AM_MFGSTA(zc)
If !mkstat & GOBJET
 zoncou = "MFGSTA" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGSTA(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_MFGSTA(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "MFGSTA" : GZNUM = 1287 : Endif
Gosub _AFF
End

$ON_EXTQTY
Onevent BEFORE_AREA Gosub AV_EXTQTY From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_EXTQTY(zc) From W1MULTIWOX
Onevent CONTROL Call C_EXTQTY(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_EXTQTY From W1MULTIWOX
Return

$AV_EXTQTY
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find([M]STU,GUNITE(1..GNBUNT)),1))
Endif
Chgfmt [M]EXTQTY(indice) With "N+z:"+GUNTFMT
Gosub _AFF
Return

Subprog AS_EXTQTY(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(454,GBOUT1) From OBJDIV
Call TEXTE(454,GBOUT2) From OBJDIV
Call TEXTE(454,GBOUT3) From OBJDIV
## Action STD
Call AS_EXTQTY(VALEUR) From SUBMUTX
If mkstat=2
 [M]EXTQTY(INDIC) = VALEUR
 Affzo EXTQTY(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_EXTQTY(zc) From W1MULTIWOX
Onkey 130 Titled GBOUT2 Call B2_EXTQTY(zc) From W1MULTIWOX
Onkey 131 Titled GBOUT3 Call B3_EXTQTY(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_EXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_EXTQTY(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "EXTQTY" : GZNUM = 1906 : Endif
Gosub _AFF
End

$AMM_EXTQTY
Call AM_EXTQTY(zc)
If !mkstat & GOBJET
 zoncou = "EXTQTY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EXTQTY(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EXTQTY(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "EXTQTY" : GZNUM = 1906 : Endif
Gosub _AFF
End

Subprog B1_EXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B1_EXTQTY(VALEUR) From SUBMUTX
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_EXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action STD
 Call B2_EXTQTY(VALEUR) From SUBMUTX
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_EXTQTY(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action FDISPNOWN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "FDISPNOWN"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = [M]ITMREF
 PARMSK(4) = num$([M]BOMALT)
 PARMSK(5) = [M]STU
 PARMSK(6) = [M]STRDAT
 PARMSK(7) = num$(VALEUR)
 Call SAISIE_NUM(VALEUR,PARMSK,"IDISPNOWN","BENCHLIB","XYZBENCHLIB") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_STU
Return

$ON_ZSTU
Onevent BEFORE_AREA Gosub AV_ZSTU From W1MULTIWOX
Return

$AV_ZSTU
Call LECTEXTRA(zc,"TABUNIT","DES",num$([M]STU(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_STRDAT
Onevent CONTROL Call C_STRDAT(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_STRDAT From W1MULTIWOX
Onevent BEFORE_AREA Gosub AV_STRDAT From W1MULTIWOX
Return

$AV_STRDAT
Chgfmt [M]STRDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_STRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_STRDAT(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "STRDAT" : GZNUM = 1805 : Endif
Gosub _AFF
End

$AMM_STRDAT
Call AM_STRDAT(zc)
If !mkstat & GOBJET
 zoncou = "STRDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STRDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_STRDAT(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "STRDAT" : GZNUM = 1805 : Endif
Gosub _AFF
End

$ON_ENDDAT
Onevent CONTROL Call C_ENDDAT(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_ENDDAT From W1MULTIWOX
Onevent BEFORE_AREA Gosub AV_ENDDAT From W1MULTIWOX
Return

$AV_ENDDAT
Chgfmt [M]ENDDAT(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog C_ENDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_ENDDAT(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ENDDAT" : GZNUM = 1806 : Endif
Gosub _AFF
End

$AMM_ENDDAT
Call AM_ENDDAT(zc)
If !mkstat & GOBJET
 zoncou = "ENDDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call AM_ENDDAT(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ENDDAT" : GZNUM = 1806 : Endif
Gosub _AFF
End

$ON_BOMALT
Onevent BEFORE_INPUT Call AS_BOMALT(zc) From W1MULTIWOX
Onevent CONTROL Call C_BOMALT(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_BOMALT From W1MULTIWOX
Return

Subprog AS_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_BOMALT(VALEUR) From SUBMUTX
If mkstat=2
 [M]BOMALT(INDIC) = VALEUR
 Affzo BOMALT(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_BOMALT(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_BOMALT(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action %OBLIG
If VALEUR=0
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 9555 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTNUM("TBO","",VALEUR,num$([M]BOMALTTYP),mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 9555 : Endif
 If !mkstat
  ## Action CONTALT
  Call CONTALT(VALEUR,[M]BOMALTTYP) From TRTBOM
  If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 9555 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_BOMALT
Call AM_BOMALT(zc)
If !mkstat & GOBJET
 zoncou = "BOMALT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_BOMALT(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 9555 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZBOMALT)")>indice
 [M]BOMALT(indice) = VALEUR
 Affzo ZBOMALT(indice)
Endif
Gosub _AFF
End

Subprog S_BOMALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELBOMALTM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOMALTM"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = num$(2+2*([M]BOMALTTYP=3))
 Call S_LIS_NUM(VALEUR,PARMSK,"SELBOMALTM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = num$([M]BOMALTTYP)
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMALT
Onevent BEFORE_AREA Gosub AV_ZBOMALT From W1MULTIWOX
Return

$AV_ZBOMALT
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX",num$([M]BOMALTTYP),num$([M]BOMALT(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_ROUNUM
Onevent CONTROL Call C_ROUNUM(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_ROUNUM(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_ROUNUM From W1MULTIWOX
Return

Subprog IB_ROUNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ROUNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ROUNUM(VALEUR)
## Action STD
Call AS_ROUNUM(VALEUR) From SUBMUTX
If mkstat=2
 [M]ROUNUM(INDIC) = VALEUR
 Affzo ROUNUM(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_ROUNUM(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_ROUNUM(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_ROUNUM(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_ROUNUM(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ROUNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ROUNUM" : GZNUM = 3817 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ROUNUM" : GZNUM = 3817 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,num$([M]ROUNUM),mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ROUNUM" : GZNUM = 3817 : Endif
  If !mkstat
   ## Action STD
   Call C_ROUNUM(VALEUR) From SUBMUTX
   If mkstat : GERR = 1 : GZONE = "ROUNUM" : GZNUM = 3817 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ROUNUM
Call AM_ROUNUM(zc)
If !mkstat & GOBJET
 zoncou = "ROUNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUNUM(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ROUNUM(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ROUNUM" : GZNUM = 3817 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZROUNUM)")>indice
 [M]ROUNUM(indice) = VALEUR
 Affzo ZROUNUM(indice)
Endif
Gosub _AFF
End

Subprog S_ROUNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELROUNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELROUNUM"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = num$([M]ROUNUM)
 PARMSK(3) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELROUNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ROUNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ROUNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
PARMSK(2) = num$([M]ROUNUM)
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ROUNUM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = num$([M]ROUNUM)
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUNUM
Onevent BEFORE_AREA Gosub AV_ZROUNUM From W1MULTIWOX
Return

$AV_ZROUNUM
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ROUNUM(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ROUECCMAJ
Onevent BEFORE_INPUT Call AS_ROUECCMAJ(zc) From W1MULTIWOX
Onevent CONTROL Call C_ROUECCMAJ(zc) From W1MULTIWOX
Return

Subprog AS_ROUECCMAJ(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ROUECCMAJ(VALEUR) From SUBMUTX
If mkstat=2
 [M]ROUECCMAJ(INDIC) = VALEUR
 Affzo ROUECCMAJ(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ROUECCMAJ(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ROUECCMAJ(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ROUECCMAJ(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ROUECCMAJ" : GZNUM = 44205 : Endif
Gosub _AFF
End

Subprog S_ROUECCMAJ(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELRVMVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELRVMVAL"
 PARMSK(1) = [M]ROUNUM
 PARMSK(2) = [M]MFGFCY
 PARMSK(3) = VALEUR
 PARMSK(4) = "[M]ROUECCMIN"
 PARMSK(5) = [M]STRDAT
 PARMSK(6) = "DIA"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELRVMVAL","RVMLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ROUECCMIN
Onevent BEFORE_INPUT Call AS_ROUECCMIN(zc) From W1MULTIWOX
Onevent CONTROL Call C_ROUECCMIN(zc) From W1MULTIWOX
Return

Subprog AS_ROUECCMIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_ROUECCMIN(VALEUR) From SUBMUTX
If mkstat=2
 [M]ROUECCMIN(INDIC) = VALEUR
 Affzo ROUECCMIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ROUECCMIN(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ROUECCMIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ROUECCMIN(VALEUR) From SUBMUTX
If mkstat : GERR = 1 : GZONE = "ROUECCMIN" : GZNUM = 44207 : Endif
Gosub _AFF
End

Subprog S_ROUECCMIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELRVMVAL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELRVMVAL"
 PARMSK(1) = [M]ROUNUM
 PARMSK(2) = [M]MFGFCY
 PARMSK(3) = [M]ROUECCMAJ
 PARMSK(4) = ""
 PARMSK(5) = [M]STRDAT
 PARMSK(6) = "DIA"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELRVMVAL","RVMLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MTSNUM
Onevent INIT_AREA Call D_MTSNUM(zc) From W1MULTIWOX
Return

Subprog D_MTSNUM(VALEUR)
Variable Char    VALEUR()
If varinit([M]MTSNUM,indice)=0
 VALEUR = GMFGMTSNUM
Endif
Gosub _AFF
End

$ON_PLANNER2
Return

$ON_ROUALT
Onevent BEFORE_INPUT Call AS_ROUALT(zc) From W1MULTIWOX
Onevent CONTROL Call C_ROUALT(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_ROUALT From W1MULTIWOX
Return

Subprog AS_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
## Action STD
Call AS_ROUALT(VALEUR) From SUBMUTX
If mkstat=2
 [M]ROUALT(INDIC) = VALEUR
 Affzo ROUALT(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_ROUALT(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_ROUALT(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_ROUALT(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TRO","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ROUALT" : GZNUM = 1528 : Endif
If !mkstat
 ## Action STD
 Call C_ROUALT(VALEUR) From SUBMUTX
 If mkstat : GERR = 1 : GZONE = "ROUALT" : GZNUM = 1528 : Endif
Endif
Gosub _AFF
End

$AMM_ROUALT
Call AM_ROUALT(zc)
If !mkstat & GOBJET
 zoncou = "ROUALT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUALT(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZROUALT)")>indice
 [M]ROUALT(indice) = VALEUR
 Affzo ZROUALT(indice)
Endif
Gosub _AFF
End

Subprog S_ROUALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELROUNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELROUNUM"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = [M]ROUNUM
 PARMSK(3) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELROUNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUALT
Onevent BEFORE_AREA Gosub AV_ZROUALT From W1MULTIWOX
Return

$AV_ZROUALT
Call LECTEXTRA(zc,"TABROUALT","TRODESAXX",num$([M]ROUALT(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_LTICOD
Onevent INIT_AREA Call D_LTICOD(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_LTICOD(zc) From W1MULTIWOX
Return

Subprog D_LTICOD(VALEUR)
Variable Integer VALEUR
If varinit([M]LTICOD,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LTICOD(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_BPCNUM
Onevent CONTROL Call C_BPCNUM(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_BPCNUM(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_BPCNUM From W1MULTIWOX
Return

Subprog AS_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1503,GBOUT1) From OBJDIV
Call TEXTE(43545,GBOUT11) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPCNUM(zc) From W1MULTIWOX
Onkey 139 Titled GBOUT11 Call B11_BPCNUM(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_BPCNUM(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_BPCNUM(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_BPCNUM(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPCCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPCCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPCCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 19569 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPC","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "BPCNUM" : GZNUM = 19569 : Endif
Endif
Gosub _AFF
End

$AMM_BPCNUM
Call AM_BPCNUM(zc)
If !mkstat & GOBJET
 zoncou = "BPCNUM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZBPCNUM)")>indice
 [M]BPCNUM(indice) = VALEUR
 Affzo ZBPCNUM(indice)
Endif
Gosub _AFF
End

Subprog S_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "BPC"
PARMSK(2) = "!"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_BPCNUM(VALEUR)
Variable Char    VALEUR()
Call OBJET("BPC",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog B11_BPCNUM(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CUSSEAQ
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CUSSEAQ"
 PARMSK(1) = ""
 Call TRAITE_CHAR(VALEUR,PARMSK,"CUSSEAQ","CUSSEAQ","",1,"XYCUSSEAQ") From GTRAITE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPC"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_BPCNUM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBPCNUM
Onevent BEFORE_AREA Gosub AV_ZBPCNUM From W1MULTIWOX
Return

$AV_ZBPCNUM
If clalev([F:BPC])=0 : Local File BPCUSTOMER [BPC] : Endif
Call LECTURE("BPC",num$([M]BPCNUM(indice)),"") From CONTOBJ
zc = [F:BPC]BPCSHO
Gosub _AFF
Return

$ON_PJT
Onevent BEFORE_INPUT Call AS_PJT(zc) From W1MULTIWOX
Onevent CONTROL Call C_PJT(zc) From W1MULTIWOX
Onevent AFTER_CHANGE Gosub AMM_PJT From W1MULTIWOX
Return

Subprog IB_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJT(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJT(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJT(INDIC) = VALEUR
 Affzo PJT(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJT(zc) From W1MULTIWOX
Onkey 130 Titled GBOUT2 Call B2_PJT(zc) From W1MULTIWOX
Onkey 131 Titled GBOUT3 Call B3_PJT(zc) From W1MULTIWOX
Onkey 132 Titled GBOUT4 Call B4_PJT(zc) From W1MULTIWOX
Onkey 172 Titled GBOUT15 Call B15_PJT(zc) From W1MULTIWOX
Onkey 173 Titled GBOUT16 Call B16_PJT(zc) From W1MULTIWOX
Onkey 174 Titled GBOUT17 Call B17_PJT(zc) From W1MULTIWOX
Onkey 175 Titled GBOUT18 Call B18_PJT(zc) From W1MULTIWOX
Onkey 176 Titled GBOUT19 Call B19_PJT(zc) From W1MULTIWOX
Onkey   2 Titled GBOUTS Call S_PJT(zc) From W1MULTIWOX
Onkey 144 Titled GBOUTP Call P_PJT(zc) From W1MULTIWOX
Onkey 146 Titled GBOUTA Call SA_PJT(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJT
Call AM_PJT(zc)
If !mkstat & GOBJET
 zoncou = "PJT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJT(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJT" : GZNUM = 1886 : Endif
Gosub _AFF
End

Subprog S_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","PJT",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJT(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJT"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJT(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VCRNUMORI
Onevent CONTROL Call C_VCRNUMORI(zc) From W1MULTIWOX
Onevent BEFORE_INPUT Call AS_VCRNUMORI(zc) From W1MULTIWOX
Return

Subprog AS_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
## Action STD
Call AS_VCRNUMORI(VALEUR) From SUBMUTX
If mkstat=2
 [M]VCRNUMORI(INDIC) = VALEUR
 Affzo VCRNUMORI(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_VCRNUMORI(zc) From W1MULTIWOX
Gosub _AFF
End

Subprog C_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRNUMORI" : GZNUM = 5421 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRNUMORI(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELVCRNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELVCRNUM"
 PARMSK(1) = "1"
 PARMSK(2) = "1"
 PARMSK(3) = [M]MFGFCY
 PARMSK(4) = [M]ORDFILTER
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELVCRNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRTYPORI
Onevent INIT_AREA Call D_VCRTYPORI(zc) From W1MULTIWOX
Return

Subprog D_VCRTYPORI(VALEUR)
Variable Integer VALEUR
If varinit([M]VCRTYPORI,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_WIPTYP
Onevent INIT_AREA Call D_WIPTYP(zc) From W1MULTIWOX
Return

Subprog D_WIPTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]WIPTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_WIPNUM
Return

$CHG_STY
Gosub CHG_STY From W2MULTIWOX
Return

$TIT_COL
Gosub TIT_COL From W2MULTIWOX
Return


