#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management SAUTINVSCH 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:11:16"
A_USER  = "ADMIN"
A_STAMP = "20180828001116"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask SAUTINVSCH [DIA]
Gosub HORODAT
Local Inpbox "SAUTINVSCH" From GFONCTION At A_STAMP With A_WINDPREV Mask [DIA] As [SIM_]
Grizo [DIA]5
Grizo [DIA]10
Grizo [DIA]15
Grizo [DIA]20
Grizo [DIA]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [DIA]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=23 : X2(0)=90 : Y1(0)=4 : Y2(0)=8
X1(1)=23 : X2(1)=90 : Y1(1)=9 : Y2(1)=10
X1(2)=23 : X2(2)=90 : Y1(2)=11 : Y2(2)=15
X1(3)=23 : X2(3)=90 : Y1(3)=16 : Y2(3)=20
X1(4)=23 : X2(4)=90 : Y1(4)=21 : Y2(4)=25
Return

$ON_CPY
Onevent CONTROL Call C_CPY(zc) From W1SAUTINVSCH
Onevent INIT_AREA Call D_CPY(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_CPY From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_CPY(zc) From W1SAUTINVSCH
Return

Subprog D_CPY(VALEUR)
Variable Char    VALEUR()
If varinit([M]CPY,indice)=0
 ## Action STD
 Call D_CPY(VALEUR) From FUNAUTINVSCH
Endif
Gosub _AFF
End

Subprog AS_CPY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_CPY(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_CPY(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_CPY(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_CPY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat
 ## Action ACONTCPY
 Call CONTSOC(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("CPY","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
  If !mkstat
   ## Action CONTCPY
   Call CONTCPY(VALEUR) From EXEFNC
   If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_CPY
Call AM_CPY(zc)
If !mkstat & GOBJET
 zoncou = "CPY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPY(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "CPY" : GZNUM = 1343 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZCPY)")>indice
 [M]CPY(indice) = VALEUR
 Affzo ZCPY(indice)
Endif
Gosub _AFF
End

Subprog S_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "CPY"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "CPY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_CPY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("CPY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZCPY
Onevent BEFORE_AREA Gosub AV_ZCPY From W1SAUTINVSCH
Return

$AV_ZCPY
If clalev([F:CPY])=0 : Local File COMPANY [CPY] : Endif
Call LECTURE("CPY",num$([M]CPY(indice)),"") From CONTOBJ
zc = [F:CPY]CPYNAM
Gosub _AFF
Return

$ON_SALFCY
Onevent CONTROL Call C_SALFCY(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_SALFCY From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_SALFCY(zc) From W1SAUTINVSCH
Return

Subprog AS_SALFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_SALFCY(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_SALFCY(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_SALFCY(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_SALFCY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","F",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
  If !mkstat
   ## Action CTLFCYAUZ
   Local Char    PARMSK(250)(1..20) , SAVACT(20)
   SAVACT = GACTION : GACTION = "CTLFCYAUZ"
   Call S_AFF_CHAR(VALEUR,PARMSK,"CTLFCYAUZ","CONTX3","") From GACTION
   GACTION = SAVACT
   If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
   If !mkstat
    ## Action CONTFCYCPY
    Call CONTFCYCPY(VALEUR,[M]CPY) From EXEFNC
    If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
   Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_SALFCY
Call AM_SALFCY(zc)
If !mkstat & GOBJET
 zoncou = "SALFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SALFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SALFCY(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "SALFCY" : GZNUM = 5060 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZSALFCY)")>indice
 [M]SALFCY(indice) = VALEUR
 Affzo ZSALFCY(indice)
Endif
Gosub _AFF
End

Subprog S_SALFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSALFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSALFCY"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSALFCY","TRTVENSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_SALFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SALFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSALFCY
Onevent BEFORE_AREA Gosub AV_ZSALFCY From W1SAUTINVSCH
Return

$AV_ZSALFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]SALFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_INVDAT
Onevent BEFORE_AREA Gosub AV_INVDAT From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_INVDAT From W1SAUTINVSCH
Onevent CONTROL Call C_INVDAT(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_INVDAT(zc) From W1SAUTINVSCH
Return

$AV_INVDAT
## Action ADATRELI
Call INIDAT(zc,[M]INVDATF) From ADATREL
Chgfmt [M]INVDAT(indice) With "DzZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_INVDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_INVDAT(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_INVDAT(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_INVDAT(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "INVDAT" : GZNUM = 2510 : Endif
Gosub _AFF
End

$AMM_INVDAT
Call AM_INVDAT(zc)
If !mkstat & GOBJET
 zoncou = "INVDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_INVDAT(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]INVDATF) From ADATREL
If mkstat : GERR = 1 : GZONE = "INVDAT" : GZNUM = 2510 : Endif
Gosub _AFF
End

Subprog B1_INVDAT(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]INVDATF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]INVDATF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_SIVTYP
Onevent CONTROL Call C_SIVTYP(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_SIVTYP From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_SIVTYP(zc) From W1SAUTINVSCH
Return

Subprog IB_SIVTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBTUNLEG
 Call IBTUNLEG("") From TRTVENCTL
Endif
Gosub _AFF
End

Subprog AS_SIVTYP(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(13024,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_SIVTYP(VALEUR)
Onkey 129 Titled GBOUT1 Call B1_SIVTYP(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_SIVTYP(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_SIVTYP(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_SIVTYP(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_SIVTYP(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "SIVTYP" : GZNUM = 15620 : Endif
If !mkstat
 ## Action CONTTSV
 Call CONTTSV(VALEUR,GCURLEG,"SAUTINVO","SIVTYP",[M]SALFCY,"",[M]CPY) From SUBTSV
 If mkstat : GERR = 1 : GZONE = "SIVTYP" : GZNUM = 15620 : Endif
 If !mkstat
  ## Action CONTOBJN
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CONTOBJN"
  Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "SIVTYP" : GZNUM = 15620 : Endif
  If !mkstat
   ## Action STD
   Call C_SIVTYP(VALEUR) From FUNAUTINVSCH
   If mkstat : GERR = 1 : GZONE = "SIVTYP" : GZNUM = 15620 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_SIVTYP
Call AM_SIVTYP(zc)
If !mkstat & GOBJET
 zoncou = "SIVTYP" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SIVTYP(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SIVTYP(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "SIVTYP" : GZNUM = 15620 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZSIVTYP)")>indice
 [M]SIVTYP(indice) = VALEUR
 Affzo ZSIVTYP(indice)
Endif
Gosub _AFF
End

Subprog S_SIVTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELTSVLEG
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTSVLEG"
 PARMSK(1) = GCURLEG
 PARMSK(2) = ""
 PARMSK(3) = [M]SALFCY
 PARMSK(4) = ""
 PARMSK(5) = [M]CPY
 PARMSK(6) = "SAUTINVO"
 PARMSK(7) = "SIVTYP"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELTSV","SUBTSV","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SIVTYP(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action TUNTSV
 Call TUNTSV(VALEUR,GCURLEG) From SUBTSV
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_SIVTYP(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TSV"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_SIVTYP(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TSV",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZSIVTYP
Onevent BEFORE_AREA Gosub AV_ZSIVTYP From W1SAUTINVSCH
Return

$AV_ZSIVTYP
Call LECTEXTRA(zc,"TABSIVTYP","DESAXX",num$([M]SIVTYP(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_DEMDLVDAT
Onevent BEFORE_AREA Gosub AV_DEMDLVDAT From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_DEMDLVDAT From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_DEMDLVDAT(zc) From W1SAUTINVSCH
Return

$AV_DEMDLVDAT
## Action ADATRELI
Call INIDAT(zc,[M]DEMDLVDATF) From ADATREL
Chgfmt [M]DEMDLVDAT(indice) With "DzZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_DEMDLVDAT(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_DEMDLVDAT(zc) From W1SAUTINVSCH
Gosub _AFF
End

$AMM_DEMDLVDAT
Call AM_DEMDLVDAT(zc)
If !mkstat & GOBJET
 zoncou = "DEMDLVDAT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_DEMDLVDAT(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]DEMDLVDATF) From ADATREL
If mkstat : GERR = 1 : GZONE = "DEMDLVDAT" : GZNUM = 56565 : Endif
Gosub _AFF
End

Subprog B1_DEMDLVDAT(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]DEMDLVDATF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]DEMDLVDATF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_IMESVIC
Onevent INIT_AREA Call D_IMESVIC(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_IMESVIC(zc) From W1SAUTINVSCH
Return

Subprog D_IMESVIC(VALEUR)
Variable Integer VALEUR
If varinit([M]IMESVIC,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_IMESVIC(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_BPCINVDEB
Onevent AFTER_CHANGE Gosub AMM_BPCINVDEB From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_BPCINVDEB(zc) From W1SAUTINVSCH
Return

Subprog AS_BPCINVDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16134,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPCINVDEB(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_BPCINVDEB(zc) From W1SAUTINVSCH
Gosub _AFF
End

$AMM_BPCINVDEB
Call AM_BPCINVDEB(zc)
If !mkstat & GOBJET
 zoncou = "BPCINVDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BPCINVDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_BPCINVDEB(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "BPCINVDEB" : GZNUM = 26083 : Endif
Gosub _AFF
End

Subprog S_BPCINVDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "BPC"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_BPCINVDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJAW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJAW"
 PARMSK(1) = "BPC"
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_BPCINVFIN
Onevent CONTROL Call C_BPCINVFIN(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_BPCINVFIN(zc) From W1SAUTINVSCH
Return

Subprog AS_BPCINVFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16134,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_BPCINVFIN(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_BPCINVFIN(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_BPCINVFIN(VALEUR)
Variable Char    VALEUR()
## Action CTLALPVALW
Local Char    PARMSK(250)(1..20) , SAVACT(20)
SAVACT = GACTION : GACTION = "CTLALPVALW"
PARMSK(1) = [M]BPCINVDEB
Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
GACTION = SAVACT
If mkstat : GERR = 1 : GZONE = "BPCINVFIN" : GZNUM = 26084 : Endif
Gosub _AFF
End

Subprog S_BPCINVFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "BPC"
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_BPCINVFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJAW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJAW"
 PARMSK(1) = "BPC"
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_SOHNUMDEB
Onevent CONTROL Call C_SOHNUMDEB(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_SOHNUMDEB From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_SOHNUMDEB(zc) From W1SAUTINVSCH
Return

Subprog AS_SOHNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16134,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_SOHNUMDEB(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_SOHNUMDEB(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_SOHNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "SOHNUMDEB" : GZNUM = 51167 : Endif
Endif
Gosub _AFF
End

$AMM_SOHNUMDEB
Call AM_SOHNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "SOHNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_SOHNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_SOHNUMDEB(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "SOHNUMDEB" : GZNUM = 51167 : Endif
Gosub _AFF
End

Subprog S_SOHNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJCRIT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJCRIT"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 PARMSK(4) = "GCTLDATORI<>2 | (GCTLDATORI=2 & [F:SOH]ORDDAT<=[M]INVDAT)"
 PARMSK(5) = "[F:SOH]SOHCAT=1 & [F:SOH]INVSTA<>3 & [F:SOH]SALFCY=[M]SALFCY"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJCRIT","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SOHNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJAW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJAW"
 PARMSK(1) = "SOH"
 PARMSK(2) = ""
 PARMSK(3) = "#"
 PARMSK(4) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_SOHNUMFIN
Onevent CONTROL Call C_SOHNUMFIN(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_SOHNUMFIN(zc) From W1SAUTINVSCH
Return

Subprog AS_SOHNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16134,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_SOHNUMFIN(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_SOHNUMFIN(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_SOHNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "SOHNUMFIN" : GZNUM = 51168 : Endif
Endif
If !mkstat
 ## Action CTLALPVALW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CTLALPVALW"
 PARMSK(1) = [M]SOHNUMDEB
 Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "SOHNUMFIN" : GZNUM = 51168 : Endif
Endif
Gosub _AFF
End

Subprog S_SOHNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJCRIT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJCRIT"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 PARMSK(4) = "GCTLDATORI<>2 | (GCTLDATORI=2 & [F:SOH]ORDDAT<=[M]INVDAT)"
 PARMSK(5) = "[F:SOH]SOHCAT=1 & [F:SOH]INVSTA<>3 & [F:SOH]SALFCY=[M]SALFCY"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJCRIT","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_SOHNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJAW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJAW"
 PARMSK(1) = "SOH"
 PARMSK(2) = ""
 PARMSK(3) = "#"
 PARMSK(4) = ""
 Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_PJTNUMDEB
Onevent BEFORE_INPUT Call AS_PJTNUMDEB(zc) From W1SAUTINVSCH
Onevent CONTROL Call C_PJTNUMDEB(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_PJTNUMDEB From W1SAUTINVSCH
Return

Subprog IB_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTNUMDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat=2
 [M]PJTNUMDEB(INDIC) = VALEUR
 Affzo PJTNUMDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 130 Titled GBOUT2 Call B2_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 131 Titled GBOUT3 Call B3_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 132 Titled GBOUT4 Call B4_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 172 Titled GBOUT15 Call B15_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 173 Titled GBOUT16 Call B16_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 174 Titled GBOUT17 Call B17_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 175 Titled GBOUT18 Call B18_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 176 Titled GBOUT19 Call B19_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_PJTNUMDEB(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_PJTNUMDEB(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTNUMDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTNUMDEB" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

$AMM_PJTNUMDEB
Call AM_PJTNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "PJTNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTNUMDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTNUMDEB(VALEUR) From FUNAUTINVSCH
 If mkstat : GERR = 1 : GZONE = "PJTNUMDEB" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

Subprog S_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","PJTNUMDEB",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PJTNUMFIN
Onevent BEFORE_INPUT Call AS_PJTNUMFIN(zc) From W1SAUTINVSCH
Onevent CONTROL Call C_PJTNUMFIN(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_PJTNUMFIN From W1SAUTINVSCH
Return

Subprog IB_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTNUMFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat=2
 [M]PJTNUMFIN(INDIC) = VALEUR
 Affzo PJTNUMFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 130 Titled GBOUT2 Call B2_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 131 Titled GBOUT3 Call B3_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 132 Titled GBOUT4 Call B4_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 172 Titled GBOUT15 Call B15_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 173 Titled GBOUT16 Call B16_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 174 Titled GBOUT17 Call B17_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 175 Titled GBOUT18 Call B18_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 176 Titled GBOUT19 Call B19_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_PJTNUMFIN(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_PJTNUMFIN(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTNUMFIN" : GZNUM = 54672 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTNUMFIN" : GZNUM = 54672 : Endif
 If !mkstat
  ## Action CTLALPVALW
  Local Char    PARMSK(250)(1..20) , SAVACT(20)
  SAVACT = GACTION : GACTION = "CTLALPVALW"
  PARMSK(1) = [M]PJTNUMDEB
  Call S_AFF_CHAR(VALEUR,PARMSK,"CTLALPVAL","CONTX3","") From GACTION
  GACTION = SAVACT
  If mkstat : GERR = 1 : GZONE = "PJTNUMFIN" : GZNUM = 54672 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTNUMFIN
Call AM_PJTNUMFIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTNUMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
&,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
&,"","","",[M]CPY) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTNUMFIN" : GZNUM = 54672 : Endif
Gosub _AFF
End

Subprog S_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","PJTNUMFIN",0,5,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M]SALFCY,""
& ,"","","",[M]CPY) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "PJTNUMFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "5"
 PARMSK(5) = num$([V]CST_ANO)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_AYES)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M]SALFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = [M]CPY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_TRSFAM
Onevent INIT_AREA Call D_TRSFAM(zc) From W1SAUTINVSCH
Return

Subprog D_TRSFAM(VALEUR)
Variable Char    VALEUR()
If varinit([M]TRSFAM,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"","") From SUBADI
Endif
Gosub _AFF
End

$ON_TRSCOD
Onevent INIT_AREA Call D_TRSCOD(zc) From W1SAUTINVSCH
Return

Subprog D_TRSCOD(VALEUR)
Variable Char    VALEUR()
If varinit([M]TRSCOD,indice)=0
 ## Action INILEG
 Call INILEG(VALEUR,"","") From SUBADI
Endif
Gosub _AFF
End

$ON_ENTCOD
Return

$ON_PRNFLG
Onevent AFTER_AREA Call AP_PRNFLG(zc) From W1SAUTINVSCH
Onevent INIT_AREA Call D_PRNFLG(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_PRNFLG(zc) From W1SAUTINVSCH
Return

Subprog D_PRNFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]PRNFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_PRNFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AP_PRNFLG(VALEUR)
Variable Integer VALEUR
## Action STD
Call AP_PRNFLG(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "PRNFLG" : GZNUM = 9784 : Endif
Gosub _AFF
End

$ON_PRNNAM
Onevent CONTROL Call C_PRNNAM(zc) From W1SAUTINVSCH
Onevent BEFORE_INPUT Call AS_PRNNAM(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_PRNNAM From W1SAUTINVSCH
Return

Subprog AS_PRNNAM(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_PRNNAM(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_PRNNAM(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_PRNNAM(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_PRNNAM(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("ARP","!SL",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PRNNAM" : GZNUM = 5169 : Endif
If !mkstat
 ## Action ARPCONT
 Call ARPCONT(VALEUR) From IMPRIME
 If mkstat : GERR = 1 : GZONE = "PRNNAM" : GZNUM = 5169 : Endif
 If !mkstat
  ## Action STD
  Call C_PRNNAM(VALEUR) From FUNAUTINVSCH
  If mkstat : GERR = 1 : GZONE = "PRNNAM" : GZNUM = 5169 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PRNNAM
Call AM_PRNNAM(zc)
If !mkstat & GOBJET
 zoncou = "PRNNAM" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRNNAM(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPRNNAM)")>indice
 [M]PRNNAM(indice) = VALEUR
 Affzo ZPRNNAM(indice)
Endif
Gosub _AFF
End

Subprog S_PRNNAM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "ARP"
PARMSK(2) = "!SL"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_PRNNAM(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ARP"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PRNNAM(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ARP",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPRNNAM
Onevent BEFORE_AREA Gosub AV_ZPRNNAM From W1SAUTINVSCH
Return

$AV_ZPRNNAM
If clalev([F:ARP])=0 : Local File AREPORT [ARP] : Endif
Call LECTURE("ARP",[M]PRNNAM(indice),"") From CONTOBJ
Call TEXTE([F:ARP]RPTDES,zc) From OBJDIV
Gosub _AFF
Return

$ON_TYPIMP
Onevent INIT_AREA Call D_TYPIMP(zc) From W1SAUTINVSCH
Return

Subprog D_TYPIMP(VALEUR)
Variable Integer VALEUR
If varinit([M]TYPIMP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_PRNDEN
Onevent BEFORE_INPUT Call AS_PRNDEN(zc) From W1SAUTINVSCH
Onevent CONTROL Call C_PRNDEN(zc) From W1SAUTINVSCH
Onevent AFTER_AREA Call AP_PRNDEN(zc) From W1SAUTINVSCH
Onevent AFTER_CHANGE Gosub AMM_PRNDEN From W1SAUTINVSCH
Return

Subprog AS_PRNDEN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(24851,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action TCAIMDEF
Call TCAIMDEF(VALEUR,[M]PRNNAM,GBIDC1,GBIDC2) From CONTX3
If mkstat=2
 [M]PRNDEN(INDIC) = VALEUR
 Affzo PRNDEN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PRNDEN(zc) From W1SAUTINVSCH
Onkey   2 Titled GBOUTS Call S_PRNDEN(zc) From W1SAUTINVSCH
Onkey 144 Titled GBOUTP Call P_PRNDEN(zc) From W1SAUTINVSCH
Onkey 146 Titled GBOUTA Call SA_PRNDEN(zc) From W1SAUTINVSCH
Gosub _AFF
End

Subprog C_PRNDEN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("AIM","!A",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "PRNDEN" : GZNUM = 5231 : Endif
If !mkstat
 ## Action AIMCONT
 Call AIMCONT(VALEUR,[M]PRNNAM,GBATCH) From IMPRIME
 If mkstat : GERR = 1 : GZONE = "PRNDEN" : GZNUM = 5231 : Endif
 If !mkstat
  ## Action STD
  Call C_PRNDEN(VALEUR) From FUNAUTINVSCH
  If mkstat : GERR = 1 : GZONE = "PRNDEN" : GZNUM = 5231 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog AP_PRNDEN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AP_PRNDEN(VALEUR) From FUNAUTINVSCH
If mkstat : GERR = 1 : GZONE = "PRNDEN" : GZNUM = 5231 : Endif
Gosub _AFF
End

$AMM_PRNDEN
Call AM_PRNDEN(zc)
If !mkstat & GOBJET
 zoncou = "PRNDEN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PRNDEN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZPRNDEN)")>indice
 [M]PRNDEN(indice) = VALEUR
 Affzo ZPRNDEN(indice)
Endif
Gosub _AFF
End

Subprog S_PRNDEN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ASELAIM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ASELAIM"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ASELAIM","SUBAIM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PRNDEN(VALEUR)
Variable Char    VALEUR()
Call OBJET("AIM",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_PRNDEN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "AIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PRNDEN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("AIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZPRNDEN
Onevent BEFORE_AREA Gosub AV_ZPRNDEN From W1SAUTINVSCH
Return

$AV_ZPRNDEN
If clalev([F:AIM])=0 : Local File APRINTER [AIM] : Endif
Call LECTURE("AIM",num$([M]PRNDEN(indice)),"") From CONTOBJ
zc = [F:AIM]DES
Gosub _AFF
Return

$ON_GTE
Return

$ON_ABT
Onevent INIT_AREA Call D_ABT(zc) From W1SAUTINVSCH
Return

Subprog D_ABT(VALEUR)
Variable Integer VALEUR
If varinit([M]ABT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Return


