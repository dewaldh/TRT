#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management POHA 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:08:35"
A_USER  = "ADMIN"
A_STAMP = "20180828000835"
Return

$TITRES
Return

$CHG_FMT
Case zoncou
 When "NBLIG"
  If [M]NBLIG=0
   If GFORREM(0)<>""
    Chgfmt DISCRGVAL1 With GFORREM(0)
   Else
    Chgfmt DISCRGVAL1 With "-K:1X"
   Endif
   If GFORREM(1)<>""
    Chgfmt DISCRGVAL2 With GFORREM(1)
   Else
    Chgfmt DISCRGVAL2 With "-K:1X"
   Endif
   If GFORREM(2)<>""
    Chgfmt DISCRGVAL3 With GFORREM(2)
   Else
    Chgfmt DISCRGVAL3 With "-K:1X"
   Endif
   If GFMTCOA(1)<>""
    Chgfmt LINACC1 With GFMTCOA(1)
   Else
    Chgfmt LINACC1 With "-K:1X"
   Endif
   If GFMTCOA(2)<>""
    Chgfmt LINACC2 With GFMTCOA(2)
   Else
    Chgfmt LINACC2 With "-K:1X"
   Endif
   If GFMTCOA(3)<>""
    Chgfmt LINACC3 With GFMTCOA(3)
   Else
    Chgfmt LINACC3 With "-K:1X"
   Endif
   If GFMTCOA(4)<>""
    Chgfmt LINACC4 With GFMTCOA(4)
   Else
    Chgfmt LINACC4 With "-K:1X"
   Endif
   If GFMTCOA(5)<>""
    Chgfmt LINACC5 With GFMTCOA(5)
   Else
    Chgfmt LINACC5 With "-K:1X"
   Endif
   If GFMTCOA(6)<>""
    Chgfmt LINACC6 With GFMTCOA(6)
   Else
    Chgfmt LINACC6 With "-K:1X"
   Endif
   If GFMTCOA(7)<>""
    Chgfmt LINACC7 With GFMTCOA(7)
   Else
    Chgfmt LINACC7 With "-K:1X"
   Endif
   If GFMTCOA(8)<>""
    Chgfmt LINACC8 With GFMTCOA(8)
   Else
    Chgfmt LINACC8 With "-K:1X"
   Endif
   If GFMTCOA(9)<>""
    Chgfmt LINACC9 With GFMTCOA(9)
   Else
    Chgfmt LINACC9 With "-K:1X"
   Endif
   If GFMTCOA(10)<>""
    Chgfmt LINACC10 With GFMTCOA(10)
   Else
    Chgfmt LINACC10 With "-K:1X"
   Endif
   If GFMTDIE(1)<>""
    Chgfmt CCE1 With GFMTDIE(1)
   Else
    Chgfmt CCE1 With "-K:1X"
   Endif
   If GFMTDIE(2)<>""
    Chgfmt CCE2 With GFMTDIE(2)
   Else
    Chgfmt CCE2 With "-K:1X"
   Endif
   If GFMTDIE(3)<>""
    Chgfmt CCE3 With GFMTDIE(3)
   Else
    Chgfmt CCE3 With "-K:1X"
   Endif
   If GFMTDIE(4)<>""
    Chgfmt CCE4 With GFMTDIE(4)
   Else
    Chgfmt CCE4 With "-K:1X"
   Endif
   If GFMTDIE(5)<>""
    Chgfmt CCE5 With GFMTDIE(5)
   Else
    Chgfmt CCE5 With "-K:1X"
   Endif
   If GFMTDIE(6)<>""
    Chgfmt CCE6 With GFMTDIE(6)
   Else
    Chgfmt CCE6 With "-K:1X"
   Endif
   If GFMTDIE(7)<>""
    Chgfmt CCE7 With GFMTDIE(7)
   Else
    Chgfmt CCE7 With "-K:1X"
   Endif
   If GFMTDIE(8)<>""
    Chgfmt CCE8 With GFMTDIE(8)
   Else
    Chgfmt CCE8 With "-K:1X"
   Endif
   If GFMTDIE(9)<>""
    Chgfmt CCE9 With GFMTDIE(9)
   Else
    Chgfmt CCE9 With "-K:1X"
   Endif
   If GFMTDIE(10)<>""
    Chgfmt CCE10 With GFMTDIE(10)
   Else
    Chgfmt CCE10 With "-K:1X"
   Endif
   If GFMTDIE(11)<>""
    Chgfmt CCE11 With GFMTDIE(11)
   Else
    Chgfmt CCE11 With "-K:1X"
   Endif
   If GFMTDIE(12)<>""
    Chgfmt CCE12 With GFMTDIE(12)
   Else
    Chgfmt CCE12 With "-K:1X"
   Endif
   If GFMTDIE(13)<>""
    Chgfmt CCE13 With GFMTDIE(13)
   Else
    Chgfmt CCE13 With "-K:1X"
   Endif
   If GFMTDIE(14)<>""
    Chgfmt CCE14 With GFMTDIE(14)
   Else
    Chgfmt CCE14 With "-K:1X"
   Endif
   If GFMTDIE(15)<>""
    Chgfmt CCE15 With GFMTDIE(15)
   Else
    Chgfmt CCE15 With "-K:1X"
   Endif
   If GFMTDIE(16)<>""
    Chgfmt CCE16 With GFMTDIE(16)
   Else
    Chgfmt CCE16 With "-K:1X"
   Endif
   If GFMTDIE(17)<>""
    Chgfmt CCE17 With GFMTDIE(17)
   Else
    Chgfmt CCE17 With "-K:1X"
   Endif
   If GFMTDIE(18)<>""
    Chgfmt CCE18 With GFMTDIE(18)
   Else
    Chgfmt CCE18 With "-K:1X"
   Endif
   If GFMTDIE(19)<>""
    Chgfmt CCE19 With GFMTDIE(19)
   Else
    Chgfmt CCE19 With "-K:1X"
   Endif
   If GFMTDIE(20)<>""
    Chgfmt CCE20 With GFMTDIE(20)
   Else
    Chgfmt CCE20 With "-K:1X"
   Endif
  Endif
Endcase
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask POHA [POHA]
Gosub HORODAT
Local Inpbox "POHA" From GFONCTION At A_STAMP With A_WINDPREV Mask [POHA] As [SIM_]
Grizo [POHA]5
Grizo [POHA]10
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [POHA]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=5 : X2(0)=108 : Y1(0)=6 : Y2(0)=7
X1(1)=5 : X2(1)=108 : Y1(1)=8 : Y2(1)=22
Return

$ON_POHNUM
Return

$ON_CUR
Return

$ON_ZCUR
Onevent BEFORE_AREA Gosub AV_ZCUR From W1POHA
Return

$AV_ZCUR
Call LECTEXTRA(zc,"TABCUR","INTDES",num$([M]CUR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_NBLIG
Onevent BEFORE_AREA Call AV_NBLIG From W1POHA
Return

Subprog AV_NBLIG
Local Decimal BASPAG
If adxgtb=1 & !GORITITCOL & nolign=1
 Local Char BASPAG(10)
 BASPAG = "NBLIG" : Gosub TIT_COL From W3POHA
Endif
Gosub _AFF
End

$ON_NOLIGNE
Onevent BEFORE_AREA Gosub AV_NOLIGNE From W1POHA
Return

$AV_NOLIGNE
zc = nolign
Gosub _AFF
Return

$ON_LINREVDAT
Onevent BEFORE_AREA Gosub AV_LINREVDAT From W1POHA
Return

$AV_LINREVDAT
Chgfmt [M]LINREVDAT(indice) With "DPZ:"+GFMDAT
Gosub _AFF
Return

$ON_ITMDES
Onevent BEFORE_AREA Gosub AV_ITMDES From W1POHA
Return

$AV_ITMDES
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"ITMDES") From TRTX3
Gosub _AFF
Return

$ON_PRHFCY
Onevent BEFORE_AREA Gosub AV_PRHFCY From W1POHA
Return

$AV_PRHFCY
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"PRHFCY") From TRTX3
Gosub _AFF
Return

$ON_FCYADD
Onevent BEFORE_AREA Gosub AV_FCYADD From W1POHA
Return

$AV_FCYADD
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"FCYADD") From TRTX3
Gosub _AFF
Return

$ON_USEPLC
Onevent BEFORE_AREA Gosub AV_USEPLC From W1POHA
Return

$AV_USEPLC
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"USEPLC") From TRTX3
Gosub _AFF
Return

$ON_LINSTOFCY
Onevent BEFORE_AREA Gosub AV_LINSTOFCY From W1POHA
Return

$AV_LINSTOFCY
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"LINSTOFCY") From TRTX3
Gosub _AFF
Return

$ON_SCOADD
Onevent BEFORE_AREA Gosub AV_SCOADD From W1POHA
Return

$AV_SCOADD
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"SCOADD") From TRTX3
Gosub _AFF
Return

$ON_UOM
Onevent BEFORE_AREA Gosub AV_UOM From W1POHA
Return

$AV_UOM
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"UOM") From TRTX3
Gosub _AFF
Return

$ON_UOMFLG
Onevent INIT_AREA Call D_UOMFLG(zc) From W1POHA
Return

Subprog D_UOMFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]UOMFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_QTYUOM
Onevent BEFORE_AREA Gosub AV_QTYUOM From W1POHA
Return

$AV_QTYUOM
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find(UOM(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"QTYUOM") From TRTX3
Chgfmt [M]QTYUOM(indice) With "NPzc:"+GUNTFMT
Gosub _AFF
Return

$ON_UOMPUUCOE
Onevent BEFORE_AREA Gosub AV_UOMPUUCOE From W1POHA
Return

$AV_UOMPUUCOE
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"UOMPUUCOE") From TRTX3
Gosub _AFF
Return

$ON_PUU
Onevent BEFORE_AREA Gosub AV_PUU From W1POHA
Return

$AV_PUU
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"PUU") From TRTX3
Gosub _AFF
Return

$ON_STU
Onevent BEFORE_AREA Gosub AV_STU From W1POHA
Return

$AV_STU
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"STU") From TRTX3
Gosub _AFF
Return

$ON_QTYSTU
Onevent BEFORE_AREA Gosub AV_QTYSTU From W1POHA
Return

$AV_QTYSTU
If !GWEBSERV
 ## Action FMTQTY
 GUNTFMT="15F" : GUNTFMT = GUNTFMT1(max(find(STU(nolign-1),GUNITE(1..GNBUNT)),1))
Endif
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"QTYSTU") From TRTX3
Chgfmt [M]QTYSTU(indice) With "NPzc:"+GUNTFMT
Gosub _AFF
Return

$ON_PJT
Onevent BEFORE_AREA Gosub AV_PJT From W1POHA
Return

$AV_PJT
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"PJT") From TRTX3
Gosub _AFF
Return

$ON_EXTRCPDAT
Onevent BEFORE_AREA Gosub AV_EXTRCPDAT From W1POHA
Return

$AV_EXTRCPDAT
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"EXTRCPDAT") From TRTX3
Chgfmt [M]EXTRCPDAT(indice) With "DPcZ:"+GFMDAT
Gosub _AFF
Return

$ON_GROPRI
Onevent BEFORE_AREA Gosub AV_GROPRI From W1POHA
Return

$AV_GROPRI
If !GWEBSERV
 ## Action PARDEV
Endif
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"GROPRI") From TRTX3
Gosub _AFF
Return

$ON_DISCRGVAL1
Onevent BEFORE_AREA Gosub AV_DISCRGVAL1 From W1POHA
Return

$AV_DISCRGVAL1
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"DISCRGVAL1","AWARNHIGH") From TRTX3
If GFORREM(0)<>""
 Chgfmt [M]DISCRGVAL1(indice) With GFORREM(0)
Else
 Chgfmt [M]DISCRGVAL1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_DISCRGVAL2
Onevent BEFORE_AREA Gosub AV_DISCRGVAL2 From W1POHA
Return

$AV_DISCRGVAL2
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"DISCRGVAL2","AWARNHIGH") From TRTX3
If GFORREM(1)<>""
 Chgfmt [M]DISCRGVAL2(indice) With GFORREM(1)
Else
 Chgfmt [M]DISCRGVAL2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_DISCRGVAL3
Onevent BEFORE_AREA Gosub AV_DISCRGVAL3 From W1POHA
Return

$AV_DISCRGVAL3
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"DISCRGVAL3","AWARNHIGH") From TRTX3
If GFORREM(2)<>""
 Chgfmt [M]DISCRGVAL3(indice) With GFORREM(2)
Else
 Chgfmt [M]DISCRGVAL3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_NETPRI
Onevent BEFORE_AREA Gosub AV_NETPRI From W1POHA
Return

$AV_NETPRI
If !GWEBSERV
 ## Action PARDEV
Endif
## Action PAVRCOLOR
Call PAVRCOLOR("POHA",nolign-1,"NETPRI") From TRTX3
Gosub _AFF
Return

$ON_LINAMT
Onevent BEFORE_AREA Gosub AV_LINAMT From W1POHA
Return

$AV_LINAMT
## Action INIDEV
GDEVFMT="11.2" : GDEVFMT = GDEVFMT1(max(find([M:POHA]CUR,GDEVISE(1..GNBDEV)),1))
Gosub _AFF
Return

$ON_LINACC1
Onevent BEFORE_AREA Gosub AV_LINACC1 From W1POHA
Return

$AV_LINACC1
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(1))) From SETGLBCOA
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"LINACC1","AWARNHIGH") From TRTX3
If GFMTCOA(1)<>""
 Chgfmt [M]LINACC1(indice) With GFMTCOA(1)
Else
 Chgfmt [M]LINACC1(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_LINACC2
Onevent BEFORE_AREA Gosub AV_LINACC2 From W1POHA
Return

$AV_LINACC2
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(2))) From SETGLBCOA
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"LINACC2","AWARNHIGH") From TRTX3
If GFMTCOA(2)<>""
 Chgfmt [M]LINACC2(indice) With GFMTCOA(2)
Else
 Chgfmt [M]LINACC2(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_LINACC3
Onevent BEFORE_AREA Gosub AV_LINACC3 From W1POHA
Return

$AV_LINACC3
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(3))) From SETGLBCOA
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"LINACC3","AWARNHIGH") From TRTX3
If GFMTCOA(3)<>""
 Chgfmt [M]LINACC3(indice) With GFMTCOA(3)
Else
 Chgfmt [M]LINACC3(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_LINACC4
Onevent BEFORE_AREA Gosub AV_LINACC4 From W1POHA
Return

$AV_LINACC4
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(4))) From SETGLBCOA
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"LINACC4","AWARNHIGH") From TRTX3
If GFMTCOA(4)<>""
 Chgfmt [M]LINACC4(indice) With GFMTCOA(4)
Else
 Chgfmt [M]LINACC4(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$ON_LINACC5
Onevent BEFORE_AREA Gosub AV_LINACC5 From W1POHA
Return

$AV_LINACC5
## Action INIACCFMT
Call INIACCFMT(num$(GCOA(5))) From SETGLBCOA
## Action REVCHGASY
Call REVCHGASY("POHA",nolign-1,"LINACC5","AWARNHIGH") From TRTX3
If GFMTCOA(5)<>""
 Chgfmt [M]LINACC5(indice) With GFMTCOA(5)
Else
 Chgfmt [M]LINACC5(indice) With "-K:1X"
Endif
Gosub _AFF
Return

$CHG_STY
Gosub CHG_STY From W3POHA
Return

$TIT_COL
Gosub TIT_COL From W3POHA
Return


