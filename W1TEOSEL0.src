#<AdxTL>@(#)0.0.0.0 $Revision$
# Supervisor
# Mask management TEOSEL0 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [28/08/2018]
A_HEURE = "00:16:15"
A_USER  = "ADMIN"
A_STAMP = "20180828001615"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask TEOSEL0 [DIA]
Gosub HORODAT
Local Inpbox "TEOSEL0" From GFONCTION At A_STAMP With A_WINDPREV Mask [DIA] As [SIM_]
Grizo [DIA]5
Grizo [DIA]10
Grizo [DIA]15
Grizo [DIA]20
Grizo [DIA]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [DIA]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=113 : Y1(0)=6 : Y2(0)=8
X1(1)=1 : X2(1)=113 : Y1(1)=9 : Y2(1)=15
X1(2)=1 : X2(2)=113 : Y1(2)=16 : Y2(2)=17
X1(3)=1 : X2(3)=113 : Y1(3)=18 : Y2(3)=21
X1(4)=1 : X2(4)=113 : Y1(4)=22 : Y2(4)=23
Return

$ON_WPOHFCY
Onevent CONTROL Call C_WPOHFCY(zc) From W1TEOSEL0
Onevent BEFORE_AREA Gosub AV_WPOHFCY From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPOHFCY From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WPOHFCY(zc) From W1TEOSEL0
Onevent INIT_AREA Call D_WPOHFCY(zc) From W1TEOSEL0
Return

$AV_WPOHFCY
## Action STD
Call AV_WPOHFCY(zc) From FUNTEOCLO
Gosub _AFF
Return

Subprog D_WPOHFCY(VALEUR)
Variable Char    VALEUR()
If varinit([M]WPOHFCY,indice)=0
 VALEUR = GFCYDEF(6)
Endif
Gosub _AFF
End

Subprog AS_WPOHFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_WPOHFCY(zc) From W1TEOSEL0
Onkey   2 Titled GBOUTS Call S_WPOHFCY(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WPOHFCY(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WPOHFCY(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WPOHFCY(VALEUR)
Variable Char    VALEUR()
## Action %OBLIG
If vireblc(VALEUR,2)=""
 mkstat = 1 : GMESSAGE = mess(10,123,1)
Endif
If mkstat : GERR = 1 : GZONE = "WPOHFCY" : GZNUM = 2550 : Endif
If !mkstat
 ## Action ACONTFCY
 Call CONTSITE(VALEUR) From SUBAGF
 If mkstat : GERR = 1 : GZONE = "WPOHFCY" : GZNUM = 2550 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("FCY","",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WPOHFCY" : GZNUM = 2550 : Endif
  If !mkstat
   ## Action STD
   Call C_WPOHFCY(VALEUR) From FUNTEOCLO
   If mkstat : GERR = 1 : GZONE = "WPOHFCY" : GZNUM = 2550 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WPOHFCY
Call AM_WPOHFCY(zc)
If !mkstat & GOBJET
 zoncou = "WPOHFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPOHFCY(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WPOHFCY(VALEUR) From FUNTEOCLO
If mkstat : GERR = 1 : GZONE = "WPOHFCY" : GZNUM = 2550 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWPOHFCY)")>indice
 [M]WPOHFCY(indice) = VALEUR
 Affzo ZWPOHFCY(indice)
Endif
Gosub _AFF
End

Subprog S_WPOHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "FCY"
PARMSK(2) = ""
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_WPOHFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_WPOHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPOHFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWPOHFCY
Onevent BEFORE_AREA Gosub AV_ZWPOHFCY From W1TEOSEL0
Return

$AV_ZWPOHFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]WPOHFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_WTRAIT
Onevent INIT_AREA Call D_WTRAIT(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WTRAIT(zc) From W1TEOSEL0
Onevent CONTROL Call C_WTRAIT(zc) From W1TEOSEL0
Return

Subprog D_WTRAIT(VALEUR)
Variable Integer VALEUR
If varinit([M]WTRAIT,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_WTRAIT(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(2373) From COMBOS
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,2373,1))))
Endif
If !mkstat
 Discombo 0 From WTRAIT(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From WTRAIT(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_WTRAIT(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_WNUMDEB
Onevent AFTER_CHANGE Gosub AMM_WNUMDEB From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WNUMDEB(zc) From W1TEOSEL0
Onevent CONTROL Call C_WNUMDEB(zc) From W1TEOSEL0
Return

Subprog AS_WNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WNUMDEB(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WNUMDEB(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WNUMDEB(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("SCO","!A",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WNUMDEB" : GZNUM = 55966 : Endif
Gosub _AFF
End

$AMM_WNUMDEB
Call AM_WNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "WNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WNUMDEB(VALEUR) From FUNTEOCLO
If mkstat : GERR = 1 : GZONE = "WNUMDEB" : GZNUM = 55966 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWNUMDEB)")>indice
 [M]WNUMDEB(indice) = VALEUR
 Affzo ZWNUMDEB(indice)
Endif
Gosub _AFF
End

Subprog S_WNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSCONUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSCONUM"
 PARMSK(1) = [M]WPOHFCY
 PARMSK(2) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSCONUM","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "SCO"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("SCO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWNUMDEB
Onevent BEFORE_AREA Gosub AV_ZWNUMDEB From W1TEOSEL0
Return

$AV_ZWNUMDEB
If clalev([F:SCO])=0 : Local File SCOHEAD [SCO] : Endif
Call LECTURE("SCO",num$([M]WNUMDEB(indice)),"") From CONTOBJ
zc = [F:SCO]SCODES
Gosub _AFF
Return

$ON_WNUMFIN
Onevent BEFORE_INPUT Call AS_WNUMFIN(zc) From W1TEOSEL0
Onevent CONTROL Call C_WNUMFIN(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WNUMFIN From W1TEOSEL0
Return

Subprog AS_WNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_WNUMFIN(VALEUR) From FUNTEOCLO
If mkstat=2
 [M]WNUMFIN(INDIC) = VALEUR
 Affzo WNUMFIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WNUMFIN(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WNUMFIN(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WNUMFIN(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WNUMFIN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("SCO","!A",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "WNUMFIN" : GZNUM = 55967 : Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]WNUMDEB) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "WNUMFIN" : GZNUM = 55967 : Endif
Endif
Gosub _AFF
End

$AMM_WNUMFIN
Call AM_WNUMFIN(zc)
If !mkstat & GOBJET
 zoncou = "WNUMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WNUMFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWNUMFIN)")>indice
 [M]WNUMFIN(indice) = VALEUR
 Affzo ZWNUMFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELSCONUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELSCONUM"
 PARMSK(1) = [M]WPOHFCY
 PARMSK(2) = "1"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELSCONUM","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "SCO"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("SCO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWNUMFIN
Onevent BEFORE_AREA Gosub AV_ZWNUMFIN From W1TEOSEL0
Return

$AV_ZWNUMFIN
If clalev([F:SCO])=0 : Local File SCOHEAD [SCO] : Endif
Call LECTURE("SCO",num$([M]WNUMFIN(indice)),"") From CONTOBJ
zc = [F:SCO]SCODES
Gosub _AFF
Return

$ON_WITMDEB
Onevent CONTROL Call C_WITMDEB(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WITMDEB From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WITMDEB(zc) From W1TEOSEL0
Return

Subprog IB_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMDEB(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_WITMDEB(zc) From W1TEOSEL0
Onkey   2 Titled GBOUTS Call S_WITMDEB(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WITMDEB(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WITMDEB(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 54934 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 54934 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!D",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 54934 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMDEB
Call AM_WITMDEB(zc)
If !mkstat & GOBJET
 zoncou = "WITMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WITMDEB(VALEUR) From FUNTEOCLO
If mkstat : GERR = 1 : GZONE = "WITMDEB" : GZNUM = 54934 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWITMDEB)")>indice
 [M]WITMDEB(indice) = VALEUR
 Affzo ZWITMDEB(indice)
Endif
Gosub _AFF
End

Subprog S_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SCOSELSCI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SCOSELSCI"
 PARMSK(1) = [M]WPOHFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SCOSELSCI","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_WITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMDEB
Onevent BEFORE_AREA Gosub AV_ZWITMDEB From W1TEOSEL0
Return

$AV_ZWITMDEB
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WITMFIN
Onevent CONTROL Call C_WITMFIN(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WITMFIN(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WITMFIN From W1TEOSEL0
Return

Subprog IB_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WITMFIN(VALEUR)
## Action STD
Call AS_WITMFIN(VALEUR) From FUNTEOCLO
If mkstat=2
 [M]WITMFIN(INDIC) = VALEUR
 Affzo WITMFIN(INDIC) : mkstat = 2
Endif
Onkey 170 Titled GBOUT13 Call B13_WITMFIN(zc) From W1TEOSEL0
Onkey   2 Titled GBOUTS Call S_WITMFIN(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WITMFIN(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WITMFIN(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 54935 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 54935 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!D",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 54935 : Endif
  If !mkstat
   ## Action CTLALPV
   Call CTLALPV(VALEUR,[M]WITMDEB) From CONTDIV
   If mkstat : GERR = 1 : GZONE = "WITMFIN" : GZNUM = 54935 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WITMFIN
Call AM_WITMFIN(zc)
If !mkstat & GOBJET
 zoncou = "WITMFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWITMFIN)")>indice
 [M]WITMFIN(indice) = VALEUR
 Affzo ZWITMFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SCOSELSCI
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SCOSELSCI"
 PARMSK(1) = [M]WPOHFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SCOSELSCI","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_WITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WITMFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWITMFIN
Onevent BEFORE_AREA Gosub AV_ZWITMFIN From W1TEOSEL0
Return

$AV_ZWITMFIN
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]WITMFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WDATDEB
Onevent BEFORE_AREA Gosub AV_WDATDEB From W1TEOSEL0
Return

$AV_WDATDEB
Chgfmt [M]WDATDEB(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

$ON_WDATFIN
Onevent BEFORE_INPUT Call AS_WDATFIN(zc) From W1TEOSEL0
Onevent CONTROL Call C_WDATFIN(zc) From W1TEOSEL0
Onevent BEFORE_AREA Gosub AV_WDATFIN From W1TEOSEL0
Return

$AV_WDATFIN
Chgfmt [M]WDATFIN(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_WDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
## Action STD
Call AS_WDATFIN(VALEUR) From FUNTEOCLO
If mkstat=2
 [M]WDATFIN(INDIC) = VALEUR
 Affzo WDATFIN(INDIC) : mkstat = 2
Endif
Gosub _AFF
End

Subprog C_WDATFIN(VALEUR)
Variable Date    VALEUR
## Action CTLDATV
Call CTLDATV(VALEUR,[M]WDATDEB) From CONTDIV
If mkstat : GERR = 1 : GZONE = "WDATFIN" : GZNUM = 1806 : Endif
Gosub _AFF
End

$ON_WPJTDEB
Onevent BEFORE_INPUT Call AS_WPJTDEB(zc) From W1TEOSEL0
Onevent CONTROL Call C_WPJTDEB(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPJTDEB From W1TEOSEL0
Return

Subprog IB_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat=2
 [M]WPJTDEB(INDIC) = VALEUR
 Affzo WPJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WPJTDEB(zc) From W1TEOSEL0
Onkey 130 Titled GBOUT2 Call B2_WPJTDEB(zc) From W1TEOSEL0
Onkey 131 Titled GBOUT3 Call B3_WPJTDEB(zc) From W1TEOSEL0
Onkey 132 Titled GBOUT4 Call B4_WPJTDEB(zc) From W1TEOSEL0
Onkey 172 Titled GBOUT15 Call B15_WPJTDEB(zc) From W1TEOSEL0
Onkey 173 Titled GBOUT16 Call B16_WPJTDEB(zc) From W1TEOSEL0
Onkey 174 Titled GBOUT17 Call B17_WPJTDEB(zc) From W1TEOSEL0
Onkey 175 Titled GBOUT18 Call B18_WPJTDEB(zc) From W1TEOSEL0
Onkey 176 Titled GBOUT19 Call B19_WPJTDEB(zc) From W1TEOSEL0
Onkey   2 Titled GBOUTS Call S_WPJTDEB(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WPJTDEB(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WPJTDEB(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 54671 : Endif
Endif
Gosub _AFF
End

$AMM_WPJTDEB
Call AM_WPJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "WPJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 54671 : Endif
If !mkstat
 ## Action STD
 Call AM_WPJTDEB(VALEUR) From FUNTEOCLO
 If mkstat : GERR = 1 : GZONE = "WPJTDEB" : GZNUM = 54671 : Endif
 If !mkstat & evalue("dim("+clanam([M])+"ZWPJTDEB)")>indice
  [M]WPJTDEB(indice) = VALEUR
  Affzo ZWPJTDEB(indice)
 Endif
Endif
Gosub _AFF
End

Subprog S_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","WPJTDEB",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWPJTDEB
Onevent BEFORE_AREA Gosub AV_ZWPJTDEB From W1TEOSEL0
Return

$AV_ZWPJTDEB
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]WPJTDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WPJTFIN
Onevent BEFORE_INPUT Call AS_WPJTFIN(zc) From W1TEOSEL0
Onevent CONTROL Call C_WPJTFIN(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPJTFIN From W1TEOSEL0
Return

Subprog IB_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_WPJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat=2
 [M]WPJTFIN(INDIC) = VALEUR
 Affzo WPJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_WPJTFIN(zc) From W1TEOSEL0
Onkey 130 Titled GBOUT2 Call B2_WPJTFIN(zc) From W1TEOSEL0
Onkey 131 Titled GBOUT3 Call B3_WPJTFIN(zc) From W1TEOSEL0
Onkey 132 Titled GBOUT4 Call B4_WPJTFIN(zc) From W1TEOSEL0
Onkey 172 Titled GBOUT15 Call B15_WPJTFIN(zc) From W1TEOSEL0
Onkey 173 Titled GBOUT16 Call B16_WPJTFIN(zc) From W1TEOSEL0
Onkey 174 Titled GBOUT17 Call B17_WPJTFIN(zc) From W1TEOSEL0
Onkey 175 Titled GBOUT18 Call B18_WPJTFIN(zc) From W1TEOSEL0
Onkey 176 Titled GBOUT19 Call B19_WPJTFIN(zc) From W1TEOSEL0
Onkey   2 Titled GBOUTS Call S_WPJTFIN(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WPJTFIN(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WPJTFIN(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 54672 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 54672 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]WPJTDEB) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 54672 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WPJTFIN
Call AM_WPJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "WPJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "WPJTFIN" : GZNUM = 54672 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWPJTFIN)")>indice
 [M]WPJTFIN(indice) = VALEUR
 Affzo ZWPJTFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"DIA","WPJTFIN",0,6,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_ANO,[V]CST_ANO,[V]CST_ANO,[M:DIA]WPOHFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_WPJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "DIA"
 PARMSK(2) = "WPJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "6"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_ANO)
 PARMSK(12) = num$([V]CST_ANO)
 PARMSK(13) = num$([V]CST_ANO)
 PARMSK(14) = [M:DIA]WPOHFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:DIA]WPOHFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWPJTFIN
Onevent BEFORE_AREA Gosub AV_ZWPJTFIN From W1TEOSEL0
Return

$AV_ZWPJTFIN
Call LECTEXTRA(zc,"PIMPL","PIMDESAXX",num$([M]WPJTFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_WBPSDEB
Onevent CONTROL Call C_WBPSDEB(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WBPSDEB From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WBPSDEB(zc) From W1TEOSEL0
Return

Subprog AS_WBPSDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WBPSDEB(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WBPSDEB(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WBPSDEB(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WBPSDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPSCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPSCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPSCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WBPSDEB" : GZNUM = 9915 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPS","!A",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "WBPSDEB" : GZNUM = 9915 : Endif
Endif
Gosub _AFF
End

$AMM_WBPSDEB
Call AM_WBPSDEB(zc)
If !mkstat & GOBJET
 zoncou = "WBPSDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBPSDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WBPSDEB(VALEUR) From FUNTEOCLO
If mkstat : GERR = 1 : GZONE = "WBPSDEB" : GZNUM = 9915 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZWBPSDEB)")>indice
 [M]WBPSDEB(indice) = VALEUR
 Affzo ZWBPSDEB(indice)
Endif
Gosub _AFF
End

Subprog S_WBPSDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPRSCO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPRSCO"
 PARMSK(1) = ""
 PARMSK(2) = "H"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPRSCO","BPRLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WBPSDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPS"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WBPSDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPS",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBPSDEB
Onevent BEFORE_AREA Gosub AV_ZWBPSDEB From W1TEOSEL0
Return

$AV_ZWBPSDEB
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LECTURE("BPS",num$([M]WBPSDEB(indice)),"") From CONTOBJ
zc = [F:BPS]BPSNAM
Gosub _AFF
Return

$ON_WBPSFIN
Onevent CONTROL Call C_WBPSFIN(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WBPSFIN(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WBPSFIN From W1TEOSEL0
Return

Subprog AS_WBPSFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
## Action STD
Call AS_WBPSFIN(VALEUR) From FUNTEOCLO
If mkstat=2
 [M]WBPSFIN(INDIC) = VALEUR
 Affzo WBPSFIN(INDIC) : mkstat = 2
Endif
Onkey   2 Titled GBOUTS Call S_WBPSFIN(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WBPSFIN(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WBPSFIN(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WBPSFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action BPSCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "BPSCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"BPSCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "WBPSFIN" : GZNUM = 9914 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("BPS","!A",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "WBPSFIN" : GZNUM = 9914 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]WBPSDEB) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "WBPSFIN" : GZNUM = 9914 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_WBPSFIN
Call AM_WBPSFIN(zc)
If !mkstat & GOBJET
 zoncou = "WBPSFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WBPSFIN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZWBPSFIN)")>indice
 [M]WBPSFIN(indice) = VALEUR
 Affzo ZWBPSFIN(indice)
Endif
Gosub _AFF
End

Subprog S_WBPSFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBPRSCO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBPRSCO"
 PARMSK(1) = ""
 PARMSK(2) = "H"
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBPRSCO","BPRLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WBPSFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "BPS"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WBPSFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("BPS",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZWBPSFIN
Onevent BEFORE_AREA Gosub AV_ZWBPSFIN From W1TEOSEL0
Return

$AV_ZWBPSFIN
If clalev([F:BPS])=0 : Local File BPSUPPLIER [BPS] : Endif
Call LECTURE("BPS",num$([M]WBPSFIN(indice)),"") From CONTOBJ
zc = [F:BPS]BPSNAM
Gosub _AFF
Return

$ON_WPOHDEB
Onevent CONTROL Call C_WPOHDEB(zc) From W1TEOSEL0
Onevent AFTER_CHANGE Gosub AMM_WPOHDEB From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WPOHDEB(zc) From W1TEOSEL0
Return

Subprog AS_WPOHDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WPOHDEB(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WPOHDEB(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WPOHDEB(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WPOHDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WPOHDEB" : GZNUM = 53979 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("POH","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "WPOHDEB" : GZNUM = 53979 : Endif
Endif
Gosub _AFF
End

$AMM_WPOHDEB
Call AM_WPOHDEB(zc)
If !mkstat & GOBJET
 zoncou = "WPOHDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_WPOHDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_WPOHDEB(VALEUR) From FUNTEOCLO
If mkstat : GERR = 1 : GZONE = "WPOHDEB" : GZNUM = 53979 : Endif
Gosub _AFF
End

Subprog S_WPOHDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPOHSCO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPOHSCO"
 PARMSK(1) = [M]WBPSDEB
 PARMSK(2) = [M]WBPSFIN
 PARMSK(3) = [M]WDATDEB
 PARMSK(4) = [M]WDATFIN
 PARMSK(5) = [M]WPOHFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPOHSCO","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WPOHDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "POH"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPOHDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("POH",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WPOHFIN
Onevent CONTROL Call C_WPOHFIN(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_WPOHFIN(zc) From W1TEOSEL0
Return

Subprog AS_WPOHFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(15597,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_WPOHFIN(zc) From W1TEOSEL0
Onkey 144 Titled GBOUTP Call P_WPOHFIN(zc) From W1TEOSEL0
Onkey 146 Titled GBOUTA Call SA_WPOHFIN(zc) From W1TEOSEL0
Gosub _AFF
End

Subprog C_WPOHFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "WPOHFIN" : GZNUM = 53980 : Endif
Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("POH","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "WPOHFIN" : GZNUM = 53980 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]WPOHDEB) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "WPOHFIN" : GZNUM = 53980 : Endif
 Endif
Endif
Gosub _AFF
End

Subprog S_WPOHFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELPOHSCO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELPOHSCO"
 PARMSK(1) = [M]WBPSDEB
 PARMSK(2) = [M]WBPSFIN
 PARMSK(3) = [M]WDATDEB
 PARMSK(4) = [M]WDATFIN
 PARMSK(5) = [M]WPOHFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPOHSCO","SCOSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog SA_WPOHFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "POH"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_WPOHFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("POH",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_WSOHDEB
Return

$ON_WSOHFIN
Return

$ON_CLOSED
Onevent INIT_AREA Call D_CLOSED(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_CLOSED(zc) From W1TEOSEL0
Return

Subprog D_CLOSED(VALEUR)
Variable Integer VALEUR
If varinit([M]CLOSED,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CLOSED(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_LANFLG
Onevent INIT_AREA Call D_LANFLG(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_LANFLG(zc) From W1TEOSEL0
Return

Subprog D_LANFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]LANFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_LANFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_QTYFLG
Onevent INIT_AREA Call D_QTYFLG(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_QTYFLG(zc) From W1TEOSEL0
Return

Subprog D_QTYFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]QTYFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_QTYFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_CNSFLG
Onevent INIT_AREA Call D_CNSFLG(zc) From W1TEOSEL0
Onevent BEFORE_INPUT Call AS_CNSFLG(zc) From W1TEOSEL0
Return

Subprog D_CNSFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]CNSFLG,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_CNSFLG(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_POHFLG
Onevent INIT_AREA Call D_POHFLG(zc) From W1TEOSEL0
Return

Subprog D_POHFLG(VALEUR)
Variable Integer VALEUR
If varinit([M]POHFLG,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

$CHG_STY
Gosub CHG_STY From W2TEOSEL0
Return

$TIT_COL
Gosub TIT_COL From W2TEOSEL0
Return


