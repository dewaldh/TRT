#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management MTL4 

Subprog SAIMSK(IMPFIC,ACTION,IMPTRT)
Value Char IMPFIC
Value Char ACTION
Value Char IMPTRT

Gosub DEFVAR

####################################
## Bloc liste 1
####################################
IMPTBL = 0

## Zone LOTCODS
mkstat = 0
zoncou = "LOTCODS"
indice = 0
IMPENT = [M]LOTCODS
If varinit([M]LOTCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOTCODS,indice)=0
 [M]LOTCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOTCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOTCODS(indice)
 Endif
Endif
[M]LOTCODS = IMPENT

## Zone LOTSCRS
mkstat = 0
zoncou = "LOTSCRS"
indice = 0
IMPENT = [M]LOTSCRS
If varinit([M]LOTSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOTSCRS,indice)=0
 [M]LOTSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOTSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOTSCRS(indice)
 Endif
Endif
[M]LOTSCRS = IMPENT

## Zone SLOCODS
mkstat = 0
zoncou = "SLOCODS"
indice = 0
IMPENT = [M]SLOCODS
If varinit([M]SLOCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SLOCODS,indice)=0
 [M]SLOCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SLOCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SLOCODS(indice)
 Endif
Endif
[M]SLOCODS = IMPENT

## Zone SLOSCRS
mkstat = 0
zoncou = "SLOSCRS"
indice = 0
IMPENT = [M]SLOSCRS
If varinit([M]SLOSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SLOSCRS,indice)=0
 [M]SLOSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SLOSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SLOSCRS(indice)
 Endif
Endif
[M]SLOSCRS = IMPENT

## Zone MATECCCOD
mkstat = 0
zoncou = "MATECCCOD"
indice = 0
IMPENT = [M]MATECCCOD
If varinit([M]MATECCCOD,indice)=0
 IMPENT = 1
Endif
If varmode([M]MATECCCOD,indice)=0
 [M]MATECCCOD(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MATECCCOD" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MATECCCOD(indice)
 Endif
Endif
[M]MATECCCOD = IMPENT

## Zone MATECCSCR
mkstat = 0
zoncou = "MATECCSCR"
indice = 0
IMPENT = [M]MATECCSCR
If varinit([M]MATECCSCR,indice)=0
 IMPENT = 1
Endif
If varmode([M]MATECCSCR,indice)=0
 [M]MATECCSCR(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MATECCSCR" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MATECCSCR(indice)
 Endif
Endif
[M]MATECCSCR = IMPENT

## Zone MATECCCODMIN
mkstat = 0
zoncou = "MATECCCODMIN"
indice = 0
IMPENT = [M]MATECCCODMIN
If varinit([M]MATECCCODMIN,indice)=0
 IMPENT = 1
Endif
If varmode([M]MATECCCODMIN,indice)=0
 [M]MATECCCODMIN(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MATECCCODMIN" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MATECCCODMIN(indice)
 Endif
Endif
[M]MATECCCODMIN = IMPENT

## Zone MATECCSCRMIN
mkstat = 0
zoncou = "MATECCSCRMIN"
indice = 0
IMPENT = [M]MATECCSCRMIN
If varinit([M]MATECCSCRMIN,indice)=0
 IMPENT = 1
Endif
If varmode([M]MATECCSCRMIN,indice)=0
 [M]MATECCSCRMIN(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MATECCSCRMIN" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MATECCSCRMIN(indice)
 Endif
Endif
[M]MATECCSCRMIN = IMPENT

## Zone AQRCODS
mkstat = 0
zoncou = "AQRCODS"
indice = 0
IMPENT = [M]AQRCODS
If varinit([M]AQRCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]AQRCODS,indice)=0
 [M]AQRCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AQRCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AQRCODS(indice)
 Endif
Endif
[M]AQRCODS = IMPENT

## Zone AQRSCRS
mkstat = 0
zoncou = "AQRSCRS"
indice = 0
IMPENT = [M]AQRSCRS
If varinit([M]AQRSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]AQRSCRS,indice)=0
 [M]AQRSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "AQRSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]AQRSCRS(indice)
 Endif
Endif
[M]AQRSCRS = IMPENT

## Zone LOCCODS
mkstat = 0
zoncou = "LOCCODS"
indice = 0
IMPENT = [M]LOCCODS
If varinit([M]LOCCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOCCODS,indice)=0
 [M]LOCCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOCCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOCCODS(indice)
 Endif
Endif
[M]LOCCODS = IMPENT

## Zone LOCSCRS
mkstat = 0
zoncou = "LOCSCRS"
indice = 0
IMPENT = [M]LOCSCRS
If varinit([M]LOCSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]LOCSCRS,indice)=0
 [M]LOCSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "LOCSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]LOCSCRS(indice)
 Endif
Endif
[M]LOCSCRS = IMPENT

## Zone SERCODS
mkstat = 0
zoncou = "SERCODS"
indice = 0
IMPENT = [M]SERCODS
If varinit([M]SERCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SERCODS,indice)=0
 [M]SERCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SERCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SERCODS(indice)
 Endif
Endif
[M]SERCODS = IMPENT

## Zone SERSCRS
mkstat = 0
zoncou = "SERSCRS"
indice = 0
IMPENT = [M]SERSCRS
If varinit([M]SERSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SERSCRS,indice)=0
 [M]SERSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SERSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SERSCRS(indice)
 Endif
Endif
[M]SERSCRS = IMPENT

## Zone SERECODS
mkstat = 0
zoncou = "SERECODS"
indice = 0
IMPENT = [M]SERECODS
If varinit([M]SERECODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SERECODS,indice)=0
 [M]SERECODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SERECODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SERECODS(indice)
 Endif
Endif
[M]SERECODS = IMPENT

## Zone SERESCRS
mkstat = 0
zoncou = "SERESCRS"
indice = 0
IMPENT = [M]SERESCRS
If varinit([M]SERESCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]SERESCRS,indice)=0
 [M]SERESCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "SERESCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]SERESCRS(indice)
 Endif
Endif
[M]SERESCRS = IMPENT

## Zone IDECODS1
mkstat = 0
zoncou = "IDECODS1"
indice = 0
IMPENT = [M]IDECODS1
If varinit([M]IDECODS1,indice)=0
 IMPENT = 1
Endif
If varmode([M]IDECODS1,indice)=0
 [M]IDECODS1(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IDECODS1" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IDECODS1(indice)
 Endif
Endif
[M]IDECODS1 = IMPENT

## Zone IDESCRS1
mkstat = 0
zoncou = "IDESCRS1"
indice = 0
IMPENT = [M]IDESCRS1
If varinit([M]IDESCRS1,indice)=0
 IMPENT = 1
Endif
If varmode([M]IDESCRS1,indice)=0
 [M]IDESCRS1(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IDESCRS1" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IDESCRS1(indice)
 Endif
Endif
[M]IDESCRS1 = IMPENT

## Zone IDECODS2
mkstat = 0
zoncou = "IDECODS2"
indice = 0
IMPENT = [M]IDECODS2
If varinit([M]IDECODS2,indice)=0
 IMPENT = 1
Endif
If varmode([M]IDECODS2,indice)=0
 [M]IDECODS2(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IDECODS2" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IDECODS2(indice)
 Endif
Endif
[M]IDECODS2 = IMPENT

## Zone IDESCRS2
mkstat = 0
zoncou = "IDESCRS2"
indice = 0
IMPENT = [M]IDESCRS2
If varinit([M]IDESCRS2,indice)=0
 IMPENT = 1
Endif
If varmode([M]IDESCRS2,indice)=0
 [M]IDESCRS2(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "IDESCRS2" : Gosub ACTION From =IMPTRT
  IMPENT = [M]IDESCRS2(indice)
 Endif
Endif
[M]IDESCRS2 = IMPENT

## Zone MVTDESCODS
mkstat = 0
zoncou = "MVTDESCODS"
indice = 0
IMPENT = [M]MVTDESCODS
If varinit([M]MVTDESCODS,indice)=0
 IMPENT = 1
Endif
If varmode([M]MVTDESCODS,indice)=0
 [M]MVTDESCODS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MVTDESCODS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MVTDESCODS(indice)
 Endif
Endif
[M]MVTDESCODS = IMPENT

## Zone MVTDESSCRS
mkstat = 0
zoncou = "MVTDESSCRS"
indice = 0
IMPENT = [M]MVTDESSCRS
If varinit([M]MVTDESSCRS,indice)=0
 IMPENT = 1
Endif
If varmode([M]MVTDESSCRS,indice)=0
 [M]MVTDESSCRS(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "MVTDESSCRS" : Gosub ACTION From =IMPTRT
  IMPENT = [M]MVTDESSCRS(indice)
 Endif
Endif
[M]MVTDESSCRS = IMPENT

## Zone WRHCOD2
mkstat = 0
zoncou = "WRHCOD2"
indice = 0
IMPENT = [M]WRHCOD2
If varinit([M]WRHCOD2,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHCOD2,indice)=0
 Call INICOMBO(35) From COMBOS
 SAVACT = GACTION : GACTION = "STD"
 Call AS_WRHCOD2(IMPENT) From SUBMTL
 GACTION = SAVACT
 If mkstat=1 : Raz IMPENT : Endif
 If IMPENT<1 | GMENLOC(IMPENT)=1
  IMPENT = find(0,GMENLOC(1..len(mess(0,35,1))))
 Endif
 [M]WRHCOD2(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHCOD2" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHCOD2(indice)
 Endif
 If !mkstat
  If IMPENT>0 & IMPENT<dim(GMENLOC) & GMENLOC(IMPENT)<>0
   mkstat = 1 : GMESSAGE = mess(99,123,1)
  Endif
  If mkstat : GERR = 1 : GZONE = "WRHCOD2" : GZNUM = 281 : Endif
  Gosub AFF From GSAISIE
  If mkstat : End : Endif
 Endif
Endif
[M]WRHCOD2 = IMPENT

## Zone WRHSCR2
mkstat = 0
zoncou = "WRHSCR2"
indice = 0
IMPENT = [M]WRHSCR2
If varinit([M]WRHSCR2,indice)=0
 IMPENT = 1
Endif
If varmode([M]WRHSCR2,indice)=0
 [M]WRHSCR2(indice) = IMPENT
 If !mkstat
  IMPMOD = 0 : IMPZON = "WRHSCR2" : Gosub ACTION From =IMPTRT
  IMPENT = [M]WRHSCR2(indice)
 Endif
Endif
[M]WRHSCR2 = IMPENT

mkstat = 0

End

$DEFVAR
Local Integer I , J , K , XOK , NOL , IMPENT , IMPMOD , IMPTBL , NBLIG
Local Char    IMPMSK(GLONAMK) , IMPZON(GLONAVA) , NOMZONE(40)
Local Char    PROGSUB(GLONADC), PROGSPE(GLONADC), PROGSPV(GLONADC)
Local Char    PARAM(250)(1..20) , SAVACT(20)
Local Char    WCHAR(255)
Local Decimal WNUM
Local Date    WDATE
Local Clbfile WCLOB(9)

IMPMSK = "MTL4"
Return

