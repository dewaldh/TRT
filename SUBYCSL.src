#<AdxTL>@(#)0.0.0.0 $Revision$
######################################################################################################################
# Script            : SUBYCSL                                                                                        #
# Creation date     : 13/2/2019                                                                                      #
# Version           : 1.0.0                                                                                          #
# Authors (Company) : JH (Leverage)                                                                                  #
# Module            : Content server                                                                                 #
# -------------------------------------------------------------------------------------------------------------------#
# Epic              : https://jira.leveragetech.com.au/browse/DFCX1-???                                              #
# Description       : Content server linking                                                                         #
#--------------------------------------------------------------------------------------------------------------------#
# Evolutions        :                                                                                                #
######################################################################################################################

$ACTION
Case ACTION
  When "OK" : Gosub OK
  When "DEBUT" : Gosub DEBUT
 When Default
Endcase
Return

#------------------------------------------------------------------------------------#
#after screen load - set default values
#------------------------------------------------------------------------------------#
$DEBUT

[M:YCSL]YOBJTYP = PARAM(1)
[M:YCSL]YOBJIDENT = PARAM(2)
Affzo[M:YCSL]

#open file
If clalev([F:YCSL]) = 0 : Local File YCSLNK[YCSL] : Endif

Return

#------------------------------------------------------------------------------------#
#Save new CS link
#please note the this is a folder node ID and not a file. we only link folder ID's
#------------------------------------------------------------------------------------#
$OK

If [M:YCSL]YCSNID = ""
  GMESSAGE = "Please enter a content server node ID"
  GERR = 1
  FIN = 0
  Return
Endif

#validate theat the ID spesified is a folder ID and not a file
#call java script here.

#check that the node id does not exist in the link table for the spesified object.

#YOBJTYP+YOBJIDENT+YCSNID

Read [F:YCSL]YCSL0 = [F:YCSL]YOBJTYP;[F:YCSL]YOBJIDENT;[F:YCSL]YCSNID
If fstat = 0
  [F:YCSL]YOBJTYP    = [M:YCSL]YOBJTYP
  [F:YCSL]YOBJIDENT  = [M:YCSL]YOBJIDENT
  #[F:YCSL]YCSNTYP    = [M:YCSL]
  [F:YCSL]YCSNID     = [M:YCSL]YCSNID
  Rewrite[F:YCSL]
Else
  [F:YCSL]YOBJTYP    = [M:YCSL]YOBJTYP
  [F:YCSL]YOBJIDENT  = [M:YCSL]YOBJIDENT
  #[F:YCSL]YCSNTYP    = [M:YCSL]
  [F:YCSL]YCSNID     = [M:YCSL]YCSNID
  Write[F:YCSL]
Endif


Return

