#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management CRITMFG 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:45:53"
A_USER  = "ADMIN"
A_STAMP = "20180326124553"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CRITMFG [CLOF]
Gosub HORODAT
Local Inpbox "CRITMFG" From GFONCTION At A_STAMP With A_WINDPREV Mask [CLOF] As [SIM_]
Grizo [CLOF]5
Grizo [CLOF]10
Grizo [CLOF]15
Grizo [CLOF]20
Grizo [CLOF]25
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [CLOF]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=1 : X2(0)=134 : Y1(0)=3 : Y2(0)=5
X1(1)=1 : X2(1)=134 : Y1(1)=6 : Y2(1)=18
X1(2)=1 : X2(2)=95 : Y1(2)=19 : Y2(2)=23
X1(3)=96 : X2(3)=134 : Y1(3)=19 : Y2(3)=23
X1(4)=1 : X2(4)=134 : Y1(4)=24 : Y2(4)=26
Return

$ON_MEMO
Return

$ON_MFGFCY
Onevent CONTROL Call C_MFGFCY(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MFGFCY(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_MFGFCY From W1CRITMFG
Return

Subprog AS_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(1427,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGFCY(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_MFGFCY(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_MFGFCY(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_MFGFCY(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_MFGFCY(VALEUR)
Variable Char    VALEUR()
## Action ACONTFCY
Call CONTSITE(VALEUR) From SUBAGF
If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 9144 : Endif
If !mkstat
 ## Action %CNTOBJ
 Call CONTSEL("FCY","!",VALEUR,"",mkstat) From CONTOBJ
 If mkstat : GERR = 1 : GZONE = "MFGFCY" : GZNUM = 9144 : Endif
Endif
Gosub _AFF
End

$AMM_MFGFCY
Call AM_MFGFCY(zc)
If !mkstat & GOBJET
 zoncou = "MFGFCY" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGFCY(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZMFGFCY)")>indice
 [M]MFGFCY(indice) = VALEUR
 Affzo ZMFGFCY(indice)
Endif
Gosub _AFF
End

Subprog S_MFGFCY(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELFCY
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELFCY"
 PARMSK(1) = ""
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELFCY","SUBFCY","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_MFGFCY(VALEUR)
Variable Char    VALEUR()
Call OBJET("FCY",VALEUR,"") From GOBJET
Gosub _AFF
End

Subprog SA_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "FCY"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_MFGFCY(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("FCY",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZMFGFCY
Onevent BEFORE_AREA Gosub AV_ZMFGFCY From W1CRITMFG
Return

$AV_ZMFGFCY
If clalev([F:FCY])=0 : Local File FACILITY [FCY] : Endif
Call LECTURE("FCY",num$([M]MFGFCY(indice)),"") From CONTOBJ
zc = [F:FCY]FCYNAM
Gosub _AFF
Return

$ON_MFGSTASTR
Onevent BEFORE_INPUT Call AS_MFGSTASTR(zc) From W1CRITMFG
Onevent INIT_AREA Call D_MFGSTASTR(zc) From W1CRITMFG
Onevent CONTROL Call C_MFGSTASTR(zc) From W1CRITMFG
Return

Subprog D_MFGSTASTR(VALEUR)
Variable Integer VALEUR
If varinit([M]MFGSTASTR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MFGSTASTR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(317) From COMBOS
## Action STD
Call AS_MFGSTASTR(VALEUR) From CNSMFGSTD
If mkstat=2
 [M]MFGSTASTR(INDIC) = VALEUR
 Affzo MFGSTASTR(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,317,1))))
Endif
If !mkstat
 Discombo 0 From MFGSTASTR(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From MFGSTASTR(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_MFGSTASTR(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_MFGSTAEND
Onevent BEFORE_INPUT Call AS_MFGSTAEND(zc) From W1CRITMFG
Onevent INIT_AREA Call D_MFGSTAEND(zc) From W1CRITMFG
Onevent CONTROL Call C_MFGSTAEND(zc) From W1CRITMFG
Return

Subprog D_MFGSTAEND(VALEUR)
Variable Integer VALEUR
If varinit([M]MFGSTAEND,indice)=0
 VALEUR = 2
Endif
Gosub _AFF
End

Subprog AS_MFGSTAEND(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call INICOMBO(317) From COMBOS
## Action STD
Call AS_MFGSTAEND(VALEUR) From CNSMFGSTD
If mkstat=2
 [M]MFGSTAEND(INDIC) = VALEUR
 Affzo MFGSTAEND(INDIC) : mkstat = 2
Endif
If VALEUR<1 | GMENLOC(VALEUR)=1
 VALEUR = find(0,GMENLOC(1..len(mess(0,317,1))))
Endif
If !mkstat
 Discombo 0 From MFGSTAEND(INDIC)
 If sum(GMENLOC)<>0
  Gosub COMBOS From COMBOS
  For WI=1 to WN : Discombo WCOMBO(WI) From MFGSTAEND(INDIC) : Next WI
 Endif
Endif
Gosub _AFF
End

Subprog C_MFGSTAEND(VALEUR)
Variable Integer VALEUR
If VALEUR>0 & VALEUR<dim(GMENLOC) & GMENLOC(VALEUR)<>0
 mkstat = 1 : End
Endif
Gosub _AFF
End

$ON_MFGNUMSTR
Onevent CONTROL Call C_MFGNUMSTR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_MFGNUMSTR From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MFGNUMSTR(zc) From W1CRITMFG
Return

Subprog AS_MFGNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(26845,GBOUT1) From OBJDIV
Call TEXTE(18522,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGNUMSTR(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_MFGNUMSTR(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_MFGNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMSTR" : GZNUM = 9595 : Endif
Endif
Gosub _AFF
End

$AMM_MFGNUMSTR
Call AM_MFGNUMSTR(zc)
If !mkstat & GOBJET
 zoncou = "MFGNUMSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGNUMSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGNUMSTR(VALEUR) From CNSMFGSTD
If mkstat : GERR = 1 : GZONE = "MFGNUMSTR" : GZNUM = 9595 : Endif
Gosub _AFF
End

Subprog S_MFGNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_MFGNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action VCRTUN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VCRTUN"
 Call OBJET_CHAR(VALEUR,"MFG","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MFGNUMEND
Onevent CONTROL Call C_MFGNUMEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MFGNUMEND(zc) From W1CRITMFG
Return

Subprog AS_MFGNUMEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(26845,GBOUT1) From OBJDIV
Call TEXTE(18522,GBOUTS) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGNUMEND(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_MFGNUMEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_MFGNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]MFGNUMSTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_MFGNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_MFGNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action VCRTUN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "VCRTUN"
 Call OBJET_CHAR(VALEUR,"MFG","") From GOBJET
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ITMREFSTR
Onevent CONTROL Call C_ITMREFSTR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ITMREFSTR From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ITMREFSTR(zc) From W1CRITMFG
Return

Subprog IB_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFSTR(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ITMREFSTR(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_ITMREFSTR(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_ITMREFSTR(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_ITMREFSTR(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 3651 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 3651 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 3651 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFSTR
Call AM_ITMREFSTR(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFSTR(VALEUR) From CNSMFGSTD
If mkstat : GERR = 1 : GZONE = "ITMREFSTR" : GZNUM = 3651 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFSTR)")>indice
 [M]ITMREFSTR(indice) = VALEUR
 Affzo ZITMREFSTR(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOM"
 PARMSK(1) = num$([M]BOMALT)
 PARMSK(2) = "B"
 PARMSK(3) = [M]ITMREFSTR
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBOM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFSTR
Onevent BEFORE_AREA Gosub AV_ZITMREFSTR From W1CRITMFG
Return

$AV_ZITMREFSTR
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFSTR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ITMREFEND
Onevent CONTROL Call C_ITMREFEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ITMREFEND(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ITMREFEND From W1CRITMFG
Return

Subprog IB_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ITMREFEND(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ITMREFEND(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_ITMREFEND(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_ITMREFEND(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_ITMREFEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 0 : Endif
  If !mkstat
   ## Action CTLALPV
   Call CTLALPV(VALEUR,[M]ITMREFSTR) From CONTDIV
   If mkstat : GERR = 1 : GZONE = "ITMREFEND" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ITMREFEND
Call AM_ITMREFEND(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZITMREFEND)")>indice
 [M]ITMREFEND(indice) = VALEUR
 Affzo ZITMREFEND(indice)
Endif
Gosub _AFF
End

Subprog S_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELBOM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELBOM"
 PARMSK(1) = num$([M]BOMALT)
 PARMSK(2) = "B"
 PARMSK(3) = [M]ITMREFEND
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELBOM","TRTBOM","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ITMREFEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ITMREFEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZITMREFEND
Onevent BEFORE_AREA Gosub AV_ZITMREFEND From W1CRITMFG
Return

$AV_ZITMREFEND
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ITMREFEND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_BOMALT
Onevent BEFORE_INPUT Call AS_BOMALT(zc) From W1CRITMFG
Onevent CONTROL Call C_BOMALT(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_BOMALT From W1CRITMFG
Return

Subprog AS_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey   2 Titled GBOUTS Call S_BOMALT(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_BOMALT(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_BOMALT(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TBO","!",VALEUR,"2",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "BOMALT" : GZNUM = 11742 : Endif
Gosub _AFF
End

$AMM_BOMALT
Call AM_BOMALT(zc)
If !mkstat & GOBJET
 zoncou = "BOMALT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_BOMALT(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZBOMALT)")>indice
 [M]BOMALT(indice) = VALEUR
 Affzo ZBOMALT(indice)
Endif
Gosub _AFF
End

Subprog S_BOMALT(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELTBO
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELTBO"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = "2"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELTBO","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog P_BOMALT(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = "2"
Call VISU("TBO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZBOMALT
Onevent BEFORE_AREA Gosub AV_ZBOMALT From W1CRITMFG
Return

$AV_ZBOMALT
Call LECTEXTRA(zc,"TABBOMALT","TBODESAXX","2",num$([M]BOMALT(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_ROUNUMSTR
Onevent CONTROL Call C_ROUNUMSTR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ROUNUMSTR From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ROUNUMSTR(zc) From W1CRITMFG
Return

Subprog IB_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ROUNUMSTR(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ROUNUMSTR(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_ROUNUMSTR(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_ROUNUMSTR(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_ROUNUMSTR(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ROUNUMSTR" : GZNUM = 3817 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ROUNUMSTR" : GZNUM = 3817 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ROUNUMSTR" : GZNUM = 3817 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ROUNUMSTR
Call AM_ROUNUMSTR(zc)
If !mkstat & GOBJET
 zoncou = "ROUNUMSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ROUNUMSTR(VALEUR) From CNSMFGSTD
If mkstat : GERR = 1 : GZONE = "ROUNUMSTR" : GZNUM = 3817 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZROUNUMSTR)")>indice
 [M]ROUNUMSTR(indice) = VALEUR
 Affzo ZROUNUMSTR(indice)
Endif
Gosub _AFF
End

Subprog S_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELROU
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELROU"
 PARMSK(1) = num$([M]ROUALT)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELROU","SELROU","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ROUNUMSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUNUMSTR
Onevent BEFORE_AREA Gosub AV_ZROUNUMSTR From W1CRITMFG
Return

$AV_ZROUNUMSTR
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ROUNUMSTR(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ROUNUMEND
Onevent CONTROL Call C_ROUNUMEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ROUNUMEND(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ROUNUMEND From W1CRITMFG
Return

Subprog IB_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action IBPRDINF
 Call IBPRDINF(VALEUR) From PRDINFLIB
Endif
Gosub _AFF
End

Subprog AS_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(12837,GBOUT13) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_ROUNUMEND(VALEUR)
Onkey 170 Titled GBOUT13 Call B13_ROUNUMEND(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_ROUNUMEND(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_ROUNUMEND(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_ROUNUMEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action ITMCHOICE
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ITMCHOICE"
 Call S_TAB_CHAR(VALEUR,PARMSK,"ITMCHOICE","TRTSEL","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "ROUNUMEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action VXADCUPC
 Call ADCCTRUPC(VALEUR) From VXADCUPC
 If mkstat : GERR = 1 : GZONE = "ROUNUMEND" : GZNUM = 0 : Endif
 If !mkstat
  ## Action %CNTOBJ
  Call CONTSEL("ITM","!",VALEUR,"",mkstat) From CONTOBJ
  If mkstat : GERR = 1 : GZONE = "ROUNUMEND" : GZNUM = 0 : Endif
  If !mkstat
   ## Action CTLALPV
   Call CTLALPV(VALEUR,[M]ROUNUMSTR) From CONTDIV
   If mkstat : GERR = 1 : GZONE = "ROUNUMEND" : GZNUM = 0 : Endif
  Endif
 Endif
Endif
Gosub _AFF
End

$AMM_ROUNUMEND
Call AM_ROUNUMEND(zc)
If !mkstat & GOBJET
 zoncou = "ROUNUMEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZROUNUMEND)")>indice
 [M]ROUNUMEND(indice) = VALEUR
 Affzo ZROUNUMEND(indice)
Endif
Gosub _AFF
End

Subprog S_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELROU
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELROU"
 PARMSK(1) = num$([M]ROUALT)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELROU","SELROU","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B13_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PRDINFA
 Call PRDINF(VALEUR) From PRDINFLIB
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "ITM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ROUNUMEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("ITM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUNUMEND
Onevent BEFORE_AREA Gosub AV_ZROUNUMEND From W1CRITMFG
Return

$AV_ZROUNUMEND
Call LECTEXTRA(zc,"ITMMASTER","DES1AXX",num$([M]ROUNUMEND(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ROUALT
Onevent CONTROL Call C_ROUALT(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ROUALT(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ROUALT From W1CRITMFG
Return

Subprog AS_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6276,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ROUALT(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_ROUALT(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_ROUALT(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ROUALT(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TRO","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ROUALT" : GZNUM = 11743 : Endif
Gosub _AFF
End

$AMM_ROUALT
Call AM_ROUALT(zc)
If !mkstat & GOBJET
 zoncou = "ROUALT" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUALT(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZROUALT)")>indice
 [M]ROUALT(indice) = VALEUR
 Affzo ZROUALT(indice)
Endif
Gosub _AFF
End

Subprog S_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TRO"
PARMSK(2) = "!"
Call S_TAB_NUM(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Char VALCHAR(20)
VALCHAR = num$(VALEUR)
Call OBJET("TRO",VALCHAR,"") From GOBJET
VALEUR = val(VALCHAR)
Gosub _AFF
End

Subprog P_ROUALT(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUALT
Onevent BEFORE_AREA Gosub AV_ZROUALT From W1CRITMFG
Return

$AV_ZROUALT
Call LECTEXTRA(zc,"TABROUALT","TRODESAXX",num$([M]ROUALT(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_PJTSTR
Onevent BEFORE_INPUT Call AS_PJTSTR(zc) From W1CRITMFG
Onevent CONTROL Call C_PJTSTR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_PJTSTR From W1CRITMFG
Return

Subprog IB_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTSTR(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTSTR(INDIC) = VALEUR
 Affzo PJTSTR(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTSTR(zc) From W1CRITMFG
Onkey 130 Titled GBOUT2 Call B2_PJTSTR(zc) From W1CRITMFG
Onkey 131 Titled GBOUT3 Call B3_PJTSTR(zc) From W1CRITMFG
Onkey 132 Titled GBOUT4 Call B4_PJTSTR(zc) From W1CRITMFG
Onkey 172 Titled GBOUT15 Call B15_PJTSTR(zc) From W1CRITMFG
Onkey 173 Titled GBOUT16 Call B16_PJTSTR(zc) From W1CRITMFG
Onkey 174 Titled GBOUT17 Call B17_PJTSTR(zc) From W1CRITMFG
Onkey 175 Titled GBOUT18 Call B18_PJTSTR(zc) From W1CRITMFG
Onkey 176 Titled GBOUT19 Call B19_PJTSTR(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_PJTSTR(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_PJTSTR(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_PJTSTR(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJTSTR
Call AM_PJTSTR(zc)
If !mkstat & GOBJET
 zoncou = "PJTSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTSTR(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTSTR(VALEUR) From CNSMFGSTD
 If mkstat : GERR = 1 : GZONE = "PJTSTR" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CLOF","PJTSTR",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTSTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTSTR"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTSTR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PJTEND
Onevent BEFORE_INPUT Call AS_PJTEND(zc) From W1CRITMFG
Onevent CONTROL Call C_PJTEND(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_PJTEND From W1CRITMFG
Return

Subprog IB_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTEND(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTEND(INDIC) = VALEUR
 Affzo PJTEND(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTEND(zc) From W1CRITMFG
Onkey 130 Titled GBOUT2 Call B2_PJTEND(zc) From W1CRITMFG
Onkey 131 Titled GBOUT3 Call B3_PJTEND(zc) From W1CRITMFG
Onkey 132 Titled GBOUT4 Call B4_PJTEND(zc) From W1CRITMFG
Onkey 172 Titled GBOUT15 Call B15_PJTEND(zc) From W1CRITMFG
Onkey 173 Titled GBOUT16 Call B16_PJTEND(zc) From W1CRITMFG
Onkey 174 Titled GBOUT17 Call B17_PJTEND(zc) From W1CRITMFG
Onkey 175 Titled GBOUT18 Call B18_PJTEND(zc) From W1CRITMFG
Onkey 176 Titled GBOUT19 Call B19_PJTEND(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_PJTEND(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_PJTEND(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_PJTEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
 If !mkstat
  ## Action CTLALPV
  Call CTLALPV(VALEUR,[M]PJTSTR) From CONTDIV
  If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTEND
Call AM_PJTEND(zc)
If !mkstat & GOBJET
 zoncou = "PJTEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTEND(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CLOF","PJTEND",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:CLOF]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CLOF"
 PARMSK(2) = "PJTEND"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:CLOF]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:CLOF]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTEND(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VCRTYP
Onevent INIT_AREA Call D_VCRTYP(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_VCRTYP(zc) From W1CRITMFG
Return

Subprog D_VCRTYP(VALEUR)
Variable Integer VALEUR
If varinit([M]VCRTYP,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_VCRTYP(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_VCRORISTR
Onevent CONTROL Call C_VCRORISTR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_VCRORISTR From W1CRITMFG
Return

Subprog C_VCRORISTR(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Endif
Gosub _AFF
End

$AMM_VCRORISTR
Call AM_VCRORISTR(zc)
If !mkstat & GOBJET
 zoncou = "VCRORISTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRORISTR(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRORISTR(VALEUR) From CNSMFGSTD
If mkstat : GERR = 1 : GZONE = "VCRORISTR" : GZNUM = 5421 : Endif
Gosub _AFF
End

$ON_VCRORIEND
Onevent CONTROL Call C_VCRORIEND(zc) From W1CRITMFG
Return

Subprog C_VCRORIEND(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action CTLALPV
 Call CTLALPV(VALEUR,[M]VCRORISTR) From CONTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIEND" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$ON_STRDATSTR
Onevent BEFORE_AREA Gosub AV_STRDATSTR From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_STRDATSTR From W1CRITMFG
Onevent BEFORE_INPUT Call AS_STRDATSTR(zc) From W1CRITMFG
Return

$AV_STRDATSTR
## Action ADATRELI
Call INIDAT(zc,[M]STRDATSTRF) From ADATREL
Chgfmt [M]STRDATSTR(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_STRDATSTR(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STRDATSTR(zc) From W1CRITMFG
Gosub _AFF
End

$AMM_STRDATSTR
Call AM_STRDATSTR(zc)
If !mkstat & GOBJET
 zoncou = "STRDATSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STRDATSTR(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]STRDATSTRF) From ADATREL
If mkstat : GERR = 1 : GZONE = "STRDATSTR" : GZNUM = 1805 : Endif
Gosub _AFF
End

Subprog B1_STRDATSTR(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]STRDATSTRF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]STRDATSTRF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_STRDATEND
Onevent BEFORE_AREA Gosub AV_STRDATEND From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_STRDATEND From W1CRITMFG
Onevent CONTROL Call C_STRDATEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_STRDATEND(zc) From W1CRITMFG
Return

$AV_STRDATEND
## Action ADATRELI
Call INIDAT(zc,[M]STRDATENDF) From ADATREL
Chgfmt [M]STRDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_STRDATEND(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_STRDATEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_STRDATEND(VALEUR)
Variable Date    VALEUR
## Action CTLDATV
Call CTLDATV(VALEUR,[M]STRDATSTR) From CONTDIV
If mkstat : GERR = 1 : GZONE = "STRDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_STRDATEND
Call AM_STRDATEND(zc)
If !mkstat & GOBJET
 zoncou = "STRDATEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_STRDATEND(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]STRDATENDF) From ADATREL
If mkstat : GERR = 1 : GZONE = "STRDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_STRDATEND(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]STRDATENDF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]STRDATENDF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ENDDATSTR
Onevent BEFORE_AREA Gosub AV_ENDDATSTR From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ENDDATSTR From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ENDDATSTR(zc) From W1CRITMFG
Return

$AV_ENDDATSTR
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATSTRF) From ADATREL
Chgfmt [M]ENDDATSTR(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_ENDDATSTR(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ENDDATSTR(zc) From W1CRITMFG
Gosub _AFF
End

$AMM_ENDDATSTR
Call AM_ENDDATSTR(zc)
If !mkstat & GOBJET
 zoncou = "ENDDATSTR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDATSTR(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATSTRF) From ADATREL
If mkstat : GERR = 1 : GZONE = "ENDDATSTR" : GZNUM = 1806 : Endif
Gosub _AFF
End

Subprog B1_ENDDATSTR(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATSTRF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATSTRF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_ENDDATEND
Onevent BEFORE_AREA Gosub AV_ENDDATEND From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_ENDDATEND From W1CRITMFG
Onevent CONTROL Call C_ENDDATEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_ENDDATEND(zc) From W1CRITMFG
Return

$AV_ENDDATEND
## Action ADATRELI
Call INIDAT(zc,[M]ENDDATENDF) From ADATREL
Chgfmt [M]ENDDATEND(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_ENDDATEND(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_ENDDATEND(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_ENDDATEND(VALEUR)
Variable Date    VALEUR
## Action CTLDATV
Call CTLDATV(VALEUR,[M]ENDDATSTR) From CONTDIV
If mkstat : GERR = 1 : GZONE = "ENDDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_ENDDATEND
Call AM_ENDDATEND(zc)
If !mkstat & GOBJET
 zoncou = "ENDDATEND" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ENDDATEND(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]ENDDATENDF) From ADATREL
If mkstat : GERR = 1 : GZONE = "ENDDATEND" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_ENDDATEND(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]ENDDATENDF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]ENDDATENDF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MTKFLGSTR
Onevent INIT_AREA Call D_MTKFLGSTR(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MTKFLGSTR(zc) From W1CRITMFG
Return

Subprog D_MTKFLGSTR(VALEUR)
Variable Integer VALEUR
If varinit([M]MTKFLGSTR,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_MTKFLGSTR(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$ON_MTKFLGEND
Onevent CONTROL Call C_MTKFLGEND(zc) From W1CRITMFG
Onevent INIT_AREA Call D_MTKFLGEND(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MTKFLGEND(zc) From W1CRITMFG
Return

Subprog D_MTKFLGEND(VALEUR)
Variable Integer VALEUR
If varinit([M]MTKFLGEND,indice)=0
 VALEUR = 6
Endif
Gosub _AFF
End

Subprog AS_MTKFLGEND(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog C_MTKFLGEND(VALEUR)
Variable Integer VALEUR
## Action CTLNUMVAL
Call CTLNUMVAL(VALEUR,[M]MTKFLGSTR) From CONTX3
If mkstat : GERR = 1 : GZONE = "MTKFLGEND" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_MFIFOR
Onevent CONTROL Call C_MFIFOR(zc) From W1CRITMFG
Onevent BEFORE_INPUT Call AS_MFIFOR(zc) From W1CRITMFG
Onevent AFTER_CHANGE Gosub AMM_MFIFOR From W1CRITMFG
Return

Subprog AS_MFIFOR(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(4574,GBOUT1) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFIFOR(zc) From W1CRITMFG
Onkey   2 Titled GBOUTS Call S_MFIFOR(zc) From W1CRITMFG
Onkey 144 Titled GBOUTP Call P_MFIFOR(zc) From W1CRITMFG
Onkey 146 Titled GBOUTA Call SA_MFIFOR(zc) From W1CRITMFG
Gosub _AFF
End

Subprog C_MFIFOR(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("TFO","!",VALEUR,"38",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "MFIFOR" : GZNUM = 12877 : Endif
Gosub _AFF
End

$AMM_MFIFOR
Call AM_MFIFOR(zc)
If !mkstat & GOBJET
 zoncou = "MFIFOR" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFIFOR(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZMFIFOR)")>indice
 [M]MFIFOR(indice) = VALEUR
 Affzo ZMFIFOR(indice)
Endif
Gosub _AFF
End

Subprog S_MFIFOR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TFO"
PARMSK(2) = "!"
PARMSK(3) = "38"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog B1_MFIFOR(VALEUR)
Variable Char    VALEUR()
Call OBJET("TFO",VALEUR,"38") From GOBJET
Gosub _AFF
End

Subprog SA_MFIFOR(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "TFO"
PARMSK(2) = "38"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_MFIFOR(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "38"
Call VISU("TFO",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZMFIFOR
Onevent BEFORE_AREA Gosub AV_ZMFIFOR From W1CRITMFG
Return

$AV_ZMFIFOR
Call LECTEXTRA(zc,"TABFOR","DES","38",num$([M]MFIFOR(indice))) From ATEXTRA
Gosub _AFF
Return

$CHG_STY
Gosub CHG_STY From W2CRITMFG
Return

$TIT_COL
Gosub TIT_COL From W2CRITMFG
Return


