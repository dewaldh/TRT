#<AdxTL>@(#)0.0.0.0 $Revision$
######################################################################################################################
# Script            : SPEYHOUINV                                                                                        #
# Creation date     : 05/03/2019                                                                                     #
# Version           : 1.0.0                                                                                          #
# Authors (Company) : JR (Leverage)                                                                                  #
# Module            : Housing Jobs                                                                                   #
# -------------------------------------------------------------------------------------------------------------------#
# Epic              : https://jira.leveragetech.com.au/browse/DDP-21                                                 #
# Description       : DFCX1-69 Housing Job Object and Screens                                                        #
#--------------------------------------------------------------------------------------------------------------------#
# Evolutions        :                                                                                                #
######################################################################################################################
Subprog IMPRIME(NBPAR,PARAMETRE)
Value    Integer NBPAR
Variable Char    PARAMETRE()()

If dim([V]GWTRTAUTO)>0 & [V]GWTRTAUTO=1  End : Endif

Local File YHOUJSTA [F:YHJS]

Local Char    YCRITERE(255), YPARAM(30) , YVALEUR(30) , ETAT(GLONARP)
Local Integer NUMREQ, IMPR, I, J

#-----
For I=1 To [L]NBPAR
  J=instr(1,[L]PARAMETRE(I),"=")
  If J
    [L]YPARAM  = left$([L]PARAMETRE(I),J-1)
    Call GETPARAM ([L]YPARAM,NBPAR,PARAMETRE,YVALEUR) From ETAT
    Case [L]YPARAM
      When "jobnbr"        : [L]YCRITERE = " YJBNR = '"+[L]YVALEUR+"'"
      When "stageno"       : [L]YCRITERE -= "& YSTANBR = "+[L]YVALEUR+""
    Endcase
  Endif
Next

For [F:YHJS]YHJS0 Where evalue([L]YCRITERE)
  If [F:YHJS]YINVNUM <> ""
    Trbegin [YPRH]
    Update [YPRH] Where PRHNUM=[F:YPRH]PRHNUM With YPRNUSR=GUSER , YPRNDES= [M:RPT]PRT , YPRNDAT = date$
    If fstat  GOK=0 : Call FSTA("YPRH") From GLOCK : Break : Rollback
    Else    : Commit    : Endif
  Endif
Next

End

