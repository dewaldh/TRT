#<AdxTL>@(#)0.0.0.0 $Revision$Class Change request
# Sage X3 supervisor
## ACLA-CLASSE ## CCMCHGREQ
# 2018-06-20 06:39:43 166

####################################################################
# AINIT
####################################################################

$AINIT
Gosub DECLARE_VAR From WMC0CCMCHGREQ
Local Integer ALINE,TBLINE,ASTASNAPSHOT,ALLSTAT
If this.APARENT=null & this.snapshotEnabled=0
 this.snapshotEnabled = 1
Elsif this.APARENT<>null
 this.snapshotEnabled = this.APARENT.snapshotEnabled
Endif
If this.ASTALIN=[V]CST_ALL : this.ASTALIN = [V]CST_ANEW : Endif
Gosub INIT_CRID From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_TITLE From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_DATEREQ From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CRSTATUS From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CLOSEDST From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CLOSEDATE From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CREDATTIM From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_REASON From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_SITE From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_PRODUCT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_PRODDESC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CRDESC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_IMPACT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_SEVERITY From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CCMUSRID From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CHGMANUSR From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CHGMANDAT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_REJECTCOD From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_REJDESC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_REJECTUSR From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_REJECTDAT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_ECCVALMAJ From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_ECCVALMIN From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_NCSREC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_UPDDATTIM From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_AUUID From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_CREUSR From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_UPDUSR From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_PLANNER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_IMPACTANAL From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_IMPPLANS From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_NCSCCMID From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_NCSMANAGER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub INIT_NCSPLANNER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub AINIT From WMC0CCMCHGREQ : Gosub TESTALLSTAT
If this.snapshotEnabled=1 & this.APARENT=null
 [L]ASTASNAPSHOT = this.freeSnapshot
Endif
Return

####################################################################
# _ALOADATTRIBUTE
####################################################################

$_ALOADATTRIBUTE
Gosub DECLARE_VAR From WMC0CCMCHGREQ
Gosub _ALOADATTRIBUTE_TITLE From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CRSTATUS From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_REASON From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_IMPACT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_SEVERITY From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub _ALOADATTRIBUTE_CCMUSRID From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Return

####################################################################
# _ALNKPRO
####################################################################

$_ALNKPRO
Gosub DECLARE_VAR From WMC0CCMCHGREQ
Gosub LNKPRO_CRID From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_SITE From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_PRODUCT From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_CRDESC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_CCMUSRID From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_CHGMANUSR From WMC1CCMCHGREQ : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.CCMCRNOTES)
 If this.CCMCRNOTES(AINDCLA)<>null& find(this.CCMCRNOTES(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMCRNOTES(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMCRORIGI)
 If this.CCMCRORIGI(AINDCLA)<>null& find(this.CCMCRORIGI(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMCRORIGI(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMCRORIGC)
 If this.CCMCRORIGC(AINDCLA)<>null& find(this.CCMCRORIGC(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMCRORIGC(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMCRORIGS)
 If this.CCMCRORIGS(AINDCLA)<>null& find(this.CCMCRORIGS(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMCRORIGS(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMCRORIGE)
 If this.CCMCRORIGE(AINDCLA)<>null& find(this.CCMCRORIGE(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMCRORIGE(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_REJDESC From WMC1CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_REJECTUSR From WMC1CCMCHGREQ : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.CCMAPPROVER)
 If this.CCMAPPROVER(AINDCLA)<>null& find(this.CCMAPPROVER(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMAPPROVER(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_CREUSR From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_UPDUSR From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_PLANNER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
For AINDCLA=1 To maxtab(this.CCMIASTAD)
 If this.CCMIASTAD(AINDCLA)<>null& find(this.CCMIASTAD(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMIASTAD(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMIASTAM)
 If this.CCMIASTAM(AINDCLA)<>null& find(this.CCMIASTAM(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMIASTAM(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
For AINDCLA=1 To maxtab(this.CCMIASTAS)
 If this.CCMIASTAS(AINDCLA)<>null& find(this.CCMIASTAS(AINDCLA).ASTALIN,[V]CST_ADEL,[V]CST_ANEWDEL)=0
  [L]ASTATUS = fmet this.CCMIASTAS(AINDCLA)._ALNKPRO : Gosub TESTALLSTAT
 Endif
Next AINDCLA
Gosub LNKPRO_NCSMANAGER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Gosub LNKPRO_NCSPLANNER From WMC2CCMCHGREQ : Gosub TESTALLSTAT
Return

$TESTALLSTAT
[L]ALLSTAT = max([L]ALLSTAT,[L]ASTATUS)
Return



