#<AdxTL>@(#)0.0.0.0 $Revision$Class Sales order history - header
# Supervisor
## ACLA-CLASSE ## VSORDER
# 2018-08-27 12:54:55 362

####################################################################
# Labels of the main class and methods 
####################################################################

####################################################################
# 61 : DEP_LEG Legislation ( Field Miscellaneous table number)
####################################################################

$SET_DEP_LEG
If [L]_AOLDVAL<>this.DEP_LEG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DEP_LEG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DEP_LEG
 Gosub PROPAGATE_DEP_LEG
Endif
Return

$INIT_DEP_LEG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DEP_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_INI(this,"DEP_LEG",this.DEP_LEG,909)
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_DEP_LEG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DEP_LEG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DEP_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DEP_LEG               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DEP_LEG
[L]CURPRO = "DEP_LEG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.DEP_LEG,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DEP_LEG
[L]CURPRO = "DEP_LEG"
If vireblc(this.DEP_LEG,2)<>vireblc(format$("K:20B",this.DEP_LEG),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_DEP_LEG
[L]CURPRO = "DEP_LEG"
[L]ASTATUS =  func ADI_TOOL.ADI_CONT(this,"DEP_LEG",this.DEP_LEG,909,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DEP_LEG
[L]CURPRO = "DEP_LEG"
Return

$PROPAGATE_DEP_LEG
this.isReadonly = 0
[L]CURPRO = "DEP_LEG"
Gosub _LNKPRO_DEP_LEG
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DEP_LEG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DEP_LEG"
$_LNKPRO_DEP_LEG
If vireblc(this.DEP_LEG,2)<>""
 # Link ATABDIV
 Local File ATABDIV [WADI]
 Read [F:WADI]CODE = 909;this.DEP_LEG
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="SHODES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP_LEG","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="ATABDIV" & ZONE="LNGDES" & IDENT1=num$([F:WADI]NUMTAB) & IDENT2=[F:WADI]CODE & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("DEP_LEG","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WADI]
Endif
Return


####################################################################
# 62 : BPTNUM Carrier ( Field BPT 15)
####################################################################

$SET_BPTNUM
If [L]_AOLDVAL<>this.BPTNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BPTNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BPTNUM
 Gosub PROPAGATE_BPTNUM
Endif
Return

$INIT_BPTNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BPTNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_BPTNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BPTNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BPTNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BPTNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BPTNUM
[L]CURPRO = "BPTNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.BPTNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BPTNUM
[L]CURPRO = "BPTNUM"
If vireblc(this.BPTNUM,2)<>vireblc(format$("K:15c",this.BPTNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_BPTNUM
[L]CURPRO = "BPTNUM"
If vireblc(this.BPTNUM,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPBPT.ACTRLREF(this,"BPTNUM",this.BPTNUM,this.BPTNUM,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.BPTNUM<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BPTNUM
[L]CURPRO = "BPTNUM"
Return

$PROPAGATE_BPTNUM
this.isReadonly = 0
[L]CURPRO = "BPTNUM"
Gosub _LNKPRO_BPTNUM
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BPTNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BPTNUM"
$_LNKPRO_BPTNUM
If vireblc(this.BPTNUM,2)<>""
 # Link BPCARRIER
 Local File BPCARRIER [WBPT]
 Read [F:WBPT]BPT0 = this.BPTNUM
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPTNUM","$title",[F:WBPT]BPTSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("BPTNUM","$description",[F:WBPT]BPTNAM)
 Endif
 LogicClose File [WBPT]
Endif
Return


####################################################################
# 63 : MDL Delivery mode ( Field MDL 5)
####################################################################

$SET_MDL
If [L]_AOLDVAL<>this.MDL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_MDL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.MDL
 Gosub PROPAGATE_MDL
Endif
Return

$INIT_MDL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "MDL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_MDL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "MDL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_MDL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_MDL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_MDL
[L]CURPRO = "MDL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.MDL,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_MDL
[L]CURPRO = "MDL"
If vireblc(this.MDL,2)<>vireblc(format$("K:5c",this.MDL),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_MDL
[L]CURPRO = "MDL"
If vireblc(this.MDL,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPMDL.ACTRLREF(this,"MDL",this.MDL,this.MDL,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.MDL<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_MDL
[L]CURPRO = "MDL"
Return

$PROPAGATE_MDL
this.isReadonly = 0
[L]CURPRO = "MDL"
Gosub _LNKPRO_MDL
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_MDL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "MDL"
$_LNKPRO_MDL
If vireblc(this.MDL,2)<>""
 # Link TABMODELIV
 Local File TABMODELIV [WTMD]
 Read [F:WTMD]TMD0 = this.MDL
 If !fstat
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABMODELIV" & ZONE="SHOAXX" & IDENT1=[F:WTMD]MDL & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("MDL","$title",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
  Local File ATEXTRA [WAXX]
  Local Char ILAN(GLONLAN)
  For ILAN=this.ACTX.LAN, this.ACTX.AFOLD.ALANGDEF
   For [F:WAXX] Where CODFIC="TABMODELIV" & ZONE="DESAXX" & IDENT1=[F:WTMD]MDL & IDENT2="" & LANGUE = ILAN
    [L]ASTATUS = fmet this.ASETATTRIBUTE("MDL","$description",[WAXX]TEXTE)
    Break 2
   Next WAXX
  Next ILAN
  LogicClose File [WAXX]
 Endif
 LogicClose File [WTMD]
Endif
Return


####################################################################
# 64 : STOFCY Shipment site ( Field FCY 5)
####################################################################

$SET_STOFCY
If [L]_AOLDVAL<>this.STOFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_STOFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.STOFCY
 Gosub PROPAGATE_STOFCY
Endif
Return

$INIT_STOFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "STOFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_STOFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "STOFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_STOFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_STOFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_STOFCY
[L]CURPRO = "STOFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.STOFCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_STOFCY
[L]CURPRO = "STOFCY"
If vireblc(this.STOFCY,2)<>vireblc(format$("K:5c",this.STOFCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_STOFCY
[L]CURPRO = "STOFCY"
If vireblc(this.STOFCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"STOFCY",this.STOFCY,this.STOFCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.STOFCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_STOFCY
[L]CURPRO = "STOFCY"
Return

$PROPAGATE_STOFCY
this.isReadonly = 0
[L]CURPRO = "STOFCY"
Gosub _LNKPRO_STOFCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_STOFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "STOFCY"
$_LNKPRO_STOFCY
If vireblc(this.STOFCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.STOFCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("STOFCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("STOFCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return

$_ALOADATTRIBUTE_STOFCY
[L]ASTATUS = fmet this.ASETATTRIBUTE("STOFCY","$isMandatory","true")
Return


####################################################################
# 65 : DRN Route no. ( Field Local menu number 409)
####################################################################

$SET_DRN
If [L]_AOLDVAL<>this.DRN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DRN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DRN
 Gosub PROPAGATE_DRN
Endif
Return

$INIT_DRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DRN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.DRN=0 and fmet this.AGETATTRIBUTE("DRN","$isMandatory")="true"
 this.DRN = 1
Endif
Return
 
$CONTROL_DRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DRN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DRN                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DRN                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DRN
[L]CURPRO = "DRN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DRN=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DRN
[L]CURPRO = "DRN"
If this.DRN<0 or this.DRN>len(mess(0,409,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"409 ->"-num$(this.DRN)-mess(99,123,1)):  Return : # Local menu "409 -> Invalid option
Endif
Return

$_AOTHERS_DRN
[L]CURPRO = "DRN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DRN
[L]CURPRO = "DRN"
Return

$PROPAGATE_DRN
this.isReadonly = 0
[L]CURPRO = "DRN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DRN"
$_LNKPRO_DRN
Return


####################################################################
# 66 : DLVPIO Delivery priority ( Field Local menu number 410)
####################################################################

$SET_DLVPIO
If [L]_AOLDVAL<>this.DLVPIO
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DLVPIO
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DLVPIO
 Gosub PROPAGATE_DLVPIO
Endif
Return

$INIT_DLVPIO
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DLVPIO"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.DLVPIO=0 and fmet this.AGETATTRIBUTE("DLVPIO","$isMandatory")="true"
 this.DLVPIO = 1
Endif
Return
 
$CONTROL_DLVPIO
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DLVPIO"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DLVPIO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DLVPIO                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DLVPIO
[L]CURPRO = "DLVPIO"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DLVPIO=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DLVPIO
[L]CURPRO = "DLVPIO"
If this.DLVPIO<0 or this.DLVPIO>len(mess(0,410,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"410 ->"-num$(this.DLVPIO)-mess(99,123,1)):  Return : # Local menu "410 -> Invalid option
Endif
Return

$_AOTHERS_DLVPIO
[L]CURPRO = "DLVPIO"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DLVPIO
[L]CURPRO = "DLVPIO"
Return

$PROPAGATE_DLVPIO
this.isReadonly = 0
[L]CURPRO = "DLVPIO"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DLVPIO
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DLVPIO"
$_LNKPRO_DLVPIO
Return


####################################################################
# 67 : ORDCLE Close unfilled lines ( Field Local menu number 1)
####################################################################

$SET_ORDCLE
If [L]_AOLDVAL<>this.ORDCLE
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORDCLE
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORDCLE
 Gosub PROPAGATE_ORDCLE
Endif
Return

$INIT_ORDCLE
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDCLE"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.ORDCLE=0 and fmet this.AGETATTRIBUTE("ORDCLE","$isMandatory")="true"
 this.ORDCLE = 1
Endif
Return
 
$CONTROL_ORDCLE
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDCLE"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORDCLE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORDCLE                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORDCLE
[L]CURPRO = "ORDCLE"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ORDCLE=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORDCLE
[L]CURPRO = "ORDCLE"
If this.ORDCLE<0 or this.ORDCLE>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.ORDCLE)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_ORDCLE
[L]CURPRO = "ORDCLE"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORDCLE
[L]CURPRO = "ORDCLE"
Return

$PROPAGATE_ORDCLE
this.isReadonly = 0
[L]CURPRO = "ORDCLE"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORDCLE
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDCLE"
$_LNKPRO_ORDCLE
Return


####################################################################
# 68 : ODL One order per delivery ( Field Local menu number 1)
####################################################################

$SET_ODL
If [L]_AOLDVAL<>this.ODL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ODL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ODL
 Gosub PROPAGATE_ODL
Endif
Return

$INIT_ODL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ODL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.ODL=0 and fmet this.AGETATTRIBUTE("ODL","$isMandatory")="true"
 this.ODL = 1
Endif
Return
 
$CONTROL_ODL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ODL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ODL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ODL                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ODL
[L]CURPRO = "ODL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ODL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ODL
[L]CURPRO = "ODL"
If this.ODL<0 or this.ODL>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.ODL)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_ODL
[L]CURPRO = "ODL"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ODL
[L]CURPRO = "ODL"
Return

$PROPAGATE_ODL
this.isReadonly = 0
[L]CURPRO = "ODL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ODL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ODL"
$_LNKPRO_ODL
Return


####################################################################
# 69 : DME Partial delivery ( Field Local menu number 414)
####################################################################

$SET_DME
If [L]_AOLDVAL<>this.DME
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_DME
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.DME
 Gosub PROPAGATE_DME
Endif
Return

$INIT_DME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DME"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.DME=0 and fmet this.AGETATTRIBUTE("DME","$isMandatory")="true"
 this.DME = 1
Endif
Return
 
$CONTROL_DME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DME"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_DME                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_DME                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_DME
[L]CURPRO = "DME"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.DME=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_DME
[L]CURPRO = "DME"
If this.DME<0 or this.DME>len(mess(0,414,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"414 ->"-num$(this.DME)-mess(99,123,1)):  Return : # Local menu "414 -> Invalid option
Endif
Return

$_AOTHERS_DME
[L]CURPRO = "DME"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_DME
[L]CURPRO = "DME"
Return

$PROPAGATE_DME
this.isReadonly = 0
[L]CURPRO = "DME"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_DME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "DME"
$_LNKPRO_DME
Return


####################################################################
# 70 : IME Invoicing mode ( Field Local menu number 408)
####################################################################

$SET_IME
If [L]_AOLDVAL<>this.IME
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_IME
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.IME
 Gosub PROPAGATE_IME
Endif
Return

$INIT_IME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "IME"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.IME=0 and fmet this.AGETATTRIBUTE("IME","$isMandatory")="true"
 this.IME = 1
Endif
Return
 
$CONTROL_IME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "IME"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_IME                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_IME                   : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_IME
[L]CURPRO = "IME"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.IME=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_IME
[L]CURPRO = "IME"
If this.IME<0 or this.IME>len(mess(0,408,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"408 ->"-num$(this.IME)-mess(99,123,1)):  Return : # Local menu "408 -> Invalid option
Endif
Return

$_AOTHERS_IME
[L]CURPRO = "IME"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_IME
[L]CURPRO = "IME"
Return

$PROPAGATE_IME
this.isReadonly = 0
[L]CURPRO = "IME"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_IME
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "IME"
$_LNKPRO_IME
Return


####################################################################
# 71 : OCNFLG Print acknowledgment ( Field Local menu number 1)
####################################################################

$SET_OCNFLG
If [L]_AOLDVAL<>this.OCNFLG
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OCNFLG
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OCNFLG
 Gosub PROPAGATE_OCNFLG
Endif
Return

$INIT_OCNFLG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNFLG"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OCNFLG=0 and fmet this.AGETATTRIBUTE("OCNFLG","$isMandatory")="true"
 this.OCNFLG = 1
Endif
Return
 
$CONTROL_OCNFLG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNFLG"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OCNFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OCNFLG                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OCNFLG
[L]CURPRO = "OCNFLG"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OCNFLG=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OCNFLG
[L]CURPRO = "OCNFLG"
If this.OCNFLG<0 or this.OCNFLG>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OCNFLG)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OCNFLG
[L]CURPRO = "OCNFLG"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OCNFLG
[L]CURPRO = "OCNFLG"
Return

$PROPAGATE_OCNFLG
this.isReadonly = 0
[L]CURPRO = "OCNFLG"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OCNFLG
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNFLG"
$_LNKPRO_OCNFLG
Return


####################################################################
# 72 : OCNPRN Acknowledgment printed ( Field Local menu number 1)
####################################################################

$SET_OCNPRN
If [L]_AOLDVAL<>this.OCNPRN
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_OCNPRN
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.OCNPRN
 Gosub PROPAGATE_OCNPRN
Endif
Return

$INIT_OCNPRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNPRN"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.OCNPRN=0 and fmet this.AGETATTRIBUTE("OCNPRN","$isMandatory")="true"
 this.OCNPRN = 1
Endif
Return
 
$CONTROL_OCNPRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNPRN"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_OCNPRN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_OCNPRN                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_OCNPRN
[L]CURPRO = "OCNPRN"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.OCNPRN=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_OCNPRN
[L]CURPRO = "OCNPRN"
If this.OCNPRN<0 or this.OCNPRN>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.OCNPRN)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_OCNPRN
[L]CURPRO = "OCNPRN"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_OCNPRN
[L]CURPRO = "OCNPRN"
Return

$PROPAGATE_OCNPRN
this.isReadonly = 0
[L]CURPRO = "OCNPRN"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_OCNPRN
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "OCNPRN"
$_LNKPRO_OCNPRN
Return


####################################################################
# 73 : COPNBR No. copies acknowledgement of receipt ( Field C 1)
####################################################################

$SET_COPNBR
If [L]_AOLDVAL<>this.COPNBR
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_COPNBR
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.COPNBR
 Gosub PROPAGATE_COPNBR
Endif
Return

$INIT_COPNBR
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "COPNBR"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_COPNBR
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "COPNBR"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_COPNBR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_COPNBR                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_COPNBR
[L]CURPRO = "COPNBR"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.COPNBR=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_COPNBR
[L]CURPRO = "COPNBR"
Return

$_AOTHERS_COPNBR
[L]CURPRO = "COPNBR"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_COPNBR
[L]CURPRO = "COPNBR"
Return

$PROPAGATE_COPNBR
this.isReadonly = 0
[L]CURPRO = "COPNBR"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_COPNBR
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "COPNBR"
$_LNKPRO_COPNBR
Return


####################################################################
# 74 : SOHTEX1 Ord header text ( Field TXC 12)
####################################################################

$SET_SOHTEX1
If [L]_AOLDVAL<>this.SOHTEX1
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SOHTEX1
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SOHTEX1
 Gosub PROPAGATE_SOHTEX1
Endif
Return

$INIT_SOHTEX1
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX1"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SOHTEX1
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX1"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SOHTEX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SOHTEX1               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SOHTEX1
[L]CURPRO = "SOHTEX1"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SOHTEX1,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SOHTEX1
[L]CURPRO = "SOHTEX1"
If vireblc(this.SOHTEX1,2)<>vireblc(format$("K:12X",this.SOHTEX1),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SOHTEX1
[L]CURPRO = "SOHTEX1"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SOHTEX1
[L]CURPRO = "SOHTEX1"
Return

$PROPAGATE_SOHTEX1
this.isReadonly = 0
[L]CURPRO = "SOHTEX1"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SOHTEX1
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX1"
$_LNKPRO_SOHTEX1
Return


####################################################################
# 75 : SOHTEX2 Ord footer text ( Field TXC 12)
####################################################################

$SET_SOHTEX2
If [L]_AOLDVAL<>this.SOHTEX2
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SOHTEX2
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SOHTEX2
 Gosub PROPAGATE_SOHTEX2
Endif
Return

$INIT_SOHTEX2
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX2"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SOHTEX2
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX2"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SOHTEX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SOHTEX2               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SOHTEX2
[L]CURPRO = "SOHTEX2"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SOHTEX2,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SOHTEX2
[L]CURPRO = "SOHTEX2"
If vireblc(this.SOHTEX2,2)<>vireblc(format$("K:12X",this.SOHTEX2),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SOHTEX2
[L]CURPRO = "SOHTEX2"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SOHTEX2
[L]CURPRO = "SOHTEX2"
Return

$PROPAGATE_SOHTEX2
this.isReadonly = 0
[L]CURPRO = "SOHTEX2"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SOHTEX2
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SOHTEX2"
$_LNKPRO_SOHTEX2
Return


####################################################################
# 76 : SQHNUM Quote no. ( Field VCR 20)
####################################################################

$SET_SQHNUM
If [L]_AOLDVAL<>this.SQHNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_SQHNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.SQHNUM
 Gosub PROPAGATE_SQHNUM
Endif
Return

$INIT_SQHNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SQHNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_SQHNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SQHNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_SQHNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_SQHNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_SQHNUM
[L]CURPRO = "SQHNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.SQHNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_SQHNUM
[L]CURPRO = "SQHNUM"
If vireblc(this.SQHNUM,2)<>vireblc(format$("K:20X",this.SQHNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_SQHNUM
[L]CURPRO = "SQHNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_SQHNUM
[L]CURPRO = "SQHNUM"
Return

$PROPAGATE_SQHNUM
this.isReadonly = 0
[L]CURPRO = "SQHNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_SQHNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "SQHNUM"
$_LNKPRO_SQHNUM
Return


####################################################################
# 77 : BETFCY Intersites ( Field Local menu number 1)
####################################################################

$SET_BETFCY
If [L]_AOLDVAL<>this.BETFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BETFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BETFCY
 Gosub PROPAGATE_BETFCY
Endif
Return

$INIT_BETFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.BETFCY=0 and fmet this.AGETATTRIBUTE("BETFCY","$isMandatory")="true"
 this.BETFCY = 1
Endif
Return
 
$CONTROL_BETFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BETFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BETFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BETFCY
[L]CURPRO = "BETFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BETFCY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BETFCY
[L]CURPRO = "BETFCY"
If this.BETFCY<0 or this.BETFCY>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.BETFCY)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_BETFCY
[L]CURPRO = "BETFCY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BETFCY
[L]CURPRO = "BETFCY"
Return

$PROPAGATE_BETFCY
this.isReadonly = 0
[L]CURPRO = "BETFCY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BETFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETFCY"
$_LNKPRO_BETFCY
Return


####################################################################
# 78 : BETCPY Intercompany ( Field Local menu number 1)
####################################################################

$SET_BETCPY
If [L]_AOLDVAL<>this.BETCPY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_BETCPY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.BETCPY
 Gosub PROPAGATE_BETCPY
Endif
Return

$INIT_BETCPY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETCPY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.BETCPY=0 and fmet this.AGETATTRIBUTE("BETCPY","$isMandatory")="true"
 this.BETCPY = 1
Endif
Return
 
$CONTROL_BETCPY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETCPY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_BETCPY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_BETCPY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_BETCPY
[L]CURPRO = "BETCPY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.BETCPY=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_BETCPY
[L]CURPRO = "BETCPY"
If this.BETCPY<0 or this.BETCPY>len(mess(0,1,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"1 ->"-num$(this.BETCPY)-mess(99,123,1)):  Return : # Local menu "1 -> Invalid option
Endif
Return

$_AOTHERS_BETCPY
[L]CURPRO = "BETCPY"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_BETCPY
[L]CURPRO = "BETCPY"
Return

$PROPAGATE_BETCPY
this.isReadonly = 0
[L]CURPRO = "BETCPY"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_BETCPY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "BETCPY"
$_LNKPRO_BETCPY
Return


####################################################################
# 79 : ORIFCY Original site ( Field FCY 5)
####################################################################

$SET_ORIFCY
If [L]_AOLDVAL<>this.ORIFCY
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORIFCY
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORIFCY
 Gosub PROPAGATE_ORIFCY
Endif
Return

$INIT_ORIFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORIFCY"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ORIFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORIFCY"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORIFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORIFCY                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORIFCY
[L]CURPRO = "ORIFCY"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.ORIFCY,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORIFCY
[L]CURPRO = "ORIFCY"
If vireblc(this.ORIFCY,2)<>vireblc(format$("K:5c",this.ORIFCY),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_ORIFCY
[L]CURPRO = "ORIFCY"
If vireblc(this.ORIFCY,2)<>""
 If fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent")=""
  [L]ASTATUS =  func WMTYPFCY.ACTRLREF(this,"ORIFCY",this.ORIFCY,this.ORIFCY,"")
  If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
 Else
  If this.ORIFCY<>evalue("this.APARENT."+fmet this.AGETATTRIBUTE([L]CURPRO,"$namProParent"))
   [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(83,123,1)) :  Return : # Invalid value
  Endif
 Endif
Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORIFCY
[L]CURPRO = "ORIFCY"
Return

$PROPAGATE_ORIFCY
this.isReadonly = 0
[L]CURPRO = "ORIFCY"
Gosub _LNKPRO_ORIFCY
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORIFCY
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORIFCY"
$_LNKPRO_ORIFCY
If vireblc(this.ORIFCY,2)<>""
 # Link FACILITY
 Local File FACILITY [WFCY]
 Read [F:WFCY]FCY0 = this.ORIFCY
 If !fstat
  [L]ASTATUS = fmet this.ASETATTRIBUTE("ORIFCY","$title",[F:WFCY]FCYSHO)
  [L]ASTATUS = fmet this.ASETATTRIBUTE("ORIFCY","$description",[F:WFCY]FCYNAM)
 Endif
 LogicClose File [WFCY]
Endif
Return


####################################################################
# 80 : PRFNUM Proforma invoice no. ( Field VCR 20)
####################################################################

$SET_PRFNUM
If [L]_AOLDVAL<>this.PRFNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRFNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRFNUM
 Gosub PROPAGATE_PRFNUM
Endif
Return

$INIT_PRFNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRFNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_PRFNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRFNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRFNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRFNUM                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRFNUM
[L]CURPRO = "PRFNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.PRFNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRFNUM
[L]CURPRO = "PRFNUM"
If vireblc(this.PRFNUM,2)<>vireblc(format$("K:20X",this.PRFNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_PRFNUM
[L]CURPRO = "PRFNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRFNUM
[L]CURPRO = "PRFNUM"
Return

$PROPAGATE_PRFNUM
this.isReadonly = 0
[L]CURPRO = "PRFNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRFNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRFNUM"
$_LNKPRO_PRFNUM
Return


####################################################################
# 81 : LASDLVNUM Last delivery no. ( Field VCR 20)
####################################################################

$SET_LASDLVNUM
If [L]_AOLDVAL<>this.LASDLVNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LASDLVNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LASDLVNUM
 Gosub PROPAGATE_LASDLVNUM
Endif
Return

$INIT_LASDLVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LASDLVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LASDLVNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LASDLVNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LASDLVNUM
[L]CURPRO = "LASDLVNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LASDLVNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LASDLVNUM
[L]CURPRO = "LASDLVNUM"
If vireblc(this.LASDLVNUM,2)<>vireblc(format$("K:20X",this.LASDLVNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_LASDLVNUM
[L]CURPRO = "LASDLVNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LASDLVNUM
[L]CURPRO = "LASDLVNUM"
Return

$PROPAGATE_LASDLVNUM
this.isReadonly = 0
[L]CURPRO = "LASDLVNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LASDLVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVNUM"
$_LNKPRO_LASDLVNUM
Return


####################################################################
# 82 : LASDLVDAT Last delivery date ( Field D)
####################################################################

$SET_LASDLVDAT
If [L]_AOLDVAL<>this.LASDLVDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LASDLVDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LASDLVDAT
 Gosub PROPAGATE_LASDLVDAT
Endif
Return

$INIT_LASDLVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LASDLVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LASDLVDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LASDLVDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LASDLVDAT
[L]CURPRO = "LASDLVDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.LASDLVDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LASDLVDAT
[L]CURPRO = "LASDLVDAT"
Return

$_AOTHERS_LASDLVDAT
[L]CURPRO = "LASDLVDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LASDLVDAT
[L]CURPRO = "LASDLVDAT"
Return

$PROPAGATE_LASDLVDAT
this.isReadonly = 0
[L]CURPRO = "LASDLVDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LASDLVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASDLVDAT"
$_LNKPRO_LASDLVDAT
Return


####################################################################
# 83 : LASINVNUM Last invoice no. ( Field VCR 20)
####################################################################

$SET_LASINVNUM
If [L]_AOLDVAL<>this.LASINVNUM
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LASINVNUM
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LASINVNUM
 Gosub PROPAGATE_LASINVNUM
Endif
Return

$INIT_LASINVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVNUM"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LASINVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVNUM"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LASINVNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LASINVNUM             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LASINVNUM
[L]CURPRO = "LASINVNUM"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & vireblc(this.LASINVNUM,2)=""
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LASINVNUM
[L]CURPRO = "LASINVNUM"
If vireblc(this.LASINVNUM,2)<>vireblc(format$("K:20X",this.LASINVNUM),2)
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(149,100,1)) :  Return : # Incorrect Format
Endif
Return

$_AOTHERS_LASINVNUM
[L]CURPRO = "LASINVNUM"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LASINVNUM
[L]CURPRO = "LASINVNUM"
Return

$PROPAGATE_LASINVNUM
this.isReadonly = 0
[L]CURPRO = "LASINVNUM"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LASINVNUM
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVNUM"
$_LNKPRO_LASINVNUM
Return


####################################################################
# 84 : LASINVDAT Last invoice date ( Field D)
####################################################################

$SET_LASINVDAT
If [L]_AOLDVAL<>this.LASINVDAT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_LASINVDAT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.LASINVDAT
 Gosub PROPAGATE_LASINVDAT
Endif
Return

$INIT_LASINVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVDAT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_LASINVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVDAT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_LASINVDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_LASINVDAT             : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_LASINVDAT
[L]CURPRO = "LASINVDAT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.LASINVDAT=[0/0/0]
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_LASINVDAT
[L]CURPRO = "LASINVDAT"
Return

$_AOTHERS_LASINVDAT
[L]CURPRO = "LASINVDAT"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_LASINVDAT
[L]CURPRO = "LASINVDAT"
Return

$PROPAGATE_LASINVDAT
this.isReadonly = 0
[L]CURPRO = "LASINVDAT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_LASINVDAT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "LASINVDAT"
$_LNKPRO_LASINVDAT
Return


####################################################################
# 86 : PRITYP Price - / +tax ( Field Local menu number 243)
####################################################################

$SET_PRITYP
If [L]_AOLDVAL<>this.PRITYP
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_PRITYP
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.PRITYP
 Gosub PROPAGATE_PRITYP
Endif
Return

$INIT_PRITYP
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRITYP"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If this.PRITYP=0 and fmet this.AGETATTRIBUTE("PRITYP","$isMandatory")="true"
 this.PRITYP = 1
Endif
Return
 
$CONTROL_PRITYP
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRITYP"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_PRITYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_PRITYP                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_PRITYP
[L]CURPRO = "PRITYP"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.PRITYP=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_PRITYP
[L]CURPRO = "PRITYP"
If this.PRITYP<0 or this.PRITYP>len(mess(0,243,1))
 # Pop / Invalid option
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(4,11,1)-"243 ->"-num$(this.PRITYP)-mess(99,123,1)):  Return : # Local menu "243 -> Invalid option
Endif
Return

$_AOTHERS_PRITYP
[L]CURPRO = "PRITYP"
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_PRITYP
[L]CURPRO = "PRITYP"
Return

$PROPAGATE_PRITYP
this.isReadonly = 0
[L]CURPRO = "PRITYP"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_PRITYP
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "PRITYP"
$_LNKPRO_PRITYP
Return


####################################################################
# 87 : ORDNOT Order amount -tax ( Field MD1 0)
####################################################################

$SET_ORDNOT
If [L]_AOLDVAL<>this.ORDNOT
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORDNOT
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORDNOT
 Gosub PROPAGATE_ORDNOT
Endif
Return

$INIT_ORDNOT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOT"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ORDNOT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOT"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORDNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORDNOT                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORDNOT
[L]CURPRO = "ORDNOT"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ORDNOT=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORDNOT
[L]CURPRO = "ORDNOT"
Return

$_AOTHERS_ORDNOT
[L]CURPRO = "ORDNOT"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"ORDNOT",this.ORDNOT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORDNOT
[L]CURPRO = "ORDNOT"
Return

$PROPAGATE_ORDNOT
this.isReadonly = 0
[L]CURPRO = "ORDNOT"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORDNOT
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOT"
$_LNKPRO_ORDNOT
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"ORDNOT",this.ORDNOT,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("ORDNOT","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 88 : ORDATI Tax-included order amount ( Field MD1 0)
####################################################################

$SET_ORDATI
If [L]_AOLDVAL<>this.ORDATI
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORDATI
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORDATI
 Gosub PROPAGATE_ORDATI
Endif
Return

$INIT_ORDATI
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATI"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ORDATI
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATI"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORDATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORDATI                : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORDATI
[L]CURPRO = "ORDATI"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ORDATI=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORDATI
[L]CURPRO = "ORDATI"
Return

$_AOTHERS_ORDATI
[L]CURPRO = "ORDATI"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"ORDATI",this.ORDATI,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORDATI
[L]CURPRO = "ORDATI"
Return

$PROPAGATE_ORDATI
this.isReadonly = 0
[L]CURPRO = "ORDATI"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORDATI
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATI"
$_LNKPRO_ORDATI
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"ORDATI",this.ORDATI,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("ORDATI","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 89 : ORDNOTL Line amt. - tax (company) ( Field MD1 0)
####################################################################

$SET_ORDNOTL
If [L]_AOLDVAL<>this.ORDNOTL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORDNOTL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORDNOTL
 Gosub PROPAGATE_ORDNOTL
Endif
Return

$INIT_ORDNOTL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOTL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ORDNOTL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOTL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORDNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORDNOTL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORDNOTL
[L]CURPRO = "ORDNOTL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ORDNOTL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORDNOTL
[L]CURPRO = "ORDNOTL"
Return

$_AOTHERS_ORDNOTL
[L]CURPRO = "ORDNOTL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"ORDNOTL",this.ORDNOTL,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORDNOTL
[L]CURPRO = "ORDNOTL"
Return

$PROPAGATE_ORDNOTL
this.isReadonly = 0
[L]CURPRO = "ORDNOTL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORDNOTL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDNOTL"
$_LNKPRO_ORDNOTL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"ORDNOTL",this.ORDNOTL,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("ORDNOTL","$x3Format",[L]AFORMAT)
Endif
Return


####################################################################
# 90 : ORDATIL Line amt. + tax (company) ( Field MD1 0)
####################################################################

$SET_ORDATIL
If [L]_AOLDVAL<>this.ORDATIL
 Call _ASTATUSPARENT(this) From ASYRSUB
Endif
Gosub CONTROL_ORDATIL
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]_AOLDVAL<>this.ORDATIL
 Gosub PROPAGATE_ORDATIL
Endif
Return

$INIT_ORDATIL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATIL"
[L]ARULE = "INIT" : [L]ACTION = "INIT" : Gosub ACTION From ASYRSUB
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return
 
$CONTROL_ORDATIL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATIL"
[L]ASTATUS = fmet this.ADELETEERROR([L]CURPRO)
Gosub _AFORMAT_ORDATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Gosub _AOTHERS_ORDATIL               : If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
Return

$_AMANDATORY_ORDATIL
[L]CURPRO = "ORDATIL"
If fmet this.AGETATTRIBUTE([L]CURPRO,"$isMandatory")="true" & this.ORDATIL=0
 [L]ASTATUS = func ASYRSUB._ASETSTATUS(this,[L]CURPRO,0,[V]CST_AERROR,[V]CST_AHTTP_BAD_REQUEST,mess(10,123,1)) :  Return : # Mandatory field
Endif
Return

$_AFORMAT_ORDATIL
[L]CURPRO = "ORDATIL"
Return

$_AOTHERS_ORDATIL
[L]CURPRO = "ORDATIL"
[L]ASTATUS =  func ASYRTRTATY.CONTROLMD1(this,"ORDATIL",this.ORDATIL,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
[L]ARULE = "CONTROL" : [L]ACTION = "CONTROL" : Gosub ACTION From ASYRSUB
Return

$_AOTHERS_REF_ORDATIL
[L]CURPRO = "ORDATIL"
Return

$PROPAGATE_ORDATIL
this.isReadonly = 0
[L]CURPRO = "ORDATIL"
[L]ARULE = "PROPAGATE" : [L]ACTION = "PROPAGATE" : Gosub ACTION From ASYRSUB
this.isReadonly = 1
Return

$LNKPRO_ORDATIL
Gosub DECLARE_VAR From WMC0VSORDER
[L]CURPRO = "ORDATIL"
$_LNKPRO_ORDATIL
Local Char AFORMAT(50)
[L]ASTATUS =  func ASYRTRTATY.GETFORMATMD1(this,"ORDATIL",this.ORDATIL,[L]AFORMAT,"")
If [L]ASTATUS>=[V]CST_AERROR : Return : Endif
If [L]AFORMAT<>''
[L]AFORMAT='"'+[L]AFORMAT+'"'
[L]ASTATUS = fmet this.ASETATTRIBUTE("ORDATIL","$x3Format",[L]AFORMAT)
Endif
Return




