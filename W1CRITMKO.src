#<AdxTL>@(#)0.0.0.0 $Revision$
# Sage X3 supervisor
# Mask management CRITMKO 

$_AFF
If GIMPORT
 Gosub AFF From GSAISIE
Else
 If GMESSAGE <>""
  Gosub ERR From GSAISIE
 Else
  Raz GERR , GZNUM
 Endif
Endif
Return

$HORODAT
Local Date    A_DATE
Local Char    A_HEURE(10) , A_USER(10)
Local Char    A_STAMP(15)
A_DATE  = [26/03/2018]
A_HEURE = "12:45:55"
A_USER  = "ADMIN"
A_STAMP = "20180326124555"
Return

$TITRES
Return

$VISU
Local Integer A_REPONSE
Global Integer GPRE_VIEW
If dim(A_WINDPREV)<=0 : Local Char A_WINDPREV(30) : Endif
Local Mask CRITMKO [CMKO]
Gosub HORODAT
Local Inpbox "CRITMKO" From GFONCTION At A_STAMP With A_WINDPREV Mask [CMKO] As [SIM_]
Grizo [CMKO]5
Grizo [CMKO]10
Grizo [CMKO]15
Boxact [SIM_]
Gosub TITRES
Boxinp [SIM_] Using A_REPONSE
Close Local Inpbox [SIM_]
Close Local Mask [CMKO]
Kill GPRE_VIEW
Return

$HARDCOP
Local Integer X1(0..14),X2(0..14),Y1(0..14),Y2(0..14)
X1(0)=27 : X2(0)=86 : Y1(0)=6 : Y2(0)=7
X1(1)=27 : X2(1)=86 : Y1(1)=8 : Y2(1)=20
X1(2)=27 : X2(2)=86 : Y1(2)=21 : Y2(2)=23
Return

$ON_MEMO
Return

$ON_EMPNUMDEB
Onevent AFTER_CHANGE Gosub AMM_EMPNUMDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_EMPNUMDEB(zc) From W1CRITMKO
Return

Subprog AS_EMPNUMDEB(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18515,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_EMPNUMDEB(zc) From W1CRITMKO
Gosub _AFF
End

$AMM_EMPNUMDEB
Call AM_EMPNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "EMPNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_EMPNUMDEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_EMPNUMDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "EMPNUMDEB" : GZNUM = 10793 : Endif
Gosub _AFF
End

Subprog S_EMPNUMDEB(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELEMPNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELEMPNUM"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELEMPNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_EMPNUMFIN
Onevent CONTROL Call C_EMPNUMFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_EMPNUMFIN(zc) From W1CRITMKO
Return

Subprog AS_EMPNUMFIN(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18515,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_EMPNUMFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_EMPNUMFIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_EMPNUMFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "EMPNUMFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_EMPNUMFIN(VALEUR)
Variable Decimal VALEUR
If !GWEBSERV
 ## Action SELEMPNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELEMPNUM"
 Call S_TAB_NUM(VALEUR,PARMSK,"SELEMPNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGDATDEB
Onevent BEFORE_AREA Gosub AV_MFGDATDEB From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_MFGDATDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGDATDEB(zc) From W1CRITMKO
Return

$AV_MFGDATDEB
## Action ADATRELI
Call INIDAT(zc,[M]MFGDATDEBF) From ADATREL
Chgfmt [M]MFGDATDEB(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MFGDATDEB(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGDATDEB(zc) From W1CRITMKO
Gosub _AFF
End

$AMM_MFGDATDEB
Call AM_MFGDATDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGDATDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGDATDEB(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]MFGDATDEBF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MFGDATDEB" : GZNUM = 10781 : Endif
If !mkstat
 ## Action STD
 Call AM_MFGDATDEB(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "MFGDATDEB" : GZNUM = 10781 : Endif
Endif
Gosub _AFF
End

Subprog B1_MFGDATDEB(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]MFGDATDEBF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]MFGDATDEBF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_MFGDATFIN
Onevent BEFORE_AREA Gosub AV_MFGDATFIN From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_MFGDATFIN From W1CRITMKO
Onevent CONTROL Call C_MFGDATFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGDATFIN(zc) From W1CRITMKO
Return

$AV_MFGDATFIN
## Action ADATRELI
Call INIDAT(zc,[M]MFGDATFINF) From ADATREL
Chgfmt [M]MFGDATFIN(indice) With "DZ:"+GFMDAT
Gosub _AFF
Return

Subprog AS_MFGDATFIN(VALEUR)
Variable Date    VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(32514,GBOUT1) From OBJDIV
Onkey 129 Titled GBOUT1 Call B1_MFGDATFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_MFGDATFIN(VALEUR)
Variable Date    VALEUR
## Action STD
Call C_MFGDATFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "MFGDATFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$AMM_MFGDATFIN
Call AM_MFGDATFIN(zc)
If !mkstat & GOBJET
 zoncou = "MFGDATFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGDATFIN(VALEUR)
Variable Date    VALEUR
## Action ADATRELM
Call MODIFDAT(VALEUR,[M]MFGDATFINF) From ADATREL
If mkstat : GERR = 1 : GZONE = "MFGDATFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog B1_MFGDATFIN(VALEUR)
Variable Date    VALEUR
If !GWEBSERV
 ## Action ADATREL
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "ADATREL"
 PARMSK(1) = [M]MFGDATFINF
 Call TRAITE_DAT(VALEUR,PARMSK,"","ADATREL","ADATREL",3,"") From GTRAITE
 [M]MFGDATFINF = PARMSK(1)
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

$ON_CPLWSTDEB
Onevent AFTER_CHANGE Gosub AMM_CPLWSTDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_CPLWSTDEB(zc) From W1CRITMKO
Return

Subprog AS_CPLWSTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6668,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_CPLWSTDEB(zc) From W1CRITMKO
Gosub _AFF
End

$AMM_CPLWSTDEB
Call AM_CPLWSTDEB(zc)
If !mkstat & GOBJET
 zoncou = "CPLWSTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_CPLWSTDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_CPLWSTDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "CPLWSTDEB" : GZNUM = 5964 : Endif
Gosub _AFF
End

Subprog S_CPLWSTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_CPLWSTFIN
Onevent CONTROL Call C_CPLWSTFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_CPLWSTFIN(zc) From W1CRITMKO
Return

Subprog AS_CPLWSTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6668,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_CPLWSTFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_CPLWSTFIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_CPLWSTFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "CPLWSTFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_CPLWSTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SWST
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SWST"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SWST","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGTNUMDEB
Onevent CONTROL Call C_MFGTNUMDEB(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_MFGTNUMDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGTNUMDEB(zc) From W1CRITMKO
Return

Subprog AS_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18518,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGTNUMDEB(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGTNUMDEB" : GZNUM = 10780 : Endif
Endif
Gosub _AFF
End

$AMM_MFGTNUMDEB
Call AM_MFGTNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGTNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGTNUMDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "MFGTNUMDEB" : GZNUM = 10780 : Endif
Gosub _AFF
End

Subprog S_MFGTNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGTNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGTNUM"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = "2"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGTNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGTNUMFIN
Onevent CONTROL Call C_MFGTNUMFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGTNUMFIN(zc) From W1CRITMKO
Return

Subprog AS_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18518,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGTNUMFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGTNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_MFGTNUMFIN(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "MFGTNUMFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_MFGTNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGTNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGTNUM"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = "2"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGTNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGNUMDEB
Onevent CONTROL Call C_MFGNUMDEB(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_MFGNUMDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGNUMDEB(zc) From W1CRITMKO
Return

Subprog AS_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18522,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGNUMDEB(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMDEB" : GZNUM = 9595 : Endif
Endif
Gosub _AFF
End

$AMM_MFGNUMDEB
Call AM_MFGNUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "MFGNUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_MFGNUMDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "MFGNUMDEB" : GZNUM = 9595 : Endif
Gosub _AFF
End

Subprog S_MFGNUMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_MFGNUMFIN
Onevent CONTROL Call C_MFGNUMFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_MFGNUMFIN(zc) From W1CRITMKO
Return

Subprog AS_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(18522,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_MFGNUMFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "MFGNUMFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_MFGNUMFIN(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "MFGNUMFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_MFGNUMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELMFGNUM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELMFGNUM"
 PARMSK(1) = [M:MKO1]MFGFCY
 PARMSK(2) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELMFGNUM","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_RELITMDEB
Onevent AFTER_CHANGE Gosub AMM_RELITMDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_RELITMDEB(zc) From W1CRITMKO
Return

Subprog AS_RELITMDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_RELITMDEB(zc) From W1CRITMKO
Gosub _AFF
End

$AMM_RELITMDEB
Call AM_RELITMDEB(zc)
If !mkstat & GOBJET
 zoncou = "RELITMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_RELITMDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_RELITMDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "RELITMDEB" : GZNUM = 11093 : Endif
Gosub _AFF
End

Subprog S_RELITMDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_RELITMFIN
Onevent CONTROL Call C_RELITMFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_RELITMFIN(zc) From W1CRITMKO
Return

Subprog AS_RELITMFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_RELITMFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_RELITMFIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_RELITMFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "RELITMFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_RELITMFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELITF
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELITF"
 PARMSK(1) = [M]MFGFCY
 PARMSK(2) = ""
 PARMSK(3) = ""
 PARMSK(4) = ""
 PARMSK(5) = ""
 PARMSK(6) = date$
 PARMSK(7) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELITF","STKSEL","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ITMREFDEB
Onevent AFTER_CHANGE Gosub AMM_ITMREFDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_ITMREFDEB(zc) From W1CRITMKO
Return

Subprog AS_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16182,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ITMREFDEB(zc) From W1CRITMKO
Gosub _AFF
End

$AMM_ITMREFDEB
Call AM_ITMREFDEB(zc)
If !mkstat & GOBJET
 zoncou = "ITMREFDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_ITMREFDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "ITMREFDEB" : GZNUM = 3817 : Endif
Gosub _AFF
End

Subprog S_ITMREFDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAM2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAM2"
 PARMSK(1) = [M:MKO1]MFGFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAM2","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ITMREFFIN
Onevent CONTROL Call C_ITMREFFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_ITMREFFIN(zc) From W1CRITMKO
Return

Subprog AS_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(16182,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ITMREFFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
## Action STD
Call C_ITMREFFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "ITMREFFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_ITMREFFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELGAM2
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELGAM2"
 PARMSK(1) = [M:MKO1]MFGFCY
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELGAM2","MFGSELLIB","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_ROUALTDEB
Onevent AFTER_CHANGE Gosub AMM_ROUALTDEB From W1CRITMKO
Onevent CONTROL Call C_ROUALTDEB(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_ROUALTDEB(zc) From W1CRITMKO
Return

Subprog AS_ROUALTDEB(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ROUALTDEB(zc) From W1CRITMKO
Onkey 144 Titled GBOUTP Call P_ROUALTDEB(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_ROUALTDEB(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TRO","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ROUALTDEB" : GZNUM = 2269 : Endif
Gosub _AFF
End

$AMM_ROUALTDEB
Call AM_ROUALTDEB(zc)
If !mkstat & GOBJET
 zoncou = "ROUALTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUALTDEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_ROUALTDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "ROUALTDEB" : GZNUM = 2269 : Endif
If !mkstat & evalue("dim("+clanam([M])+"ZROUALTDEB)")>indice
 [M]ROUALTDEB(indice) = VALEUR
 Affzo ZROUALTDEB(indice)
Endif
Gosub _AFF
End

Subprog S_ROUALTDEB(VALEUR)
Variable Decimal VALEUR
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TRO"
PARMSK(2) = "!"
Call S_TAB_NUM(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog P_ROUALTDEB(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUALTDEB
Onevent BEFORE_AREA Gosub AV_ZROUALTDEB From W1CRITMKO
Return

$AV_ZROUALTDEB
Call LECTEXTRA(zc,"TABROUALT","TRODESAXX",num$([M]ROUALTDEB(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_ROUALTFIN
Onevent CONTROL Call C_ROUALTFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_ROUALTFIN(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_ROUALTFIN From W1CRITMKO
Return

Subprog AS_ROUALTFIN(VALEUR)
Variable Decimal VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ROUALTFIN(zc) From W1CRITMKO
Onkey 144 Titled GBOUTP Call P_ROUALTFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_ROUALTFIN(VALEUR)
Variable Decimal VALEUR
## Action %CNTOBJ
Call CONTNUM("TRO","!",VALEUR,"",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ROUALTFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action STD
 Call C_ROUALTFIN(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "ROUALTFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

$AMM_ROUALTFIN
Call AM_ROUALTFIN(zc)
If !mkstat & GOBJET
 zoncou = "ROUALTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ROUALTFIN(VALEUR)
Variable Decimal VALEUR
If !mkstat & evalue("dim("+clanam([M])+"ZROUALTFIN)")>indice
 [M]ROUALTFIN(indice) = VALEUR
 Affzo ZROUALTFIN(indice)
Endif
Gosub _AFF
End

Subprog S_ROUALTFIN(VALEUR)
Variable Decimal VALEUR
Local Char PARMSK(250)(1..16)
PARMSK(1) = "TRO"
PARMSK(2) = "!"
Call S_TAB_NUM(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog P_ROUALTFIN(VALEUR)
Variable Decimal VALEUR
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("TRO",num$(VALEUR),PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZROUALTFIN
Onevent BEFORE_AREA Gosub AV_ZROUALTFIN From W1CRITMKO
Return

$AV_ZROUALTFIN
Call LECTEXTRA(zc,"TABROUALT","TRODESAXX",num$([M]ROUALTFIN(indice)),"") From ATEXTRA
Gosub _AFF
Return

$ON_OPENUMDEB
Onevent AFTER_CHANGE Gosub AMM_OPENUMDEB From W1CRITMKO
Onevent CONTROL Call C_OPENUMDEB(zc) From W1CRITMKO
Return

Subprog C_OPENUMDEB(VALEUR)
Variable Decimal VALEUR
Gosub _AFF
End

$AMM_OPENUMDEB
Call AM_OPENUMDEB(zc)
If !mkstat & GOBJET
 zoncou = "OPENUMDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_OPENUMDEB(VALEUR)
Variable Decimal VALEUR
## Action STD
Call AM_OPENUMDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "OPENUMDEB" : GZNUM = 2296 : Endif
Gosub _AFF
End

$ON_OPENUMFIN
Onevent CONTROL Call C_OPENUMFIN(zc) From W1CRITMKO
Return

Subprog C_OPENUMFIN(VALEUR)
Variable Decimal VALEUR
## Action STD
Call C_OPENUMFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "OPENUMFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_PJTDEB
Onevent BEFORE_INPUT Call AS_PJTDEB(zc) From W1CRITMKO
Onevent CONTROL Call C_PJTDEB(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_PJTDEB From W1CRITMKO
Return

Subprog IB_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTDEB(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTDEB(INDIC) = VALEUR
 Affzo PJTDEB(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTDEB(zc) From W1CRITMKO
Onkey 130 Titled GBOUT2 Call B2_PJTDEB(zc) From W1CRITMKO
Onkey 131 Titled GBOUT3 Call B3_PJTDEB(zc) From W1CRITMKO
Onkey 132 Titled GBOUT4 Call B4_PJTDEB(zc) From W1CRITMKO
Onkey 172 Titled GBOUT15 Call B15_PJTDEB(zc) From W1CRITMKO
Onkey 173 Titled GBOUT16 Call B16_PJTDEB(zc) From W1CRITMKO
Onkey 174 Titled GBOUT17 Call B17_PJTDEB(zc) From W1CRITMKO
Onkey 175 Titled GBOUT18 Call B18_PJTDEB(zc) From W1CRITMKO
Onkey 176 Titled GBOUT19 Call B19_PJTDEB(zc) From W1CRITMKO
Onkey   2 Titled GBOUTS Call S_PJTDEB(zc) From W1CRITMKO
Onkey 144 Titled GBOUTP Call P_PJTDEB(zc) From W1CRITMKO
Onkey 146 Titled GBOUTA Call SA_PJTDEB(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

$AMM_PJTDEB
Call AM_PJTDEB(zc)
If !mkstat & GOBJET
 zoncou = "PJTDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTDEB(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
If !mkstat
 ## Action STD
 Call AM_PJTDEB(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "PJTDEB" : GZNUM = 1886 : Endif
Endif
Gosub _AFF
End

Subprog S_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CMKO","PJTDEB",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTDEB"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTDEB(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_PJTFIN
Onevent BEFORE_INPUT Call AS_PJTFIN(zc) From W1CRITMKO
Onevent CONTROL Call C_PJTFIN(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_PJTFIN From W1CRITMKO
Return

Subprog IB_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTINIBUT
Call PJT_INIT_BUTTON(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Gosub _AFF
End

Subprog AS_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(43841,GBOUT1) From OBJDIV
Call TEXTE(14667,GBOUT2) From OBJDIV
Call TEXTE(54273,GBOUT3) From OBJDIV
Call TEXTE(43844,GBOUT4) From OBJDIV
Call TEXTE(43868,GBOUT15) From OBJDIV
Call TEXTE(17676,GBOUT16) From OBJDIV
Call TEXTE(54274,GBOUT17) From OBJDIV
Call TEXTE(54275,GBOUT18) From OBJDIV
Call TEXTE(11781,GBOUT19) From OBJDIV
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Call IB_PJTFIN(VALEUR)
## Action PJTBEFZON
Call PJT_BEFORE_ZONE(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat=2
 [M]PJTFIN(INDIC) = VALEUR
 Affzo PJTFIN(INDIC) : mkstat = 2
Endif
Onkey 129 Titled GBOUT1 Call B1_PJTFIN(zc) From W1CRITMKO
Onkey 130 Titled GBOUT2 Call B2_PJTFIN(zc) From W1CRITMKO
Onkey 131 Titled GBOUT3 Call B3_PJTFIN(zc) From W1CRITMKO
Onkey 132 Titled GBOUT4 Call B4_PJTFIN(zc) From W1CRITMKO
Onkey 172 Titled GBOUT15 Call B15_PJTFIN(zc) From W1CRITMKO
Onkey 173 Titled GBOUT16 Call B16_PJTFIN(zc) From W1CRITMKO
Onkey 174 Titled GBOUT17 Call B17_PJTFIN(zc) From W1CRITMKO
Onkey 175 Titled GBOUT18 Call B18_PJTFIN(zc) From W1CRITMKO
Onkey 176 Titled GBOUT19 Call B19_PJTFIN(zc) From W1CRITMKO
Onkey   2 Titled GBOUTS Call S_PJTFIN(zc) From W1CRITMKO
Onkey 144 Titled GBOUTP Call P_PJTFIN(zc) From W1CRITMKO
Onkey 146 Titled GBOUTA Call SA_PJTFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTCTL
Call PJT_CONTROL(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
If !mkstat
 ## Action CONTOBJN
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "CONTOBJN"
 Call S_AFF_CHAR(VALEUR,PARMSK,"CONTOBJN","CONTOBJ","") From GACTION
 GACTION = SAVACT
 If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
 If !mkstat
  ## Action STD
  Call C_PJTFIN(VALEUR) From CNSMKOSTD
  If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
 Endif
Endif
Gosub _AFF
End

$AMM_PJTFIN
Call AM_PJTFIN(zc)
If !mkstat & GOBJET
 zoncou = "PJTFIN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_PJTFIN(VALEUR)
Variable Char    VALEUR()
## Action PJTAFTMOD
Call PJT_AFTER_MODIFY(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
&,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
&,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
If mkstat : GERR = 1 : GZONE = "PJTFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

Subprog S_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBUT
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBUT"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJT","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

Subprog B1_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU1CRM
 Call PJT_BUT1_CRM(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B2_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU2PRP
 Call PJT_BUT2_PRP(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B3_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU3BUD
 Call PJT_BUT3_PRPBUD(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B4_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTBU4TAC
 Call PJT_BUT4_PRPTAC(VALEUR,"CMKO","PJTFIN",0,8,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES
& ,[V]CST_ANO,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[V]CST_AYES,[M:MKO1]MFGFCY,""
& ,"","","",func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)) From TRTPJT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B15_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBCRM
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBCRM"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTCRM","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B16_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBPRP
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBPRP"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTPRP","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B17_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBUD
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBUD"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBUD","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B18_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBTAC
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBTAC"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTTAC","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog B19_PJTFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action PJTSELBBPR
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "PJTSELBBPR"
 PARMSK(1) = "CMKO"
 PARMSK(2) = "PJTFIN"
 PARMSK(3) = "0"
 PARMSK(4) = "8"
 PARMSK(5) = num$([V]CST_AYES)
 PARMSK(6) = num$([V]CST_AYES)
 PARMSK(7) = num$([V]CST_AYES)
 PARMSK(8) = num$([V]CST_ANO)
 PARMSK(9) = num$([V]CST_AYES)
 PARMSK(10) = num$([V]CST_AYES)
 PARMSK(11) = num$([V]CST_AYES)
 PARMSK(12) = num$([V]CST_AYES)
 PARMSK(13) = num$([V]CST_AYES)
 PARMSK(14) = [M:MKO1]MFGFCY
 PARMSK(15) = ""
 PARMSK(16) = ""
 PARMSK(17) = ""
 PARMSK(18) = ""
 PARMSK(19) = func TRTPJT.GET_CPY_FROM_FCY([M:MKO1]MFGFCY)
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELPJTBPR","TRTPJT","") From GACTION
 GACTION = SAVACT
Endif
If mkstat=99 : mkstat = 0 : Elsif mkstat=0 : mkstat = 2 : Endif
Gosub _AFF
End

Subprog SA_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "PIM"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_PJTFIN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = ""
Call VISU("PIM",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_VCRORIDEB
Onevent CONTROL Call C_VCRORIDEB(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_VCRORIDEB From W1CRITMKO
Onevent BEFORE_INPUT Call AS_VCRORIDEB(zc) From W1CRITMKO
Return

Subprog AS_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6109,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_VCRORIDEB(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIDEB" : GZNUM = 3312 : Endif
Endif
Gosub _AFF
End

$AMM_VCRORIDEB
Call AM_VCRORIDEB(zc)
If !mkstat & GOBJET
 zoncou = "VCRORIDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
## Action STD
Call AM_VCRORIDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "VCRORIDEB" : GZNUM = 3312 : Endif
Gosub _AFF
End

Subprog S_VCRORIDEB(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_VCRORIFIN
Onevent CONTROL Call C_VCRORIFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_VCRORIFIN(zc) From W1CRITMKO
Return

Subprog AS_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(6109,GBOUTS) From OBJDIV
Onkey   2 Titled GBOUTS Call S_VCRORIFIN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action CONTVCR
 Call CONTVCR(VALEUR) From TRTDIV
 If mkstat : GERR = 1 : GZONE = "VCRORIFIN" : GZNUM = 0 : Endif
Endif
If !mkstat
 ## Action STD
 Call C_VCRORIFIN(VALEUR) From CNSMKOSTD
 If mkstat : GERR = 1 : GZONE = "VCRORIFIN" : GZNUM = 0 : Endif
Endif
Gosub _AFF
End

Subprog S_VCRORIFIN(VALEUR)
Variable Char    VALEUR()
If !GWEBSERV
 ## Action SELOBJW
 Local Char    PARMSK(250)(1..20) , SAVACT(20)
 SAVACT = GACTION : GACTION = "SELOBJW"
 PARMSK(1) = "SOH"
 PARMSK(2) = "#"
 PARMSK(3) = ""
 Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
 GACTION = SAVACT
Endif
Gosub _AFF
End

$ON_TIMTYPDEB
Onevent AFTER_CHANGE Gosub AMM_TIMTYPDEB From W1CRITMKO
Onevent INIT_AREA Call D_TIMTYPDEB(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_TIMTYPDEB(zc) From W1CRITMKO
Return

Subprog D_TIMTYPDEB(VALEUR)
Variable Integer VALEUR
If varinit([M]TIMTYPDEB,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_TIMTYPDEB(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$AMM_TIMTYPDEB
Call AM_TIMTYPDEB(zc)
If !mkstat & GOBJET
 zoncou = "TIMTYPDEB" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_TIMTYPDEB(VALEUR)
Variable Integer VALEUR
## Action STD
Call AM_TIMTYPDEB(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "TIMTYPDEB" : GZNUM = 10884 : Endif
Gosub _AFF
End

$ON_TIMTYPFIN
Onevent CONTROL Call C_TIMTYPFIN(zc) From W1CRITMKO
Onevent INIT_AREA Call D_TIMTYPFIN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_TIMTYPFIN(zc) From W1CRITMKO
Return

Subprog D_TIMTYPFIN(VALEUR)
Variable Integer VALEUR
If varinit([M]TIMTYPFIN,indice)=0
 VALEUR = 3
Endif
Gosub _AFF
End

Subprog AS_TIMTYPFIN(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog C_TIMTYPFIN(VALEUR)
Variable Integer VALEUR
## Action STD
Call C_TIMTYPFIN(VALEUR) From CNSMKOSTD
If mkstat : GERR = 1 : GZONE = "TIMTYPFIN" : GZNUM = 0 : Endif
Gosub _AFF
End

$ON_ECRAN
Onevent CONTROL Call C_ECRAN(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_ECRAN(zc) From W1CRITMKO
Onevent AFTER_CHANGE Gosub AMM_ECRAN From W1CRITMKO
Return

Subprog AS_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Integer INDIC : INDIC = indice
Raz mkstat
Call TEXTE(8255,GBOUTS) From OBJDIV
Call TEXTE(12276,GBOUTP) From OBJDIV
Call TEXTE(16134,GBOUTA) From OBJDIV
Onkey   2 Titled GBOUTS Call S_ECRAN(zc) From W1CRITMKO
Onkey 144 Titled GBOUTP Call P_ECRAN(zc) From W1CRITMKO
Onkey 146 Titled GBOUTA Call SA_ECRAN(zc) From W1CRITMKO
Gosub _AFF
End

Subprog C_ECRAN(VALEUR)
Variable Char    VALEUR()
## Action %CNTOBJ
Call CONTSEL("GTC","!",VALEUR,"MKO",mkstat) From CONTOBJ
If mkstat : GERR = 1 : GZONE = "ECRAN" : GZNUM = 46 : Endif
Gosub _AFF
End

$AMM_ECRAN
Call AM_ECRAN(zc)
If !mkstat & GOBJET
 zoncou = "ECRAN" : Gosub APRES_MODIF From =GPROGRAMME
Endif
Return

Subprog AM_ECRAN(VALEUR)
Variable Char    VALEUR()
If !mkstat & evalue("dim("+clanam([M])+"ZECRAN)")>indice
 [M]ECRAN(indice) = VALEUR
 Affzo ZECRAN(indice)
Endif
Gosub _AFF
End

Subprog S_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16)
PARMSK(1) = "GTC"
PARMSK(2) = "!"
PARMSK(3) = "MKO"
Call S_TAB_CHAR(VALEUR,PARMSK,"SELOBJ","SELOBJ","") From GACTION
Gosub _AFF
End

Subprog SA_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PARMSK(250)(1..16) , SAVACT(20)
SAVACT = GACTION : GACTION = "SELOBJAW"
PARMSK(1) = "GTC"
PARMSK(2) = "MKO"
Call SAISIE_CHAR(VALEUR,PARMSK,"DSELOBJAW","SELOBJAW","XWDSELOBJAW") From GSAISIE
GACTION = SAVACT
Gosub _AFF
End

Subprog P_ECRAN(VALEUR)
Variable Char    VALEUR()
Local Char PAROBJ(250)
PAROBJ = "MKO"
Call VISU("GTC",VALEUR,PAROBJ) From SUBAOP
Gosub _AFF
End

$ON_ZECRAN
Onevent BEFORE_AREA Gosub AV_ZECRAN From W1CRITMKO
Return

$AV_ZECRAN
Call LECTEXTRA(zc,"GTABACC","INTIT","MKO",num$([M]ECRAN(indice))) From ATEXTRA
Gosub _AFF
Return

$ON_TRI
Onevent INIT_AREA Call D_TRI(zc) From W1CRITMKO
Onevent BEFORE_INPUT Call AS_TRI(zc) From W1CRITMKO
Return

Subprog D_TRI(VALEUR)
Variable Integer VALEUR
If varinit([M]TRI,indice)=0
 VALEUR = 1
Endif
Gosub _AFF
End

Subprog AS_TRI(VALEUR)
Variable Integer VALEUR
Local Integer INDIC : INDIC = indice
Raz mkstat
If VALEUR<1
 VALEUR = 1
Endif
Gosub _AFF
End

$CHG_STY
Return


