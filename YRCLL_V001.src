#<AdxTL>@(#)0.0.0.0 $Revision$
Subprog YRCLL_V001(YBPNUM,YNREC,YSTATUS,YMESS,YCLLNUM,YSALFCY,YCLLCMP,YCLLCCN,YCLLCOR,YCLLOPP,YCLLDON,YCLLTYP,YCLLDAT,YCLLHOU,YCLLWEE,YCLLCAT,YCLLREP,
& YCLLPIOLEV,YCLLETS,YCLLMOB,YCLLORIVCR,YFULRPO,YRPOICO,YCLLSAO,YCLLDUR,YCLLEML,YCLLOBJ,YCLLORIADI,YCREUSR,YCREDAT,YCRETIM)
Value Char YBPNUM
Value Integer YNREC
Variable Integer YSTATUS
Variable Char YMESS
Variable Char YCLLNUM()(1..2000)
Variable Char YSALFCY()(1..2000)
Variable Char YCLLCMP()(1..2000)
Variable Char YCLLCCN()(1..2000)
Variable Char YCLLCOR()(1..2000)
Variable Char YCLLOPP()(1..2000)
Variable Integer YCLLDON(1..2000)
Variable Integer YCLLTYP(1..2000)
Variable Char YCLLDAT()(1..2000)
Variable Char YCLLHOU()(1..2000)
Variable Integer YCLLWEE(1..2000)
Variable Char YCLLCAT()(1..2000)
Variable Char YCLLREP()(1..2000)
Variable Char YCLLPIOLEV()(1..2000)
Variable Char YCLLETS()(1..2000)
Variable Char YCLLMOB()(1..2000)
Variable Char YCLLORIVCR()(1..2000)

Variable Char YFULRPO()(1..2000)
Variable Char YRPOICO()(1..2000)
Variable Char YCLLSAO()(1..2000)
Variable Integer YCLLDUR(1..2000)
Variable Char YCLLEML()(1..2000)
Variable Char YCLLOBJ()(1..2000)
Variable Char YCLLORIADI()(1..2000)
Variable Char YCREUSR()(1..2000)
Variable Date YCREDAT(1..2000)
Variable Char YCRETIM()(1..2000)

Local Integer YCOUNT : YCOUNT = 1
If clalev([F:YCLL]) = 0 : Local File PHONECALL[YCLL] : Endif

Filter [F:YCLL] Where CLLCMP = YBPNUM

For[F:YCLL]

  YCLLNUM(YCOUNT) = [F:YCLL]CLLNUM
  YSALFCY(YCOUNT) = [F:YCLL]SALFCY
  YCLLCMP(YCOUNT) = [F:YCLL]CLLCMP
  YCLLCCN(YCOUNT) = [F:YCLL]CLLCCN
  YCLLCOR(YCOUNT) = [F:YCLL]CLLCOR
  YCLLOPP(YCOUNT) = [F:YCLL]CLLOPP
  YCLLDON(YCOUNT) = [F:YCLL]CLLDON
  YCLLTYP(YCOUNT) = [F:YCLL]CLLTYP
  YCLLDAT(YCOUNT) = [F:YCLL]CLLDAT
  YCLLHOU(YCOUNT) = [F:YCLL]CLLHOU
  YCLLWEE(YCOUNT) = [F:YCLL]CLLWEE
  YCLLCAT(YCOUNT) = [F:YCLL]CLLCAT
  YCLLREP(YCOUNT) = [F:YCLL]CLLREP
  YCLLPIOLEV(YCOUNT) = [F:YCLL]CLLPIOLEV
  YCLLETS(YCOUNT) = [F:YCLL]CLLETS
  YCLLMOB(YCOUNT) = [F:YCLL]CLLMOB
  YCLLORIVCR(YCOUNT) = [F:YCLL]CLLORIVCR
  #YFULRPO(YCOUNT) = [F:YCLL]FULRPO
  #YRPOICO(YCOUNT) = [F:YCLL]RPOICO
  YCLLSAO(YCOUNT) = [F:YCLL]CLLSAO
  YCLLDUR(YCOUNT) = [F:YCLL]CLLDUR

  YCLLEML(YCOUNT) = [F:YCLL]CLLEML
  YCLLOBJ(YCOUNT) = [F:YCLL]CLLOBJ
  YCLLORIADI(YCOUNT) = [F:YCLL]CLLORIADI
  YCREUSR(YCOUNT) = [F:YCLL]CREUSR
  YCREDAT(YCOUNT) = [F:YCLL]CREDAT
  YCRETIM(YCOUNT) = [F:YCLL]CREHOU

  If YCOUNT >= YNREC
    Break
  Endif

  YCOUNT += 1
Next
Filter[F:YCLL]

If YCOUNT >= 2
 YSTATUS = 1
 YMESS = "Success"
Else
  YSTATUS = 2
  YMESS = "No records found."
Endif
End

